
const INPUT_SIZE = 76;
const H1 = 32;
const H2 = 32;
const OUTPUT_SIZE = 5; // [mvx, mvy, fx, fy, fire_logit]

const W1 = [
  0.231249,0.252307,0.277549,-0.080441,-0.056814,-0.017329,-0.03729,0.086753,0.122447,-0.381046,-0.012094,0.002491,-0.183581,0.097481,0.067492,0.057175,
  0.059112,0.214549,0.42343,0.303794,0.116437,-0.137641,0.138886,0.375197,0.177459,-0.137844,-0.354217,0.393907,-0.011193,0.021641,-0.025584,0.085705,
  -0.07592,-0.095949,-0.013901,-0.16592,0.090642,0.003898,-0.053293,0.001682,0.001988,0.043385,-0.01573,0.343829,-0.092087,-0.008471,0.222984,0.334922,
  -0.129952,0.158514,-0.017785,0.014144,0.159652,0.274476,0.004687,0.116878,-0.295685,-0.107057,0.265392,0.123549,0.182867,0.13654,-0.107376,0.062359,
  0.034339,0.027035,0.086895,0.002537,0.006179,0.021991,-0.112255,-0.035348,0.14066,0.07763,-0.073481,0.009612,-0.16441,0.07252,0.09489,0.282891,
  0.168923,0.002073,-0.04729,0.182894,-0.054457,0.054282,0.00975,0.021356,0.194464,-0.058447,0.209679,0.07782,0.094445,0.00661,-0.111975,0.042909,
  0.102029,0.095552,-0.035737,-0.074742,-0.210353,0.109379,0.01774,-0.485099,-0.127244,0.176676,0.027057,-0.140293,0.13579,-0.02035,-0.071361,0.030229,
  -0.099923,-0.036192,0.029663,-0.023531,-0.112156,0.144072,0.235565,-0.475378,-0.03504,-0.145612,0.0342,-0.063241,0.069014,-0.264007,0.047478,-0.115281,
  0.027475,-0.132847,0.341269,-0.126718,0.23187,0.268695,-0.080436,-0.063963,0.038427,-0.245087,0.130909,0.078642,0.017888,-0.23696,0.247609,-0.02891,
  0.115154,0.139652,0.100362,0.005329,0.11403,0.06441,0.029392,0.32734,0.083084,0.107289,0.060838,-0.055452,0.074276,0.056687,-0.065191,0.052332,
  -0.152936,-0.187324,0.017415,0.021242,-0.003169,0.026812,-0.063456,-0.178316,0.075306,0.390732,-0.019557,-0.068721,-0.049308,-0.079795,0.198757,0.128274,
  -0.119618,-0.036931,0.195009,-0.147944,0.192563,-0.087338,-0.114024,-0.315607,0.192127,-0.023869,-0.174601,-0.259945,-0.022001,0.021529,-0.069289,0.199371,
  -0.15614,-0.02703,-0.140107,0.123729,0.248163,0.023272,0.043381,0.18092,0.009153,-0.207206,0.109657,-0.01964,-0.01565,0.264206,0.19638,-0.170432,
  -0.152638,-0.110755,-0.114911,0.185059,0.218309,-0.248634,-0.012094,-0.067803,0.01673,0.260555,-0.167029,-0.056029,-0.15504,-0.108546,0.039792,0.11992,
  -0.08085,0.054533,0.155033,0.083988,0.107993,0.225401,-0.125344,0.170629,0.0079,0.059999,-0.17205,-0.010754,-0.016086,-0.230478,-0.177144,0.046707,
  0.043333,0.030807,-0.210242,-0.005623,-0.081899,0.108946,0.196994,-0.062466,0.066424,0.075504,-0.105066,0.022428,-0.036635,0.0508,-0.091117,0.193803,
  0.234642,-0.091593,-0.058831,-0.052719,-0.190395,-0.011782,-0.05412,-0.037195,0.047667,-0.106122,-0.094499,-0.012481,0.12228,0.120793,-0.124058,0.256646,
  -0.206133,-0.142556,0.034169,0.215976,0.166105,0.150425,-0.118902,0.013237,0.227881,0.404726,0.14554,0.123853,-0.211866,0.021287,0.069836,0.088628,
  0.266148,0.011142,-0.033858,-0.060848,0.069514,-0.001845,-0.164382,0.232031,-0.013076,0.088518,-0.024882,0.121853,-0.09547,0.129247,0.023822,0.0701,
  0.044805,-0.011508,-0.288175,0.007469,0.167103,0.127085,0.025522,0.197875,0.005763,0.194158,0.045954,0.055957,0.033337,-0.117676,-0.067896,0.009017,
  0.035343,-0.242824,-0.020475,-0.034971,-0.042475,0.07191,-0.047921,0.086175,-0.278755,-0.045365,0.123885,-0.184203,0.196427,-0.004445,0.062692,0.049139,
  0.042708,0.137667,-0.25662,0.083362,0.104321,0.124092,0.068975,-0.106787,0.235856,0.047117,0.038217,0.100415,0.223961,-0.033163,-0.014981,-0.002237,
  0.074313,-0.18447,0.203712,-0.063977,-0.106069,-0.139609,0.218535,-0.165839,0.237946,0.017028,-0.048425,-0.067711,-0.149326,0.061298,0.273153,0.072547,
  0.137193,0.015049,0.033872,-0.057425,0.211321,-0.108231,0.229444,0.031371,0.057188,0.037516,0.029653,0.132936,-0.059273,-0.037365,-0.026374,0.204505,
  0.123123,0.112858,0.084817,-0.160403,-0.002883,0.047882,0.266663,-0.027175,-0.118324,0.12456,-0.055469,0.069956,-0.077283,-0.138015,-0.073203,-0.010261,
  0.123227,-0.035158,0.081683,-0.066688,-0.167863,0.127134,0.127322,-0.194224,0.028522,0.134337,0.054119,-0.05296,0.006513,0.13624,-0.207391,0.21178,
  0.111596,-0.003922,0.029001,-0.197344,0.122451,-0.043228,-0.07487,0.17784,0.114142,0.115804,-0.15813,-0.052404,-0.087087,0.18943,0.171276,0.105773,
  0.040023,-0.083138,-0.072463,0.135607,0.46744,0.099743,-0.112477,-0.052892,-0.140221,-0.024942,0.011883,0.063352,0.049967,-0.007052,-0.050341,0.002863,
  0.035555,0.0147,0.100548,-0.04223,0.042134,-0.067829,-0.041812,-0.078869,-0.394323,0.179906,0.129637,0.047157,-0.194705,0.037108,0.064449,0.191894,
  0.159489,0.344247,-0.163247,0.293521,0.091716,0.136242,-0.010424,0.029076,0.132582,0.001106,-0.00891,-0.065589,-0.0567,0.042175,0.051132,-0.151723,
  -0.185627,0.021391,0.05772,-0.107138,-0.297818,0.040708,0.025775,-0.044988,0.356386,-0.174938,0.137028,-0.190978,-0.079992,-0.07614,-0.151951,0.398727,
  -0.222571,-0.081983,-0.153999,-0.495894,0.170703,0.103813,-0.017748,-0.060069,0.120527,-0.170282,0.006203,0.193054,-0.103065,0.006783,0.364155,-0.248314,
  0.012365,0.131644,-0.01555,-0.118559,0.011093,-0.234566,-0.103794,0.058922,0.066304,0.021402,0.124638,0.199293,-0.009892,0.018558,-0.055227,-0.095637,
  0.1006,-0.056904,0.102509,-0.097548,-0.16312,-0.24644,0.053525,-0.087985,0.257169,-0.14664,0.159833,0.249545,0.117496,0.424051,0.15791,0.078168,
  0.23759,0.043348,0.13577,-0.097177,0.205834,-0.017892,-0.037489,-0.045111,0.110127,0.122843,-0.194956,-0.051857,-0.084906,0.028587,0.110075,0.057819,
  -0.227617,0.186038,-0.070601,0.102921,0.178572,0.020583,0.084807,0.24937,0.336935,-0.156773,-0.209748,0.164419,0.041437,0.054865,0.083418,-0.268134,
  0.01835,0.3109,0.080148,-0.292869,-0.013107,-0.249624,0.052774,0.214961,-0.045026,-0.147196,-0.016502,0.020301,0.126772,0.01566,0.136218,-0.014523,
  -0.113181,0.031313,0.179802,0.304519,0.021748,-0.221606,0.136473,-0.202596,0.128974,0.324431,0.01175,-0.094097,-0.06924,0.156021,0.066631,0.057369,
  -0.242566,-0.263158,0.082489,0.274178,0.111404,-0.04734,-0.053722,0.183313,0.11506,0.458901,0.165932,0.103643,0.165155,-0.129389,0.108173,0.030912,
  -0.041097,-0.049275,-0.044234,0.206114,0.216834,0.026496,-0.044073,-0.117768,0.101188,-0.086122,0.050626,0.015543,-0.083579,0.047146,0.265658,0.110068,
  -0.147321,0.124068,0.048411,0.156616,-0.047327,-0.103875,0.048432,0.167079,-0.02982,0.020041,-0.061373,-0.035818,0.047782,0.090457,0.038209,-0.164425,
  -0.1612,-0.013872,0.273196,0.038358,-0.007351,-0.103647,0.093237,0.075898,0.333202,0.172131,0.032848,-0.222281,-0.00693,-0.013317,0.282612,0.126687,
  0.000137,-0.020772,-0.16813,-0.105393,0.139904,-0.095715,-0.020528,-0.243683,0.020324,-0.027296,0.090097,0.041266,-0.129351,-0.102434,0.107737,-0.114979,
  0.110835,-0.060537,0.108392,0.169065,0.076129,-0.013412,0.159818,0.016859,0.255534,0.116514,0.089879,0.223239,0.114398,-0.167365,0.27271,0.138146,
  -0.049266,0.185881,-0.312935,0.034765,0.076815,-0.058174,0.097009,-0.068336,-0.010557,0.067275,0.025777,0.096314,0.048628,0.123301,0.232706,0.263149,
  -0.031127,-0.121748,-0.063413,-0.011151,0.082827,0.099182,0.00125,-0.192035,-0.085239,0.118928,-0.142797,-0.025796,0.245366,0.073151,-0.08788,-0.119151,
  -0.007744,0.217453,0.038278,0.137262,-0.05669,-0.010127,0.07073,0.012979,0.03037,0.109622,0.063809,0.146466,0.137379,0.089216,0.033613,0.081829,
  0.080948,-0.035933,0.25701,-0.012283,0.137053,0.026079,-0.237186,0.038919,0.007233,0.129018,0.049523,0.1635,-0.141972,-0.000099,0.068541,-0.086505,
  0.284747,-0.196997,0.22773,0.323352,-0.013431,-0.208766,-0.132829,-0.074146,-0.005072,0.184256,-0.036847,-0.011007,-0.223028,0.069623,0.11758,0.004287,
  0.068281,-0.014497,0.140602,0.008066,-0.033605,0.086583,0.141954,0.059634,0.232638,0.004817,0.227604,0.08831,0.141897,-0.211777,-0.025257,0.216811,
  -0.131638,0.27112,-0.111228,-0.172998,-0.063589,0.182118,0.090233,0.098929,-0.040283,-0.006336,-0.270862,0.091016,0.1001,0.191659,-0.108384,-0.122747,
  -0.124232,-0.038024,-0.00844,0.063135,0.079876,0.048025,-0.073429,-0.083597,0.321103,0.156478,-0.159449,0.055817,-0.050203,-0.013741,0.31841,0.196692,
  0.073984,-0.11818,0.01651,0.088508,0.1312,-0.049206,0.025182,0.270474,0.04149,0.057806,0.170953,0.125773,0.108982,-0.428161,0.501593,-0.035524,
  -0.229812,-0.062461,0.124928,0.071849,-0.198539,0.021828,0.015555,-0.015806,0.12291,-0.155494,-0.071056,-0.10351,-0.376223,0.285575,-0.012232,-0.309168,
  -0.163037,-0.054532,0.059355,-0.15631,-0.007488,-0.093043,0.096893,-0.017635,0.229107,0.054752,0.430329,0.022831,0.019911,0.01221,0.230391,-0.321197,
  -0.067483,0.173704,-0.030813,0.008768,-0.140686,-0.006771,-0.139564,0.085783,0.131765,0.157433,-0.156106,-0.144944,-0.175705,0.089021,0.032312,0.253304,
  -0.264218,0.016791,-0.164803,0.075411,-0.095075,0.065935,-0.224484,-0.072137,-0.007324,0.095406,-0.055471,-0.01348,-0.003295,-0.207779,0.024338,0.220557,
  -0.01131,-0.040829,-0.045666,-0.009792,-0.047667,0.019947,-0.141142,0.112932,0.098531,-0.155702,-0.06235,0.020026,-0.24086,0.047655,-0.156088,-0.029996,
  -0.012707,0.112406,-0.047265,-0.247277,-0.12398,-0.035475,0.076738,0.196647,-0.02042,-0.212485,-0.026959,0.000509,-0.032713,0.041008,-0.09608,0.057868,
  0.077416,-0.063487,0.009248,-0.131312,-0.014471,-0.038847,-0.23589,0.060778,-0.235116,0.002525,-0.034374,0.065507,0.047786,-0.140224,0.074648,-0.154519,
  -0.063424,-0.051858,-0.112917,-0.169478,0.07843,0.118349,-0.032771,0.02241,0.063097,-0.040755,-0.027059,-0.009486,-0.030183,-0.052684,-0.036807,-0.041972,
  0.112568,-0.04201,0.056222,-0.015798,-0.083734,-0.107573,-0.065848,0.051922,0.168877,-0.107143,0.031732,0.087719,-0.044237,0.259588,0.011598,-0.176822,
  -0.087824,-0.025342,-0.044488,-0.030542,-0.035881,-0.059793,0.077038,-0.013054,0.084323,-0.177662,0.100376,0.090573,0.021363,-0.137889,0.002029,-0.040591,
  -0.169648,0.100885,-0.083715,-0.079903,0.099416,0.117757,0.031451,0.151117,0.058442,0.148265,-0.18171,0.025129,-0.032957,0.030822,-0.015311,0.079303,
  0.052091,0.123447,-0.072098,-0.068652,0.054241,-0.012486,-0.0877,-0.059705,0.104262,-0.114962,0.056872,-0.079227,-0.093722,0.030255,-0.238218,0.264626,
  -0.105171,-0.017901,-0.09722,0.224062,-0.063371,-0.121713,0.051567,-0.091224,0.067517,-0.022443,0.002278,-0.123503,0.094656,-0.169294,-0.045749,0.106478,
  0.060947,-0.005408,-0.046666,-0.151013,-0.108636,-0.146436,0.076293,-0.164829,-0.252168,0.12763,0.068211,0.047908,-0.118845,0.042705,0.104772,-0.046088,
  0.293642,0.110498,-0.006141,0.018687,0.104715,0.215198,0.020994,-0.047526,0.230854,-0.094183,0.122049,-0.055241,-0.008203,0.072597,0.100178,0.153761,
  -0.129105,-0.051451,-0.300395,0.031814,-0.19691,0.136036,-0.111743,0.125776,0.133838,-0.308571,0.275142,-0.12223,0.098991,-0.106475,-0.062149,0.285482,
  -0.127611,-0.138356,-0.036531,-0.1896,-0.134249,0.103184,0.151096,0.231216,0.097741,-0.332667,-0.110004,0.012097,0.188564,0.058663,-0.010191,-0.10409,
  -0.176691,0.190089,0.094647,-0.014375,0.078885,-0.233692,-0.079865,0.058007,0.346608,0.077517,0.128301,-0.069717,0.014468,-0.069687,-0.00217,0.143611,
  0.107017,0.169904,-0.002606,0.139565,0.264567,-0.016515,-0.098482,-0.061225,0.141139,-0.157378,-0.005566,0.090247,-0.021632,-0.465912,0.015436,-0.016422,
  -0.119552,-0.036511,-0.031651,0.130866,0.312093,-0.081712,-0.08465,-0.003825,-0.075407,0.138355,0.01341,0.024528,-0.057221,0.060176,0.361092,-0.047301,
  0.039085,0.021519,0.05674,0.029985,0.070953,0.096013,0.009388,0.155688,0.088055,0.079958,-0.144064,-0.073708,0.152551,-0.084822,-0.245671,0.23022,
  0.041439,-0.010651,-0.146087,0.135307,-0.021954,-0.072694,0.126127,0.13609,-0.133282,0.054119,-0.052929,0.073015,0.125644,0.098068,0.179271,0.135895,
  -0.115072,-0.171285,0.063126,-0.018851,-0.066138,0.22874,0.353637,-0.093403,0.044356,-0.069927,0.117645,0.017517,-0.033948,0.162918,-0.015424,0.018275,
  0.02999,0.253082,0.026516,0.105064,-0.145958,0.001426,0.051976,0.048404,0.031888,0.11401,-0.390715,0.078503,-0.11032,0.14476,-0.096537,-0.030558,
  -0.171358,0.119329,0.109711,0.072423,-0.156632,-0.00547,0.069661,0.064445,-0.051075,0.161723,-0.008072,0.261728,0.005339,-0.104106,0.01682,-0.121391,
  -0.119533,-0.250838,-0.016243,0.060196,0.128437,0.160761,0.091551,-0.162603,0.179386,0.053451,-0.129363,0.456084,0.234576,0.082433,-0.00484,0.298006,
  0.015022,0.180209,0.069208,0.005333,0.043549,0.057527,0.233714,0.102327,0.174938,-0.004207,0.001724,0.07617,0.074772,-0.071643,0.02412,0.001187,
  0.022076,0.001101,0.151454,-0.045538,-0.120631,-0.187954,0.11084,0.142723,0.177878,0.141847,0.083519,-0.187836,0.049642,0.232477,-0.49146,0.168312,
  0.324127,0.236365,-0.104342,-0.236557,-0.043496,0.151707,-0.174965,-0.033589,0.40112,0.177373,0.059479,-0.634521,-0.047593,-0.056437,-0.049573,0.093886,
  -0.381432,-0.123966,-0.080403,-0.041089,-0.167801,-0.240324,-0.026904,-0.344978,0.440128,-0.230873,0.063813,0.12372,-0.551605,0.285666,-0.053754,-0.364583,
  0.1587,0.378164,-0.076835,0.003641,-0.095415,0.056581,-0.061586,-0.337895,0.096557,0.104816,-0.000674,0.26084,-0.030362,-0.560106,0.08084,0.048814,
  -0.030243,0.065722,0.243499,-0.574315,0.001437,0.212859,-0.037226,0.08718,0.201659,-0.61275,0.026714,0.040482,0.00829,0.082255,-0.005173,-0.367604,
  -0.185855,-0.009291,0.104137,-0.133903,0.127311,-0.106831,0.147649,-0.091026,-0.155512,-0.151132,0.008815,0.166399,-0.148261,-0.010067,-0.061182,0.171586,
  -0.082352,0.09869,0.120564,0.11659,-0.020864,-0.200441,-0.170395,-0.116136,0.204477,-0.049442,-0.080469,0.054772,0.162816,-0.035917,-0.114014,0.080634,
  0.160954,0.050027,-0.067798,-0.008296,0.142028,-0.026042,-0.129346,0.108843,0.01569,0.250184,-0.291044,0.328341,0.054767,0.180088,0.00482,-0.156217,
  0.365521,0.137041,0.116294,0.450861,0.351417,-0.06388,-0.070691,0.004369,-0.232989,0.147382,0.398933,0.03098,-0.137181,0.035186,-0.050495,0.280716,
  0.048011,0.246648,-0.077772,0.159861,-0.144073,0.155794,0.385444,0.051325,-0.017374,-0.036376,-0.052038,0.182071,0.211273,0.071304,-0.078119,-0.025992,
  -0.007831,-0.038989,-0.004361,-0.118303,-0.151001,0.066386,-0.013928,0.268684,0.320682,-0.011067,0.057464,-0.068353,0.060232,0.178755,-0.203554,-0.183278,
  0.092728,0.267277,0.029154,0.09617,0.03438,0.031129,-0.088522,-0.154638,-0.122341,-0.024367,-0.18975,-0.080911,0.121143,0.025484,0.198213,0.046724,
  0.069033,-0.103163,-0.059692,-0.075387,0.048794,0.062677,-0.041834,-0.097214,-0.369671,-0.108412,-0.220765,-0.256188,0.029229,-0.357522,0.117161,0.210492,
  0.042929,0.017552,-0.302809,0.031708,0.036932,0.164805,0.083724,-0.245723,-0.339474,0.024472,0.125939,0.416281,0.041343,0.234249,-0.064447,0.18528,
  -0.099625,0.368503,0.00954,-0.149809,0.29379,-0.156937,-0.03357,0.369471,0.0036,-0.087215,-0.112337,0.108194,-0.012485,0.20583,-0.114557,-0.010514,
  0.202642,0.019993,0.205495,0.174633,0.01038,0.11552,-0.125581,0.14044,0.177419,-0.472359,0.096849,-0.196789,-0.229227,-0.235901,0.135284,0.162815,
  -0.118027,0.06867,0.18214,-0.00637,-0.114345,-0.226636,0.005466,-0.039743,-0.049391,-0.05501,0.103741,-0.117124,0.27604,0.047568,-0.047291,-0.046663,
  -0.208677,0.187502,-0.017776,0.179995,-0.795536,0.197374,0.213755,-0.093801,0.216948,-0.017772,-0.06756,0.499629,-0.015249,-0.03397,-0.126563,0.097885,
  0.001811,0.412455,0.06792,0.038216,-0.07157,0.264739,-0.13439,0.328751,0.045035,-0.201425,-0.188572,-0.12677,-0.204584,0.284147,0.062861,-0.047405,
  0.198029,0.070807,0.127515,0.327634,0.090598,0.116646,0.090506,-0.074941,-0.002909,-0.152051,-0.057482,0.078793,-0.109243,0.023333,-0.193755,0.089571,
  -0.117659,0.15889,0.066588,0.245789,0.068998,0.207969,0.459693,0.108012,-0.283561,-0.281696,-0.083744,-0.137432,0.136255,0.184129,-0.210616,-0.061803,
  -0.134742,-0.291462,0.136291,-0.105646,-0.061563,-0.037389,0.042818,0.140672,0.099423,-0.079597,-0.1803,-0.089714,-0.14486,0.208205,-0.324271,-0.138905,
  -0.149513,0.154236,0.005131,-0.068341,0.143287,-0.011274,0.230669,0.109559,0.075473,0.145356,0.079895,0.018144,-0.254082,-0.154986,0.297851,0.269916,
  0.074888,0.147117,0.060097,0.16507,0.070349,0.052277,-0.135362,-0.066878,0.03605,0.113878,0.138247,-0.032815,-0.205942,0.043104,0.073518,-0.245788,
  0.300566,0.051121,-0.065904,-0.160039,0.127095,0.017762,-0.046187,-0.147601,0.368348,0.291835,0.050018,0.224281,0.063789,0.061751,0.306495,0.147832,
  -0.035608,-0.450231,0.091021,0.016634,0.017377,0.007535,0.015216,0.021685,-0.038242,-0.118702,0.133683,-0.101182,-0.060815,-0.279207,0.077098,-0.131578,
  -0.063774,0.005525,-0.359706,-0.177908,0.103163,0.109195,0.014359,0.055491,-0.260193,0.132676,0.041345,0.006679,-0.06767,0.083446,0.129521,-0.022891,
  -0.252899,-0.005459,-0.251133,-0.10366,-0.045311,-0.128726,0.057803,0.232916,-0.073247,0.05861,-0.036079,0.00236,-0.051852,0.032749,-0.13472,-0.036096,
  -0.293232,0.030317,0.019155,0.070094,0.091628,0.120249,-0.078399,0.056661,-0.176257,0.002731,0.009736,0.229891,0.005751,-0.059217,-0.033037,0.062155,
  -0.077578,0.215279,-0.108624,0.06588,0.085295,0.171913,-0.130714,-0.01787,0.140335,-0.056024,-0.072895,0.090363,0.154561,-0.102061,-0.128275,0.088996,
  -0.098836,-0.035279,-0.098205,0.039511,0.292521,-0.099498,0.011681,-0.245973,0.11889,0.045635,0.106832,0.026157,0.129279,0.031545,0.211516,0.320973,
  0.114638,0.074734,-0.022691,0.13101,-0.056636,-0.091038,-0.205913,0.036502,0.249694,0.010803,0.144404,0.013548,0.291665,0.033482,0.020061,0.382667,
  0.278159,0.10709,0.160134,0.188052,0.044846,0.206205,0.167618,0.26543,-0.176481,0.128541,0.048759,-0.035405,0.012978,0.196214,0.055816,-0.009183,
  -0.122296,-0.136554,0.098187,0.073431,-0.108627,-0.029001,-0.053739,-0.190389,0.055946,-0.02209,-0.03812,-0.283581,-0.027063,0.168007,0.219836,0.151494,
  -0.206238,0.01557,0.069941,-0.060482,0.175927,0.040487,-0.075719,-0.244648,-0.049667,0.121101,0.012764,-0.060653,-0.059069,0.094431,-0.02095,-0.243353,
  0.099915,0.083931,0.172653,-0.035223,0.015547,0.013759,0.105458,-0.017677,-0.146267,-0.091747,-0.042258,0.023588,-0.113443,-0.022305,-0.068068,-0.034842,
  0.124089,0.103016,-0.026385,0.103981,-0.087407,-0.184251,0.09549,-0.025303,-0.098564,0.13871,0.037977,-0.127752,0.01961,0.107725,-0.085121,-0.199781,
  -0.059963,-0.035747,-0.056097,0.103505,-0.075079,-0.07806,-0.194611,-0.162447,-0.138005,0.016198,0.161673,0.001173,-0.0569,0.027746,-0.227454,-0.125547,
  0.03951,-0.122576,-0.018588,0.232801,-0.414942,-0.203266,0.170084,0.004483,-0.03968,0.062289,-0.196237,0.054531,0.059808,-0.016212,0.169828,-0.112318,
  0.066767,-0.055554,-0.100504,-0.029389,-0.119538,-0.037686,-0.118494,-0.137431,-0.087074,0.184611,-0.121871,0.071991,0.011813,-0.233933,-0.183065,-0.066154,
  0.009474,0.171572,0.027597,-0.044171,-0.194928,0.04891,0.099543,-0.052434,0.195009,-0.178167,0.052384,-0.099744,-0.121512,-0.030072,-0.130303,-0.105616,
  -0.005444,0.028517,-0.051878,-0.016004,-0.084651,-0.013279,-0.180031,-0.13109,0.076926,-0.005975,0.025526,-0.028332,-0.044107,0.020079,-0.035998,0.15064,
  0.05672,-0.045374,0.017524,-0.012966,-0.123735,0.084758,-0.004455,-0.255188,-0.081786,0.076731,-0.075103,0.077965,-0.183802,0.028917,-0.23372,-0.095854,
  -0.188645,-0.120784,-0.019877,0.039936,0.078472,0.050726,-0.13193,-0.104028,0.189017,0.097476,0.029758,-0.143815,-0.087933,0.052462,0.081989,0.107591,
  0.087167,-0.341964,0.239144,0.174196,-0.3209,-0.083675,0.023277,0.059589,-0.066475,-0.125093,-0.057551,-0.259747,0.246342,0.417886,0.028602,-0.026084,
  0.111006,0.229029,-0.066067,0.359963,0.151297,-0.030482,0.084389,-0.072022,-0.014328,-0.251579,-0.033951,-0.128142,-0.433163,-0.183167,-0.305858,-0.237147,
  -0.223377,-0.089275,-0.130285,0.246921,0.033224,0.092538,0.055141,0.114805,-0.482144,0.231133,-0.059321,0.03947,-0.028177,0.18968,-0.247092,0.367002,
  0.002427,0.220159,-0.083985,0.113169,-0.121353,0.389728,0.017396,0.00621,0.175777,0.083417,-0.216836,0.286057,0.177795,0.161042,0.033037,0.170054,
  -0.135758,-0.041059,0.006145,-0.082482,-0.104862,0.163285,0.140805,0.13244,-0.132287,-0.110372,0.09752,0.036729,0.071702,0.463405,-0.163387,-0.110108,
  0.338758,0.090087,-0.007403,0.016045,-0.02503,0.154497,0.090892,0.078223,0.099441,-0.103325,0.009966,-0.116179,0.124724,0.002804,-0.006737,-0.011918,
  -0.08433,-0.031069,0.093902,-0.073695,0.254218,0.029275,0.085313,-0.045893,-0.310046,0.100404,-0.103832,0.078251,-0.055285,-0.077886,0.06428,-0.078744,
  0.007237,-0.025221,-0.025405,0.004234,0.07769,-0.058424,-0.028284,0.057573,0.123351,0.095447,-0.052164,0.12972,0.15294,-0.019939,0.062453,-0.028,
  0.185075,-0.010751,0.028952,0.010386,-0.11617,-0.062377,0.106235,0.288426,0.058194,0.133961,-0.07767,0.142693,-0.021663,0.065387,0.028527,0.148809,
  -0.070497,0.068073,-0.033395,0.067811,0.031753,-0.057413,-0.113206,-0.000462,-0.069791,0.113041,0.342021,0.279622,-0.136135,-0.188659,-0.190483,-0.136818,
  0.108732,-0.062572,0.101706,0.016429,-0.025939,-0.269668,0.157792,0.072783,0.103896,0.002853,-0.265761,0.435082,0.167188,0.028651,0.2435,-0.220521,
  -0.033779,0.020167,-0.272172,0.359063,0.021511,0.01408,-0.012087,0.043662,0.162527,-0.217971,-0.069759,0.41794,0.221304,-0.048632,0.115692,0.115372,
  -0.1093,0.121678,0.345143,0.075094,0.236654,-0.157403,0.034503,0.3759,0.188933,0.164085,0.162642,-0.097126,0.041591,0.16691,0.114326,0.052351,
  0.217528,-0.017766,-0.139642,-0.130948,0.213907,0.056855,0.176212,-0.166916,0.039403,0.123305,0.002387,-0.18607,-0.021474,0.0038,0.2103,-0.02906,
  0.155387,-0.185832,-0.126466,0.093414,-0.175643,0.074865,-0.152313,0.065936,-0.063015,-0.129288,0.115857,-0.199718,-0.053951,0.017465,0.072656,0.105647,
  -0.066617,-0.085513,-0.080769,-0.055548,-0.128747,-0.077664,-0.073868,-0.07215,-0.042007,-0.10309,0.040622,-0.010955,-0.02096,0.120734,-0.1768,-0.059579,
  0.018119,-0.112939,0.25215,-0.143491,0.057468,-0.057879,-0.129945,-0.016714,-0.047107,0.029999,-0.030583,-0.013462,0.001587,0.064841,-0.141582,0.083357,
  -0.067419,0.176534,-0.083371,0.019587,-0.139999,-0.052522,-0.03767,-0.067997,0.11866,0.106663,-0.22396,-0.021064,-0.08439,-0.14621,-0.014542,0.067785,
  -0.033791,0.111819,-0.004731,0.032806,-0.160186,0.00092,-0.059901,0.021767,0.217786,0.089742,-0.351876,-0.238268,0.014128,0.091592,-0.174774,0.074924,
  0.112929,-0.234571,-0.391433,-0.201337,-0.065104,-0.024498,-0.08317,-0.026477,0.067171,0.116422,-0.036431,-0.138932,-0.098156,-0.177603,-0.07024,0.330166,
  -0.214848,-0.1596,-0.062481,-0.173879,0.10304,0.085288,0.023404,0.136002,0.104226,-0.071228,-0.138676,0.242607,0.404615,0.241891,0.100054,0.0356,
  0.258009,0.08388,-0.138709,0.815426,0.134791,-0.000784,-0.261682,0.155557,0.151283,0.461457,0.137215,0.019354,0.002717,0.145448,0.16618,0.36916,
  0.269387,0.047958,-0.261726,0.085328,0.138813,0.247776,0.135053,-0.046324,-0.066113,0.172392,0.05224,0.032272,0.075163,-0.032912,-0.010989,-0.010114,
  0.204752,0.186989,-0.044173,-0.022595,-0.305578,0.120008,0.087871,0.035703,0.380369,0.364476,-0.29209,0.006583,0.145938,0.211177,-0.166249,-0.399272,
  0.049003,-0.046967,0.173716,-0.348583,0.122156,0.124879,-0.036508,0.236849,-0.044744,0.158616,-0.087099,-0.055918,-0.052287,-0.196985,0.4197,-0.166885,
  0.318975,-0.023263,0.182229,-0.094116,-0.531847,0.190714,-0.045999,0.0246,-0.073474,-0.254116,0.010136,-0.267891,-0.03753,0.016724,0.114997,-0.653023,
  -0.032032,-0.114736,0.124275,-0.085857,0.096935,-0.585782,0.034724,0.107218,0.000049,-0.086267,0.3927,-0.379331,-0.181509,-0.031782,0.030197,-0.146112,
  0.049711,-0.151504,0.031813,0.110617,0.075343,0.340499,0.243868,-0.120276,0.061545,0.274671,0.227895,-0.143324,-0.11016,-0.002618,-0.081453,0.151874,
];
const B1 = [
  0.041228,0.16196,0.01143,0.002572,0.047116,0.02696,0.054485,0.069245,0.049041,0.051371,0.048428,0.142745,-0.024621,0,0.052184,0.049079,
  -0.025808,-0.005198,0.029472,0.03478,0.050998,0.037092,0.141056,0.016616,-0.028002,-0.028195,0.04635,0.090808,-0.016762,-0.041123,-0.004359,0.059757,
];
const W2 = [
  0.137515,0.156665,0.09304,0.132659,0.129343,0.042248,0.024748,0.1051,-0.091069,0.246137,0.362586,0.260252,0.136903,0.042272,0.105691,0.269656,
  -0.023661,-0.387288,0.036795,0.271689,0.188901,0.032848,0.244362,0.081021,0.018795,0.038664,-0.120394,0.156844,0.01655,0.058337,0.174036,0.280516,
  0.107849,-0.077,0.271097,0.173307,0.160242,-0.03981,-0.057241,-0.02478,-0.186818,0.010465,0.428188,0.019343,0.09374,0.187501,-0.093473,0.137802,
  0.077954,0.38846,-0.017058,0.175089,-0.024427,0.069301,0.141364,0.02539,-0.080072,-0.11295,0.22547,-0.118097,-0.15864,0.109636,-0.146126,0.469096,
  0.108774,-0.039821,0.037281,0.03825,0.029291,-0.070963,-0.034512,0.011212,0.140449,-0.060763,-0.209787,-0.142279,-0.056991,-0.123955,-0.13427,0.03826,
  -0.148541,-0.100298,0.034182,0.294613,-0.128773,-0.035009,-0.055893,-0.016095,0.124531,0.040128,-0.054246,-0.133939,-0.084278,-0.088676,0.03276,-0.085704,
  0.016381,0.095346,-0.003544,-0.008797,0.083138,0.021518,0.097751,-0.207628,0.03774,-0.107747,-0.045224,-0.056892,-0.080358,-0.147465,-0.173669,0.101906,
  -0.102396,-0.023153,-0.139243,-0.133228,-0.071938,-0.140531,-0.050731,-0.069861,0.088472,-0.050578,0.000061,-0.095724,-0.130813,0.134205,0.095301,-0.042471,
  -0.108984,0.013971,0.152319,-0.157539,0.036949,0.057657,0.012903,0.055087,-0.10384,-0.160835,-0.064764,0.318662,0.033305,0.072835,0.039674,0.123895,
  0.07991,0.458271,-0.005017,0.071314,-0.275382,0.028863,0.123883,0.044987,0.002739,-0.023143,-0.10669,-0.02964,-0.36606,-0.032158,0.160829,0.267741,
  -0.021744,0.008793,-0.007387,-0.054477,0.057153,-0.031424,-0.079156,-0.045143,-0.087621,-0.126161,-0.097381,-0.096777,0.006889,-0.084122,-0.010848,-0.004774,
  0.087839,-0.317058,0.035202,-0.035415,0.053547,0.06575,-0.085191,-0.167052,-0.046392,0.044076,0.068366,-0.053187,-0.196612,-0.074486,0.025043,0.103735,
  -0.19876,0.268438,0.031616,-0.206671,-0.075289,-0.029757,0.099977,0.247013,0.149461,0.074629,0.205534,0.18782,0.072561,-0.038624,0.079947,-0.185916,
  -0.12879,-0.200541,-0.007018,-0.078565,-0.333647,0.110806,-0.139748,-0.055557,-0.018296,0.033934,0.100668,0.147133,0.052835,-0.134705,-0.382049,0.010037,
  0.08571,-0.029146,0.052626,0.054993,-0.027942,-0.208853,-0.024,0.098681,-0.028179,-0.108878,-0.132802,-0.003581,-0.019102,-0.02832,-0.196423,0.005133,
  -0.015659,-0.060387,0.146984,-0.090033,-0.234005,0.205185,0.056055,0.012229,-0.104105,0.088605,0.06452,-0.060349,-0.157602,0.09429,-0.098773,-0.048633,
  -0.09792,0.113835,-0.053902,0.003193,0.093852,0.05905,-0.052647,0.021846,0.069274,0.076936,-0.045668,0.478748,-0.18764,0.161332,0.034363,0.106643,
  0.00388,-0.442525,0.180888,0.101012,0.202889,-0.058414,0.127996,0.012627,0.189347,-0.059857,0.203153,-0.176952,0.015813,0.080138,-0.014904,-0.096599,
  0.030213,-0.082658,0.296301,0.108034,0.09128,0.039069,-0.017743,-0.055998,-0.037524,-0.019622,0.035072,-0.172005,0.20132,-0.033491,0.106428,0.270608,
  0.074245,0.201758,0.03961,-0.13009,-0.205927,0.04569,-0.017974,0.37187,-0.119268,-0.126932,0.172028,-0.09048,0.155035,-0.300541,0.106072,-0.200699,
  -0.280513,0.328319,-0.101005,-0.278111,0.216585,0.168305,-0.046616,0.072962,0.064375,0.037859,-0.072129,-0.020197,-0.00096,-0.026997,-0.049019,-0.112638,
  0.034293,-0.260261,0.289548,0.123019,-0.040774,0.133838,-0.114903,0.057927,0.10418,0.132192,-0.100408,0.1404,0.091176,0.112907,0.032596,-0.201894,
  -0.023786,0.028712,0.098188,-0.021612,-0.022794,0.032743,-0.045418,0.020324,0.064484,0.047437,-0.022405,0.217126,0.050435,0.119441,0.067199,0.274265,
  -0.084535,0.012134,0.060594,-0.018556,0.227643,0.161258,0.200211,0.120118,-0.153854,-0.113827,0.054804,-0.134738,-0.036356,0.042886,0.113732,-0.125424,
  0.193321,-0.047767,0.109576,-0.04157,-0.00424,0.10075,0.179308,-0.051988,-0.013788,-0.058903,0.146413,0.071939,-0.105111,0.041046,0.059215,0.048711,
  -0.088246,0.158015,0.197274,-0.074233,0.155444,0.145075,0.146774,0.085766,-0.237256,-0.038811,0.333537,-0.063766,0.35962,0.003303,0.112286,-0.520227,
  -0.013269,-0.086889,-0.028755,-0.026975,0.024965,0.129668,-0.014489,-0.092363,-0.036242,0.072325,-0.070783,0.034615,-0.122932,-0.065033,-0.04445,-0.080389,
  -0.00903,0.021809,-0.213876,-0.145218,0.085952,0.144899,-0.20976,-0.379886,-0.212134,0.168925,-0.174153,-0.191739,0.069966,-0.101638,0.039047,-0.062118,
  -0.109982,-0.065405,-0.143585,-0.01243,0.075191,0.210669,0.305053,0.253735,0.45267,0.12378,0.078726,-0.253584,-0.134611,0.040747,0.012525,-0.177755,
  0.190579,0.27154,0.172321,0.076132,-0.004569,0.220363,0.010475,0.026712,0.049119,0.021685,0.001603,0.047035,0.211358,0.080238,0.123294,-0.12181,
  0.083932,0.028164,-0.1142,0.047127,0.156565,0.135949,0.002031,0.176875,0.160451,0.087107,-0.121011,-0.102616,0.045977,0.201759,-0.009659,-0.158012,
  -0.00971,0.066702,0.086854,0.310938,-0.105688,0.034111,0.061302,0.075782,0.009221,-0.056752,-0.195576,0.168278,0.372727,-0.083299,-0.086528,0.07167,
  0.118883,0.011148,0.151256,0.139013,0.302986,-0.021476,0.019206,0.203959,0.043182,-0.005912,-0.017626,-0.112005,0.162692,-0.018011,0.210003,-0.076545,
  0.100711,0.382461,0.180782,0.059155,0.093892,0.077283,0.07488,0.2019,0.071231,-0.021374,-0.190381,0.344703,-0.028021,-0.192671,0.229152,0.034719,
  0.07131,0.082631,0.080884,0.158304,-0.056486,-0.019186,0.246119,-0.043544,-0.143685,0.189331,0.119252,0.065913,0.084132,-0.076644,0.239088,0.210857,
  0.206279,-0.363024,-0.069804,0.035397,0.075388,-0.145232,0.156148,0.056961,0.029407,-0.015477,-0.223713,0.11151,-0.028134,-0.001418,0.127594,0.188021,
  0.168064,-0.091377,0.281318,0.012545,0.02773,-0.014945,-0.071255,0.095375,-0.0302,0.019,0.26998,0.009072,-0.045003,-0.139967,0.102727,0.063774,
  0.274591,0.482421,0.012879,-0.126766,-0.071294,0.093404,-0.083019,0.028606,-0.048548,0.024886,0.362624,0.003184,0.210367,0.117278,-0.027959,0.022524,
  -0.378866,0.25117,0.054584,-0.110958,0.040124,0.020865,0.254592,0.122697,0.065156,0.030348,-0.179447,-0.220989,-0.112509,-0.040885,-0.079683,-0.178322,
  0.038072,-0.36856,-0.128747,0.226546,-0.119327,0.045551,-0.132589,-0.013818,-0.00613,0.036021,-0.481655,0.260577,-0.152108,0.092761,-0.061527,0.169632,
  -0.100187,-0.057015,-0.206929,0.023253,-0.048882,0.010265,0.049483,-0.060672,-0.159851,-0.06942,-0.060749,-0.136825,0.110384,0.085681,-0.124503,0.108333,
  -0.150461,-0.050879,-0.012021,-0.138583,-0.091792,-0.076649,-0.112526,-0.083687,-0.014858,-0.028336,-0.123177,0.145531,-0.158203,0.059128,0.274061,0.004389,
  0.247986,0.04722,-0.101349,0.067979,-0.084674,0.099261,-0.034268,-0.115644,-0.078591,0.027502,0.119319,0.056898,-0.106591,0.111857,0.0937,0.098589,
  -0.153197,-0.044311,0.029636,0.029146,-0.001107,0.060172,0.26763,0.060109,0.140871,-0.043373,0.184363,0.111412,-0.168709,-0.035699,0.0345,0.403506,
  -0.080808,-0.112108,0.155598,0.016873,0.089853,-0.099936,-0.007089,-0.201913,-0.155456,-0.025679,-0.049292,-0.179807,0.058556,0.018496,-0.182257,0.032076,
  -0.206997,-0.222408,-0.028577,-0.200707,-0.111102,0.099952,-0.059926,-0.058513,-0.046798,0.040653,-0.200619,0.040154,0.049215,0.006305,-0.040759,0.031431,
  0.014196,-0.192518,-0.033304,-0.074418,0.183002,0.33359,-0.127663,0.090936,0.046574,-0.017906,0.038963,0.106257,0.11026,0.130695,-0.124576,0.156781,
  -0.183122,0.299324,0.086796,-0.158929,0.25688,0.221532,0.107649,0.098532,0.152477,-0.032519,0.378404,0.064482,0.264958,-0.081382,0.010676,-0.36853,
  0.188649,-0.260183,0.040341,-0.034231,-0.231942,0.045459,0.073402,-0.008628,0.054621,0.224824,0.143366,0.300878,0.034743,-0.041888,0.137248,-0.017864,
  -0.028253,0.076431,-0.011793,0.078978,0.038893,-0.113763,0.186642,0.10687,-0.001718,-0.038085,0.098892,0.016655,-0.005227,-0.090375,-0.205324,0.043071,
  0.293605,-0.062369,0.066015,0.055158,-0.146487,-0.070334,0.028199,-0.070267,-0.042899,0.019383,-0.032568,0.023612,-0.157988,0.155042,0.123905,-0.195908,
  -0.117099,0.336432,-0.006259,-0.072644,-0.047075,-0.02051,-0.035427,0.184616,0.125576,-0.174502,0.130052,0.078181,0.11705,0.154564,-0.119386,0.145112,
  0.107882,0.21008,0.178197,0.020058,0.111013,0.11415,-0.042111,0.09747,0.0833,0.138088,-0.071995,-0.14158,0.010101,-0.181825,0.019534,0.09975,
  0.160018,0.229898,0.140623,0.049715,0.231328,0.09812,-0.032907,0.203978,-0.092845,-0.04172,0.132551,0.255332,0.133166,0.000257,0.243179,-0.185746,
  -0.151359,-0.079365,0.067921,0.00127,-0.022996,-0.034371,0.236083,-0.070129,0.219431,0.100738,-0.24401,-0.502188,-0.067865,0.04942,0.17814,-0.238231,
  0.207342,0.688176,0.0871,-0.079765,-0.253919,-0.010159,0.069753,0.00318,0.045378,0.177506,0.034003,0.080172,0.158857,0.061974,-0.038373,-0.073746,
  -0.050741,0.112976,-0.114272,-0.163858,0.080471,0.019273,0.313143,0.111666,0.099068,-0.018116,0.171797,0.16403,0.001395,-0.035538,0.176044,-0.057906,
  -0.304881,0.125326,-0.175775,0.012521,-0.27917,0.016974,0.0369,0.002585,-0.158998,-0.00714,-0.099851,-0.052831,0.007654,0.088973,-0.317228,0.558094,
  0.073088,0.125264,-0.202804,-0.001043,0.121144,0.27938,0.192759,0.145207,0.088651,0.095195,0.111775,-0.011997,-0.016293,-0.112829,0.154448,-0.114517,
  -0.023321,-0.343404,0.13821,0.087591,0.198296,0.259375,0.126498,0.212086,0.00197,0.079538,-0.074543,0.197744,-0.086047,-0.05151,0.100981,-0.093788,
  0.067911,-0.098442,-0.143823,0.061727,0.061152,0.057599,-0.177365,0.030807,0.172986,0.051273,0.149037,0.223522,-0.047345,0.029403,0.07283,-0.016021,
  -0.068827,-0.448687,-0.123793,0.036338,0.115081,-0.033851,0.17459,-0.083172,-0.024941,0.130177,-0.189847,-0.039495,-0.014641,-0.081738,0.028824,0.238439,
  0.156592,0.327155,0.167312,0.059608,-0.109142,0.001643,0.010335,-0.369512,-0.258904,-0.260869,-0.100125,0.095018,0.122758,-0.15937,-0.11827,-0.094101,
  0.071758,0.220298,-0.121904,0.053957,0.30859,0.281901,0.183648,-0.021308,-0.113758,-0.016319,0.059233,0.213954,-0.101109,0.224023,0.074972,0.253017,
];
const B2 = [
  0.15068,0.006653,-0.050164,0,0.097282,-0.02665,0.125855,-0.038921,0.114361,-0.015069,0.09419,0.10771,0.033138,-0.043387,0.042105,0.142689,
  0.067408,0.081254,0.014065,0.081295,-0.042523,0.092416,-0.024581,-0.047407,0.039758,-0.017768,0.030649,-0.049549,0.081309,0.132831,0.056192,0.12082,
];
const W3 = [
  -0.00628,-0.242713,-0.023137,0.086747,-0.031212,0.208652,-0.298132,0.014903,0.149646,0.05241,0.303078,0.116206,0.143218,-0.032696,0.050374,0.016667,
  -0.095636,-0.0609,-0.171671,-0.126789,0.135752,-0.106161,0.032326,0.121938,-0.087422,-0.244922,0.091717,-0.133864,-0.263455,0.073893,0.052164,-0.34012,
  -0.194802,0.104213,-0.082109,0.143943,0.218933,0.113988,-0.158284,-0.106074,-0.062144,0.121103,-0.078129,0.038824,0.191298,-0.153942,0.081247,-0.034607,
  0.031089,-0.061038,0.276842,-0.22636,0.008512,-0.075759,-0.206176,0.209361,0.011992,0.100574,0.085841,0.219115,-0.242961,-0.088542,-0.24076,-0.004986,
  -0.166403,-0.147141,0.055112,0.008035,-0.185919,-0.052932,0.255617,-0.066725,-0.207522,-0.121917,0.197978,-0.315822,-0.176085,-0.107526,0.225279,0.191492,
  0.17727,-0.145458,-0.043542,0.155452,0.186537,-0.11484,0.076052,-0.05947,-0.108345,-0.074958,0.02457,0.301228,-0.175398,0.098927,-0.142059,-0.061479,
  -0.025591,-0.210127,0.084022,0.054836,0.078421,-0.019239,0.406239,-0.055403,0.32287,-0.126344,0.02995,0.230293,0.180383,-0.025628,0.017232,-0.008984,
  -0.191972,-0.366835,-0.033984,-0.190582,-0.140359,-0.00581,0.014044,0.29266,0.086692,0.077918,-0.084235,-0.17862,0.217269,0.059144,0.109515,-0.123727,
  0.387586,0.100662,-0.176698,-0.025821,0.263554,0.019903,0.228103,0.047349,0.208235,0.157852,0.184879,0.465255,0.406637,-0.104235,0.312414,0.608084,
  0.391836,0.274017,0.335818,0.100991,-0.097556,0.588099,-0.004221,0.135141,0.422577,0.055527,0.274635,0.140401,0.136017,0.372989,0.056386,0.046385,
];
const B3 = [
  0.00119,-0.117362,-0.022761,-0.033886,0.112898,
];

function relu(x){return x>0?x:0;}
function tanh(x){const e1=Math.exp(x), e2=Math.exp(-x); return (e1-e2)/(e1+e2);}
function sigmoid(x){return 1/(1+Math.exp(-x));}

function mlpForward(x){
  // x: length INPUT_SIZE
  const h1 = new Array(H1).fill(0);
  for(let i=0;i<H1;i++){
    let s = B1[i];
    for(let j=0;j<INPUT_SIZE;j++) s += W1[i*INPUT_SIZE + j]*x[j];
    h1[i] = relu(s);
  }
  const h2 = new Array(H2).fill(0);
  for(let i=0;i<H2;i++){
    let s = B2[i];
    for(let j=0;j<H1;j++) s += W2[i*H1 + j]*h1[j];
    h2[i] = relu(s);
  }
  const out = new Array(OUTPUT_SIZE).fill(0);
  for(let i=0;i<OUTPUT_SIZE;i++){
    let s = B3[i];
    for(let j=0;j<H2;j++) s += W3[i*H2 + j]*h2[j];
    out[i] = s;
  }
  // post-process
  const mvx = tanh(out[0]);
  const mvy = tanh(out[1]);
  const fx  = tanh(out[2]);
  const fy  = tanh(out[3]);
  const fireP = sigmoid(out[4]);
  // 각도 변환
  const mvAngle = Math.atan2(mvy, mvx) * 180/Math.PI;
  const fireAngle = Math.atan2(fy, fx) * 180/Math.PI;
  return { mvAngle, fireAngle, fireP };
}

function norm(x, a, b){ return (x - a) / (b - a); }
function clamp01(v){ return v<0?0:(v>1?1:v); }

function buildFeatures(tank, enemies, allies, bulletInfo){
  // 입력 피처 구성 (전부 사용)
  // - 탱크 자체 상태: x,y,health,energy,typeOneHot(3),size
  // - 적/아군 최근접 K명: 상대 위치(상대 좌표-자기 좌표), 거리, 각, 체력
  // - 총알 최근접 K발: 상대 위치/속도(상대 좌표-자기 좌표), 거리
  const W=900, H=600;
  const self = [
    norm(tank.x, 0, W),
    norm(tank.y, 0, H),
    clamp01(tank.health/200),
    clamp01(tank.energy/200),
    tank.type===0?1:0,
    tank.type===1?1:0,
    tank.type===2?1:0,
    clamp01(tank.size/60),
  ];

  // 정렬 및 K개 추출
  function topK(arr, k){
    const sorted = arr.slice().sort((a,b)=> (a.distance||1e9)-(b.distance||1e9));
    return sorted.slice(0,k);
  }
  const KE=4, KA=3, KB=5;
  const es = topK(enemies, KE);
  const as = topK(allies, KA);
  const bs = topK(bulletInfo, KB);

  const ef = [];
  for(let i=0;i<KE;i++){
    const e = es[i];
    if(e){
      const dx = e.x - tank.x; const dy = e.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI; // -1..1
      ef.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(e.health/200));
    }else{
      ef.push(0,0,0,0,0);
    }
  }
  const af = [];
  for(let i=0;i<KA;i++){
    const a = as[i];
    if(a){
      const dx = a.x - tank.x; const dy = a.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      af.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(a.health/200));
    }else{
      af.push(0,0,0,0,0);
    }
  }
  const bf = [];
  for(let i=0;i<KB;i++){
    const b = bs[i];
    if(b){
      const dx = b.x - tank.x; const dy = b.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      bf.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang,
              clamp01((b.vx+8)/16), clamp01((b.vy+8)/16));
    }else{
      bf.push(0,0,0,0,0,0);
    }
  }

  // 전역 통계(개수/합계)
  const stats = [
    clamp01(enemies.length/6),
    clamp01(allies.length/5),
    clamp01(bulletInfo.length/10),
  ];

  const x = self.concat(ef, af, bf, stats);
  // 길이 보정(정확히 INPUT_SIZE)
  if (x.length < INPUT_SIZE) {
    while (x.length < INPUT_SIZE) x.push(0);
  } else if (x.length > INPUT_SIZE) {
    x.length = INPUT_SIZE;
  }
  return x;
}

function policyStep(tank, enemies, allies, bulletInfo){
  const feat = buildFeatures(tank, enemies, allies, bulletInfo);
  const out = mlpForward(feat);
  // 액션 적용
  // 발사 결정은 DNN의 fireP로만 제어
  if (out.fireP > 0.5) tank.fire(out.fireAngle);
  tank.move(out.mvAngle);
}


function name(){ return "DNN-N1"; }
function type(){ return Type.NORMAL; }
function update(tank, enemies, allies, bulletInfo){
  policyStep(tank, enemies, allies, bulletInfo);
}


// ===== 다음 로봇 =====


const INPUT_SIZE = 76;
const H1 = 32;
const H2 = 32;
const OUTPUT_SIZE = 5; // [mvx, mvy, fx, fy, fire_logit]

const W1 = [
  0.231249,0.252307,0.277549,-0.080441,-0.056814,-0.017329,-0.03729,0.086753,0.122447,-0.381046,-0.012094,0.002491,-0.183581,0.097481,0.067492,0.057175,
  0.059112,0.214549,0.42343,0.303794,0.116437,-0.137641,0.138886,0.375197,0.177459,-0.137844,-0.354217,0.393907,-0.011193,0.021641,-0.025584,0.085705,
  -0.07592,-0.095949,-0.013901,-0.16592,0.090642,0.003898,-0.053293,0.001682,0.001988,0.043385,-0.01573,0.343829,-0.092087,-0.008471,0.222984,0.334922,
  -0.129952,0.158514,-0.017785,0.014144,0.159652,0.274476,0.004687,0.116878,-0.295685,-0.107057,0.265392,0.123549,0.182867,0.13654,-0.107376,0.062359,
  0.034339,0.027035,0.086895,0.002537,0.006179,0.021991,-0.112255,-0.035348,0.14066,0.07763,-0.073481,0.009612,-0.16441,0.07252,0.09489,0.282891,
  0.168923,0.002073,-0.04729,0.182894,-0.054457,0.054282,0.00975,0.021356,0.194464,-0.058447,0.209679,0.07782,0.094445,0.00661,-0.111975,0.042909,
  0.102029,0.095552,-0.035737,-0.074742,-0.210353,0.109379,0.01774,-0.485099,-0.127244,0.176676,0.027057,-0.140293,0.13579,-0.02035,-0.071361,0.030229,
  -0.099923,-0.036192,0.029663,-0.023531,-0.112156,0.144072,0.235565,-0.475378,-0.03504,-0.145612,0.0342,-0.063241,0.069014,-0.264007,0.047478,-0.115281,
  0.027475,-0.132847,0.341269,-0.126718,0.23187,0.268695,-0.080436,-0.063963,0.038427,-0.245087,0.130909,0.078642,0.017888,-0.23696,0.247609,-0.02891,
  0.115154,0.139652,0.100362,0.005329,0.11403,0.06441,0.029392,0.32734,0.083084,0.107289,0.060838,-0.055452,0.074276,0.056687,-0.065191,0.052332,
  -0.152936,-0.187324,0.017415,0.021242,-0.003169,0.026812,-0.063456,-0.178316,0.075306,0.390732,-0.019557,-0.068721,-0.049308,-0.079795,0.198757,0.128274,
  -0.119618,-0.036931,0.195009,-0.147944,0.192563,-0.087338,-0.114024,-0.315607,0.192127,-0.023869,-0.174601,-0.259945,-0.022001,0.021529,-0.069289,0.199371,
  -0.15614,-0.02703,-0.140107,0.123729,0.248163,0.023272,0.043381,0.18092,0.009153,-0.207206,0.109657,-0.01964,-0.01565,0.264206,0.19638,-0.170432,
  -0.152638,-0.110755,-0.114911,0.185059,0.218309,-0.248634,-0.012094,-0.067803,0.01673,0.260555,-0.167029,-0.056029,-0.15504,-0.108546,0.039792,0.11992,
  -0.08085,0.054533,0.155033,0.083988,0.107993,0.225401,-0.125344,0.170629,0.0079,0.059999,-0.17205,-0.010754,-0.016086,-0.230478,-0.177144,0.046707,
  0.043333,0.030807,-0.210242,-0.005623,-0.081899,0.108946,0.196994,-0.062466,0.066424,0.075504,-0.105066,0.022428,-0.036635,0.0508,-0.091117,0.193803,
  0.234642,-0.091593,-0.058831,-0.052719,-0.190395,-0.011782,-0.05412,-0.037195,0.047667,-0.106122,-0.094499,-0.012481,0.12228,0.120793,-0.124058,0.256646,
  -0.206133,-0.142556,0.034169,0.215976,0.166105,0.150425,-0.118902,0.013237,0.227881,0.404726,0.14554,0.123853,-0.211866,0.021287,0.069836,0.088628,
  0.266148,0.011142,-0.033858,-0.060848,0.069514,-0.001845,-0.164382,0.232031,-0.013076,0.088518,-0.024882,0.121853,-0.09547,0.129247,0.023822,0.0701,
  0.044805,-0.011508,-0.288175,0.007469,0.167103,0.127085,0.025522,0.197875,0.005763,0.194158,0.045954,0.055957,0.033337,-0.117676,-0.067896,0.009017,
  0.035343,-0.242824,-0.020475,-0.034971,-0.042475,0.07191,-0.047921,0.086175,-0.278755,-0.045365,0.123885,-0.184203,0.196427,-0.004445,0.062692,0.049139,
  0.042708,0.137667,-0.25662,0.083362,0.104321,0.124092,0.068975,-0.106787,0.235856,0.047117,0.038217,0.100415,0.223961,-0.033163,-0.014981,-0.002237,
  0.074313,-0.18447,0.203712,-0.063977,-0.106069,-0.139609,0.218535,-0.165839,0.237946,0.017028,-0.048425,-0.067711,-0.149326,0.061298,0.273153,0.072547,
  0.137193,0.015049,0.033872,-0.057425,0.211321,-0.108231,0.229444,0.031371,0.057188,0.037516,0.029653,0.132936,-0.059273,-0.037365,-0.026374,0.204505,
  0.123123,0.112858,0.084817,-0.160403,-0.002883,0.047882,0.266663,-0.027175,-0.118324,0.12456,-0.055469,0.069956,-0.077283,-0.138015,-0.073203,-0.010261,
  0.123227,-0.035158,0.081683,-0.066688,-0.167863,0.127134,0.127322,-0.194224,0.028522,0.134337,0.054119,-0.05296,0.006513,0.13624,-0.207391,0.21178,
  0.111596,-0.003922,0.029001,-0.197344,0.122451,-0.043228,-0.07487,0.17784,0.114142,0.115804,-0.15813,-0.052404,-0.087087,0.18943,0.171276,0.105773,
  0.040023,-0.083138,-0.072463,0.135607,0.46744,0.099743,-0.112477,-0.052892,-0.140221,-0.024942,0.011883,0.063352,0.049967,-0.007052,-0.050341,0.002863,
  0.035555,0.0147,0.100548,-0.04223,0.042134,-0.067829,-0.041812,-0.078869,-0.394323,0.179906,0.129637,0.047157,-0.194705,0.037108,0.064449,0.191894,
  0.159489,0.344247,-0.163247,0.293521,0.091716,0.136242,-0.010424,0.029076,0.132582,0.001106,-0.00891,-0.065589,-0.0567,0.042175,0.051132,-0.151723,
  -0.185627,0.021391,0.05772,-0.107138,-0.297818,0.040708,0.025775,-0.044988,0.356386,-0.174938,0.137028,-0.190978,-0.079992,-0.07614,-0.151951,0.398727,
  -0.222571,-0.081983,-0.153999,-0.495894,0.170703,0.103813,-0.017748,-0.060069,0.120527,-0.170282,0.006203,0.193054,-0.103065,0.006783,0.364155,-0.248314,
  0.012365,0.131644,-0.01555,-0.118559,0.011093,-0.234566,-0.103794,0.058922,0.066304,0.021402,0.124638,0.199293,-0.009892,0.018558,-0.055227,-0.095637,
  0.1006,-0.056904,0.102509,-0.097548,-0.16312,-0.24644,0.053525,-0.087985,0.257169,-0.14664,0.159833,0.249545,0.117496,0.424051,0.15791,0.078168,
  0.23759,0.043348,0.13577,-0.097177,0.205834,-0.017892,-0.037489,-0.045111,0.110127,0.122843,-0.194956,-0.051857,-0.084906,0.028587,0.110075,0.057819,
  -0.227617,0.186038,-0.070601,0.102921,0.178572,0.020583,0.084807,0.24937,0.336935,-0.156773,-0.209748,0.164419,0.041437,0.054865,0.083418,-0.268134,
  0.01835,0.3109,0.080148,-0.292869,-0.013107,-0.249624,0.052774,0.214961,-0.045026,-0.147196,-0.016502,0.020301,0.126772,0.01566,0.136218,-0.014523,
  -0.113181,0.031313,0.179802,0.304519,0.021748,-0.221606,0.136473,-0.202596,0.128974,0.324431,0.01175,-0.094097,-0.06924,0.156021,0.066631,0.057369,
  -0.242566,-0.263158,0.082489,0.274178,0.111404,-0.04734,-0.053722,0.183313,0.11506,0.458901,0.165932,0.103643,0.165155,-0.129389,0.108173,0.030912,
  -0.041097,-0.049275,-0.044234,0.206114,0.216834,0.026496,-0.044073,-0.117768,0.101188,-0.086122,0.050626,0.015543,-0.083579,0.047146,0.265658,0.110068,
  -0.147321,0.124068,0.048411,0.156616,-0.047327,-0.103875,0.048432,0.167079,-0.02982,0.020041,-0.061373,-0.035818,0.047782,0.090457,0.038209,-0.164425,
  -0.1612,-0.013872,0.273196,0.038358,-0.007351,-0.103647,0.093237,0.075898,0.333202,0.172131,0.032848,-0.222281,-0.00693,-0.013317,0.282612,0.126687,
  0.000137,-0.020772,-0.16813,-0.105393,0.139904,-0.095715,-0.020528,-0.243683,0.020324,-0.027296,0.090097,0.041266,-0.129351,-0.102434,0.107737,-0.114979,
  0.110835,-0.060537,0.108392,0.169065,0.076129,-0.013412,0.159818,0.016859,0.255534,0.116514,0.089879,0.223239,0.114398,-0.167365,0.27271,0.138146,
  -0.049266,0.185881,-0.312935,0.034765,0.076815,-0.058174,0.097009,-0.068336,-0.010557,0.067275,0.025777,0.096314,0.048628,0.123301,0.232706,0.263149,
  -0.031127,-0.121748,-0.063413,-0.011151,0.082827,0.099182,0.00125,-0.192035,-0.085239,0.118928,-0.142797,-0.025796,0.245366,0.073151,-0.08788,-0.119151,
  -0.007744,0.217453,0.038278,0.137262,-0.05669,-0.010127,0.07073,0.012979,0.03037,0.109622,0.063809,0.146466,0.137379,0.089216,0.033613,0.081829,
  0.080948,-0.035933,0.25701,-0.012283,0.137053,0.026079,-0.237186,0.038919,0.007233,0.129018,0.049523,0.1635,-0.141972,-0.000099,0.068541,-0.086505,
  0.284747,-0.196997,0.22773,0.323352,-0.013431,-0.208766,-0.132829,-0.074146,-0.005072,0.184256,-0.036847,-0.011007,-0.223028,0.069623,0.11758,0.004287,
  0.068281,-0.014497,0.140602,0.008066,-0.033605,0.086583,0.141954,0.059634,0.232638,0.004817,0.227604,0.08831,0.141897,-0.211777,-0.025257,0.216811,
  -0.131638,0.27112,-0.111228,-0.172998,-0.063589,0.182118,0.090233,0.098929,-0.040283,-0.006336,-0.270862,0.091016,0.1001,0.191659,-0.108384,-0.122747,
  -0.124232,-0.038024,-0.00844,0.063135,0.079876,0.048025,-0.073429,-0.083597,0.321103,0.156478,-0.159449,0.055817,-0.050203,-0.013741,0.31841,0.196692,
  0.073984,-0.11818,0.01651,0.088508,0.1312,-0.049206,0.025182,0.270474,0.04149,0.057806,0.170953,0.125773,0.108982,-0.428161,0.501593,-0.035524,
  -0.229812,-0.062461,0.124928,0.071849,-0.198539,0.021828,0.015555,-0.015806,0.12291,-0.155494,-0.071056,-0.10351,-0.376223,0.285575,-0.012232,-0.309168,
  -0.163037,-0.054532,0.059355,-0.15631,-0.007488,-0.093043,0.096893,-0.017635,0.229107,0.054752,0.430329,0.022831,0.019911,0.01221,0.230391,-0.321197,
  -0.067483,0.173704,-0.030813,0.008768,-0.140686,-0.006771,-0.139564,0.085783,0.131765,0.157433,-0.156106,-0.144944,-0.175705,0.089021,0.032312,0.253304,
  -0.264218,0.016791,-0.164803,0.075411,-0.095075,0.065935,-0.224484,-0.072137,-0.007324,0.095406,-0.055471,-0.01348,-0.003295,-0.207779,0.024338,0.220557,
  -0.01131,-0.040829,-0.045666,-0.009792,-0.047667,0.019947,-0.141142,0.112932,0.098531,-0.155702,-0.06235,0.020026,-0.24086,0.047655,-0.156088,-0.029996,
  -0.012707,0.112406,-0.047265,-0.247277,-0.12398,-0.035475,0.076738,0.196647,-0.02042,-0.212485,-0.026959,0.000509,-0.032713,0.041008,-0.09608,0.057868,
  0.077416,-0.063487,0.009248,-0.131312,-0.014471,-0.038847,-0.23589,0.060778,-0.235116,0.002525,-0.034374,0.065507,0.047786,-0.140224,0.074648,-0.154519,
  -0.063424,-0.051858,-0.112917,-0.169478,0.07843,0.118349,-0.032771,0.02241,0.063097,-0.040755,-0.027059,-0.009486,-0.030183,-0.052684,-0.036807,-0.041972,
  0.112568,-0.04201,0.056222,-0.015798,-0.083734,-0.107573,-0.065848,0.051922,0.168877,-0.107143,0.031732,0.087719,-0.044237,0.259588,0.011598,-0.176822,
  -0.087824,-0.025342,-0.044488,-0.030542,-0.035881,-0.059793,0.077038,-0.013054,0.084323,-0.177662,0.100376,0.090573,0.021363,-0.137889,0.002029,-0.040591,
  -0.169648,0.100885,-0.083715,-0.079903,0.099416,0.117757,0.031451,0.151117,0.058442,0.148265,-0.18171,0.025129,-0.032957,0.030822,-0.015311,0.079303,
  0.052091,0.123447,-0.072098,-0.068652,0.054241,-0.012486,-0.0877,-0.059705,0.104262,-0.114962,0.056872,-0.079227,-0.093722,0.030255,-0.238218,0.264626,
  -0.105171,-0.017901,-0.09722,0.224062,-0.063371,-0.121713,0.051567,-0.091224,0.067517,-0.022443,0.002278,-0.123503,0.094656,-0.169294,-0.045749,0.106478,
  0.060947,-0.005408,-0.046666,-0.151013,-0.108636,-0.146436,0.076293,-0.164829,-0.252168,0.12763,0.068211,0.047908,-0.118845,0.042705,0.104772,-0.046088,
  0.293642,0.110498,-0.006141,0.018687,0.104715,0.215198,0.020994,-0.047526,0.230854,-0.094183,0.122049,-0.055241,-0.008203,0.072597,0.100178,0.153761,
  -0.129105,-0.051451,-0.300395,0.031814,-0.19691,0.136036,-0.111743,0.125776,0.133838,-0.308571,0.275142,-0.12223,0.098991,-0.106475,-0.062149,0.285482,
  -0.127611,-0.138356,-0.036531,-0.1896,-0.134249,0.103184,0.151096,0.231216,0.097741,-0.332667,-0.110004,0.012097,0.188564,0.058663,-0.010191,-0.10409,
  -0.176691,0.190089,0.094647,-0.014375,0.078885,-0.233692,-0.079865,0.058007,0.346608,0.077517,0.128301,-0.069717,0.014468,-0.069687,-0.00217,0.143611,
  0.107017,0.169904,-0.002606,0.139565,0.264567,-0.016515,-0.098482,-0.061225,0.141139,-0.157378,-0.005566,0.090247,-0.021632,-0.465912,0.015436,-0.016422,
  -0.119552,-0.036511,-0.031651,0.130866,0.312093,-0.081712,-0.08465,-0.003825,-0.075407,0.138355,0.01341,0.024528,-0.057221,0.060176,0.361092,-0.047301,
  0.039085,0.021519,0.05674,0.029985,0.070953,0.096013,0.009388,0.155688,0.088055,0.079958,-0.144064,-0.073708,0.152551,-0.084822,-0.245671,0.23022,
  0.041439,-0.010651,-0.146087,0.135307,-0.021954,-0.072694,0.126127,0.13609,-0.133282,0.054119,-0.052929,0.073015,0.125644,0.098068,0.179271,0.135895,
  -0.115072,-0.171285,0.063126,-0.018851,-0.066138,0.22874,0.353637,-0.093403,0.044356,-0.069927,0.117645,0.017517,-0.033948,0.162918,-0.015424,0.018275,
  0.02999,0.253082,0.026516,0.105064,-0.145958,0.001426,0.051976,0.048404,0.031888,0.11401,-0.390715,0.078503,-0.11032,0.14476,-0.096537,-0.030558,
  -0.171358,0.119329,0.109711,0.072423,-0.156632,-0.00547,0.069661,0.064445,-0.051075,0.161723,-0.008072,0.261728,0.005339,-0.104106,0.01682,-0.121391,
  -0.119533,-0.250838,-0.016243,0.060196,0.128437,0.160761,0.091551,-0.162603,0.179386,0.053451,-0.129363,0.456084,0.234576,0.082433,-0.00484,0.298006,
  0.015022,0.180209,0.069208,0.005333,0.043549,0.057527,0.233714,0.102327,0.174938,-0.004207,0.001724,0.07617,0.074772,-0.071643,0.02412,0.001187,
  0.022076,0.001101,0.151454,-0.045538,-0.120631,-0.187954,0.11084,0.142723,0.177878,0.141847,0.083519,-0.187836,0.049642,0.232477,-0.49146,0.168312,
  0.324127,0.236365,-0.104342,-0.236557,-0.043496,0.151707,-0.174965,-0.033589,0.40112,0.177373,0.059479,-0.634521,-0.047593,-0.056437,-0.049573,0.093886,
  -0.381432,-0.123966,-0.080403,-0.041089,-0.167801,-0.240324,-0.026904,-0.344978,0.440128,-0.230873,0.063813,0.12372,-0.551605,0.285666,-0.053754,-0.364583,
  0.1587,0.378164,-0.076835,0.003641,-0.095415,0.056581,-0.061586,-0.337895,0.096557,0.104816,-0.000674,0.26084,-0.030362,-0.560106,0.08084,0.048814,
  -0.030243,0.065722,0.243499,-0.574315,0.001437,0.212859,-0.037226,0.08718,0.201659,-0.61275,0.026714,0.040482,0.00829,0.082255,-0.005173,-0.367604,
  -0.185855,-0.009291,0.104137,-0.133903,0.127311,-0.106831,0.147649,-0.091026,-0.155512,-0.151132,0.008815,0.166399,-0.148261,-0.010067,-0.061182,0.171586,
  -0.082352,0.09869,0.120564,0.11659,-0.020864,-0.200441,-0.170395,-0.116136,0.204477,-0.049442,-0.080469,0.054772,0.162816,-0.035917,-0.114014,0.080634,
  0.160954,0.050027,-0.067798,-0.008296,0.142028,-0.026042,-0.129346,0.108843,0.01569,0.250184,-0.291044,0.328341,0.054767,0.180088,0.00482,-0.156217,
  0.365521,0.137041,0.116294,0.450861,0.351417,-0.06388,-0.070691,0.004369,-0.232989,0.147382,0.398933,0.03098,-0.137181,0.035186,-0.050495,0.280716,
  0.048011,0.246648,-0.077772,0.159861,-0.144073,0.155794,0.385444,0.051325,-0.017374,-0.036376,-0.052038,0.182071,0.211273,0.071304,-0.078119,-0.025992,
  -0.007831,-0.038989,-0.004361,-0.118303,-0.151001,0.066386,-0.013928,0.268684,0.320682,-0.011067,0.057464,-0.068353,0.060232,0.178755,-0.203554,-0.183278,
  0.092728,0.267277,0.029154,0.09617,0.03438,0.031129,-0.088522,-0.154638,-0.122341,-0.024367,-0.18975,-0.080911,0.121143,0.025484,0.198213,0.046724,
  0.069033,-0.103163,-0.059692,-0.075387,0.048794,0.062677,-0.041834,-0.097214,-0.369671,-0.108412,-0.220765,-0.256188,0.029229,-0.357522,0.117161,0.210492,
  0.042929,0.017552,-0.302809,0.031708,0.036932,0.164805,0.083724,-0.245723,-0.339474,0.024472,0.125939,0.416281,0.041343,0.234249,-0.064447,0.18528,
  -0.099625,0.368503,0.00954,-0.149809,0.29379,-0.156937,-0.03357,0.369471,0.0036,-0.087215,-0.112337,0.108194,-0.012485,0.20583,-0.114557,-0.010514,
  0.202642,0.019993,0.205495,0.174633,0.01038,0.11552,-0.125581,0.14044,0.177419,-0.472359,0.096849,-0.196789,-0.229227,-0.235901,0.135284,0.162815,
  -0.118027,0.06867,0.18214,-0.00637,-0.114345,-0.226636,0.005466,-0.039743,-0.049391,-0.05501,0.103741,-0.117124,0.27604,0.047568,-0.047291,-0.046663,
  -0.208677,0.187502,-0.017776,0.179995,-0.795536,0.197374,0.213755,-0.093801,0.216948,-0.017772,-0.06756,0.499629,-0.015249,-0.03397,-0.126563,0.097885,
  0.001811,0.412455,0.06792,0.038216,-0.07157,0.264739,-0.13439,0.328751,0.045035,-0.201425,-0.188572,-0.12677,-0.204584,0.284147,0.062861,-0.047405,
  0.198029,0.070807,0.127515,0.327634,0.090598,0.116646,0.090506,-0.074941,-0.002909,-0.152051,-0.057482,0.078793,-0.109243,0.023333,-0.193755,0.089571,
  -0.117659,0.15889,0.066588,0.245789,0.068998,0.207969,0.459693,0.108012,-0.283561,-0.281696,-0.083744,-0.137432,0.136255,0.184129,-0.210616,-0.061803,
  -0.134742,-0.291462,0.136291,-0.105646,-0.061563,-0.037389,0.042818,0.140672,0.099423,-0.079597,-0.1803,-0.089714,-0.14486,0.208205,-0.324271,-0.138905,
  -0.149513,0.154236,0.005131,-0.068341,0.143287,-0.011274,0.230669,0.109559,0.075473,0.145356,0.079895,0.018144,-0.254082,-0.154986,0.297851,0.269916,
  0.074888,0.147117,0.060097,0.16507,0.070349,0.052277,-0.135362,-0.066878,0.03605,0.113878,0.138247,-0.032815,-0.205942,0.043104,0.073518,-0.245788,
  0.300566,0.051121,-0.065904,-0.160039,0.127095,0.017762,-0.046187,-0.147601,0.368348,0.291835,0.050018,0.224281,0.063789,0.061751,0.306495,0.147832,
  -0.035608,-0.450231,0.091021,0.016634,0.017377,0.007535,0.015216,0.021685,-0.038242,-0.118702,0.133683,-0.101182,-0.060815,-0.279207,0.077098,-0.131578,
  -0.063774,0.005525,-0.359706,-0.177908,0.103163,0.109195,0.014359,0.055491,-0.260193,0.132676,0.041345,0.006679,-0.06767,0.083446,0.129521,-0.022891,
  -0.252899,-0.005459,-0.251133,-0.10366,-0.045311,-0.128726,0.057803,0.232916,-0.073247,0.05861,-0.036079,0.00236,-0.051852,0.032749,-0.13472,-0.036096,
  -0.293232,0.030317,0.019155,0.070094,0.091628,0.120249,-0.078399,0.056661,-0.176257,0.002731,0.009736,0.229891,0.005751,-0.059217,-0.033037,0.062155,
  -0.077578,0.215279,-0.108624,0.06588,0.085295,0.171913,-0.130714,-0.01787,0.140335,-0.056024,-0.072895,0.090363,0.154561,-0.102061,-0.128275,0.088996,
  -0.098836,-0.035279,-0.098205,0.039511,0.292521,-0.099498,0.011681,-0.245973,0.11889,0.045635,0.106832,0.026157,0.129279,0.031545,0.211516,0.320973,
  0.114638,0.074734,-0.022691,0.13101,-0.056636,-0.091038,-0.205913,0.036502,0.249694,0.010803,0.144404,0.013548,0.291665,0.033482,0.020061,0.382667,
  0.278159,0.10709,0.160134,0.188052,0.044846,0.206205,0.167618,0.26543,-0.176481,0.128541,0.048759,-0.035405,0.012978,0.196214,0.055816,-0.009183,
  -0.122296,-0.136554,0.098187,0.073431,-0.108627,-0.029001,-0.053739,-0.190389,0.055946,-0.02209,-0.03812,-0.283581,-0.027063,0.168007,0.219836,0.151494,
  -0.206238,0.01557,0.069941,-0.060482,0.175927,0.040487,-0.075719,-0.244648,-0.049667,0.121101,0.012764,-0.060653,-0.059069,0.094431,-0.02095,-0.243353,
  0.099915,0.083931,0.172653,-0.035223,0.015547,0.013759,0.105458,-0.017677,-0.146267,-0.091747,-0.042258,0.023588,-0.113443,-0.022305,-0.068068,-0.034842,
  0.124089,0.103016,-0.026385,0.103981,-0.087407,-0.184251,0.09549,-0.025303,-0.098564,0.13871,0.037977,-0.127752,0.01961,0.107725,-0.085121,-0.199781,
  -0.059963,-0.035747,-0.056097,0.103505,-0.075079,-0.07806,-0.194611,-0.162447,-0.138005,0.016198,0.161673,0.001173,-0.0569,0.027746,-0.227454,-0.125547,
  0.03951,-0.122576,-0.018588,0.232801,-0.414942,-0.203266,0.170084,0.004483,-0.03968,0.062289,-0.196237,0.054531,0.059808,-0.016212,0.169828,-0.112318,
  0.066767,-0.055554,-0.100504,-0.029389,-0.119538,-0.037686,-0.118494,-0.137431,-0.087074,0.184611,-0.121871,0.071991,0.011813,-0.233933,-0.183065,-0.066154,
  0.009474,0.171572,0.027597,-0.044171,-0.194928,0.04891,0.099543,-0.052434,0.195009,-0.178167,0.052384,-0.099744,-0.121512,-0.030072,-0.130303,-0.105616,
  -0.005444,0.028517,-0.051878,-0.016004,-0.084651,-0.013279,-0.180031,-0.13109,0.076926,-0.005975,0.025526,-0.028332,-0.044107,0.020079,-0.035998,0.15064,
  0.05672,-0.045374,0.017524,-0.012966,-0.123735,0.084758,-0.004455,-0.255188,-0.081786,0.076731,-0.075103,0.077965,-0.183802,0.028917,-0.23372,-0.095854,
  -0.188645,-0.120784,-0.019877,0.039936,0.078472,0.050726,-0.13193,-0.104028,0.189017,0.097476,0.029758,-0.143815,-0.087933,0.052462,0.081989,0.107591,
  0.087167,-0.341964,0.239144,0.174196,-0.3209,-0.083675,0.023277,0.059589,-0.066475,-0.125093,-0.057551,-0.259747,0.246342,0.417886,0.028602,-0.026084,
  0.111006,0.229029,-0.066067,0.359963,0.151297,-0.030482,0.084389,-0.072022,-0.014328,-0.251579,-0.033951,-0.128142,-0.433163,-0.183167,-0.305858,-0.237147,
  -0.223377,-0.089275,-0.130285,0.246921,0.033224,0.092538,0.055141,0.114805,-0.482144,0.231133,-0.059321,0.03947,-0.028177,0.18968,-0.247092,0.367002,
  0.002427,0.220159,-0.083985,0.113169,-0.121353,0.389728,0.017396,0.00621,0.175777,0.083417,-0.216836,0.286057,0.177795,0.161042,0.033037,0.170054,
  -0.135758,-0.041059,0.006145,-0.082482,-0.104862,0.163285,0.140805,0.13244,-0.132287,-0.110372,0.09752,0.036729,0.071702,0.463405,-0.163387,-0.110108,
  0.338758,0.090087,-0.007403,0.016045,-0.02503,0.154497,0.090892,0.078223,0.099441,-0.103325,0.009966,-0.116179,0.124724,0.002804,-0.006737,-0.011918,
  -0.08433,-0.031069,0.093902,-0.073695,0.254218,0.029275,0.085313,-0.045893,-0.310046,0.100404,-0.103832,0.078251,-0.055285,-0.077886,0.06428,-0.078744,
  0.007237,-0.025221,-0.025405,0.004234,0.07769,-0.058424,-0.028284,0.057573,0.123351,0.095447,-0.052164,0.12972,0.15294,-0.019939,0.062453,-0.028,
  0.185075,-0.010751,0.028952,0.010386,-0.11617,-0.062377,0.106235,0.288426,0.058194,0.133961,-0.07767,0.142693,-0.021663,0.065387,0.028527,0.148809,
  -0.070497,0.068073,-0.033395,0.067811,0.031753,-0.057413,-0.113206,-0.000462,-0.069791,0.113041,0.342021,0.279622,-0.136135,-0.188659,-0.190483,-0.136818,
  0.108732,-0.062572,0.101706,0.016429,-0.025939,-0.269668,0.157792,0.072783,0.103896,0.002853,-0.265761,0.435082,0.167188,0.028651,0.2435,-0.220521,
  -0.033779,0.020167,-0.272172,0.359063,0.021511,0.01408,-0.012087,0.043662,0.162527,-0.217971,-0.069759,0.41794,0.221304,-0.048632,0.115692,0.115372,
  -0.1093,0.121678,0.345143,0.075094,0.236654,-0.157403,0.034503,0.3759,0.188933,0.164085,0.162642,-0.097126,0.041591,0.16691,0.114326,0.052351,
  0.217528,-0.017766,-0.139642,-0.130948,0.213907,0.056855,0.176212,-0.166916,0.039403,0.123305,0.002387,-0.18607,-0.021474,0.0038,0.2103,-0.02906,
  0.155387,-0.185832,-0.126466,0.093414,-0.175643,0.074865,-0.152313,0.065936,-0.063015,-0.129288,0.115857,-0.199718,-0.053951,0.017465,0.072656,0.105647,
  -0.066617,-0.085513,-0.080769,-0.055548,-0.128747,-0.077664,-0.073868,-0.07215,-0.042007,-0.10309,0.040622,-0.010955,-0.02096,0.120734,-0.1768,-0.059579,
  0.018119,-0.112939,0.25215,-0.143491,0.057468,-0.057879,-0.129945,-0.016714,-0.047107,0.029999,-0.030583,-0.013462,0.001587,0.064841,-0.141582,0.083357,
  -0.067419,0.176534,-0.083371,0.019587,-0.139999,-0.052522,-0.03767,-0.067997,0.11866,0.106663,-0.22396,-0.021064,-0.08439,-0.14621,-0.014542,0.067785,
  -0.033791,0.111819,-0.004731,0.032806,-0.160186,0.00092,-0.059901,0.021767,0.217786,0.089742,-0.351876,-0.238268,0.014128,0.091592,-0.174774,0.074924,
  0.112929,-0.234571,-0.391433,-0.201337,-0.065104,-0.024498,-0.08317,-0.026477,0.067171,0.116422,-0.036431,-0.138932,-0.098156,-0.177603,-0.07024,0.330166,
  -0.214848,-0.1596,-0.062481,-0.173879,0.10304,0.085288,0.023404,0.136002,0.104226,-0.071228,-0.138676,0.242607,0.404615,0.241891,0.100054,0.0356,
  0.258009,0.08388,-0.138709,0.815426,0.134791,-0.000784,-0.261682,0.155557,0.151283,0.461457,0.137215,0.019354,0.002717,0.145448,0.16618,0.36916,
  0.269387,0.047958,-0.261726,0.085328,0.138813,0.247776,0.135053,-0.046324,-0.066113,0.172392,0.05224,0.032272,0.075163,-0.032912,-0.010989,-0.010114,
  0.204752,0.186989,-0.044173,-0.022595,-0.305578,0.120008,0.087871,0.035703,0.380369,0.364476,-0.29209,0.006583,0.145938,0.211177,-0.166249,-0.399272,
  0.049003,-0.046967,0.173716,-0.348583,0.122156,0.124879,-0.036508,0.236849,-0.044744,0.158616,-0.087099,-0.055918,-0.052287,-0.196985,0.4197,-0.166885,
  0.318975,-0.023263,0.182229,-0.094116,-0.531847,0.190714,-0.045999,0.0246,-0.073474,-0.254116,0.010136,-0.267891,-0.03753,0.016724,0.114997,-0.653023,
  -0.032032,-0.114736,0.124275,-0.085857,0.096935,-0.585782,0.034724,0.107218,0.000049,-0.086267,0.3927,-0.379331,-0.181509,-0.031782,0.030197,-0.146112,
  0.049711,-0.151504,0.031813,0.110617,0.075343,0.340499,0.243868,-0.120276,0.061545,0.274671,0.227895,-0.143324,-0.11016,-0.002618,-0.081453,0.151874,
];
const B1 = [
  0.041228,0.16196,0.01143,0.002572,0.047116,0.02696,0.054485,0.069245,0.049041,0.051371,0.048428,0.142745,-0.024621,0,0.052184,0.049079,
  -0.025808,-0.005198,0.029472,0.03478,0.050998,0.037092,0.141056,0.016616,-0.028002,-0.028195,0.04635,0.090808,-0.016762,-0.041123,-0.004359,0.059757,
];
const W2 = [
  0.137515,0.156665,0.09304,0.132659,0.129343,0.042248,0.024748,0.1051,-0.091069,0.246137,0.362586,0.260252,0.136903,0.042272,0.105691,0.269656,
  -0.023661,-0.387288,0.036795,0.271689,0.188901,0.032848,0.244362,0.081021,0.018795,0.038664,-0.120394,0.156844,0.01655,0.058337,0.174036,0.280516,
  0.107849,-0.077,0.271097,0.173307,0.160242,-0.03981,-0.057241,-0.02478,-0.186818,0.010465,0.428188,0.019343,0.09374,0.187501,-0.093473,0.137802,
  0.077954,0.38846,-0.017058,0.175089,-0.024427,0.069301,0.141364,0.02539,-0.080072,-0.11295,0.22547,-0.118097,-0.15864,0.109636,-0.146126,0.469096,
  0.108774,-0.039821,0.037281,0.03825,0.029291,-0.070963,-0.034512,0.011212,0.140449,-0.060763,-0.209787,-0.142279,-0.056991,-0.123955,-0.13427,0.03826,
  -0.148541,-0.100298,0.034182,0.294613,-0.128773,-0.035009,-0.055893,-0.016095,0.124531,0.040128,-0.054246,-0.133939,-0.084278,-0.088676,0.03276,-0.085704,
  0.016381,0.095346,-0.003544,-0.008797,0.083138,0.021518,0.097751,-0.207628,0.03774,-0.107747,-0.045224,-0.056892,-0.080358,-0.147465,-0.173669,0.101906,
  -0.102396,-0.023153,-0.139243,-0.133228,-0.071938,-0.140531,-0.050731,-0.069861,0.088472,-0.050578,0.000061,-0.095724,-0.130813,0.134205,0.095301,-0.042471,
  -0.108984,0.013971,0.152319,-0.157539,0.036949,0.057657,0.012903,0.055087,-0.10384,-0.160835,-0.064764,0.318662,0.033305,0.072835,0.039674,0.123895,
  0.07991,0.458271,-0.005017,0.071314,-0.275382,0.028863,0.123883,0.044987,0.002739,-0.023143,-0.10669,-0.02964,-0.36606,-0.032158,0.160829,0.267741,
  -0.021744,0.008793,-0.007387,-0.054477,0.057153,-0.031424,-0.079156,-0.045143,-0.087621,-0.126161,-0.097381,-0.096777,0.006889,-0.084122,-0.010848,-0.004774,
  0.087839,-0.317058,0.035202,-0.035415,0.053547,0.06575,-0.085191,-0.167052,-0.046392,0.044076,0.068366,-0.053187,-0.196612,-0.074486,0.025043,0.103735,
  -0.19876,0.268438,0.031616,-0.206671,-0.075289,-0.029757,0.099977,0.247013,0.149461,0.074629,0.205534,0.18782,0.072561,-0.038624,0.079947,-0.185916,
  -0.12879,-0.200541,-0.007018,-0.078565,-0.333647,0.110806,-0.139748,-0.055557,-0.018296,0.033934,0.100668,0.147133,0.052835,-0.134705,-0.382049,0.010037,
  0.08571,-0.029146,0.052626,0.054993,-0.027942,-0.208853,-0.024,0.098681,-0.028179,-0.108878,-0.132802,-0.003581,-0.019102,-0.02832,-0.196423,0.005133,
  -0.015659,-0.060387,0.146984,-0.090033,-0.234005,0.205185,0.056055,0.012229,-0.104105,0.088605,0.06452,-0.060349,-0.157602,0.09429,-0.098773,-0.048633,
  -0.09792,0.113835,-0.053902,0.003193,0.093852,0.05905,-0.052647,0.021846,0.069274,0.076936,-0.045668,0.478748,-0.18764,0.161332,0.034363,0.106643,
  0.00388,-0.442525,0.180888,0.101012,0.202889,-0.058414,0.127996,0.012627,0.189347,-0.059857,0.203153,-0.176952,0.015813,0.080138,-0.014904,-0.096599,
  0.030213,-0.082658,0.296301,0.108034,0.09128,0.039069,-0.017743,-0.055998,-0.037524,-0.019622,0.035072,-0.172005,0.20132,-0.033491,0.106428,0.270608,
  0.074245,0.201758,0.03961,-0.13009,-0.205927,0.04569,-0.017974,0.37187,-0.119268,-0.126932,0.172028,-0.09048,0.155035,-0.300541,0.106072,-0.200699,
  -0.280513,0.328319,-0.101005,-0.278111,0.216585,0.168305,-0.046616,0.072962,0.064375,0.037859,-0.072129,-0.020197,-0.00096,-0.026997,-0.049019,-0.112638,
  0.034293,-0.260261,0.289548,0.123019,-0.040774,0.133838,-0.114903,0.057927,0.10418,0.132192,-0.100408,0.1404,0.091176,0.112907,0.032596,-0.201894,
  -0.023786,0.028712,0.098188,-0.021612,-0.022794,0.032743,-0.045418,0.020324,0.064484,0.047437,-0.022405,0.217126,0.050435,0.119441,0.067199,0.274265,
  -0.084535,0.012134,0.060594,-0.018556,0.227643,0.161258,0.200211,0.120118,-0.153854,-0.113827,0.054804,-0.134738,-0.036356,0.042886,0.113732,-0.125424,
  0.193321,-0.047767,0.109576,-0.04157,-0.00424,0.10075,0.179308,-0.051988,-0.013788,-0.058903,0.146413,0.071939,-0.105111,0.041046,0.059215,0.048711,
  -0.088246,0.158015,0.197274,-0.074233,0.155444,0.145075,0.146774,0.085766,-0.237256,-0.038811,0.333537,-0.063766,0.35962,0.003303,0.112286,-0.520227,
  -0.013269,-0.086889,-0.028755,-0.026975,0.024965,0.129668,-0.014489,-0.092363,-0.036242,0.072325,-0.070783,0.034615,-0.122932,-0.065033,-0.04445,-0.080389,
  -0.00903,0.021809,-0.213876,-0.145218,0.085952,0.144899,-0.20976,-0.379886,-0.212134,0.168925,-0.174153,-0.191739,0.069966,-0.101638,0.039047,-0.062118,
  -0.109982,-0.065405,-0.143585,-0.01243,0.075191,0.210669,0.305053,0.253735,0.45267,0.12378,0.078726,-0.253584,-0.134611,0.040747,0.012525,-0.177755,
  0.190579,0.27154,0.172321,0.076132,-0.004569,0.220363,0.010475,0.026712,0.049119,0.021685,0.001603,0.047035,0.211358,0.080238,0.123294,-0.12181,
  0.083932,0.028164,-0.1142,0.047127,0.156565,0.135949,0.002031,0.176875,0.160451,0.087107,-0.121011,-0.102616,0.045977,0.201759,-0.009659,-0.158012,
  -0.00971,0.066702,0.086854,0.310938,-0.105688,0.034111,0.061302,0.075782,0.009221,-0.056752,-0.195576,0.168278,0.372727,-0.083299,-0.086528,0.07167,
  0.118883,0.011148,0.151256,0.139013,0.302986,-0.021476,0.019206,0.203959,0.043182,-0.005912,-0.017626,-0.112005,0.162692,-0.018011,0.210003,-0.076545,
  0.100711,0.382461,0.180782,0.059155,0.093892,0.077283,0.07488,0.2019,0.071231,-0.021374,-0.190381,0.344703,-0.028021,-0.192671,0.229152,0.034719,
  0.07131,0.082631,0.080884,0.158304,-0.056486,-0.019186,0.246119,-0.043544,-0.143685,0.189331,0.119252,0.065913,0.084132,-0.076644,0.239088,0.210857,
  0.206279,-0.363024,-0.069804,0.035397,0.075388,-0.145232,0.156148,0.056961,0.029407,-0.015477,-0.223713,0.11151,-0.028134,-0.001418,0.127594,0.188021,
  0.168064,-0.091377,0.281318,0.012545,0.02773,-0.014945,-0.071255,0.095375,-0.0302,0.019,0.26998,0.009072,-0.045003,-0.139967,0.102727,0.063774,
  0.274591,0.482421,0.012879,-0.126766,-0.071294,0.093404,-0.083019,0.028606,-0.048548,0.024886,0.362624,0.003184,0.210367,0.117278,-0.027959,0.022524,
  -0.378866,0.25117,0.054584,-0.110958,0.040124,0.020865,0.254592,0.122697,0.065156,0.030348,-0.179447,-0.220989,-0.112509,-0.040885,-0.079683,-0.178322,
  0.038072,-0.36856,-0.128747,0.226546,-0.119327,0.045551,-0.132589,-0.013818,-0.00613,0.036021,-0.481655,0.260577,-0.152108,0.092761,-0.061527,0.169632,
  -0.100187,-0.057015,-0.206929,0.023253,-0.048882,0.010265,0.049483,-0.060672,-0.159851,-0.06942,-0.060749,-0.136825,0.110384,0.085681,-0.124503,0.108333,
  -0.150461,-0.050879,-0.012021,-0.138583,-0.091792,-0.076649,-0.112526,-0.083687,-0.014858,-0.028336,-0.123177,0.145531,-0.158203,0.059128,0.274061,0.004389,
  0.247986,0.04722,-0.101349,0.067979,-0.084674,0.099261,-0.034268,-0.115644,-0.078591,0.027502,0.119319,0.056898,-0.106591,0.111857,0.0937,0.098589,
  -0.153197,-0.044311,0.029636,0.029146,-0.001107,0.060172,0.26763,0.060109,0.140871,-0.043373,0.184363,0.111412,-0.168709,-0.035699,0.0345,0.403506,
  -0.080808,-0.112108,0.155598,0.016873,0.089853,-0.099936,-0.007089,-0.201913,-0.155456,-0.025679,-0.049292,-0.179807,0.058556,0.018496,-0.182257,0.032076,
  -0.206997,-0.222408,-0.028577,-0.200707,-0.111102,0.099952,-0.059926,-0.058513,-0.046798,0.040653,-0.200619,0.040154,0.049215,0.006305,-0.040759,0.031431,
  0.014196,-0.192518,-0.033304,-0.074418,0.183002,0.33359,-0.127663,0.090936,0.046574,-0.017906,0.038963,0.106257,0.11026,0.130695,-0.124576,0.156781,
  -0.183122,0.299324,0.086796,-0.158929,0.25688,0.221532,0.107649,0.098532,0.152477,-0.032519,0.378404,0.064482,0.264958,-0.081382,0.010676,-0.36853,
  0.188649,-0.260183,0.040341,-0.034231,-0.231942,0.045459,0.073402,-0.008628,0.054621,0.224824,0.143366,0.300878,0.034743,-0.041888,0.137248,-0.017864,
  -0.028253,0.076431,-0.011793,0.078978,0.038893,-0.113763,0.186642,0.10687,-0.001718,-0.038085,0.098892,0.016655,-0.005227,-0.090375,-0.205324,0.043071,
  0.293605,-0.062369,0.066015,0.055158,-0.146487,-0.070334,0.028199,-0.070267,-0.042899,0.019383,-0.032568,0.023612,-0.157988,0.155042,0.123905,-0.195908,
  -0.117099,0.336432,-0.006259,-0.072644,-0.047075,-0.02051,-0.035427,0.184616,0.125576,-0.174502,0.130052,0.078181,0.11705,0.154564,-0.119386,0.145112,
  0.107882,0.21008,0.178197,0.020058,0.111013,0.11415,-0.042111,0.09747,0.0833,0.138088,-0.071995,-0.14158,0.010101,-0.181825,0.019534,0.09975,
  0.160018,0.229898,0.140623,0.049715,0.231328,0.09812,-0.032907,0.203978,-0.092845,-0.04172,0.132551,0.255332,0.133166,0.000257,0.243179,-0.185746,
  -0.151359,-0.079365,0.067921,0.00127,-0.022996,-0.034371,0.236083,-0.070129,0.219431,0.100738,-0.24401,-0.502188,-0.067865,0.04942,0.17814,-0.238231,
  0.207342,0.688176,0.0871,-0.079765,-0.253919,-0.010159,0.069753,0.00318,0.045378,0.177506,0.034003,0.080172,0.158857,0.061974,-0.038373,-0.073746,
  -0.050741,0.112976,-0.114272,-0.163858,0.080471,0.019273,0.313143,0.111666,0.099068,-0.018116,0.171797,0.16403,0.001395,-0.035538,0.176044,-0.057906,
  -0.304881,0.125326,-0.175775,0.012521,-0.27917,0.016974,0.0369,0.002585,-0.158998,-0.00714,-0.099851,-0.052831,0.007654,0.088973,-0.317228,0.558094,
  0.073088,0.125264,-0.202804,-0.001043,0.121144,0.27938,0.192759,0.145207,0.088651,0.095195,0.111775,-0.011997,-0.016293,-0.112829,0.154448,-0.114517,
  -0.023321,-0.343404,0.13821,0.087591,0.198296,0.259375,0.126498,0.212086,0.00197,0.079538,-0.074543,0.197744,-0.086047,-0.05151,0.100981,-0.093788,
  0.067911,-0.098442,-0.143823,0.061727,0.061152,0.057599,-0.177365,0.030807,0.172986,0.051273,0.149037,0.223522,-0.047345,0.029403,0.07283,-0.016021,
  -0.068827,-0.448687,-0.123793,0.036338,0.115081,-0.033851,0.17459,-0.083172,-0.024941,0.130177,-0.189847,-0.039495,-0.014641,-0.081738,0.028824,0.238439,
  0.156592,0.327155,0.167312,0.059608,-0.109142,0.001643,0.010335,-0.369512,-0.258904,-0.260869,-0.100125,0.095018,0.122758,-0.15937,-0.11827,-0.094101,
  0.071758,0.220298,-0.121904,0.053957,0.30859,0.281901,0.183648,-0.021308,-0.113758,-0.016319,0.059233,0.213954,-0.101109,0.224023,0.074972,0.253017,
];
const B2 = [
  0.15068,0.006653,-0.050164,0,0.097282,-0.02665,0.125855,-0.038921,0.114361,-0.015069,0.09419,0.10771,0.033138,-0.043387,0.042105,0.142689,
  0.067408,0.081254,0.014065,0.081295,-0.042523,0.092416,-0.024581,-0.047407,0.039758,-0.017768,0.030649,-0.049549,0.081309,0.132831,0.056192,0.12082,
];
const W3 = [
  -0.00628,-0.242713,-0.023137,0.086747,-0.031212,0.208652,-0.298132,0.014903,0.149646,0.05241,0.303078,0.116206,0.143218,-0.032696,0.050374,0.016667,
  -0.095636,-0.0609,-0.171671,-0.126789,0.135752,-0.106161,0.032326,0.121938,-0.087422,-0.244922,0.091717,-0.133864,-0.263455,0.073893,0.052164,-0.34012,
  -0.194802,0.104213,-0.082109,0.143943,0.218933,0.113988,-0.158284,-0.106074,-0.062144,0.121103,-0.078129,0.038824,0.191298,-0.153942,0.081247,-0.034607,
  0.031089,-0.061038,0.276842,-0.22636,0.008512,-0.075759,-0.206176,0.209361,0.011992,0.100574,0.085841,0.219115,-0.242961,-0.088542,-0.24076,-0.004986,
  -0.166403,-0.147141,0.055112,0.008035,-0.185919,-0.052932,0.255617,-0.066725,-0.207522,-0.121917,0.197978,-0.315822,-0.176085,-0.107526,0.225279,0.191492,
  0.17727,-0.145458,-0.043542,0.155452,0.186537,-0.11484,0.076052,-0.05947,-0.108345,-0.074958,0.02457,0.301228,-0.175398,0.098927,-0.142059,-0.061479,
  -0.025591,-0.210127,0.084022,0.054836,0.078421,-0.019239,0.406239,-0.055403,0.32287,-0.126344,0.02995,0.230293,0.180383,-0.025628,0.017232,-0.008984,
  -0.191972,-0.366835,-0.033984,-0.190582,-0.140359,-0.00581,0.014044,0.29266,0.086692,0.077918,-0.084235,-0.17862,0.217269,0.059144,0.109515,-0.123727,
  0.387586,0.100662,-0.176698,-0.025821,0.263554,0.019903,0.228103,0.047349,0.208235,0.157852,0.184879,0.465255,0.406637,-0.104235,0.312414,0.608084,
  0.391836,0.274017,0.335818,0.100991,-0.097556,0.588099,-0.004221,0.135141,0.422577,0.055527,0.274635,0.140401,0.136017,0.372989,0.056386,0.046385,
];
const B3 = [
  0.00119,-0.117362,-0.022761,-0.033886,0.112898,
];

function relu(x){return x>0?x:0;}
function tanh(x){const e1=Math.exp(x), e2=Math.exp(-x); return (e1-e2)/(e1+e2);}
function sigmoid(x){return 1/(1+Math.exp(-x));}

function mlpForward(x){
  // x: length INPUT_SIZE
  const h1 = new Array(H1).fill(0);
  for(let i=0;i<H1;i++){
    let s = B1[i];
    for(let j=0;j<INPUT_SIZE;j++) s += W1[i*INPUT_SIZE + j]*x[j];
    h1[i] = relu(s);
  }
  const h2 = new Array(H2).fill(0);
  for(let i=0;i<H2;i++){
    let s = B2[i];
    for(let j=0;j<H1;j++) s += W2[i*H1 + j]*h1[j];
    h2[i] = relu(s);
  }
  const out = new Array(OUTPUT_SIZE).fill(0);
  for(let i=0;i<OUTPUT_SIZE;i++){
    let s = B3[i];
    for(let j=0;j<H2;j++) s += W3[i*H2 + j]*h2[j];
    out[i] = s;
  }
  // post-process
  const mvx = tanh(out[0]);
  const mvy = tanh(out[1]);
  const fx  = tanh(out[2]);
  const fy  = tanh(out[3]);
  const fireP = sigmoid(out[4]);
  // 각도 변환
  const mvAngle = Math.atan2(mvy, mvx) * 180/Math.PI;
  const fireAngle = Math.atan2(fy, fx) * 180/Math.PI;
  return { mvAngle, fireAngle, fireP };
}

function norm(x, a, b){ return (x - a) / (b - a); }
function clamp01(v){ return v<0?0:(v>1?1:v); }

function buildFeatures(tank, enemies, allies, bulletInfo){
  // 입력 피처 구성 (전부 사용)
  // - 탱크 자체 상태: x,y,health,energy,typeOneHot(3),size
  // - 적/아군 최근접 K명: 상대 위치(상대 좌표-자기 좌표), 거리, 각, 체력
  // - 총알 최근접 K발: 상대 위치/속도(상대 좌표-자기 좌표), 거리
  const W=900, H=600;
  const self = [
    norm(tank.x, 0, W),
    norm(tank.y, 0, H),
    clamp01(tank.health/200),
    clamp01(tank.energy/200),
    tank.type===0?1:0,
    tank.type===1?1:0,
    tank.type===2?1:0,
    clamp01(tank.size/60),
  ];

  // 정렬 및 K개 추출
  function topK(arr, k){
    const sorted = arr.slice().sort((a,b)=> (a.distance||1e9)-(b.distance||1e9));
    return sorted.slice(0,k);
  }
  const KE=4, KA=3, KB=5;
  const es = topK(enemies, KE);
  const as = topK(allies, KA);
  const bs = topK(bulletInfo, KB);

  const ef = [];
  for(let i=0;i<KE;i++){
    const e = es[i];
    if(e){
      const dx = e.x - tank.x; const dy = e.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI; // -1..1
      ef.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(e.health/200));
    }else{
      ef.push(0,0,0,0,0);
    }
  }
  const af = [];
  for(let i=0;i<KA;i++){
    const a = as[i];
    if(a){
      const dx = a.x - tank.x; const dy = a.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      af.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(a.health/200));
    }else{
      af.push(0,0,0,0,0);
    }
  }
  const bf = [];
  for(let i=0;i<KB;i++){
    const b = bs[i];
    if(b){
      const dx = b.x - tank.x; const dy = b.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      bf.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang,
              clamp01((b.vx+8)/16), clamp01((b.vy+8)/16));
    }else{
      bf.push(0,0,0,0,0,0);
    }
  }

  // 전역 통계(개수/합계)
  const stats = [
    clamp01(enemies.length/6),
    clamp01(allies.length/5),
    clamp01(bulletInfo.length/10),
  ];

  const x = self.concat(ef, af, bf, stats);
  // 길이 보정(정확히 INPUT_SIZE)
  if (x.length < INPUT_SIZE) {
    while (x.length < INPUT_SIZE) x.push(0);
  } else if (x.length > INPUT_SIZE) {
    x.length = INPUT_SIZE;
  }
  return x;
}

function policyStep(tank, enemies, allies, bulletInfo){
  const feat = buildFeatures(tank, enemies, allies, bulletInfo);
  const out = mlpForward(feat);
  // 액션 적용
  // 발사 결정은 DNN의 fireP로만 제어
  if (out.fireP > 0.5) tank.fire(out.fireAngle);
  tank.move(out.mvAngle);
}


function name(){ return "DNN-D1"; }
function type(){ return Type.DEALER; }
function update(tank, enemies, allies, bulletInfo){
  policyStep(tank, enemies, allies, bulletInfo);
}


// ===== 다음 로봇 =====


const INPUT_SIZE = 76;
const H1 = 32;
const H2 = 32;
const OUTPUT_SIZE = 5; // [mvx, mvy, fx, fy, fire_logit]

const W1 = [
  0.231249,0.252307,0.277549,-0.080441,-0.056814,-0.017329,-0.03729,0.086753,0.122447,-0.381046,-0.012094,0.002491,-0.183581,0.097481,0.067492,0.057175,
  0.059112,0.214549,0.42343,0.303794,0.116437,-0.137641,0.138886,0.375197,0.177459,-0.137844,-0.354217,0.393907,-0.011193,0.021641,-0.025584,0.085705,
  -0.07592,-0.095949,-0.013901,-0.16592,0.090642,0.003898,-0.053293,0.001682,0.001988,0.043385,-0.01573,0.343829,-0.092087,-0.008471,0.222984,0.334922,
  -0.129952,0.158514,-0.017785,0.014144,0.159652,0.274476,0.004687,0.116878,-0.295685,-0.107057,0.265392,0.123549,0.182867,0.13654,-0.107376,0.062359,
  0.034339,0.027035,0.086895,0.002537,0.006179,0.021991,-0.112255,-0.035348,0.14066,0.07763,-0.073481,0.009612,-0.16441,0.07252,0.09489,0.282891,
  0.168923,0.002073,-0.04729,0.182894,-0.054457,0.054282,0.00975,0.021356,0.194464,-0.058447,0.209679,0.07782,0.094445,0.00661,-0.111975,0.042909,
  0.102029,0.095552,-0.035737,-0.074742,-0.210353,0.109379,0.01774,-0.485099,-0.127244,0.176676,0.027057,-0.140293,0.13579,-0.02035,-0.071361,0.030229,
  -0.099923,-0.036192,0.029663,-0.023531,-0.112156,0.144072,0.235565,-0.475378,-0.03504,-0.145612,0.0342,-0.063241,0.069014,-0.264007,0.047478,-0.115281,
  0.027475,-0.132847,0.341269,-0.126718,0.23187,0.268695,-0.080436,-0.063963,0.038427,-0.245087,0.130909,0.078642,0.017888,-0.23696,0.247609,-0.02891,
  0.115154,0.139652,0.100362,0.005329,0.11403,0.06441,0.029392,0.32734,0.083084,0.107289,0.060838,-0.055452,0.074276,0.056687,-0.065191,0.052332,
  -0.152936,-0.187324,0.017415,0.021242,-0.003169,0.026812,-0.063456,-0.178316,0.075306,0.390732,-0.019557,-0.068721,-0.049308,-0.079795,0.198757,0.128274,
  -0.119618,-0.036931,0.195009,-0.147944,0.192563,-0.087338,-0.114024,-0.315607,0.192127,-0.023869,-0.174601,-0.259945,-0.022001,0.021529,-0.069289,0.199371,
  -0.15614,-0.02703,-0.140107,0.123729,0.248163,0.023272,0.043381,0.18092,0.009153,-0.207206,0.109657,-0.01964,-0.01565,0.264206,0.19638,-0.170432,
  -0.152638,-0.110755,-0.114911,0.185059,0.218309,-0.248634,-0.012094,-0.067803,0.01673,0.260555,-0.167029,-0.056029,-0.15504,-0.108546,0.039792,0.11992,
  -0.08085,0.054533,0.155033,0.083988,0.107993,0.225401,-0.125344,0.170629,0.0079,0.059999,-0.17205,-0.010754,-0.016086,-0.230478,-0.177144,0.046707,
  0.043333,0.030807,-0.210242,-0.005623,-0.081899,0.108946,0.196994,-0.062466,0.066424,0.075504,-0.105066,0.022428,-0.036635,0.0508,-0.091117,0.193803,
  0.234642,-0.091593,-0.058831,-0.052719,-0.190395,-0.011782,-0.05412,-0.037195,0.047667,-0.106122,-0.094499,-0.012481,0.12228,0.120793,-0.124058,0.256646,
  -0.206133,-0.142556,0.034169,0.215976,0.166105,0.150425,-0.118902,0.013237,0.227881,0.404726,0.14554,0.123853,-0.211866,0.021287,0.069836,0.088628,
  0.266148,0.011142,-0.033858,-0.060848,0.069514,-0.001845,-0.164382,0.232031,-0.013076,0.088518,-0.024882,0.121853,-0.09547,0.129247,0.023822,0.0701,
  0.044805,-0.011508,-0.288175,0.007469,0.167103,0.127085,0.025522,0.197875,0.005763,0.194158,0.045954,0.055957,0.033337,-0.117676,-0.067896,0.009017,
  0.035343,-0.242824,-0.020475,-0.034971,-0.042475,0.07191,-0.047921,0.086175,-0.278755,-0.045365,0.123885,-0.184203,0.196427,-0.004445,0.062692,0.049139,
  0.042708,0.137667,-0.25662,0.083362,0.104321,0.124092,0.068975,-0.106787,0.235856,0.047117,0.038217,0.100415,0.223961,-0.033163,-0.014981,-0.002237,
  0.074313,-0.18447,0.203712,-0.063977,-0.106069,-0.139609,0.218535,-0.165839,0.237946,0.017028,-0.048425,-0.067711,-0.149326,0.061298,0.273153,0.072547,
  0.137193,0.015049,0.033872,-0.057425,0.211321,-0.108231,0.229444,0.031371,0.057188,0.037516,0.029653,0.132936,-0.059273,-0.037365,-0.026374,0.204505,
  0.123123,0.112858,0.084817,-0.160403,-0.002883,0.047882,0.266663,-0.027175,-0.118324,0.12456,-0.055469,0.069956,-0.077283,-0.138015,-0.073203,-0.010261,
  0.123227,-0.035158,0.081683,-0.066688,-0.167863,0.127134,0.127322,-0.194224,0.028522,0.134337,0.054119,-0.05296,0.006513,0.13624,-0.207391,0.21178,
  0.111596,-0.003922,0.029001,-0.197344,0.122451,-0.043228,-0.07487,0.17784,0.114142,0.115804,-0.15813,-0.052404,-0.087087,0.18943,0.171276,0.105773,
  0.040023,-0.083138,-0.072463,0.135607,0.46744,0.099743,-0.112477,-0.052892,-0.140221,-0.024942,0.011883,0.063352,0.049967,-0.007052,-0.050341,0.002863,
  0.035555,0.0147,0.100548,-0.04223,0.042134,-0.067829,-0.041812,-0.078869,-0.394323,0.179906,0.129637,0.047157,-0.194705,0.037108,0.064449,0.191894,
  0.159489,0.344247,-0.163247,0.293521,0.091716,0.136242,-0.010424,0.029076,0.132582,0.001106,-0.00891,-0.065589,-0.0567,0.042175,0.051132,-0.151723,
  -0.185627,0.021391,0.05772,-0.107138,-0.297818,0.040708,0.025775,-0.044988,0.356386,-0.174938,0.137028,-0.190978,-0.079992,-0.07614,-0.151951,0.398727,
  -0.222571,-0.081983,-0.153999,-0.495894,0.170703,0.103813,-0.017748,-0.060069,0.120527,-0.170282,0.006203,0.193054,-0.103065,0.006783,0.364155,-0.248314,
  0.012365,0.131644,-0.01555,-0.118559,0.011093,-0.234566,-0.103794,0.058922,0.066304,0.021402,0.124638,0.199293,-0.009892,0.018558,-0.055227,-0.095637,
  0.1006,-0.056904,0.102509,-0.097548,-0.16312,-0.24644,0.053525,-0.087985,0.257169,-0.14664,0.159833,0.249545,0.117496,0.424051,0.15791,0.078168,
  0.23759,0.043348,0.13577,-0.097177,0.205834,-0.017892,-0.037489,-0.045111,0.110127,0.122843,-0.194956,-0.051857,-0.084906,0.028587,0.110075,0.057819,
  -0.227617,0.186038,-0.070601,0.102921,0.178572,0.020583,0.084807,0.24937,0.336935,-0.156773,-0.209748,0.164419,0.041437,0.054865,0.083418,-0.268134,
  0.01835,0.3109,0.080148,-0.292869,-0.013107,-0.249624,0.052774,0.214961,-0.045026,-0.147196,-0.016502,0.020301,0.126772,0.01566,0.136218,-0.014523,
  -0.113181,0.031313,0.179802,0.304519,0.021748,-0.221606,0.136473,-0.202596,0.128974,0.324431,0.01175,-0.094097,-0.06924,0.156021,0.066631,0.057369,
  -0.242566,-0.263158,0.082489,0.274178,0.111404,-0.04734,-0.053722,0.183313,0.11506,0.458901,0.165932,0.103643,0.165155,-0.129389,0.108173,0.030912,
  -0.041097,-0.049275,-0.044234,0.206114,0.216834,0.026496,-0.044073,-0.117768,0.101188,-0.086122,0.050626,0.015543,-0.083579,0.047146,0.265658,0.110068,
  -0.147321,0.124068,0.048411,0.156616,-0.047327,-0.103875,0.048432,0.167079,-0.02982,0.020041,-0.061373,-0.035818,0.047782,0.090457,0.038209,-0.164425,
  -0.1612,-0.013872,0.273196,0.038358,-0.007351,-0.103647,0.093237,0.075898,0.333202,0.172131,0.032848,-0.222281,-0.00693,-0.013317,0.282612,0.126687,
  0.000137,-0.020772,-0.16813,-0.105393,0.139904,-0.095715,-0.020528,-0.243683,0.020324,-0.027296,0.090097,0.041266,-0.129351,-0.102434,0.107737,-0.114979,
  0.110835,-0.060537,0.108392,0.169065,0.076129,-0.013412,0.159818,0.016859,0.255534,0.116514,0.089879,0.223239,0.114398,-0.167365,0.27271,0.138146,
  -0.049266,0.185881,-0.312935,0.034765,0.076815,-0.058174,0.097009,-0.068336,-0.010557,0.067275,0.025777,0.096314,0.048628,0.123301,0.232706,0.263149,
  -0.031127,-0.121748,-0.063413,-0.011151,0.082827,0.099182,0.00125,-0.192035,-0.085239,0.118928,-0.142797,-0.025796,0.245366,0.073151,-0.08788,-0.119151,
  -0.007744,0.217453,0.038278,0.137262,-0.05669,-0.010127,0.07073,0.012979,0.03037,0.109622,0.063809,0.146466,0.137379,0.089216,0.033613,0.081829,
  0.080948,-0.035933,0.25701,-0.012283,0.137053,0.026079,-0.237186,0.038919,0.007233,0.129018,0.049523,0.1635,-0.141972,-0.000099,0.068541,-0.086505,
  0.284747,-0.196997,0.22773,0.323352,-0.013431,-0.208766,-0.132829,-0.074146,-0.005072,0.184256,-0.036847,-0.011007,-0.223028,0.069623,0.11758,0.004287,
  0.068281,-0.014497,0.140602,0.008066,-0.033605,0.086583,0.141954,0.059634,0.232638,0.004817,0.227604,0.08831,0.141897,-0.211777,-0.025257,0.216811,
  -0.131638,0.27112,-0.111228,-0.172998,-0.063589,0.182118,0.090233,0.098929,-0.040283,-0.006336,-0.270862,0.091016,0.1001,0.191659,-0.108384,-0.122747,
  -0.124232,-0.038024,-0.00844,0.063135,0.079876,0.048025,-0.073429,-0.083597,0.321103,0.156478,-0.159449,0.055817,-0.050203,-0.013741,0.31841,0.196692,
  0.073984,-0.11818,0.01651,0.088508,0.1312,-0.049206,0.025182,0.270474,0.04149,0.057806,0.170953,0.125773,0.108982,-0.428161,0.501593,-0.035524,
  -0.229812,-0.062461,0.124928,0.071849,-0.198539,0.021828,0.015555,-0.015806,0.12291,-0.155494,-0.071056,-0.10351,-0.376223,0.285575,-0.012232,-0.309168,
  -0.163037,-0.054532,0.059355,-0.15631,-0.007488,-0.093043,0.096893,-0.017635,0.229107,0.054752,0.430329,0.022831,0.019911,0.01221,0.230391,-0.321197,
  -0.067483,0.173704,-0.030813,0.008768,-0.140686,-0.006771,-0.139564,0.085783,0.131765,0.157433,-0.156106,-0.144944,-0.175705,0.089021,0.032312,0.253304,
  -0.264218,0.016791,-0.164803,0.075411,-0.095075,0.065935,-0.224484,-0.072137,-0.007324,0.095406,-0.055471,-0.01348,-0.003295,-0.207779,0.024338,0.220557,
  -0.01131,-0.040829,-0.045666,-0.009792,-0.047667,0.019947,-0.141142,0.112932,0.098531,-0.155702,-0.06235,0.020026,-0.24086,0.047655,-0.156088,-0.029996,
  -0.012707,0.112406,-0.047265,-0.247277,-0.12398,-0.035475,0.076738,0.196647,-0.02042,-0.212485,-0.026959,0.000509,-0.032713,0.041008,-0.09608,0.057868,
  0.077416,-0.063487,0.009248,-0.131312,-0.014471,-0.038847,-0.23589,0.060778,-0.235116,0.002525,-0.034374,0.065507,0.047786,-0.140224,0.074648,-0.154519,
  -0.063424,-0.051858,-0.112917,-0.169478,0.07843,0.118349,-0.032771,0.02241,0.063097,-0.040755,-0.027059,-0.009486,-0.030183,-0.052684,-0.036807,-0.041972,
  0.112568,-0.04201,0.056222,-0.015798,-0.083734,-0.107573,-0.065848,0.051922,0.168877,-0.107143,0.031732,0.087719,-0.044237,0.259588,0.011598,-0.176822,
  -0.087824,-0.025342,-0.044488,-0.030542,-0.035881,-0.059793,0.077038,-0.013054,0.084323,-0.177662,0.100376,0.090573,0.021363,-0.137889,0.002029,-0.040591,
  -0.169648,0.100885,-0.083715,-0.079903,0.099416,0.117757,0.031451,0.151117,0.058442,0.148265,-0.18171,0.025129,-0.032957,0.030822,-0.015311,0.079303,
  0.052091,0.123447,-0.072098,-0.068652,0.054241,-0.012486,-0.0877,-0.059705,0.104262,-0.114962,0.056872,-0.079227,-0.093722,0.030255,-0.238218,0.264626,
  -0.105171,-0.017901,-0.09722,0.224062,-0.063371,-0.121713,0.051567,-0.091224,0.067517,-0.022443,0.002278,-0.123503,0.094656,-0.169294,-0.045749,0.106478,
  0.060947,-0.005408,-0.046666,-0.151013,-0.108636,-0.146436,0.076293,-0.164829,-0.252168,0.12763,0.068211,0.047908,-0.118845,0.042705,0.104772,-0.046088,
  0.293642,0.110498,-0.006141,0.018687,0.104715,0.215198,0.020994,-0.047526,0.230854,-0.094183,0.122049,-0.055241,-0.008203,0.072597,0.100178,0.153761,
  -0.129105,-0.051451,-0.300395,0.031814,-0.19691,0.136036,-0.111743,0.125776,0.133838,-0.308571,0.275142,-0.12223,0.098991,-0.106475,-0.062149,0.285482,
  -0.127611,-0.138356,-0.036531,-0.1896,-0.134249,0.103184,0.151096,0.231216,0.097741,-0.332667,-0.110004,0.012097,0.188564,0.058663,-0.010191,-0.10409,
  -0.176691,0.190089,0.094647,-0.014375,0.078885,-0.233692,-0.079865,0.058007,0.346608,0.077517,0.128301,-0.069717,0.014468,-0.069687,-0.00217,0.143611,
  0.107017,0.169904,-0.002606,0.139565,0.264567,-0.016515,-0.098482,-0.061225,0.141139,-0.157378,-0.005566,0.090247,-0.021632,-0.465912,0.015436,-0.016422,
  -0.119552,-0.036511,-0.031651,0.130866,0.312093,-0.081712,-0.08465,-0.003825,-0.075407,0.138355,0.01341,0.024528,-0.057221,0.060176,0.361092,-0.047301,
  0.039085,0.021519,0.05674,0.029985,0.070953,0.096013,0.009388,0.155688,0.088055,0.079958,-0.144064,-0.073708,0.152551,-0.084822,-0.245671,0.23022,
  0.041439,-0.010651,-0.146087,0.135307,-0.021954,-0.072694,0.126127,0.13609,-0.133282,0.054119,-0.052929,0.073015,0.125644,0.098068,0.179271,0.135895,
  -0.115072,-0.171285,0.063126,-0.018851,-0.066138,0.22874,0.353637,-0.093403,0.044356,-0.069927,0.117645,0.017517,-0.033948,0.162918,-0.015424,0.018275,
  0.02999,0.253082,0.026516,0.105064,-0.145958,0.001426,0.051976,0.048404,0.031888,0.11401,-0.390715,0.078503,-0.11032,0.14476,-0.096537,-0.030558,
  -0.171358,0.119329,0.109711,0.072423,-0.156632,-0.00547,0.069661,0.064445,-0.051075,0.161723,-0.008072,0.261728,0.005339,-0.104106,0.01682,-0.121391,
  -0.119533,-0.250838,-0.016243,0.060196,0.128437,0.160761,0.091551,-0.162603,0.179386,0.053451,-0.129363,0.456084,0.234576,0.082433,-0.00484,0.298006,
  0.015022,0.180209,0.069208,0.005333,0.043549,0.057527,0.233714,0.102327,0.174938,-0.004207,0.001724,0.07617,0.074772,-0.071643,0.02412,0.001187,
  0.022076,0.001101,0.151454,-0.045538,-0.120631,-0.187954,0.11084,0.142723,0.177878,0.141847,0.083519,-0.187836,0.049642,0.232477,-0.49146,0.168312,
  0.324127,0.236365,-0.104342,-0.236557,-0.043496,0.151707,-0.174965,-0.033589,0.40112,0.177373,0.059479,-0.634521,-0.047593,-0.056437,-0.049573,0.093886,
  -0.381432,-0.123966,-0.080403,-0.041089,-0.167801,-0.240324,-0.026904,-0.344978,0.440128,-0.230873,0.063813,0.12372,-0.551605,0.285666,-0.053754,-0.364583,
  0.1587,0.378164,-0.076835,0.003641,-0.095415,0.056581,-0.061586,-0.337895,0.096557,0.104816,-0.000674,0.26084,-0.030362,-0.560106,0.08084,0.048814,
  -0.030243,0.065722,0.243499,-0.574315,0.001437,0.212859,-0.037226,0.08718,0.201659,-0.61275,0.026714,0.040482,0.00829,0.082255,-0.005173,-0.367604,
  -0.185855,-0.009291,0.104137,-0.133903,0.127311,-0.106831,0.147649,-0.091026,-0.155512,-0.151132,0.008815,0.166399,-0.148261,-0.010067,-0.061182,0.171586,
  -0.082352,0.09869,0.120564,0.11659,-0.020864,-0.200441,-0.170395,-0.116136,0.204477,-0.049442,-0.080469,0.054772,0.162816,-0.035917,-0.114014,0.080634,
  0.160954,0.050027,-0.067798,-0.008296,0.142028,-0.026042,-0.129346,0.108843,0.01569,0.250184,-0.291044,0.328341,0.054767,0.180088,0.00482,-0.156217,
  0.365521,0.137041,0.116294,0.450861,0.351417,-0.06388,-0.070691,0.004369,-0.232989,0.147382,0.398933,0.03098,-0.137181,0.035186,-0.050495,0.280716,
  0.048011,0.246648,-0.077772,0.159861,-0.144073,0.155794,0.385444,0.051325,-0.017374,-0.036376,-0.052038,0.182071,0.211273,0.071304,-0.078119,-0.025992,
  -0.007831,-0.038989,-0.004361,-0.118303,-0.151001,0.066386,-0.013928,0.268684,0.320682,-0.011067,0.057464,-0.068353,0.060232,0.178755,-0.203554,-0.183278,
  0.092728,0.267277,0.029154,0.09617,0.03438,0.031129,-0.088522,-0.154638,-0.122341,-0.024367,-0.18975,-0.080911,0.121143,0.025484,0.198213,0.046724,
  0.069033,-0.103163,-0.059692,-0.075387,0.048794,0.062677,-0.041834,-0.097214,-0.369671,-0.108412,-0.220765,-0.256188,0.029229,-0.357522,0.117161,0.210492,
  0.042929,0.017552,-0.302809,0.031708,0.036932,0.164805,0.083724,-0.245723,-0.339474,0.024472,0.125939,0.416281,0.041343,0.234249,-0.064447,0.18528,
  -0.099625,0.368503,0.00954,-0.149809,0.29379,-0.156937,-0.03357,0.369471,0.0036,-0.087215,-0.112337,0.108194,-0.012485,0.20583,-0.114557,-0.010514,
  0.202642,0.019993,0.205495,0.174633,0.01038,0.11552,-0.125581,0.14044,0.177419,-0.472359,0.096849,-0.196789,-0.229227,-0.235901,0.135284,0.162815,
  -0.118027,0.06867,0.18214,-0.00637,-0.114345,-0.226636,0.005466,-0.039743,-0.049391,-0.05501,0.103741,-0.117124,0.27604,0.047568,-0.047291,-0.046663,
  -0.208677,0.187502,-0.017776,0.179995,-0.795536,0.197374,0.213755,-0.093801,0.216948,-0.017772,-0.06756,0.499629,-0.015249,-0.03397,-0.126563,0.097885,
  0.001811,0.412455,0.06792,0.038216,-0.07157,0.264739,-0.13439,0.328751,0.045035,-0.201425,-0.188572,-0.12677,-0.204584,0.284147,0.062861,-0.047405,
  0.198029,0.070807,0.127515,0.327634,0.090598,0.116646,0.090506,-0.074941,-0.002909,-0.152051,-0.057482,0.078793,-0.109243,0.023333,-0.193755,0.089571,
  -0.117659,0.15889,0.066588,0.245789,0.068998,0.207969,0.459693,0.108012,-0.283561,-0.281696,-0.083744,-0.137432,0.136255,0.184129,-0.210616,-0.061803,
  -0.134742,-0.291462,0.136291,-0.105646,-0.061563,-0.037389,0.042818,0.140672,0.099423,-0.079597,-0.1803,-0.089714,-0.14486,0.208205,-0.324271,-0.138905,
  -0.149513,0.154236,0.005131,-0.068341,0.143287,-0.011274,0.230669,0.109559,0.075473,0.145356,0.079895,0.018144,-0.254082,-0.154986,0.297851,0.269916,
  0.074888,0.147117,0.060097,0.16507,0.070349,0.052277,-0.135362,-0.066878,0.03605,0.113878,0.138247,-0.032815,-0.205942,0.043104,0.073518,-0.245788,
  0.300566,0.051121,-0.065904,-0.160039,0.127095,0.017762,-0.046187,-0.147601,0.368348,0.291835,0.050018,0.224281,0.063789,0.061751,0.306495,0.147832,
  -0.035608,-0.450231,0.091021,0.016634,0.017377,0.007535,0.015216,0.021685,-0.038242,-0.118702,0.133683,-0.101182,-0.060815,-0.279207,0.077098,-0.131578,
  -0.063774,0.005525,-0.359706,-0.177908,0.103163,0.109195,0.014359,0.055491,-0.260193,0.132676,0.041345,0.006679,-0.06767,0.083446,0.129521,-0.022891,
  -0.252899,-0.005459,-0.251133,-0.10366,-0.045311,-0.128726,0.057803,0.232916,-0.073247,0.05861,-0.036079,0.00236,-0.051852,0.032749,-0.13472,-0.036096,
  -0.293232,0.030317,0.019155,0.070094,0.091628,0.120249,-0.078399,0.056661,-0.176257,0.002731,0.009736,0.229891,0.005751,-0.059217,-0.033037,0.062155,
  -0.077578,0.215279,-0.108624,0.06588,0.085295,0.171913,-0.130714,-0.01787,0.140335,-0.056024,-0.072895,0.090363,0.154561,-0.102061,-0.128275,0.088996,
  -0.098836,-0.035279,-0.098205,0.039511,0.292521,-0.099498,0.011681,-0.245973,0.11889,0.045635,0.106832,0.026157,0.129279,0.031545,0.211516,0.320973,
  0.114638,0.074734,-0.022691,0.13101,-0.056636,-0.091038,-0.205913,0.036502,0.249694,0.010803,0.144404,0.013548,0.291665,0.033482,0.020061,0.382667,
  0.278159,0.10709,0.160134,0.188052,0.044846,0.206205,0.167618,0.26543,-0.176481,0.128541,0.048759,-0.035405,0.012978,0.196214,0.055816,-0.009183,
  -0.122296,-0.136554,0.098187,0.073431,-0.108627,-0.029001,-0.053739,-0.190389,0.055946,-0.02209,-0.03812,-0.283581,-0.027063,0.168007,0.219836,0.151494,
  -0.206238,0.01557,0.069941,-0.060482,0.175927,0.040487,-0.075719,-0.244648,-0.049667,0.121101,0.012764,-0.060653,-0.059069,0.094431,-0.02095,-0.243353,
  0.099915,0.083931,0.172653,-0.035223,0.015547,0.013759,0.105458,-0.017677,-0.146267,-0.091747,-0.042258,0.023588,-0.113443,-0.022305,-0.068068,-0.034842,
  0.124089,0.103016,-0.026385,0.103981,-0.087407,-0.184251,0.09549,-0.025303,-0.098564,0.13871,0.037977,-0.127752,0.01961,0.107725,-0.085121,-0.199781,
  -0.059963,-0.035747,-0.056097,0.103505,-0.075079,-0.07806,-0.194611,-0.162447,-0.138005,0.016198,0.161673,0.001173,-0.0569,0.027746,-0.227454,-0.125547,
  0.03951,-0.122576,-0.018588,0.232801,-0.414942,-0.203266,0.170084,0.004483,-0.03968,0.062289,-0.196237,0.054531,0.059808,-0.016212,0.169828,-0.112318,
  0.066767,-0.055554,-0.100504,-0.029389,-0.119538,-0.037686,-0.118494,-0.137431,-0.087074,0.184611,-0.121871,0.071991,0.011813,-0.233933,-0.183065,-0.066154,
  0.009474,0.171572,0.027597,-0.044171,-0.194928,0.04891,0.099543,-0.052434,0.195009,-0.178167,0.052384,-0.099744,-0.121512,-0.030072,-0.130303,-0.105616,
  -0.005444,0.028517,-0.051878,-0.016004,-0.084651,-0.013279,-0.180031,-0.13109,0.076926,-0.005975,0.025526,-0.028332,-0.044107,0.020079,-0.035998,0.15064,
  0.05672,-0.045374,0.017524,-0.012966,-0.123735,0.084758,-0.004455,-0.255188,-0.081786,0.076731,-0.075103,0.077965,-0.183802,0.028917,-0.23372,-0.095854,
  -0.188645,-0.120784,-0.019877,0.039936,0.078472,0.050726,-0.13193,-0.104028,0.189017,0.097476,0.029758,-0.143815,-0.087933,0.052462,0.081989,0.107591,
  0.087167,-0.341964,0.239144,0.174196,-0.3209,-0.083675,0.023277,0.059589,-0.066475,-0.125093,-0.057551,-0.259747,0.246342,0.417886,0.028602,-0.026084,
  0.111006,0.229029,-0.066067,0.359963,0.151297,-0.030482,0.084389,-0.072022,-0.014328,-0.251579,-0.033951,-0.128142,-0.433163,-0.183167,-0.305858,-0.237147,
  -0.223377,-0.089275,-0.130285,0.246921,0.033224,0.092538,0.055141,0.114805,-0.482144,0.231133,-0.059321,0.03947,-0.028177,0.18968,-0.247092,0.367002,
  0.002427,0.220159,-0.083985,0.113169,-0.121353,0.389728,0.017396,0.00621,0.175777,0.083417,-0.216836,0.286057,0.177795,0.161042,0.033037,0.170054,
  -0.135758,-0.041059,0.006145,-0.082482,-0.104862,0.163285,0.140805,0.13244,-0.132287,-0.110372,0.09752,0.036729,0.071702,0.463405,-0.163387,-0.110108,
  0.338758,0.090087,-0.007403,0.016045,-0.02503,0.154497,0.090892,0.078223,0.099441,-0.103325,0.009966,-0.116179,0.124724,0.002804,-0.006737,-0.011918,
  -0.08433,-0.031069,0.093902,-0.073695,0.254218,0.029275,0.085313,-0.045893,-0.310046,0.100404,-0.103832,0.078251,-0.055285,-0.077886,0.06428,-0.078744,
  0.007237,-0.025221,-0.025405,0.004234,0.07769,-0.058424,-0.028284,0.057573,0.123351,0.095447,-0.052164,0.12972,0.15294,-0.019939,0.062453,-0.028,
  0.185075,-0.010751,0.028952,0.010386,-0.11617,-0.062377,0.106235,0.288426,0.058194,0.133961,-0.07767,0.142693,-0.021663,0.065387,0.028527,0.148809,
  -0.070497,0.068073,-0.033395,0.067811,0.031753,-0.057413,-0.113206,-0.000462,-0.069791,0.113041,0.342021,0.279622,-0.136135,-0.188659,-0.190483,-0.136818,
  0.108732,-0.062572,0.101706,0.016429,-0.025939,-0.269668,0.157792,0.072783,0.103896,0.002853,-0.265761,0.435082,0.167188,0.028651,0.2435,-0.220521,
  -0.033779,0.020167,-0.272172,0.359063,0.021511,0.01408,-0.012087,0.043662,0.162527,-0.217971,-0.069759,0.41794,0.221304,-0.048632,0.115692,0.115372,
  -0.1093,0.121678,0.345143,0.075094,0.236654,-0.157403,0.034503,0.3759,0.188933,0.164085,0.162642,-0.097126,0.041591,0.16691,0.114326,0.052351,
  0.217528,-0.017766,-0.139642,-0.130948,0.213907,0.056855,0.176212,-0.166916,0.039403,0.123305,0.002387,-0.18607,-0.021474,0.0038,0.2103,-0.02906,
  0.155387,-0.185832,-0.126466,0.093414,-0.175643,0.074865,-0.152313,0.065936,-0.063015,-0.129288,0.115857,-0.199718,-0.053951,0.017465,0.072656,0.105647,
  -0.066617,-0.085513,-0.080769,-0.055548,-0.128747,-0.077664,-0.073868,-0.07215,-0.042007,-0.10309,0.040622,-0.010955,-0.02096,0.120734,-0.1768,-0.059579,
  0.018119,-0.112939,0.25215,-0.143491,0.057468,-0.057879,-0.129945,-0.016714,-0.047107,0.029999,-0.030583,-0.013462,0.001587,0.064841,-0.141582,0.083357,
  -0.067419,0.176534,-0.083371,0.019587,-0.139999,-0.052522,-0.03767,-0.067997,0.11866,0.106663,-0.22396,-0.021064,-0.08439,-0.14621,-0.014542,0.067785,
  -0.033791,0.111819,-0.004731,0.032806,-0.160186,0.00092,-0.059901,0.021767,0.217786,0.089742,-0.351876,-0.238268,0.014128,0.091592,-0.174774,0.074924,
  0.112929,-0.234571,-0.391433,-0.201337,-0.065104,-0.024498,-0.08317,-0.026477,0.067171,0.116422,-0.036431,-0.138932,-0.098156,-0.177603,-0.07024,0.330166,
  -0.214848,-0.1596,-0.062481,-0.173879,0.10304,0.085288,0.023404,0.136002,0.104226,-0.071228,-0.138676,0.242607,0.404615,0.241891,0.100054,0.0356,
  0.258009,0.08388,-0.138709,0.815426,0.134791,-0.000784,-0.261682,0.155557,0.151283,0.461457,0.137215,0.019354,0.002717,0.145448,0.16618,0.36916,
  0.269387,0.047958,-0.261726,0.085328,0.138813,0.247776,0.135053,-0.046324,-0.066113,0.172392,0.05224,0.032272,0.075163,-0.032912,-0.010989,-0.010114,
  0.204752,0.186989,-0.044173,-0.022595,-0.305578,0.120008,0.087871,0.035703,0.380369,0.364476,-0.29209,0.006583,0.145938,0.211177,-0.166249,-0.399272,
  0.049003,-0.046967,0.173716,-0.348583,0.122156,0.124879,-0.036508,0.236849,-0.044744,0.158616,-0.087099,-0.055918,-0.052287,-0.196985,0.4197,-0.166885,
  0.318975,-0.023263,0.182229,-0.094116,-0.531847,0.190714,-0.045999,0.0246,-0.073474,-0.254116,0.010136,-0.267891,-0.03753,0.016724,0.114997,-0.653023,
  -0.032032,-0.114736,0.124275,-0.085857,0.096935,-0.585782,0.034724,0.107218,0.000049,-0.086267,0.3927,-0.379331,-0.181509,-0.031782,0.030197,-0.146112,
  0.049711,-0.151504,0.031813,0.110617,0.075343,0.340499,0.243868,-0.120276,0.061545,0.274671,0.227895,-0.143324,-0.11016,-0.002618,-0.081453,0.151874,
];
const B1 = [
  0.041228,0.16196,0.01143,0.002572,0.047116,0.02696,0.054485,0.069245,0.049041,0.051371,0.048428,0.142745,-0.024621,0,0.052184,0.049079,
  -0.025808,-0.005198,0.029472,0.03478,0.050998,0.037092,0.141056,0.016616,-0.028002,-0.028195,0.04635,0.090808,-0.016762,-0.041123,-0.004359,0.059757,
];
const W2 = [
  0.137515,0.156665,0.09304,0.132659,0.129343,0.042248,0.024748,0.1051,-0.091069,0.246137,0.362586,0.260252,0.136903,0.042272,0.105691,0.269656,
  -0.023661,-0.387288,0.036795,0.271689,0.188901,0.032848,0.244362,0.081021,0.018795,0.038664,-0.120394,0.156844,0.01655,0.058337,0.174036,0.280516,
  0.107849,-0.077,0.271097,0.173307,0.160242,-0.03981,-0.057241,-0.02478,-0.186818,0.010465,0.428188,0.019343,0.09374,0.187501,-0.093473,0.137802,
  0.077954,0.38846,-0.017058,0.175089,-0.024427,0.069301,0.141364,0.02539,-0.080072,-0.11295,0.22547,-0.118097,-0.15864,0.109636,-0.146126,0.469096,
  0.108774,-0.039821,0.037281,0.03825,0.029291,-0.070963,-0.034512,0.011212,0.140449,-0.060763,-0.209787,-0.142279,-0.056991,-0.123955,-0.13427,0.03826,
  -0.148541,-0.100298,0.034182,0.294613,-0.128773,-0.035009,-0.055893,-0.016095,0.124531,0.040128,-0.054246,-0.133939,-0.084278,-0.088676,0.03276,-0.085704,
  0.016381,0.095346,-0.003544,-0.008797,0.083138,0.021518,0.097751,-0.207628,0.03774,-0.107747,-0.045224,-0.056892,-0.080358,-0.147465,-0.173669,0.101906,
  -0.102396,-0.023153,-0.139243,-0.133228,-0.071938,-0.140531,-0.050731,-0.069861,0.088472,-0.050578,0.000061,-0.095724,-0.130813,0.134205,0.095301,-0.042471,
  -0.108984,0.013971,0.152319,-0.157539,0.036949,0.057657,0.012903,0.055087,-0.10384,-0.160835,-0.064764,0.318662,0.033305,0.072835,0.039674,0.123895,
  0.07991,0.458271,-0.005017,0.071314,-0.275382,0.028863,0.123883,0.044987,0.002739,-0.023143,-0.10669,-0.02964,-0.36606,-0.032158,0.160829,0.267741,
  -0.021744,0.008793,-0.007387,-0.054477,0.057153,-0.031424,-0.079156,-0.045143,-0.087621,-0.126161,-0.097381,-0.096777,0.006889,-0.084122,-0.010848,-0.004774,
  0.087839,-0.317058,0.035202,-0.035415,0.053547,0.06575,-0.085191,-0.167052,-0.046392,0.044076,0.068366,-0.053187,-0.196612,-0.074486,0.025043,0.103735,
  -0.19876,0.268438,0.031616,-0.206671,-0.075289,-0.029757,0.099977,0.247013,0.149461,0.074629,0.205534,0.18782,0.072561,-0.038624,0.079947,-0.185916,
  -0.12879,-0.200541,-0.007018,-0.078565,-0.333647,0.110806,-0.139748,-0.055557,-0.018296,0.033934,0.100668,0.147133,0.052835,-0.134705,-0.382049,0.010037,
  0.08571,-0.029146,0.052626,0.054993,-0.027942,-0.208853,-0.024,0.098681,-0.028179,-0.108878,-0.132802,-0.003581,-0.019102,-0.02832,-0.196423,0.005133,
  -0.015659,-0.060387,0.146984,-0.090033,-0.234005,0.205185,0.056055,0.012229,-0.104105,0.088605,0.06452,-0.060349,-0.157602,0.09429,-0.098773,-0.048633,
  -0.09792,0.113835,-0.053902,0.003193,0.093852,0.05905,-0.052647,0.021846,0.069274,0.076936,-0.045668,0.478748,-0.18764,0.161332,0.034363,0.106643,
  0.00388,-0.442525,0.180888,0.101012,0.202889,-0.058414,0.127996,0.012627,0.189347,-0.059857,0.203153,-0.176952,0.015813,0.080138,-0.014904,-0.096599,
  0.030213,-0.082658,0.296301,0.108034,0.09128,0.039069,-0.017743,-0.055998,-0.037524,-0.019622,0.035072,-0.172005,0.20132,-0.033491,0.106428,0.270608,
  0.074245,0.201758,0.03961,-0.13009,-0.205927,0.04569,-0.017974,0.37187,-0.119268,-0.126932,0.172028,-0.09048,0.155035,-0.300541,0.106072,-0.200699,
  -0.280513,0.328319,-0.101005,-0.278111,0.216585,0.168305,-0.046616,0.072962,0.064375,0.037859,-0.072129,-0.020197,-0.00096,-0.026997,-0.049019,-0.112638,
  0.034293,-0.260261,0.289548,0.123019,-0.040774,0.133838,-0.114903,0.057927,0.10418,0.132192,-0.100408,0.1404,0.091176,0.112907,0.032596,-0.201894,
  -0.023786,0.028712,0.098188,-0.021612,-0.022794,0.032743,-0.045418,0.020324,0.064484,0.047437,-0.022405,0.217126,0.050435,0.119441,0.067199,0.274265,
  -0.084535,0.012134,0.060594,-0.018556,0.227643,0.161258,0.200211,0.120118,-0.153854,-0.113827,0.054804,-0.134738,-0.036356,0.042886,0.113732,-0.125424,
  0.193321,-0.047767,0.109576,-0.04157,-0.00424,0.10075,0.179308,-0.051988,-0.013788,-0.058903,0.146413,0.071939,-0.105111,0.041046,0.059215,0.048711,
  -0.088246,0.158015,0.197274,-0.074233,0.155444,0.145075,0.146774,0.085766,-0.237256,-0.038811,0.333537,-0.063766,0.35962,0.003303,0.112286,-0.520227,
  -0.013269,-0.086889,-0.028755,-0.026975,0.024965,0.129668,-0.014489,-0.092363,-0.036242,0.072325,-0.070783,0.034615,-0.122932,-0.065033,-0.04445,-0.080389,
  -0.00903,0.021809,-0.213876,-0.145218,0.085952,0.144899,-0.20976,-0.379886,-0.212134,0.168925,-0.174153,-0.191739,0.069966,-0.101638,0.039047,-0.062118,
  -0.109982,-0.065405,-0.143585,-0.01243,0.075191,0.210669,0.305053,0.253735,0.45267,0.12378,0.078726,-0.253584,-0.134611,0.040747,0.012525,-0.177755,
  0.190579,0.27154,0.172321,0.076132,-0.004569,0.220363,0.010475,0.026712,0.049119,0.021685,0.001603,0.047035,0.211358,0.080238,0.123294,-0.12181,
  0.083932,0.028164,-0.1142,0.047127,0.156565,0.135949,0.002031,0.176875,0.160451,0.087107,-0.121011,-0.102616,0.045977,0.201759,-0.009659,-0.158012,
  -0.00971,0.066702,0.086854,0.310938,-0.105688,0.034111,0.061302,0.075782,0.009221,-0.056752,-0.195576,0.168278,0.372727,-0.083299,-0.086528,0.07167,
  0.118883,0.011148,0.151256,0.139013,0.302986,-0.021476,0.019206,0.203959,0.043182,-0.005912,-0.017626,-0.112005,0.162692,-0.018011,0.210003,-0.076545,
  0.100711,0.382461,0.180782,0.059155,0.093892,0.077283,0.07488,0.2019,0.071231,-0.021374,-0.190381,0.344703,-0.028021,-0.192671,0.229152,0.034719,
  0.07131,0.082631,0.080884,0.158304,-0.056486,-0.019186,0.246119,-0.043544,-0.143685,0.189331,0.119252,0.065913,0.084132,-0.076644,0.239088,0.210857,
  0.206279,-0.363024,-0.069804,0.035397,0.075388,-0.145232,0.156148,0.056961,0.029407,-0.015477,-0.223713,0.11151,-0.028134,-0.001418,0.127594,0.188021,
  0.168064,-0.091377,0.281318,0.012545,0.02773,-0.014945,-0.071255,0.095375,-0.0302,0.019,0.26998,0.009072,-0.045003,-0.139967,0.102727,0.063774,
  0.274591,0.482421,0.012879,-0.126766,-0.071294,0.093404,-0.083019,0.028606,-0.048548,0.024886,0.362624,0.003184,0.210367,0.117278,-0.027959,0.022524,
  -0.378866,0.25117,0.054584,-0.110958,0.040124,0.020865,0.254592,0.122697,0.065156,0.030348,-0.179447,-0.220989,-0.112509,-0.040885,-0.079683,-0.178322,
  0.038072,-0.36856,-0.128747,0.226546,-0.119327,0.045551,-0.132589,-0.013818,-0.00613,0.036021,-0.481655,0.260577,-0.152108,0.092761,-0.061527,0.169632,
  -0.100187,-0.057015,-0.206929,0.023253,-0.048882,0.010265,0.049483,-0.060672,-0.159851,-0.06942,-0.060749,-0.136825,0.110384,0.085681,-0.124503,0.108333,
  -0.150461,-0.050879,-0.012021,-0.138583,-0.091792,-0.076649,-0.112526,-0.083687,-0.014858,-0.028336,-0.123177,0.145531,-0.158203,0.059128,0.274061,0.004389,
  0.247986,0.04722,-0.101349,0.067979,-0.084674,0.099261,-0.034268,-0.115644,-0.078591,0.027502,0.119319,0.056898,-0.106591,0.111857,0.0937,0.098589,
  -0.153197,-0.044311,0.029636,0.029146,-0.001107,0.060172,0.26763,0.060109,0.140871,-0.043373,0.184363,0.111412,-0.168709,-0.035699,0.0345,0.403506,
  -0.080808,-0.112108,0.155598,0.016873,0.089853,-0.099936,-0.007089,-0.201913,-0.155456,-0.025679,-0.049292,-0.179807,0.058556,0.018496,-0.182257,0.032076,
  -0.206997,-0.222408,-0.028577,-0.200707,-0.111102,0.099952,-0.059926,-0.058513,-0.046798,0.040653,-0.200619,0.040154,0.049215,0.006305,-0.040759,0.031431,
  0.014196,-0.192518,-0.033304,-0.074418,0.183002,0.33359,-0.127663,0.090936,0.046574,-0.017906,0.038963,0.106257,0.11026,0.130695,-0.124576,0.156781,
  -0.183122,0.299324,0.086796,-0.158929,0.25688,0.221532,0.107649,0.098532,0.152477,-0.032519,0.378404,0.064482,0.264958,-0.081382,0.010676,-0.36853,
  0.188649,-0.260183,0.040341,-0.034231,-0.231942,0.045459,0.073402,-0.008628,0.054621,0.224824,0.143366,0.300878,0.034743,-0.041888,0.137248,-0.017864,
  -0.028253,0.076431,-0.011793,0.078978,0.038893,-0.113763,0.186642,0.10687,-0.001718,-0.038085,0.098892,0.016655,-0.005227,-0.090375,-0.205324,0.043071,
  0.293605,-0.062369,0.066015,0.055158,-0.146487,-0.070334,0.028199,-0.070267,-0.042899,0.019383,-0.032568,0.023612,-0.157988,0.155042,0.123905,-0.195908,
  -0.117099,0.336432,-0.006259,-0.072644,-0.047075,-0.02051,-0.035427,0.184616,0.125576,-0.174502,0.130052,0.078181,0.11705,0.154564,-0.119386,0.145112,
  0.107882,0.21008,0.178197,0.020058,0.111013,0.11415,-0.042111,0.09747,0.0833,0.138088,-0.071995,-0.14158,0.010101,-0.181825,0.019534,0.09975,
  0.160018,0.229898,0.140623,0.049715,0.231328,0.09812,-0.032907,0.203978,-0.092845,-0.04172,0.132551,0.255332,0.133166,0.000257,0.243179,-0.185746,
  -0.151359,-0.079365,0.067921,0.00127,-0.022996,-0.034371,0.236083,-0.070129,0.219431,0.100738,-0.24401,-0.502188,-0.067865,0.04942,0.17814,-0.238231,
  0.207342,0.688176,0.0871,-0.079765,-0.253919,-0.010159,0.069753,0.00318,0.045378,0.177506,0.034003,0.080172,0.158857,0.061974,-0.038373,-0.073746,
  -0.050741,0.112976,-0.114272,-0.163858,0.080471,0.019273,0.313143,0.111666,0.099068,-0.018116,0.171797,0.16403,0.001395,-0.035538,0.176044,-0.057906,
  -0.304881,0.125326,-0.175775,0.012521,-0.27917,0.016974,0.0369,0.002585,-0.158998,-0.00714,-0.099851,-0.052831,0.007654,0.088973,-0.317228,0.558094,
  0.073088,0.125264,-0.202804,-0.001043,0.121144,0.27938,0.192759,0.145207,0.088651,0.095195,0.111775,-0.011997,-0.016293,-0.112829,0.154448,-0.114517,
  -0.023321,-0.343404,0.13821,0.087591,0.198296,0.259375,0.126498,0.212086,0.00197,0.079538,-0.074543,0.197744,-0.086047,-0.05151,0.100981,-0.093788,
  0.067911,-0.098442,-0.143823,0.061727,0.061152,0.057599,-0.177365,0.030807,0.172986,0.051273,0.149037,0.223522,-0.047345,0.029403,0.07283,-0.016021,
  -0.068827,-0.448687,-0.123793,0.036338,0.115081,-0.033851,0.17459,-0.083172,-0.024941,0.130177,-0.189847,-0.039495,-0.014641,-0.081738,0.028824,0.238439,
  0.156592,0.327155,0.167312,0.059608,-0.109142,0.001643,0.010335,-0.369512,-0.258904,-0.260869,-0.100125,0.095018,0.122758,-0.15937,-0.11827,-0.094101,
  0.071758,0.220298,-0.121904,0.053957,0.30859,0.281901,0.183648,-0.021308,-0.113758,-0.016319,0.059233,0.213954,-0.101109,0.224023,0.074972,0.253017,
];
const B2 = [
  0.15068,0.006653,-0.050164,0,0.097282,-0.02665,0.125855,-0.038921,0.114361,-0.015069,0.09419,0.10771,0.033138,-0.043387,0.042105,0.142689,
  0.067408,0.081254,0.014065,0.081295,-0.042523,0.092416,-0.024581,-0.047407,0.039758,-0.017768,0.030649,-0.049549,0.081309,0.132831,0.056192,0.12082,
];
const W3 = [
  -0.00628,-0.242713,-0.023137,0.086747,-0.031212,0.208652,-0.298132,0.014903,0.149646,0.05241,0.303078,0.116206,0.143218,-0.032696,0.050374,0.016667,
  -0.095636,-0.0609,-0.171671,-0.126789,0.135752,-0.106161,0.032326,0.121938,-0.087422,-0.244922,0.091717,-0.133864,-0.263455,0.073893,0.052164,-0.34012,
  -0.194802,0.104213,-0.082109,0.143943,0.218933,0.113988,-0.158284,-0.106074,-0.062144,0.121103,-0.078129,0.038824,0.191298,-0.153942,0.081247,-0.034607,
  0.031089,-0.061038,0.276842,-0.22636,0.008512,-0.075759,-0.206176,0.209361,0.011992,0.100574,0.085841,0.219115,-0.242961,-0.088542,-0.24076,-0.004986,
  -0.166403,-0.147141,0.055112,0.008035,-0.185919,-0.052932,0.255617,-0.066725,-0.207522,-0.121917,0.197978,-0.315822,-0.176085,-0.107526,0.225279,0.191492,
  0.17727,-0.145458,-0.043542,0.155452,0.186537,-0.11484,0.076052,-0.05947,-0.108345,-0.074958,0.02457,0.301228,-0.175398,0.098927,-0.142059,-0.061479,
  -0.025591,-0.210127,0.084022,0.054836,0.078421,-0.019239,0.406239,-0.055403,0.32287,-0.126344,0.02995,0.230293,0.180383,-0.025628,0.017232,-0.008984,
  -0.191972,-0.366835,-0.033984,-0.190582,-0.140359,-0.00581,0.014044,0.29266,0.086692,0.077918,-0.084235,-0.17862,0.217269,0.059144,0.109515,-0.123727,
  0.387586,0.100662,-0.176698,-0.025821,0.263554,0.019903,0.228103,0.047349,0.208235,0.157852,0.184879,0.465255,0.406637,-0.104235,0.312414,0.608084,
  0.391836,0.274017,0.335818,0.100991,-0.097556,0.588099,-0.004221,0.135141,0.422577,0.055527,0.274635,0.140401,0.136017,0.372989,0.056386,0.046385,
];
const B3 = [
  0.00119,-0.117362,-0.022761,-0.033886,0.112898,
];

function relu(x){return x>0?x:0;}
function tanh(x){const e1=Math.exp(x), e2=Math.exp(-x); return (e1-e2)/(e1+e2);}
function sigmoid(x){return 1/(1+Math.exp(-x));}

function mlpForward(x){
  // x: length INPUT_SIZE
  const h1 = new Array(H1).fill(0);
  for(let i=0;i<H1;i++){
    let s = B1[i];
    for(let j=0;j<INPUT_SIZE;j++) s += W1[i*INPUT_SIZE + j]*x[j];
    h1[i] = relu(s);
  }
  const h2 = new Array(H2).fill(0);
  for(let i=0;i<H2;i++){
    let s = B2[i];
    for(let j=0;j<H1;j++) s += W2[i*H1 + j]*h1[j];
    h2[i] = relu(s);
  }
  const out = new Array(OUTPUT_SIZE).fill(0);
  for(let i=0;i<OUTPUT_SIZE;i++){
    let s = B3[i];
    for(let j=0;j<H2;j++) s += W3[i*H2 + j]*h2[j];
    out[i] = s;
  }
  // post-process
  const mvx = tanh(out[0]);
  const mvy = tanh(out[1]);
  const fx  = tanh(out[2]);
  const fy  = tanh(out[3]);
  const fireP = sigmoid(out[4]);
  // 각도 변환
  const mvAngle = Math.atan2(mvy, mvx) * 180/Math.PI;
  const fireAngle = Math.atan2(fy, fx) * 180/Math.PI;
  return { mvAngle, fireAngle, fireP };
}

function norm(x, a, b){ return (x - a) / (b - a); }
function clamp01(v){ return v<0?0:(v>1?1:v); }

function buildFeatures(tank, enemies, allies, bulletInfo){
  // 입력 피처 구성 (전부 사용)
  // - 탱크 자체 상태: x,y,health,energy,typeOneHot(3),size
  // - 적/아군 최근접 K명: 상대 위치(상대 좌표-자기 좌표), 거리, 각, 체력
  // - 총알 최근접 K발: 상대 위치/속도(상대 좌표-자기 좌표), 거리
  const W=900, H=600;
  const self = [
    norm(tank.x, 0, W),
    norm(tank.y, 0, H),
    clamp01(tank.health/200),
    clamp01(tank.energy/200),
    tank.type===0?1:0,
    tank.type===1?1:0,
    tank.type===2?1:0,
    clamp01(tank.size/60),
  ];

  // 정렬 및 K개 추출
  function topK(arr, k){
    const sorted = arr.slice().sort((a,b)=> (a.distance||1e9)-(b.distance||1e9));
    return sorted.slice(0,k);
  }
  const KE=4, KA=3, KB=5;
  const es = topK(enemies, KE);
  const as = topK(allies, KA);
  const bs = topK(bulletInfo, KB);

  const ef = [];
  for(let i=0;i<KE;i++){
    const e = es[i];
    if(e){
      const dx = e.x - tank.x; const dy = e.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI; // -1..1
      ef.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(e.health/200));
    }else{
      ef.push(0,0,0,0,0);
    }
  }
  const af = [];
  for(let i=0;i<KA;i++){
    const a = as[i];
    if(a){
      const dx = a.x - tank.x; const dy = a.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      af.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(a.health/200));
    }else{
      af.push(0,0,0,0,0);
    }
  }
  const bf = [];
  for(let i=0;i<KB;i++){
    const b = bs[i];
    if(b){
      const dx = b.x - tank.x; const dy = b.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      bf.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang,
              clamp01((b.vx+8)/16), clamp01((b.vy+8)/16));
    }else{
      bf.push(0,0,0,0,0,0);
    }
  }

  // 전역 통계(개수/합계)
  const stats = [
    clamp01(enemies.length/6),
    clamp01(allies.length/5),
    clamp01(bulletInfo.length/10),
  ];

  const x = self.concat(ef, af, bf, stats);
  // 길이 보정(정확히 INPUT_SIZE)
  if (x.length < INPUT_SIZE) {
    while (x.length < INPUT_SIZE) x.push(0);
  } else if (x.length > INPUT_SIZE) {
    x.length = INPUT_SIZE;
  }
  return x;
}

function policyStep(tank, enemies, allies, bulletInfo){
  const feat = buildFeatures(tank, enemies, allies, bulletInfo);
  const out = mlpForward(feat);
  // 액션 적용
  // 발사 결정은 DNN의 fireP로만 제어
  if (out.fireP > 0.5) tank.fire(out.fireAngle);
  tank.move(out.mvAngle);
}


function name(){ return "DNN-T1"; }
function type(){ return Type.TANKER; }
function update(tank, enemies, allies, bulletInfo){
  policyStep(tank, enemies, allies, bulletInfo);
}


// ===== 다음 로봇 =====


const INPUT_SIZE = 76;
const H1 = 32;
const H2 = 32;
const OUTPUT_SIZE = 5; // [mvx, mvy, fx, fy, fire_logit]

const W1 = [
  0.231249,0.252307,0.277549,-0.080441,-0.056814,-0.017329,-0.03729,0.086753,0.122447,-0.381046,-0.012094,0.002491,-0.183581,0.097481,0.067492,0.057175,
  0.059112,0.214549,0.42343,0.303794,0.116437,-0.137641,0.138886,0.375197,0.177459,-0.137844,-0.354217,0.393907,-0.011193,0.021641,-0.025584,0.085705,
  -0.07592,-0.095949,-0.013901,-0.16592,0.090642,0.003898,-0.053293,0.001682,0.001988,0.043385,-0.01573,0.343829,-0.092087,-0.008471,0.222984,0.334922,
  -0.129952,0.158514,-0.017785,0.014144,0.159652,0.274476,0.004687,0.116878,-0.295685,-0.107057,0.265392,0.123549,0.182867,0.13654,-0.107376,0.062359,
  0.034339,0.027035,0.086895,0.002537,0.006179,0.021991,-0.112255,-0.035348,0.14066,0.07763,-0.073481,0.009612,-0.16441,0.07252,0.09489,0.282891,
  0.168923,0.002073,-0.04729,0.182894,-0.054457,0.054282,0.00975,0.021356,0.194464,-0.058447,0.209679,0.07782,0.094445,0.00661,-0.111975,0.042909,
  0.102029,0.095552,-0.035737,-0.074742,-0.210353,0.109379,0.01774,-0.485099,-0.127244,0.176676,0.027057,-0.140293,0.13579,-0.02035,-0.071361,0.030229,
  -0.099923,-0.036192,0.029663,-0.023531,-0.112156,0.144072,0.235565,-0.475378,-0.03504,-0.145612,0.0342,-0.063241,0.069014,-0.264007,0.047478,-0.115281,
  0.027475,-0.132847,0.341269,-0.126718,0.23187,0.268695,-0.080436,-0.063963,0.038427,-0.245087,0.130909,0.078642,0.017888,-0.23696,0.247609,-0.02891,
  0.115154,0.139652,0.100362,0.005329,0.11403,0.06441,0.029392,0.32734,0.083084,0.107289,0.060838,-0.055452,0.074276,0.056687,-0.065191,0.052332,
  -0.152936,-0.187324,0.017415,0.021242,-0.003169,0.026812,-0.063456,-0.178316,0.075306,0.390732,-0.019557,-0.068721,-0.049308,-0.079795,0.198757,0.128274,
  -0.119618,-0.036931,0.195009,-0.147944,0.192563,-0.087338,-0.114024,-0.315607,0.192127,-0.023869,-0.174601,-0.259945,-0.022001,0.021529,-0.069289,0.199371,
  -0.15614,-0.02703,-0.140107,0.123729,0.248163,0.023272,0.043381,0.18092,0.009153,-0.207206,0.109657,-0.01964,-0.01565,0.264206,0.19638,-0.170432,
  -0.152638,-0.110755,-0.114911,0.185059,0.218309,-0.248634,-0.012094,-0.067803,0.01673,0.260555,-0.167029,-0.056029,-0.15504,-0.108546,0.039792,0.11992,
  -0.08085,0.054533,0.155033,0.083988,0.107993,0.225401,-0.125344,0.170629,0.0079,0.059999,-0.17205,-0.010754,-0.016086,-0.230478,-0.177144,0.046707,
  0.043333,0.030807,-0.210242,-0.005623,-0.081899,0.108946,0.196994,-0.062466,0.066424,0.075504,-0.105066,0.022428,-0.036635,0.0508,-0.091117,0.193803,
  0.234642,-0.091593,-0.058831,-0.052719,-0.190395,-0.011782,-0.05412,-0.037195,0.047667,-0.106122,-0.094499,-0.012481,0.12228,0.120793,-0.124058,0.256646,
  -0.206133,-0.142556,0.034169,0.215976,0.166105,0.150425,-0.118902,0.013237,0.227881,0.404726,0.14554,0.123853,-0.211866,0.021287,0.069836,0.088628,
  0.266148,0.011142,-0.033858,-0.060848,0.069514,-0.001845,-0.164382,0.232031,-0.013076,0.088518,-0.024882,0.121853,-0.09547,0.129247,0.023822,0.0701,
  0.044805,-0.011508,-0.288175,0.007469,0.167103,0.127085,0.025522,0.197875,0.005763,0.194158,0.045954,0.055957,0.033337,-0.117676,-0.067896,0.009017,
  0.035343,-0.242824,-0.020475,-0.034971,-0.042475,0.07191,-0.047921,0.086175,-0.278755,-0.045365,0.123885,-0.184203,0.196427,-0.004445,0.062692,0.049139,
  0.042708,0.137667,-0.25662,0.083362,0.104321,0.124092,0.068975,-0.106787,0.235856,0.047117,0.038217,0.100415,0.223961,-0.033163,-0.014981,-0.002237,
  0.074313,-0.18447,0.203712,-0.063977,-0.106069,-0.139609,0.218535,-0.165839,0.237946,0.017028,-0.048425,-0.067711,-0.149326,0.061298,0.273153,0.072547,
  0.137193,0.015049,0.033872,-0.057425,0.211321,-0.108231,0.229444,0.031371,0.057188,0.037516,0.029653,0.132936,-0.059273,-0.037365,-0.026374,0.204505,
  0.123123,0.112858,0.084817,-0.160403,-0.002883,0.047882,0.266663,-0.027175,-0.118324,0.12456,-0.055469,0.069956,-0.077283,-0.138015,-0.073203,-0.010261,
  0.123227,-0.035158,0.081683,-0.066688,-0.167863,0.127134,0.127322,-0.194224,0.028522,0.134337,0.054119,-0.05296,0.006513,0.13624,-0.207391,0.21178,
  0.111596,-0.003922,0.029001,-0.197344,0.122451,-0.043228,-0.07487,0.17784,0.114142,0.115804,-0.15813,-0.052404,-0.087087,0.18943,0.171276,0.105773,
  0.040023,-0.083138,-0.072463,0.135607,0.46744,0.099743,-0.112477,-0.052892,-0.140221,-0.024942,0.011883,0.063352,0.049967,-0.007052,-0.050341,0.002863,
  0.035555,0.0147,0.100548,-0.04223,0.042134,-0.067829,-0.041812,-0.078869,-0.394323,0.179906,0.129637,0.047157,-0.194705,0.037108,0.064449,0.191894,
  0.159489,0.344247,-0.163247,0.293521,0.091716,0.136242,-0.010424,0.029076,0.132582,0.001106,-0.00891,-0.065589,-0.0567,0.042175,0.051132,-0.151723,
  -0.185627,0.021391,0.05772,-0.107138,-0.297818,0.040708,0.025775,-0.044988,0.356386,-0.174938,0.137028,-0.190978,-0.079992,-0.07614,-0.151951,0.398727,
  -0.222571,-0.081983,-0.153999,-0.495894,0.170703,0.103813,-0.017748,-0.060069,0.120527,-0.170282,0.006203,0.193054,-0.103065,0.006783,0.364155,-0.248314,
  0.012365,0.131644,-0.01555,-0.118559,0.011093,-0.234566,-0.103794,0.058922,0.066304,0.021402,0.124638,0.199293,-0.009892,0.018558,-0.055227,-0.095637,
  0.1006,-0.056904,0.102509,-0.097548,-0.16312,-0.24644,0.053525,-0.087985,0.257169,-0.14664,0.159833,0.249545,0.117496,0.424051,0.15791,0.078168,
  0.23759,0.043348,0.13577,-0.097177,0.205834,-0.017892,-0.037489,-0.045111,0.110127,0.122843,-0.194956,-0.051857,-0.084906,0.028587,0.110075,0.057819,
  -0.227617,0.186038,-0.070601,0.102921,0.178572,0.020583,0.084807,0.24937,0.336935,-0.156773,-0.209748,0.164419,0.041437,0.054865,0.083418,-0.268134,
  0.01835,0.3109,0.080148,-0.292869,-0.013107,-0.249624,0.052774,0.214961,-0.045026,-0.147196,-0.016502,0.020301,0.126772,0.01566,0.136218,-0.014523,
  -0.113181,0.031313,0.179802,0.304519,0.021748,-0.221606,0.136473,-0.202596,0.128974,0.324431,0.01175,-0.094097,-0.06924,0.156021,0.066631,0.057369,
  -0.242566,-0.263158,0.082489,0.274178,0.111404,-0.04734,-0.053722,0.183313,0.11506,0.458901,0.165932,0.103643,0.165155,-0.129389,0.108173,0.030912,
  -0.041097,-0.049275,-0.044234,0.206114,0.216834,0.026496,-0.044073,-0.117768,0.101188,-0.086122,0.050626,0.015543,-0.083579,0.047146,0.265658,0.110068,
  -0.147321,0.124068,0.048411,0.156616,-0.047327,-0.103875,0.048432,0.167079,-0.02982,0.020041,-0.061373,-0.035818,0.047782,0.090457,0.038209,-0.164425,
  -0.1612,-0.013872,0.273196,0.038358,-0.007351,-0.103647,0.093237,0.075898,0.333202,0.172131,0.032848,-0.222281,-0.00693,-0.013317,0.282612,0.126687,
  0.000137,-0.020772,-0.16813,-0.105393,0.139904,-0.095715,-0.020528,-0.243683,0.020324,-0.027296,0.090097,0.041266,-0.129351,-0.102434,0.107737,-0.114979,
  0.110835,-0.060537,0.108392,0.169065,0.076129,-0.013412,0.159818,0.016859,0.255534,0.116514,0.089879,0.223239,0.114398,-0.167365,0.27271,0.138146,
  -0.049266,0.185881,-0.312935,0.034765,0.076815,-0.058174,0.097009,-0.068336,-0.010557,0.067275,0.025777,0.096314,0.048628,0.123301,0.232706,0.263149,
  -0.031127,-0.121748,-0.063413,-0.011151,0.082827,0.099182,0.00125,-0.192035,-0.085239,0.118928,-0.142797,-0.025796,0.245366,0.073151,-0.08788,-0.119151,
  -0.007744,0.217453,0.038278,0.137262,-0.05669,-0.010127,0.07073,0.012979,0.03037,0.109622,0.063809,0.146466,0.137379,0.089216,0.033613,0.081829,
  0.080948,-0.035933,0.25701,-0.012283,0.137053,0.026079,-0.237186,0.038919,0.007233,0.129018,0.049523,0.1635,-0.141972,-0.000099,0.068541,-0.086505,
  0.284747,-0.196997,0.22773,0.323352,-0.013431,-0.208766,-0.132829,-0.074146,-0.005072,0.184256,-0.036847,-0.011007,-0.223028,0.069623,0.11758,0.004287,
  0.068281,-0.014497,0.140602,0.008066,-0.033605,0.086583,0.141954,0.059634,0.232638,0.004817,0.227604,0.08831,0.141897,-0.211777,-0.025257,0.216811,
  -0.131638,0.27112,-0.111228,-0.172998,-0.063589,0.182118,0.090233,0.098929,-0.040283,-0.006336,-0.270862,0.091016,0.1001,0.191659,-0.108384,-0.122747,
  -0.124232,-0.038024,-0.00844,0.063135,0.079876,0.048025,-0.073429,-0.083597,0.321103,0.156478,-0.159449,0.055817,-0.050203,-0.013741,0.31841,0.196692,
  0.073984,-0.11818,0.01651,0.088508,0.1312,-0.049206,0.025182,0.270474,0.04149,0.057806,0.170953,0.125773,0.108982,-0.428161,0.501593,-0.035524,
  -0.229812,-0.062461,0.124928,0.071849,-0.198539,0.021828,0.015555,-0.015806,0.12291,-0.155494,-0.071056,-0.10351,-0.376223,0.285575,-0.012232,-0.309168,
  -0.163037,-0.054532,0.059355,-0.15631,-0.007488,-0.093043,0.096893,-0.017635,0.229107,0.054752,0.430329,0.022831,0.019911,0.01221,0.230391,-0.321197,
  -0.067483,0.173704,-0.030813,0.008768,-0.140686,-0.006771,-0.139564,0.085783,0.131765,0.157433,-0.156106,-0.144944,-0.175705,0.089021,0.032312,0.253304,
  -0.264218,0.016791,-0.164803,0.075411,-0.095075,0.065935,-0.224484,-0.072137,-0.007324,0.095406,-0.055471,-0.01348,-0.003295,-0.207779,0.024338,0.220557,
  -0.01131,-0.040829,-0.045666,-0.009792,-0.047667,0.019947,-0.141142,0.112932,0.098531,-0.155702,-0.06235,0.020026,-0.24086,0.047655,-0.156088,-0.029996,
  -0.012707,0.112406,-0.047265,-0.247277,-0.12398,-0.035475,0.076738,0.196647,-0.02042,-0.212485,-0.026959,0.000509,-0.032713,0.041008,-0.09608,0.057868,
  0.077416,-0.063487,0.009248,-0.131312,-0.014471,-0.038847,-0.23589,0.060778,-0.235116,0.002525,-0.034374,0.065507,0.047786,-0.140224,0.074648,-0.154519,
  -0.063424,-0.051858,-0.112917,-0.169478,0.07843,0.118349,-0.032771,0.02241,0.063097,-0.040755,-0.027059,-0.009486,-0.030183,-0.052684,-0.036807,-0.041972,
  0.112568,-0.04201,0.056222,-0.015798,-0.083734,-0.107573,-0.065848,0.051922,0.168877,-0.107143,0.031732,0.087719,-0.044237,0.259588,0.011598,-0.176822,
  -0.087824,-0.025342,-0.044488,-0.030542,-0.035881,-0.059793,0.077038,-0.013054,0.084323,-0.177662,0.100376,0.090573,0.021363,-0.137889,0.002029,-0.040591,
  -0.169648,0.100885,-0.083715,-0.079903,0.099416,0.117757,0.031451,0.151117,0.058442,0.148265,-0.18171,0.025129,-0.032957,0.030822,-0.015311,0.079303,
  0.052091,0.123447,-0.072098,-0.068652,0.054241,-0.012486,-0.0877,-0.059705,0.104262,-0.114962,0.056872,-0.079227,-0.093722,0.030255,-0.238218,0.264626,
  -0.105171,-0.017901,-0.09722,0.224062,-0.063371,-0.121713,0.051567,-0.091224,0.067517,-0.022443,0.002278,-0.123503,0.094656,-0.169294,-0.045749,0.106478,
  0.060947,-0.005408,-0.046666,-0.151013,-0.108636,-0.146436,0.076293,-0.164829,-0.252168,0.12763,0.068211,0.047908,-0.118845,0.042705,0.104772,-0.046088,
  0.293642,0.110498,-0.006141,0.018687,0.104715,0.215198,0.020994,-0.047526,0.230854,-0.094183,0.122049,-0.055241,-0.008203,0.072597,0.100178,0.153761,
  -0.129105,-0.051451,-0.300395,0.031814,-0.19691,0.136036,-0.111743,0.125776,0.133838,-0.308571,0.275142,-0.12223,0.098991,-0.106475,-0.062149,0.285482,
  -0.127611,-0.138356,-0.036531,-0.1896,-0.134249,0.103184,0.151096,0.231216,0.097741,-0.332667,-0.110004,0.012097,0.188564,0.058663,-0.010191,-0.10409,
  -0.176691,0.190089,0.094647,-0.014375,0.078885,-0.233692,-0.079865,0.058007,0.346608,0.077517,0.128301,-0.069717,0.014468,-0.069687,-0.00217,0.143611,
  0.107017,0.169904,-0.002606,0.139565,0.264567,-0.016515,-0.098482,-0.061225,0.141139,-0.157378,-0.005566,0.090247,-0.021632,-0.465912,0.015436,-0.016422,
  -0.119552,-0.036511,-0.031651,0.130866,0.312093,-0.081712,-0.08465,-0.003825,-0.075407,0.138355,0.01341,0.024528,-0.057221,0.060176,0.361092,-0.047301,
  0.039085,0.021519,0.05674,0.029985,0.070953,0.096013,0.009388,0.155688,0.088055,0.079958,-0.144064,-0.073708,0.152551,-0.084822,-0.245671,0.23022,
  0.041439,-0.010651,-0.146087,0.135307,-0.021954,-0.072694,0.126127,0.13609,-0.133282,0.054119,-0.052929,0.073015,0.125644,0.098068,0.179271,0.135895,
  -0.115072,-0.171285,0.063126,-0.018851,-0.066138,0.22874,0.353637,-0.093403,0.044356,-0.069927,0.117645,0.017517,-0.033948,0.162918,-0.015424,0.018275,
  0.02999,0.253082,0.026516,0.105064,-0.145958,0.001426,0.051976,0.048404,0.031888,0.11401,-0.390715,0.078503,-0.11032,0.14476,-0.096537,-0.030558,
  -0.171358,0.119329,0.109711,0.072423,-0.156632,-0.00547,0.069661,0.064445,-0.051075,0.161723,-0.008072,0.261728,0.005339,-0.104106,0.01682,-0.121391,
  -0.119533,-0.250838,-0.016243,0.060196,0.128437,0.160761,0.091551,-0.162603,0.179386,0.053451,-0.129363,0.456084,0.234576,0.082433,-0.00484,0.298006,
  0.015022,0.180209,0.069208,0.005333,0.043549,0.057527,0.233714,0.102327,0.174938,-0.004207,0.001724,0.07617,0.074772,-0.071643,0.02412,0.001187,
  0.022076,0.001101,0.151454,-0.045538,-0.120631,-0.187954,0.11084,0.142723,0.177878,0.141847,0.083519,-0.187836,0.049642,0.232477,-0.49146,0.168312,
  0.324127,0.236365,-0.104342,-0.236557,-0.043496,0.151707,-0.174965,-0.033589,0.40112,0.177373,0.059479,-0.634521,-0.047593,-0.056437,-0.049573,0.093886,
  -0.381432,-0.123966,-0.080403,-0.041089,-0.167801,-0.240324,-0.026904,-0.344978,0.440128,-0.230873,0.063813,0.12372,-0.551605,0.285666,-0.053754,-0.364583,
  0.1587,0.378164,-0.076835,0.003641,-0.095415,0.056581,-0.061586,-0.337895,0.096557,0.104816,-0.000674,0.26084,-0.030362,-0.560106,0.08084,0.048814,
  -0.030243,0.065722,0.243499,-0.574315,0.001437,0.212859,-0.037226,0.08718,0.201659,-0.61275,0.026714,0.040482,0.00829,0.082255,-0.005173,-0.367604,
  -0.185855,-0.009291,0.104137,-0.133903,0.127311,-0.106831,0.147649,-0.091026,-0.155512,-0.151132,0.008815,0.166399,-0.148261,-0.010067,-0.061182,0.171586,
  -0.082352,0.09869,0.120564,0.11659,-0.020864,-0.200441,-0.170395,-0.116136,0.204477,-0.049442,-0.080469,0.054772,0.162816,-0.035917,-0.114014,0.080634,
  0.160954,0.050027,-0.067798,-0.008296,0.142028,-0.026042,-0.129346,0.108843,0.01569,0.250184,-0.291044,0.328341,0.054767,0.180088,0.00482,-0.156217,
  0.365521,0.137041,0.116294,0.450861,0.351417,-0.06388,-0.070691,0.004369,-0.232989,0.147382,0.398933,0.03098,-0.137181,0.035186,-0.050495,0.280716,
  0.048011,0.246648,-0.077772,0.159861,-0.144073,0.155794,0.385444,0.051325,-0.017374,-0.036376,-0.052038,0.182071,0.211273,0.071304,-0.078119,-0.025992,
  -0.007831,-0.038989,-0.004361,-0.118303,-0.151001,0.066386,-0.013928,0.268684,0.320682,-0.011067,0.057464,-0.068353,0.060232,0.178755,-0.203554,-0.183278,
  0.092728,0.267277,0.029154,0.09617,0.03438,0.031129,-0.088522,-0.154638,-0.122341,-0.024367,-0.18975,-0.080911,0.121143,0.025484,0.198213,0.046724,
  0.069033,-0.103163,-0.059692,-0.075387,0.048794,0.062677,-0.041834,-0.097214,-0.369671,-0.108412,-0.220765,-0.256188,0.029229,-0.357522,0.117161,0.210492,
  0.042929,0.017552,-0.302809,0.031708,0.036932,0.164805,0.083724,-0.245723,-0.339474,0.024472,0.125939,0.416281,0.041343,0.234249,-0.064447,0.18528,
  -0.099625,0.368503,0.00954,-0.149809,0.29379,-0.156937,-0.03357,0.369471,0.0036,-0.087215,-0.112337,0.108194,-0.012485,0.20583,-0.114557,-0.010514,
  0.202642,0.019993,0.205495,0.174633,0.01038,0.11552,-0.125581,0.14044,0.177419,-0.472359,0.096849,-0.196789,-0.229227,-0.235901,0.135284,0.162815,
  -0.118027,0.06867,0.18214,-0.00637,-0.114345,-0.226636,0.005466,-0.039743,-0.049391,-0.05501,0.103741,-0.117124,0.27604,0.047568,-0.047291,-0.046663,
  -0.208677,0.187502,-0.017776,0.179995,-0.795536,0.197374,0.213755,-0.093801,0.216948,-0.017772,-0.06756,0.499629,-0.015249,-0.03397,-0.126563,0.097885,
  0.001811,0.412455,0.06792,0.038216,-0.07157,0.264739,-0.13439,0.328751,0.045035,-0.201425,-0.188572,-0.12677,-0.204584,0.284147,0.062861,-0.047405,
  0.198029,0.070807,0.127515,0.327634,0.090598,0.116646,0.090506,-0.074941,-0.002909,-0.152051,-0.057482,0.078793,-0.109243,0.023333,-0.193755,0.089571,
  -0.117659,0.15889,0.066588,0.245789,0.068998,0.207969,0.459693,0.108012,-0.283561,-0.281696,-0.083744,-0.137432,0.136255,0.184129,-0.210616,-0.061803,
  -0.134742,-0.291462,0.136291,-0.105646,-0.061563,-0.037389,0.042818,0.140672,0.099423,-0.079597,-0.1803,-0.089714,-0.14486,0.208205,-0.324271,-0.138905,
  -0.149513,0.154236,0.005131,-0.068341,0.143287,-0.011274,0.230669,0.109559,0.075473,0.145356,0.079895,0.018144,-0.254082,-0.154986,0.297851,0.269916,
  0.074888,0.147117,0.060097,0.16507,0.070349,0.052277,-0.135362,-0.066878,0.03605,0.113878,0.138247,-0.032815,-0.205942,0.043104,0.073518,-0.245788,
  0.300566,0.051121,-0.065904,-0.160039,0.127095,0.017762,-0.046187,-0.147601,0.368348,0.291835,0.050018,0.224281,0.063789,0.061751,0.306495,0.147832,
  -0.035608,-0.450231,0.091021,0.016634,0.017377,0.007535,0.015216,0.021685,-0.038242,-0.118702,0.133683,-0.101182,-0.060815,-0.279207,0.077098,-0.131578,
  -0.063774,0.005525,-0.359706,-0.177908,0.103163,0.109195,0.014359,0.055491,-0.260193,0.132676,0.041345,0.006679,-0.06767,0.083446,0.129521,-0.022891,
  -0.252899,-0.005459,-0.251133,-0.10366,-0.045311,-0.128726,0.057803,0.232916,-0.073247,0.05861,-0.036079,0.00236,-0.051852,0.032749,-0.13472,-0.036096,
  -0.293232,0.030317,0.019155,0.070094,0.091628,0.120249,-0.078399,0.056661,-0.176257,0.002731,0.009736,0.229891,0.005751,-0.059217,-0.033037,0.062155,
  -0.077578,0.215279,-0.108624,0.06588,0.085295,0.171913,-0.130714,-0.01787,0.140335,-0.056024,-0.072895,0.090363,0.154561,-0.102061,-0.128275,0.088996,
  -0.098836,-0.035279,-0.098205,0.039511,0.292521,-0.099498,0.011681,-0.245973,0.11889,0.045635,0.106832,0.026157,0.129279,0.031545,0.211516,0.320973,
  0.114638,0.074734,-0.022691,0.13101,-0.056636,-0.091038,-0.205913,0.036502,0.249694,0.010803,0.144404,0.013548,0.291665,0.033482,0.020061,0.382667,
  0.278159,0.10709,0.160134,0.188052,0.044846,0.206205,0.167618,0.26543,-0.176481,0.128541,0.048759,-0.035405,0.012978,0.196214,0.055816,-0.009183,
  -0.122296,-0.136554,0.098187,0.073431,-0.108627,-0.029001,-0.053739,-0.190389,0.055946,-0.02209,-0.03812,-0.283581,-0.027063,0.168007,0.219836,0.151494,
  -0.206238,0.01557,0.069941,-0.060482,0.175927,0.040487,-0.075719,-0.244648,-0.049667,0.121101,0.012764,-0.060653,-0.059069,0.094431,-0.02095,-0.243353,
  0.099915,0.083931,0.172653,-0.035223,0.015547,0.013759,0.105458,-0.017677,-0.146267,-0.091747,-0.042258,0.023588,-0.113443,-0.022305,-0.068068,-0.034842,
  0.124089,0.103016,-0.026385,0.103981,-0.087407,-0.184251,0.09549,-0.025303,-0.098564,0.13871,0.037977,-0.127752,0.01961,0.107725,-0.085121,-0.199781,
  -0.059963,-0.035747,-0.056097,0.103505,-0.075079,-0.07806,-0.194611,-0.162447,-0.138005,0.016198,0.161673,0.001173,-0.0569,0.027746,-0.227454,-0.125547,
  0.03951,-0.122576,-0.018588,0.232801,-0.414942,-0.203266,0.170084,0.004483,-0.03968,0.062289,-0.196237,0.054531,0.059808,-0.016212,0.169828,-0.112318,
  0.066767,-0.055554,-0.100504,-0.029389,-0.119538,-0.037686,-0.118494,-0.137431,-0.087074,0.184611,-0.121871,0.071991,0.011813,-0.233933,-0.183065,-0.066154,
  0.009474,0.171572,0.027597,-0.044171,-0.194928,0.04891,0.099543,-0.052434,0.195009,-0.178167,0.052384,-0.099744,-0.121512,-0.030072,-0.130303,-0.105616,
  -0.005444,0.028517,-0.051878,-0.016004,-0.084651,-0.013279,-0.180031,-0.13109,0.076926,-0.005975,0.025526,-0.028332,-0.044107,0.020079,-0.035998,0.15064,
  0.05672,-0.045374,0.017524,-0.012966,-0.123735,0.084758,-0.004455,-0.255188,-0.081786,0.076731,-0.075103,0.077965,-0.183802,0.028917,-0.23372,-0.095854,
  -0.188645,-0.120784,-0.019877,0.039936,0.078472,0.050726,-0.13193,-0.104028,0.189017,0.097476,0.029758,-0.143815,-0.087933,0.052462,0.081989,0.107591,
  0.087167,-0.341964,0.239144,0.174196,-0.3209,-0.083675,0.023277,0.059589,-0.066475,-0.125093,-0.057551,-0.259747,0.246342,0.417886,0.028602,-0.026084,
  0.111006,0.229029,-0.066067,0.359963,0.151297,-0.030482,0.084389,-0.072022,-0.014328,-0.251579,-0.033951,-0.128142,-0.433163,-0.183167,-0.305858,-0.237147,
  -0.223377,-0.089275,-0.130285,0.246921,0.033224,0.092538,0.055141,0.114805,-0.482144,0.231133,-0.059321,0.03947,-0.028177,0.18968,-0.247092,0.367002,
  0.002427,0.220159,-0.083985,0.113169,-0.121353,0.389728,0.017396,0.00621,0.175777,0.083417,-0.216836,0.286057,0.177795,0.161042,0.033037,0.170054,
  -0.135758,-0.041059,0.006145,-0.082482,-0.104862,0.163285,0.140805,0.13244,-0.132287,-0.110372,0.09752,0.036729,0.071702,0.463405,-0.163387,-0.110108,
  0.338758,0.090087,-0.007403,0.016045,-0.02503,0.154497,0.090892,0.078223,0.099441,-0.103325,0.009966,-0.116179,0.124724,0.002804,-0.006737,-0.011918,
  -0.08433,-0.031069,0.093902,-0.073695,0.254218,0.029275,0.085313,-0.045893,-0.310046,0.100404,-0.103832,0.078251,-0.055285,-0.077886,0.06428,-0.078744,
  0.007237,-0.025221,-0.025405,0.004234,0.07769,-0.058424,-0.028284,0.057573,0.123351,0.095447,-0.052164,0.12972,0.15294,-0.019939,0.062453,-0.028,
  0.185075,-0.010751,0.028952,0.010386,-0.11617,-0.062377,0.106235,0.288426,0.058194,0.133961,-0.07767,0.142693,-0.021663,0.065387,0.028527,0.148809,
  -0.070497,0.068073,-0.033395,0.067811,0.031753,-0.057413,-0.113206,-0.000462,-0.069791,0.113041,0.342021,0.279622,-0.136135,-0.188659,-0.190483,-0.136818,
  0.108732,-0.062572,0.101706,0.016429,-0.025939,-0.269668,0.157792,0.072783,0.103896,0.002853,-0.265761,0.435082,0.167188,0.028651,0.2435,-0.220521,
  -0.033779,0.020167,-0.272172,0.359063,0.021511,0.01408,-0.012087,0.043662,0.162527,-0.217971,-0.069759,0.41794,0.221304,-0.048632,0.115692,0.115372,
  -0.1093,0.121678,0.345143,0.075094,0.236654,-0.157403,0.034503,0.3759,0.188933,0.164085,0.162642,-0.097126,0.041591,0.16691,0.114326,0.052351,
  0.217528,-0.017766,-0.139642,-0.130948,0.213907,0.056855,0.176212,-0.166916,0.039403,0.123305,0.002387,-0.18607,-0.021474,0.0038,0.2103,-0.02906,
  0.155387,-0.185832,-0.126466,0.093414,-0.175643,0.074865,-0.152313,0.065936,-0.063015,-0.129288,0.115857,-0.199718,-0.053951,0.017465,0.072656,0.105647,
  -0.066617,-0.085513,-0.080769,-0.055548,-0.128747,-0.077664,-0.073868,-0.07215,-0.042007,-0.10309,0.040622,-0.010955,-0.02096,0.120734,-0.1768,-0.059579,
  0.018119,-0.112939,0.25215,-0.143491,0.057468,-0.057879,-0.129945,-0.016714,-0.047107,0.029999,-0.030583,-0.013462,0.001587,0.064841,-0.141582,0.083357,
  -0.067419,0.176534,-0.083371,0.019587,-0.139999,-0.052522,-0.03767,-0.067997,0.11866,0.106663,-0.22396,-0.021064,-0.08439,-0.14621,-0.014542,0.067785,
  -0.033791,0.111819,-0.004731,0.032806,-0.160186,0.00092,-0.059901,0.021767,0.217786,0.089742,-0.351876,-0.238268,0.014128,0.091592,-0.174774,0.074924,
  0.112929,-0.234571,-0.391433,-0.201337,-0.065104,-0.024498,-0.08317,-0.026477,0.067171,0.116422,-0.036431,-0.138932,-0.098156,-0.177603,-0.07024,0.330166,
  -0.214848,-0.1596,-0.062481,-0.173879,0.10304,0.085288,0.023404,0.136002,0.104226,-0.071228,-0.138676,0.242607,0.404615,0.241891,0.100054,0.0356,
  0.258009,0.08388,-0.138709,0.815426,0.134791,-0.000784,-0.261682,0.155557,0.151283,0.461457,0.137215,0.019354,0.002717,0.145448,0.16618,0.36916,
  0.269387,0.047958,-0.261726,0.085328,0.138813,0.247776,0.135053,-0.046324,-0.066113,0.172392,0.05224,0.032272,0.075163,-0.032912,-0.010989,-0.010114,
  0.204752,0.186989,-0.044173,-0.022595,-0.305578,0.120008,0.087871,0.035703,0.380369,0.364476,-0.29209,0.006583,0.145938,0.211177,-0.166249,-0.399272,
  0.049003,-0.046967,0.173716,-0.348583,0.122156,0.124879,-0.036508,0.236849,-0.044744,0.158616,-0.087099,-0.055918,-0.052287,-0.196985,0.4197,-0.166885,
  0.318975,-0.023263,0.182229,-0.094116,-0.531847,0.190714,-0.045999,0.0246,-0.073474,-0.254116,0.010136,-0.267891,-0.03753,0.016724,0.114997,-0.653023,
  -0.032032,-0.114736,0.124275,-0.085857,0.096935,-0.585782,0.034724,0.107218,0.000049,-0.086267,0.3927,-0.379331,-0.181509,-0.031782,0.030197,-0.146112,
  0.049711,-0.151504,0.031813,0.110617,0.075343,0.340499,0.243868,-0.120276,0.061545,0.274671,0.227895,-0.143324,-0.11016,-0.002618,-0.081453,0.151874,
];
const B1 = [
  0.041228,0.16196,0.01143,0.002572,0.047116,0.02696,0.054485,0.069245,0.049041,0.051371,0.048428,0.142745,-0.024621,0,0.052184,0.049079,
  -0.025808,-0.005198,0.029472,0.03478,0.050998,0.037092,0.141056,0.016616,-0.028002,-0.028195,0.04635,0.090808,-0.016762,-0.041123,-0.004359,0.059757,
];
const W2 = [
  0.137515,0.156665,0.09304,0.132659,0.129343,0.042248,0.024748,0.1051,-0.091069,0.246137,0.362586,0.260252,0.136903,0.042272,0.105691,0.269656,
  -0.023661,-0.387288,0.036795,0.271689,0.188901,0.032848,0.244362,0.081021,0.018795,0.038664,-0.120394,0.156844,0.01655,0.058337,0.174036,0.280516,
  0.107849,-0.077,0.271097,0.173307,0.160242,-0.03981,-0.057241,-0.02478,-0.186818,0.010465,0.428188,0.019343,0.09374,0.187501,-0.093473,0.137802,
  0.077954,0.38846,-0.017058,0.175089,-0.024427,0.069301,0.141364,0.02539,-0.080072,-0.11295,0.22547,-0.118097,-0.15864,0.109636,-0.146126,0.469096,
  0.108774,-0.039821,0.037281,0.03825,0.029291,-0.070963,-0.034512,0.011212,0.140449,-0.060763,-0.209787,-0.142279,-0.056991,-0.123955,-0.13427,0.03826,
  -0.148541,-0.100298,0.034182,0.294613,-0.128773,-0.035009,-0.055893,-0.016095,0.124531,0.040128,-0.054246,-0.133939,-0.084278,-0.088676,0.03276,-0.085704,
  0.016381,0.095346,-0.003544,-0.008797,0.083138,0.021518,0.097751,-0.207628,0.03774,-0.107747,-0.045224,-0.056892,-0.080358,-0.147465,-0.173669,0.101906,
  -0.102396,-0.023153,-0.139243,-0.133228,-0.071938,-0.140531,-0.050731,-0.069861,0.088472,-0.050578,0.000061,-0.095724,-0.130813,0.134205,0.095301,-0.042471,
  -0.108984,0.013971,0.152319,-0.157539,0.036949,0.057657,0.012903,0.055087,-0.10384,-0.160835,-0.064764,0.318662,0.033305,0.072835,0.039674,0.123895,
  0.07991,0.458271,-0.005017,0.071314,-0.275382,0.028863,0.123883,0.044987,0.002739,-0.023143,-0.10669,-0.02964,-0.36606,-0.032158,0.160829,0.267741,
  -0.021744,0.008793,-0.007387,-0.054477,0.057153,-0.031424,-0.079156,-0.045143,-0.087621,-0.126161,-0.097381,-0.096777,0.006889,-0.084122,-0.010848,-0.004774,
  0.087839,-0.317058,0.035202,-0.035415,0.053547,0.06575,-0.085191,-0.167052,-0.046392,0.044076,0.068366,-0.053187,-0.196612,-0.074486,0.025043,0.103735,
  -0.19876,0.268438,0.031616,-0.206671,-0.075289,-0.029757,0.099977,0.247013,0.149461,0.074629,0.205534,0.18782,0.072561,-0.038624,0.079947,-0.185916,
  -0.12879,-0.200541,-0.007018,-0.078565,-0.333647,0.110806,-0.139748,-0.055557,-0.018296,0.033934,0.100668,0.147133,0.052835,-0.134705,-0.382049,0.010037,
  0.08571,-0.029146,0.052626,0.054993,-0.027942,-0.208853,-0.024,0.098681,-0.028179,-0.108878,-0.132802,-0.003581,-0.019102,-0.02832,-0.196423,0.005133,
  -0.015659,-0.060387,0.146984,-0.090033,-0.234005,0.205185,0.056055,0.012229,-0.104105,0.088605,0.06452,-0.060349,-0.157602,0.09429,-0.098773,-0.048633,
  -0.09792,0.113835,-0.053902,0.003193,0.093852,0.05905,-0.052647,0.021846,0.069274,0.076936,-0.045668,0.478748,-0.18764,0.161332,0.034363,0.106643,
  0.00388,-0.442525,0.180888,0.101012,0.202889,-0.058414,0.127996,0.012627,0.189347,-0.059857,0.203153,-0.176952,0.015813,0.080138,-0.014904,-0.096599,
  0.030213,-0.082658,0.296301,0.108034,0.09128,0.039069,-0.017743,-0.055998,-0.037524,-0.019622,0.035072,-0.172005,0.20132,-0.033491,0.106428,0.270608,
  0.074245,0.201758,0.03961,-0.13009,-0.205927,0.04569,-0.017974,0.37187,-0.119268,-0.126932,0.172028,-0.09048,0.155035,-0.300541,0.106072,-0.200699,
  -0.280513,0.328319,-0.101005,-0.278111,0.216585,0.168305,-0.046616,0.072962,0.064375,0.037859,-0.072129,-0.020197,-0.00096,-0.026997,-0.049019,-0.112638,
  0.034293,-0.260261,0.289548,0.123019,-0.040774,0.133838,-0.114903,0.057927,0.10418,0.132192,-0.100408,0.1404,0.091176,0.112907,0.032596,-0.201894,
  -0.023786,0.028712,0.098188,-0.021612,-0.022794,0.032743,-0.045418,0.020324,0.064484,0.047437,-0.022405,0.217126,0.050435,0.119441,0.067199,0.274265,
  -0.084535,0.012134,0.060594,-0.018556,0.227643,0.161258,0.200211,0.120118,-0.153854,-0.113827,0.054804,-0.134738,-0.036356,0.042886,0.113732,-0.125424,
  0.193321,-0.047767,0.109576,-0.04157,-0.00424,0.10075,0.179308,-0.051988,-0.013788,-0.058903,0.146413,0.071939,-0.105111,0.041046,0.059215,0.048711,
  -0.088246,0.158015,0.197274,-0.074233,0.155444,0.145075,0.146774,0.085766,-0.237256,-0.038811,0.333537,-0.063766,0.35962,0.003303,0.112286,-0.520227,
  -0.013269,-0.086889,-0.028755,-0.026975,0.024965,0.129668,-0.014489,-0.092363,-0.036242,0.072325,-0.070783,0.034615,-0.122932,-0.065033,-0.04445,-0.080389,
  -0.00903,0.021809,-0.213876,-0.145218,0.085952,0.144899,-0.20976,-0.379886,-0.212134,0.168925,-0.174153,-0.191739,0.069966,-0.101638,0.039047,-0.062118,
  -0.109982,-0.065405,-0.143585,-0.01243,0.075191,0.210669,0.305053,0.253735,0.45267,0.12378,0.078726,-0.253584,-0.134611,0.040747,0.012525,-0.177755,
  0.190579,0.27154,0.172321,0.076132,-0.004569,0.220363,0.010475,0.026712,0.049119,0.021685,0.001603,0.047035,0.211358,0.080238,0.123294,-0.12181,
  0.083932,0.028164,-0.1142,0.047127,0.156565,0.135949,0.002031,0.176875,0.160451,0.087107,-0.121011,-0.102616,0.045977,0.201759,-0.009659,-0.158012,
  -0.00971,0.066702,0.086854,0.310938,-0.105688,0.034111,0.061302,0.075782,0.009221,-0.056752,-0.195576,0.168278,0.372727,-0.083299,-0.086528,0.07167,
  0.118883,0.011148,0.151256,0.139013,0.302986,-0.021476,0.019206,0.203959,0.043182,-0.005912,-0.017626,-0.112005,0.162692,-0.018011,0.210003,-0.076545,
  0.100711,0.382461,0.180782,0.059155,0.093892,0.077283,0.07488,0.2019,0.071231,-0.021374,-0.190381,0.344703,-0.028021,-0.192671,0.229152,0.034719,
  0.07131,0.082631,0.080884,0.158304,-0.056486,-0.019186,0.246119,-0.043544,-0.143685,0.189331,0.119252,0.065913,0.084132,-0.076644,0.239088,0.210857,
  0.206279,-0.363024,-0.069804,0.035397,0.075388,-0.145232,0.156148,0.056961,0.029407,-0.015477,-0.223713,0.11151,-0.028134,-0.001418,0.127594,0.188021,
  0.168064,-0.091377,0.281318,0.012545,0.02773,-0.014945,-0.071255,0.095375,-0.0302,0.019,0.26998,0.009072,-0.045003,-0.139967,0.102727,0.063774,
  0.274591,0.482421,0.012879,-0.126766,-0.071294,0.093404,-0.083019,0.028606,-0.048548,0.024886,0.362624,0.003184,0.210367,0.117278,-0.027959,0.022524,
  -0.378866,0.25117,0.054584,-0.110958,0.040124,0.020865,0.254592,0.122697,0.065156,0.030348,-0.179447,-0.220989,-0.112509,-0.040885,-0.079683,-0.178322,
  0.038072,-0.36856,-0.128747,0.226546,-0.119327,0.045551,-0.132589,-0.013818,-0.00613,0.036021,-0.481655,0.260577,-0.152108,0.092761,-0.061527,0.169632,
  -0.100187,-0.057015,-0.206929,0.023253,-0.048882,0.010265,0.049483,-0.060672,-0.159851,-0.06942,-0.060749,-0.136825,0.110384,0.085681,-0.124503,0.108333,
  -0.150461,-0.050879,-0.012021,-0.138583,-0.091792,-0.076649,-0.112526,-0.083687,-0.014858,-0.028336,-0.123177,0.145531,-0.158203,0.059128,0.274061,0.004389,
  0.247986,0.04722,-0.101349,0.067979,-0.084674,0.099261,-0.034268,-0.115644,-0.078591,0.027502,0.119319,0.056898,-0.106591,0.111857,0.0937,0.098589,
  -0.153197,-0.044311,0.029636,0.029146,-0.001107,0.060172,0.26763,0.060109,0.140871,-0.043373,0.184363,0.111412,-0.168709,-0.035699,0.0345,0.403506,
  -0.080808,-0.112108,0.155598,0.016873,0.089853,-0.099936,-0.007089,-0.201913,-0.155456,-0.025679,-0.049292,-0.179807,0.058556,0.018496,-0.182257,0.032076,
  -0.206997,-0.222408,-0.028577,-0.200707,-0.111102,0.099952,-0.059926,-0.058513,-0.046798,0.040653,-0.200619,0.040154,0.049215,0.006305,-0.040759,0.031431,
  0.014196,-0.192518,-0.033304,-0.074418,0.183002,0.33359,-0.127663,0.090936,0.046574,-0.017906,0.038963,0.106257,0.11026,0.130695,-0.124576,0.156781,
  -0.183122,0.299324,0.086796,-0.158929,0.25688,0.221532,0.107649,0.098532,0.152477,-0.032519,0.378404,0.064482,0.264958,-0.081382,0.010676,-0.36853,
  0.188649,-0.260183,0.040341,-0.034231,-0.231942,0.045459,0.073402,-0.008628,0.054621,0.224824,0.143366,0.300878,0.034743,-0.041888,0.137248,-0.017864,
  -0.028253,0.076431,-0.011793,0.078978,0.038893,-0.113763,0.186642,0.10687,-0.001718,-0.038085,0.098892,0.016655,-0.005227,-0.090375,-0.205324,0.043071,
  0.293605,-0.062369,0.066015,0.055158,-0.146487,-0.070334,0.028199,-0.070267,-0.042899,0.019383,-0.032568,0.023612,-0.157988,0.155042,0.123905,-0.195908,
  -0.117099,0.336432,-0.006259,-0.072644,-0.047075,-0.02051,-0.035427,0.184616,0.125576,-0.174502,0.130052,0.078181,0.11705,0.154564,-0.119386,0.145112,
  0.107882,0.21008,0.178197,0.020058,0.111013,0.11415,-0.042111,0.09747,0.0833,0.138088,-0.071995,-0.14158,0.010101,-0.181825,0.019534,0.09975,
  0.160018,0.229898,0.140623,0.049715,0.231328,0.09812,-0.032907,0.203978,-0.092845,-0.04172,0.132551,0.255332,0.133166,0.000257,0.243179,-0.185746,
  -0.151359,-0.079365,0.067921,0.00127,-0.022996,-0.034371,0.236083,-0.070129,0.219431,0.100738,-0.24401,-0.502188,-0.067865,0.04942,0.17814,-0.238231,
  0.207342,0.688176,0.0871,-0.079765,-0.253919,-0.010159,0.069753,0.00318,0.045378,0.177506,0.034003,0.080172,0.158857,0.061974,-0.038373,-0.073746,
  -0.050741,0.112976,-0.114272,-0.163858,0.080471,0.019273,0.313143,0.111666,0.099068,-0.018116,0.171797,0.16403,0.001395,-0.035538,0.176044,-0.057906,
  -0.304881,0.125326,-0.175775,0.012521,-0.27917,0.016974,0.0369,0.002585,-0.158998,-0.00714,-0.099851,-0.052831,0.007654,0.088973,-0.317228,0.558094,
  0.073088,0.125264,-0.202804,-0.001043,0.121144,0.27938,0.192759,0.145207,0.088651,0.095195,0.111775,-0.011997,-0.016293,-0.112829,0.154448,-0.114517,
  -0.023321,-0.343404,0.13821,0.087591,0.198296,0.259375,0.126498,0.212086,0.00197,0.079538,-0.074543,0.197744,-0.086047,-0.05151,0.100981,-0.093788,
  0.067911,-0.098442,-0.143823,0.061727,0.061152,0.057599,-0.177365,0.030807,0.172986,0.051273,0.149037,0.223522,-0.047345,0.029403,0.07283,-0.016021,
  -0.068827,-0.448687,-0.123793,0.036338,0.115081,-0.033851,0.17459,-0.083172,-0.024941,0.130177,-0.189847,-0.039495,-0.014641,-0.081738,0.028824,0.238439,
  0.156592,0.327155,0.167312,0.059608,-0.109142,0.001643,0.010335,-0.369512,-0.258904,-0.260869,-0.100125,0.095018,0.122758,-0.15937,-0.11827,-0.094101,
  0.071758,0.220298,-0.121904,0.053957,0.30859,0.281901,0.183648,-0.021308,-0.113758,-0.016319,0.059233,0.213954,-0.101109,0.224023,0.074972,0.253017,
];
const B2 = [
  0.15068,0.006653,-0.050164,0,0.097282,-0.02665,0.125855,-0.038921,0.114361,-0.015069,0.09419,0.10771,0.033138,-0.043387,0.042105,0.142689,
  0.067408,0.081254,0.014065,0.081295,-0.042523,0.092416,-0.024581,-0.047407,0.039758,-0.017768,0.030649,-0.049549,0.081309,0.132831,0.056192,0.12082,
];
const W3 = [
  -0.00628,-0.242713,-0.023137,0.086747,-0.031212,0.208652,-0.298132,0.014903,0.149646,0.05241,0.303078,0.116206,0.143218,-0.032696,0.050374,0.016667,
  -0.095636,-0.0609,-0.171671,-0.126789,0.135752,-0.106161,0.032326,0.121938,-0.087422,-0.244922,0.091717,-0.133864,-0.263455,0.073893,0.052164,-0.34012,
  -0.194802,0.104213,-0.082109,0.143943,0.218933,0.113988,-0.158284,-0.106074,-0.062144,0.121103,-0.078129,0.038824,0.191298,-0.153942,0.081247,-0.034607,
  0.031089,-0.061038,0.276842,-0.22636,0.008512,-0.075759,-0.206176,0.209361,0.011992,0.100574,0.085841,0.219115,-0.242961,-0.088542,-0.24076,-0.004986,
  -0.166403,-0.147141,0.055112,0.008035,-0.185919,-0.052932,0.255617,-0.066725,-0.207522,-0.121917,0.197978,-0.315822,-0.176085,-0.107526,0.225279,0.191492,
  0.17727,-0.145458,-0.043542,0.155452,0.186537,-0.11484,0.076052,-0.05947,-0.108345,-0.074958,0.02457,0.301228,-0.175398,0.098927,-0.142059,-0.061479,
  -0.025591,-0.210127,0.084022,0.054836,0.078421,-0.019239,0.406239,-0.055403,0.32287,-0.126344,0.02995,0.230293,0.180383,-0.025628,0.017232,-0.008984,
  -0.191972,-0.366835,-0.033984,-0.190582,-0.140359,-0.00581,0.014044,0.29266,0.086692,0.077918,-0.084235,-0.17862,0.217269,0.059144,0.109515,-0.123727,
  0.387586,0.100662,-0.176698,-0.025821,0.263554,0.019903,0.228103,0.047349,0.208235,0.157852,0.184879,0.465255,0.406637,-0.104235,0.312414,0.608084,
  0.391836,0.274017,0.335818,0.100991,-0.097556,0.588099,-0.004221,0.135141,0.422577,0.055527,0.274635,0.140401,0.136017,0.372989,0.056386,0.046385,
];
const B3 = [
  0.00119,-0.117362,-0.022761,-0.033886,0.112898,
];

function relu(x){return x>0?x:0;}
function tanh(x){const e1=Math.exp(x), e2=Math.exp(-x); return (e1-e2)/(e1+e2);}
function sigmoid(x){return 1/(1+Math.exp(-x));}

function mlpForward(x){
  // x: length INPUT_SIZE
  const h1 = new Array(H1).fill(0);
  for(let i=0;i<H1;i++){
    let s = B1[i];
    for(let j=0;j<INPUT_SIZE;j++) s += W1[i*INPUT_SIZE + j]*x[j];
    h1[i] = relu(s);
  }
  const h2 = new Array(H2).fill(0);
  for(let i=0;i<H2;i++){
    let s = B2[i];
    for(let j=0;j<H1;j++) s += W2[i*H1 + j]*h1[j];
    h2[i] = relu(s);
  }
  const out = new Array(OUTPUT_SIZE).fill(0);
  for(let i=0;i<OUTPUT_SIZE;i++){
    let s = B3[i];
    for(let j=0;j<H2;j++) s += W3[i*H2 + j]*h2[j];
    out[i] = s;
  }
  // post-process
  const mvx = tanh(out[0]);
  const mvy = tanh(out[1]);
  const fx  = tanh(out[2]);
  const fy  = tanh(out[3]);
  const fireP = sigmoid(out[4]);
  // 각도 변환
  const mvAngle = Math.atan2(mvy, mvx) * 180/Math.PI;
  const fireAngle = Math.atan2(fy, fx) * 180/Math.PI;
  return { mvAngle, fireAngle, fireP };
}

function norm(x, a, b){ return (x - a) / (b - a); }
function clamp01(v){ return v<0?0:(v>1?1:v); }

function buildFeatures(tank, enemies, allies, bulletInfo){
  // 입력 피처 구성 (전부 사용)
  // - 탱크 자체 상태: x,y,health,energy,typeOneHot(3),size
  // - 적/아군 최근접 K명: 상대 위치(상대 좌표-자기 좌표), 거리, 각, 체력
  // - 총알 최근접 K발: 상대 위치/속도(상대 좌표-자기 좌표), 거리
  const W=900, H=600;
  const self = [
    norm(tank.x, 0, W),
    norm(tank.y, 0, H),
    clamp01(tank.health/200),
    clamp01(tank.energy/200),
    tank.type===0?1:0,
    tank.type===1?1:0,
    tank.type===2?1:0,
    clamp01(tank.size/60),
  ];

  // 정렬 및 K개 추출
  function topK(arr, k){
    const sorted = arr.slice().sort((a,b)=> (a.distance||1e9)-(b.distance||1e9));
    return sorted.slice(0,k);
  }
  const KE=4, KA=3, KB=5;
  const es = topK(enemies, KE);
  const as = topK(allies, KA);
  const bs = topK(bulletInfo, KB);

  const ef = [];
  for(let i=0;i<KE;i++){
    const e = es[i];
    if(e){
      const dx = e.x - tank.x; const dy = e.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI; // -1..1
      ef.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(e.health/200));
    }else{
      ef.push(0,0,0,0,0);
    }
  }
  const af = [];
  for(let i=0;i<KA;i++){
    const a = as[i];
    if(a){
      const dx = a.x - tank.x; const dy = a.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      af.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(a.health/200));
    }else{
      af.push(0,0,0,0,0);
    }
  }
  const bf = [];
  for(let i=0;i<KB;i++){
    const b = bs[i];
    if(b){
      const dx = b.x - tank.x; const dy = b.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      bf.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang,
              clamp01((b.vx+8)/16), clamp01((b.vy+8)/16));
    }else{
      bf.push(0,0,0,0,0,0);
    }
  }

  // 전역 통계(개수/합계)
  const stats = [
    clamp01(enemies.length/6),
    clamp01(allies.length/5),
    clamp01(bulletInfo.length/10),
  ];

  const x = self.concat(ef, af, bf, stats);
  // 길이 보정(정확히 INPUT_SIZE)
  if (x.length < INPUT_SIZE) {
    while (x.length < INPUT_SIZE) x.push(0);
  } else if (x.length > INPUT_SIZE) {
    x.length = INPUT_SIZE;
  }
  return x;
}

function policyStep(tank, enemies, allies, bulletInfo){
  const feat = buildFeatures(tank, enemies, allies, bulletInfo);
  const out = mlpForward(feat);
  // 액션 적용
  // 발사 결정은 DNN의 fireP로만 제어
  if (out.fireP > 0.5) tank.fire(out.fireAngle);
  tank.move(out.mvAngle);
}


function name(){ return "DNN-D2"; }
function type(){ return Type.DEALER; }
function update(tank, enemies, allies, bulletInfo){
  policyStep(tank, enemies, allies, bulletInfo);
}


// ===== 다음 로봇 =====


const INPUT_SIZE = 76;
const H1 = 32;
const H2 = 32;
const OUTPUT_SIZE = 5; // [mvx, mvy, fx, fy, fire_logit]

const W1 = [
  0.231249,0.252307,0.277549,-0.080441,-0.056814,-0.017329,-0.03729,0.086753,0.122447,-0.381046,-0.012094,0.002491,-0.183581,0.097481,0.067492,0.057175,
  0.059112,0.214549,0.42343,0.303794,0.116437,-0.137641,0.138886,0.375197,0.177459,-0.137844,-0.354217,0.393907,-0.011193,0.021641,-0.025584,0.085705,
  -0.07592,-0.095949,-0.013901,-0.16592,0.090642,0.003898,-0.053293,0.001682,0.001988,0.043385,-0.01573,0.343829,-0.092087,-0.008471,0.222984,0.334922,
  -0.129952,0.158514,-0.017785,0.014144,0.159652,0.274476,0.004687,0.116878,-0.295685,-0.107057,0.265392,0.123549,0.182867,0.13654,-0.107376,0.062359,
  0.034339,0.027035,0.086895,0.002537,0.006179,0.021991,-0.112255,-0.035348,0.14066,0.07763,-0.073481,0.009612,-0.16441,0.07252,0.09489,0.282891,
  0.168923,0.002073,-0.04729,0.182894,-0.054457,0.054282,0.00975,0.021356,0.194464,-0.058447,0.209679,0.07782,0.094445,0.00661,-0.111975,0.042909,
  0.102029,0.095552,-0.035737,-0.074742,-0.210353,0.109379,0.01774,-0.485099,-0.127244,0.176676,0.027057,-0.140293,0.13579,-0.02035,-0.071361,0.030229,
  -0.099923,-0.036192,0.029663,-0.023531,-0.112156,0.144072,0.235565,-0.475378,-0.03504,-0.145612,0.0342,-0.063241,0.069014,-0.264007,0.047478,-0.115281,
  0.027475,-0.132847,0.341269,-0.126718,0.23187,0.268695,-0.080436,-0.063963,0.038427,-0.245087,0.130909,0.078642,0.017888,-0.23696,0.247609,-0.02891,
  0.115154,0.139652,0.100362,0.005329,0.11403,0.06441,0.029392,0.32734,0.083084,0.107289,0.060838,-0.055452,0.074276,0.056687,-0.065191,0.052332,
  -0.152936,-0.187324,0.017415,0.021242,-0.003169,0.026812,-0.063456,-0.178316,0.075306,0.390732,-0.019557,-0.068721,-0.049308,-0.079795,0.198757,0.128274,
  -0.119618,-0.036931,0.195009,-0.147944,0.192563,-0.087338,-0.114024,-0.315607,0.192127,-0.023869,-0.174601,-0.259945,-0.022001,0.021529,-0.069289,0.199371,
  -0.15614,-0.02703,-0.140107,0.123729,0.248163,0.023272,0.043381,0.18092,0.009153,-0.207206,0.109657,-0.01964,-0.01565,0.264206,0.19638,-0.170432,
  -0.152638,-0.110755,-0.114911,0.185059,0.218309,-0.248634,-0.012094,-0.067803,0.01673,0.260555,-0.167029,-0.056029,-0.15504,-0.108546,0.039792,0.11992,
  -0.08085,0.054533,0.155033,0.083988,0.107993,0.225401,-0.125344,0.170629,0.0079,0.059999,-0.17205,-0.010754,-0.016086,-0.230478,-0.177144,0.046707,
  0.043333,0.030807,-0.210242,-0.005623,-0.081899,0.108946,0.196994,-0.062466,0.066424,0.075504,-0.105066,0.022428,-0.036635,0.0508,-0.091117,0.193803,
  0.234642,-0.091593,-0.058831,-0.052719,-0.190395,-0.011782,-0.05412,-0.037195,0.047667,-0.106122,-0.094499,-0.012481,0.12228,0.120793,-0.124058,0.256646,
  -0.206133,-0.142556,0.034169,0.215976,0.166105,0.150425,-0.118902,0.013237,0.227881,0.404726,0.14554,0.123853,-0.211866,0.021287,0.069836,0.088628,
  0.266148,0.011142,-0.033858,-0.060848,0.069514,-0.001845,-0.164382,0.232031,-0.013076,0.088518,-0.024882,0.121853,-0.09547,0.129247,0.023822,0.0701,
  0.044805,-0.011508,-0.288175,0.007469,0.167103,0.127085,0.025522,0.197875,0.005763,0.194158,0.045954,0.055957,0.033337,-0.117676,-0.067896,0.009017,
  0.035343,-0.242824,-0.020475,-0.034971,-0.042475,0.07191,-0.047921,0.086175,-0.278755,-0.045365,0.123885,-0.184203,0.196427,-0.004445,0.062692,0.049139,
  0.042708,0.137667,-0.25662,0.083362,0.104321,0.124092,0.068975,-0.106787,0.235856,0.047117,0.038217,0.100415,0.223961,-0.033163,-0.014981,-0.002237,
  0.074313,-0.18447,0.203712,-0.063977,-0.106069,-0.139609,0.218535,-0.165839,0.237946,0.017028,-0.048425,-0.067711,-0.149326,0.061298,0.273153,0.072547,
  0.137193,0.015049,0.033872,-0.057425,0.211321,-0.108231,0.229444,0.031371,0.057188,0.037516,0.029653,0.132936,-0.059273,-0.037365,-0.026374,0.204505,
  0.123123,0.112858,0.084817,-0.160403,-0.002883,0.047882,0.266663,-0.027175,-0.118324,0.12456,-0.055469,0.069956,-0.077283,-0.138015,-0.073203,-0.010261,
  0.123227,-0.035158,0.081683,-0.066688,-0.167863,0.127134,0.127322,-0.194224,0.028522,0.134337,0.054119,-0.05296,0.006513,0.13624,-0.207391,0.21178,
  0.111596,-0.003922,0.029001,-0.197344,0.122451,-0.043228,-0.07487,0.17784,0.114142,0.115804,-0.15813,-0.052404,-0.087087,0.18943,0.171276,0.105773,
  0.040023,-0.083138,-0.072463,0.135607,0.46744,0.099743,-0.112477,-0.052892,-0.140221,-0.024942,0.011883,0.063352,0.049967,-0.007052,-0.050341,0.002863,
  0.035555,0.0147,0.100548,-0.04223,0.042134,-0.067829,-0.041812,-0.078869,-0.394323,0.179906,0.129637,0.047157,-0.194705,0.037108,0.064449,0.191894,
  0.159489,0.344247,-0.163247,0.293521,0.091716,0.136242,-0.010424,0.029076,0.132582,0.001106,-0.00891,-0.065589,-0.0567,0.042175,0.051132,-0.151723,
  -0.185627,0.021391,0.05772,-0.107138,-0.297818,0.040708,0.025775,-0.044988,0.356386,-0.174938,0.137028,-0.190978,-0.079992,-0.07614,-0.151951,0.398727,
  -0.222571,-0.081983,-0.153999,-0.495894,0.170703,0.103813,-0.017748,-0.060069,0.120527,-0.170282,0.006203,0.193054,-0.103065,0.006783,0.364155,-0.248314,
  0.012365,0.131644,-0.01555,-0.118559,0.011093,-0.234566,-0.103794,0.058922,0.066304,0.021402,0.124638,0.199293,-0.009892,0.018558,-0.055227,-0.095637,
  0.1006,-0.056904,0.102509,-0.097548,-0.16312,-0.24644,0.053525,-0.087985,0.257169,-0.14664,0.159833,0.249545,0.117496,0.424051,0.15791,0.078168,
  0.23759,0.043348,0.13577,-0.097177,0.205834,-0.017892,-0.037489,-0.045111,0.110127,0.122843,-0.194956,-0.051857,-0.084906,0.028587,0.110075,0.057819,
  -0.227617,0.186038,-0.070601,0.102921,0.178572,0.020583,0.084807,0.24937,0.336935,-0.156773,-0.209748,0.164419,0.041437,0.054865,0.083418,-0.268134,
  0.01835,0.3109,0.080148,-0.292869,-0.013107,-0.249624,0.052774,0.214961,-0.045026,-0.147196,-0.016502,0.020301,0.126772,0.01566,0.136218,-0.014523,
  -0.113181,0.031313,0.179802,0.304519,0.021748,-0.221606,0.136473,-0.202596,0.128974,0.324431,0.01175,-0.094097,-0.06924,0.156021,0.066631,0.057369,
  -0.242566,-0.263158,0.082489,0.274178,0.111404,-0.04734,-0.053722,0.183313,0.11506,0.458901,0.165932,0.103643,0.165155,-0.129389,0.108173,0.030912,
  -0.041097,-0.049275,-0.044234,0.206114,0.216834,0.026496,-0.044073,-0.117768,0.101188,-0.086122,0.050626,0.015543,-0.083579,0.047146,0.265658,0.110068,
  -0.147321,0.124068,0.048411,0.156616,-0.047327,-0.103875,0.048432,0.167079,-0.02982,0.020041,-0.061373,-0.035818,0.047782,0.090457,0.038209,-0.164425,
  -0.1612,-0.013872,0.273196,0.038358,-0.007351,-0.103647,0.093237,0.075898,0.333202,0.172131,0.032848,-0.222281,-0.00693,-0.013317,0.282612,0.126687,
  0.000137,-0.020772,-0.16813,-0.105393,0.139904,-0.095715,-0.020528,-0.243683,0.020324,-0.027296,0.090097,0.041266,-0.129351,-0.102434,0.107737,-0.114979,
  0.110835,-0.060537,0.108392,0.169065,0.076129,-0.013412,0.159818,0.016859,0.255534,0.116514,0.089879,0.223239,0.114398,-0.167365,0.27271,0.138146,
  -0.049266,0.185881,-0.312935,0.034765,0.076815,-0.058174,0.097009,-0.068336,-0.010557,0.067275,0.025777,0.096314,0.048628,0.123301,0.232706,0.263149,
  -0.031127,-0.121748,-0.063413,-0.011151,0.082827,0.099182,0.00125,-0.192035,-0.085239,0.118928,-0.142797,-0.025796,0.245366,0.073151,-0.08788,-0.119151,
  -0.007744,0.217453,0.038278,0.137262,-0.05669,-0.010127,0.07073,0.012979,0.03037,0.109622,0.063809,0.146466,0.137379,0.089216,0.033613,0.081829,
  0.080948,-0.035933,0.25701,-0.012283,0.137053,0.026079,-0.237186,0.038919,0.007233,0.129018,0.049523,0.1635,-0.141972,-0.000099,0.068541,-0.086505,
  0.284747,-0.196997,0.22773,0.323352,-0.013431,-0.208766,-0.132829,-0.074146,-0.005072,0.184256,-0.036847,-0.011007,-0.223028,0.069623,0.11758,0.004287,
  0.068281,-0.014497,0.140602,0.008066,-0.033605,0.086583,0.141954,0.059634,0.232638,0.004817,0.227604,0.08831,0.141897,-0.211777,-0.025257,0.216811,
  -0.131638,0.27112,-0.111228,-0.172998,-0.063589,0.182118,0.090233,0.098929,-0.040283,-0.006336,-0.270862,0.091016,0.1001,0.191659,-0.108384,-0.122747,
  -0.124232,-0.038024,-0.00844,0.063135,0.079876,0.048025,-0.073429,-0.083597,0.321103,0.156478,-0.159449,0.055817,-0.050203,-0.013741,0.31841,0.196692,
  0.073984,-0.11818,0.01651,0.088508,0.1312,-0.049206,0.025182,0.270474,0.04149,0.057806,0.170953,0.125773,0.108982,-0.428161,0.501593,-0.035524,
  -0.229812,-0.062461,0.124928,0.071849,-0.198539,0.021828,0.015555,-0.015806,0.12291,-0.155494,-0.071056,-0.10351,-0.376223,0.285575,-0.012232,-0.309168,
  -0.163037,-0.054532,0.059355,-0.15631,-0.007488,-0.093043,0.096893,-0.017635,0.229107,0.054752,0.430329,0.022831,0.019911,0.01221,0.230391,-0.321197,
  -0.067483,0.173704,-0.030813,0.008768,-0.140686,-0.006771,-0.139564,0.085783,0.131765,0.157433,-0.156106,-0.144944,-0.175705,0.089021,0.032312,0.253304,
  -0.264218,0.016791,-0.164803,0.075411,-0.095075,0.065935,-0.224484,-0.072137,-0.007324,0.095406,-0.055471,-0.01348,-0.003295,-0.207779,0.024338,0.220557,
  -0.01131,-0.040829,-0.045666,-0.009792,-0.047667,0.019947,-0.141142,0.112932,0.098531,-0.155702,-0.06235,0.020026,-0.24086,0.047655,-0.156088,-0.029996,
  -0.012707,0.112406,-0.047265,-0.247277,-0.12398,-0.035475,0.076738,0.196647,-0.02042,-0.212485,-0.026959,0.000509,-0.032713,0.041008,-0.09608,0.057868,
  0.077416,-0.063487,0.009248,-0.131312,-0.014471,-0.038847,-0.23589,0.060778,-0.235116,0.002525,-0.034374,0.065507,0.047786,-0.140224,0.074648,-0.154519,
  -0.063424,-0.051858,-0.112917,-0.169478,0.07843,0.118349,-0.032771,0.02241,0.063097,-0.040755,-0.027059,-0.009486,-0.030183,-0.052684,-0.036807,-0.041972,
  0.112568,-0.04201,0.056222,-0.015798,-0.083734,-0.107573,-0.065848,0.051922,0.168877,-0.107143,0.031732,0.087719,-0.044237,0.259588,0.011598,-0.176822,
  -0.087824,-0.025342,-0.044488,-0.030542,-0.035881,-0.059793,0.077038,-0.013054,0.084323,-0.177662,0.100376,0.090573,0.021363,-0.137889,0.002029,-0.040591,
  -0.169648,0.100885,-0.083715,-0.079903,0.099416,0.117757,0.031451,0.151117,0.058442,0.148265,-0.18171,0.025129,-0.032957,0.030822,-0.015311,0.079303,
  0.052091,0.123447,-0.072098,-0.068652,0.054241,-0.012486,-0.0877,-0.059705,0.104262,-0.114962,0.056872,-0.079227,-0.093722,0.030255,-0.238218,0.264626,
  -0.105171,-0.017901,-0.09722,0.224062,-0.063371,-0.121713,0.051567,-0.091224,0.067517,-0.022443,0.002278,-0.123503,0.094656,-0.169294,-0.045749,0.106478,
  0.060947,-0.005408,-0.046666,-0.151013,-0.108636,-0.146436,0.076293,-0.164829,-0.252168,0.12763,0.068211,0.047908,-0.118845,0.042705,0.104772,-0.046088,
  0.293642,0.110498,-0.006141,0.018687,0.104715,0.215198,0.020994,-0.047526,0.230854,-0.094183,0.122049,-0.055241,-0.008203,0.072597,0.100178,0.153761,
  -0.129105,-0.051451,-0.300395,0.031814,-0.19691,0.136036,-0.111743,0.125776,0.133838,-0.308571,0.275142,-0.12223,0.098991,-0.106475,-0.062149,0.285482,
  -0.127611,-0.138356,-0.036531,-0.1896,-0.134249,0.103184,0.151096,0.231216,0.097741,-0.332667,-0.110004,0.012097,0.188564,0.058663,-0.010191,-0.10409,
  -0.176691,0.190089,0.094647,-0.014375,0.078885,-0.233692,-0.079865,0.058007,0.346608,0.077517,0.128301,-0.069717,0.014468,-0.069687,-0.00217,0.143611,
  0.107017,0.169904,-0.002606,0.139565,0.264567,-0.016515,-0.098482,-0.061225,0.141139,-0.157378,-0.005566,0.090247,-0.021632,-0.465912,0.015436,-0.016422,
  -0.119552,-0.036511,-0.031651,0.130866,0.312093,-0.081712,-0.08465,-0.003825,-0.075407,0.138355,0.01341,0.024528,-0.057221,0.060176,0.361092,-0.047301,
  0.039085,0.021519,0.05674,0.029985,0.070953,0.096013,0.009388,0.155688,0.088055,0.079958,-0.144064,-0.073708,0.152551,-0.084822,-0.245671,0.23022,
  0.041439,-0.010651,-0.146087,0.135307,-0.021954,-0.072694,0.126127,0.13609,-0.133282,0.054119,-0.052929,0.073015,0.125644,0.098068,0.179271,0.135895,
  -0.115072,-0.171285,0.063126,-0.018851,-0.066138,0.22874,0.353637,-0.093403,0.044356,-0.069927,0.117645,0.017517,-0.033948,0.162918,-0.015424,0.018275,
  0.02999,0.253082,0.026516,0.105064,-0.145958,0.001426,0.051976,0.048404,0.031888,0.11401,-0.390715,0.078503,-0.11032,0.14476,-0.096537,-0.030558,
  -0.171358,0.119329,0.109711,0.072423,-0.156632,-0.00547,0.069661,0.064445,-0.051075,0.161723,-0.008072,0.261728,0.005339,-0.104106,0.01682,-0.121391,
  -0.119533,-0.250838,-0.016243,0.060196,0.128437,0.160761,0.091551,-0.162603,0.179386,0.053451,-0.129363,0.456084,0.234576,0.082433,-0.00484,0.298006,
  0.015022,0.180209,0.069208,0.005333,0.043549,0.057527,0.233714,0.102327,0.174938,-0.004207,0.001724,0.07617,0.074772,-0.071643,0.02412,0.001187,
  0.022076,0.001101,0.151454,-0.045538,-0.120631,-0.187954,0.11084,0.142723,0.177878,0.141847,0.083519,-0.187836,0.049642,0.232477,-0.49146,0.168312,
  0.324127,0.236365,-0.104342,-0.236557,-0.043496,0.151707,-0.174965,-0.033589,0.40112,0.177373,0.059479,-0.634521,-0.047593,-0.056437,-0.049573,0.093886,
  -0.381432,-0.123966,-0.080403,-0.041089,-0.167801,-0.240324,-0.026904,-0.344978,0.440128,-0.230873,0.063813,0.12372,-0.551605,0.285666,-0.053754,-0.364583,
  0.1587,0.378164,-0.076835,0.003641,-0.095415,0.056581,-0.061586,-0.337895,0.096557,0.104816,-0.000674,0.26084,-0.030362,-0.560106,0.08084,0.048814,
  -0.030243,0.065722,0.243499,-0.574315,0.001437,0.212859,-0.037226,0.08718,0.201659,-0.61275,0.026714,0.040482,0.00829,0.082255,-0.005173,-0.367604,
  -0.185855,-0.009291,0.104137,-0.133903,0.127311,-0.106831,0.147649,-0.091026,-0.155512,-0.151132,0.008815,0.166399,-0.148261,-0.010067,-0.061182,0.171586,
  -0.082352,0.09869,0.120564,0.11659,-0.020864,-0.200441,-0.170395,-0.116136,0.204477,-0.049442,-0.080469,0.054772,0.162816,-0.035917,-0.114014,0.080634,
  0.160954,0.050027,-0.067798,-0.008296,0.142028,-0.026042,-0.129346,0.108843,0.01569,0.250184,-0.291044,0.328341,0.054767,0.180088,0.00482,-0.156217,
  0.365521,0.137041,0.116294,0.450861,0.351417,-0.06388,-0.070691,0.004369,-0.232989,0.147382,0.398933,0.03098,-0.137181,0.035186,-0.050495,0.280716,
  0.048011,0.246648,-0.077772,0.159861,-0.144073,0.155794,0.385444,0.051325,-0.017374,-0.036376,-0.052038,0.182071,0.211273,0.071304,-0.078119,-0.025992,
  -0.007831,-0.038989,-0.004361,-0.118303,-0.151001,0.066386,-0.013928,0.268684,0.320682,-0.011067,0.057464,-0.068353,0.060232,0.178755,-0.203554,-0.183278,
  0.092728,0.267277,0.029154,0.09617,0.03438,0.031129,-0.088522,-0.154638,-0.122341,-0.024367,-0.18975,-0.080911,0.121143,0.025484,0.198213,0.046724,
  0.069033,-0.103163,-0.059692,-0.075387,0.048794,0.062677,-0.041834,-0.097214,-0.369671,-0.108412,-0.220765,-0.256188,0.029229,-0.357522,0.117161,0.210492,
  0.042929,0.017552,-0.302809,0.031708,0.036932,0.164805,0.083724,-0.245723,-0.339474,0.024472,0.125939,0.416281,0.041343,0.234249,-0.064447,0.18528,
  -0.099625,0.368503,0.00954,-0.149809,0.29379,-0.156937,-0.03357,0.369471,0.0036,-0.087215,-0.112337,0.108194,-0.012485,0.20583,-0.114557,-0.010514,
  0.202642,0.019993,0.205495,0.174633,0.01038,0.11552,-0.125581,0.14044,0.177419,-0.472359,0.096849,-0.196789,-0.229227,-0.235901,0.135284,0.162815,
  -0.118027,0.06867,0.18214,-0.00637,-0.114345,-0.226636,0.005466,-0.039743,-0.049391,-0.05501,0.103741,-0.117124,0.27604,0.047568,-0.047291,-0.046663,
  -0.208677,0.187502,-0.017776,0.179995,-0.795536,0.197374,0.213755,-0.093801,0.216948,-0.017772,-0.06756,0.499629,-0.015249,-0.03397,-0.126563,0.097885,
  0.001811,0.412455,0.06792,0.038216,-0.07157,0.264739,-0.13439,0.328751,0.045035,-0.201425,-0.188572,-0.12677,-0.204584,0.284147,0.062861,-0.047405,
  0.198029,0.070807,0.127515,0.327634,0.090598,0.116646,0.090506,-0.074941,-0.002909,-0.152051,-0.057482,0.078793,-0.109243,0.023333,-0.193755,0.089571,
  -0.117659,0.15889,0.066588,0.245789,0.068998,0.207969,0.459693,0.108012,-0.283561,-0.281696,-0.083744,-0.137432,0.136255,0.184129,-0.210616,-0.061803,
  -0.134742,-0.291462,0.136291,-0.105646,-0.061563,-0.037389,0.042818,0.140672,0.099423,-0.079597,-0.1803,-0.089714,-0.14486,0.208205,-0.324271,-0.138905,
  -0.149513,0.154236,0.005131,-0.068341,0.143287,-0.011274,0.230669,0.109559,0.075473,0.145356,0.079895,0.018144,-0.254082,-0.154986,0.297851,0.269916,
  0.074888,0.147117,0.060097,0.16507,0.070349,0.052277,-0.135362,-0.066878,0.03605,0.113878,0.138247,-0.032815,-0.205942,0.043104,0.073518,-0.245788,
  0.300566,0.051121,-0.065904,-0.160039,0.127095,0.017762,-0.046187,-0.147601,0.368348,0.291835,0.050018,0.224281,0.063789,0.061751,0.306495,0.147832,
  -0.035608,-0.450231,0.091021,0.016634,0.017377,0.007535,0.015216,0.021685,-0.038242,-0.118702,0.133683,-0.101182,-0.060815,-0.279207,0.077098,-0.131578,
  -0.063774,0.005525,-0.359706,-0.177908,0.103163,0.109195,0.014359,0.055491,-0.260193,0.132676,0.041345,0.006679,-0.06767,0.083446,0.129521,-0.022891,
  -0.252899,-0.005459,-0.251133,-0.10366,-0.045311,-0.128726,0.057803,0.232916,-0.073247,0.05861,-0.036079,0.00236,-0.051852,0.032749,-0.13472,-0.036096,
  -0.293232,0.030317,0.019155,0.070094,0.091628,0.120249,-0.078399,0.056661,-0.176257,0.002731,0.009736,0.229891,0.005751,-0.059217,-0.033037,0.062155,
  -0.077578,0.215279,-0.108624,0.06588,0.085295,0.171913,-0.130714,-0.01787,0.140335,-0.056024,-0.072895,0.090363,0.154561,-0.102061,-0.128275,0.088996,
  -0.098836,-0.035279,-0.098205,0.039511,0.292521,-0.099498,0.011681,-0.245973,0.11889,0.045635,0.106832,0.026157,0.129279,0.031545,0.211516,0.320973,
  0.114638,0.074734,-0.022691,0.13101,-0.056636,-0.091038,-0.205913,0.036502,0.249694,0.010803,0.144404,0.013548,0.291665,0.033482,0.020061,0.382667,
  0.278159,0.10709,0.160134,0.188052,0.044846,0.206205,0.167618,0.26543,-0.176481,0.128541,0.048759,-0.035405,0.012978,0.196214,0.055816,-0.009183,
  -0.122296,-0.136554,0.098187,0.073431,-0.108627,-0.029001,-0.053739,-0.190389,0.055946,-0.02209,-0.03812,-0.283581,-0.027063,0.168007,0.219836,0.151494,
  -0.206238,0.01557,0.069941,-0.060482,0.175927,0.040487,-0.075719,-0.244648,-0.049667,0.121101,0.012764,-0.060653,-0.059069,0.094431,-0.02095,-0.243353,
  0.099915,0.083931,0.172653,-0.035223,0.015547,0.013759,0.105458,-0.017677,-0.146267,-0.091747,-0.042258,0.023588,-0.113443,-0.022305,-0.068068,-0.034842,
  0.124089,0.103016,-0.026385,0.103981,-0.087407,-0.184251,0.09549,-0.025303,-0.098564,0.13871,0.037977,-0.127752,0.01961,0.107725,-0.085121,-0.199781,
  -0.059963,-0.035747,-0.056097,0.103505,-0.075079,-0.07806,-0.194611,-0.162447,-0.138005,0.016198,0.161673,0.001173,-0.0569,0.027746,-0.227454,-0.125547,
  0.03951,-0.122576,-0.018588,0.232801,-0.414942,-0.203266,0.170084,0.004483,-0.03968,0.062289,-0.196237,0.054531,0.059808,-0.016212,0.169828,-0.112318,
  0.066767,-0.055554,-0.100504,-0.029389,-0.119538,-0.037686,-0.118494,-0.137431,-0.087074,0.184611,-0.121871,0.071991,0.011813,-0.233933,-0.183065,-0.066154,
  0.009474,0.171572,0.027597,-0.044171,-0.194928,0.04891,0.099543,-0.052434,0.195009,-0.178167,0.052384,-0.099744,-0.121512,-0.030072,-0.130303,-0.105616,
  -0.005444,0.028517,-0.051878,-0.016004,-0.084651,-0.013279,-0.180031,-0.13109,0.076926,-0.005975,0.025526,-0.028332,-0.044107,0.020079,-0.035998,0.15064,
  0.05672,-0.045374,0.017524,-0.012966,-0.123735,0.084758,-0.004455,-0.255188,-0.081786,0.076731,-0.075103,0.077965,-0.183802,0.028917,-0.23372,-0.095854,
  -0.188645,-0.120784,-0.019877,0.039936,0.078472,0.050726,-0.13193,-0.104028,0.189017,0.097476,0.029758,-0.143815,-0.087933,0.052462,0.081989,0.107591,
  0.087167,-0.341964,0.239144,0.174196,-0.3209,-0.083675,0.023277,0.059589,-0.066475,-0.125093,-0.057551,-0.259747,0.246342,0.417886,0.028602,-0.026084,
  0.111006,0.229029,-0.066067,0.359963,0.151297,-0.030482,0.084389,-0.072022,-0.014328,-0.251579,-0.033951,-0.128142,-0.433163,-0.183167,-0.305858,-0.237147,
  -0.223377,-0.089275,-0.130285,0.246921,0.033224,0.092538,0.055141,0.114805,-0.482144,0.231133,-0.059321,0.03947,-0.028177,0.18968,-0.247092,0.367002,
  0.002427,0.220159,-0.083985,0.113169,-0.121353,0.389728,0.017396,0.00621,0.175777,0.083417,-0.216836,0.286057,0.177795,0.161042,0.033037,0.170054,
  -0.135758,-0.041059,0.006145,-0.082482,-0.104862,0.163285,0.140805,0.13244,-0.132287,-0.110372,0.09752,0.036729,0.071702,0.463405,-0.163387,-0.110108,
  0.338758,0.090087,-0.007403,0.016045,-0.02503,0.154497,0.090892,0.078223,0.099441,-0.103325,0.009966,-0.116179,0.124724,0.002804,-0.006737,-0.011918,
  -0.08433,-0.031069,0.093902,-0.073695,0.254218,0.029275,0.085313,-0.045893,-0.310046,0.100404,-0.103832,0.078251,-0.055285,-0.077886,0.06428,-0.078744,
  0.007237,-0.025221,-0.025405,0.004234,0.07769,-0.058424,-0.028284,0.057573,0.123351,0.095447,-0.052164,0.12972,0.15294,-0.019939,0.062453,-0.028,
  0.185075,-0.010751,0.028952,0.010386,-0.11617,-0.062377,0.106235,0.288426,0.058194,0.133961,-0.07767,0.142693,-0.021663,0.065387,0.028527,0.148809,
  -0.070497,0.068073,-0.033395,0.067811,0.031753,-0.057413,-0.113206,-0.000462,-0.069791,0.113041,0.342021,0.279622,-0.136135,-0.188659,-0.190483,-0.136818,
  0.108732,-0.062572,0.101706,0.016429,-0.025939,-0.269668,0.157792,0.072783,0.103896,0.002853,-0.265761,0.435082,0.167188,0.028651,0.2435,-0.220521,
  -0.033779,0.020167,-0.272172,0.359063,0.021511,0.01408,-0.012087,0.043662,0.162527,-0.217971,-0.069759,0.41794,0.221304,-0.048632,0.115692,0.115372,
  -0.1093,0.121678,0.345143,0.075094,0.236654,-0.157403,0.034503,0.3759,0.188933,0.164085,0.162642,-0.097126,0.041591,0.16691,0.114326,0.052351,
  0.217528,-0.017766,-0.139642,-0.130948,0.213907,0.056855,0.176212,-0.166916,0.039403,0.123305,0.002387,-0.18607,-0.021474,0.0038,0.2103,-0.02906,
  0.155387,-0.185832,-0.126466,0.093414,-0.175643,0.074865,-0.152313,0.065936,-0.063015,-0.129288,0.115857,-0.199718,-0.053951,0.017465,0.072656,0.105647,
  -0.066617,-0.085513,-0.080769,-0.055548,-0.128747,-0.077664,-0.073868,-0.07215,-0.042007,-0.10309,0.040622,-0.010955,-0.02096,0.120734,-0.1768,-0.059579,
  0.018119,-0.112939,0.25215,-0.143491,0.057468,-0.057879,-0.129945,-0.016714,-0.047107,0.029999,-0.030583,-0.013462,0.001587,0.064841,-0.141582,0.083357,
  -0.067419,0.176534,-0.083371,0.019587,-0.139999,-0.052522,-0.03767,-0.067997,0.11866,0.106663,-0.22396,-0.021064,-0.08439,-0.14621,-0.014542,0.067785,
  -0.033791,0.111819,-0.004731,0.032806,-0.160186,0.00092,-0.059901,0.021767,0.217786,0.089742,-0.351876,-0.238268,0.014128,0.091592,-0.174774,0.074924,
  0.112929,-0.234571,-0.391433,-0.201337,-0.065104,-0.024498,-0.08317,-0.026477,0.067171,0.116422,-0.036431,-0.138932,-0.098156,-0.177603,-0.07024,0.330166,
  -0.214848,-0.1596,-0.062481,-0.173879,0.10304,0.085288,0.023404,0.136002,0.104226,-0.071228,-0.138676,0.242607,0.404615,0.241891,0.100054,0.0356,
  0.258009,0.08388,-0.138709,0.815426,0.134791,-0.000784,-0.261682,0.155557,0.151283,0.461457,0.137215,0.019354,0.002717,0.145448,0.16618,0.36916,
  0.269387,0.047958,-0.261726,0.085328,0.138813,0.247776,0.135053,-0.046324,-0.066113,0.172392,0.05224,0.032272,0.075163,-0.032912,-0.010989,-0.010114,
  0.204752,0.186989,-0.044173,-0.022595,-0.305578,0.120008,0.087871,0.035703,0.380369,0.364476,-0.29209,0.006583,0.145938,0.211177,-0.166249,-0.399272,
  0.049003,-0.046967,0.173716,-0.348583,0.122156,0.124879,-0.036508,0.236849,-0.044744,0.158616,-0.087099,-0.055918,-0.052287,-0.196985,0.4197,-0.166885,
  0.318975,-0.023263,0.182229,-0.094116,-0.531847,0.190714,-0.045999,0.0246,-0.073474,-0.254116,0.010136,-0.267891,-0.03753,0.016724,0.114997,-0.653023,
  -0.032032,-0.114736,0.124275,-0.085857,0.096935,-0.585782,0.034724,0.107218,0.000049,-0.086267,0.3927,-0.379331,-0.181509,-0.031782,0.030197,-0.146112,
  0.049711,-0.151504,0.031813,0.110617,0.075343,0.340499,0.243868,-0.120276,0.061545,0.274671,0.227895,-0.143324,-0.11016,-0.002618,-0.081453,0.151874,
];
const B1 = [
  0.041228,0.16196,0.01143,0.002572,0.047116,0.02696,0.054485,0.069245,0.049041,0.051371,0.048428,0.142745,-0.024621,0,0.052184,0.049079,
  -0.025808,-0.005198,0.029472,0.03478,0.050998,0.037092,0.141056,0.016616,-0.028002,-0.028195,0.04635,0.090808,-0.016762,-0.041123,-0.004359,0.059757,
];
const W2 = [
  0.137515,0.156665,0.09304,0.132659,0.129343,0.042248,0.024748,0.1051,-0.091069,0.246137,0.362586,0.260252,0.136903,0.042272,0.105691,0.269656,
  -0.023661,-0.387288,0.036795,0.271689,0.188901,0.032848,0.244362,0.081021,0.018795,0.038664,-0.120394,0.156844,0.01655,0.058337,0.174036,0.280516,
  0.107849,-0.077,0.271097,0.173307,0.160242,-0.03981,-0.057241,-0.02478,-0.186818,0.010465,0.428188,0.019343,0.09374,0.187501,-0.093473,0.137802,
  0.077954,0.38846,-0.017058,0.175089,-0.024427,0.069301,0.141364,0.02539,-0.080072,-0.11295,0.22547,-0.118097,-0.15864,0.109636,-0.146126,0.469096,
  0.108774,-0.039821,0.037281,0.03825,0.029291,-0.070963,-0.034512,0.011212,0.140449,-0.060763,-0.209787,-0.142279,-0.056991,-0.123955,-0.13427,0.03826,
  -0.148541,-0.100298,0.034182,0.294613,-0.128773,-0.035009,-0.055893,-0.016095,0.124531,0.040128,-0.054246,-0.133939,-0.084278,-0.088676,0.03276,-0.085704,
  0.016381,0.095346,-0.003544,-0.008797,0.083138,0.021518,0.097751,-0.207628,0.03774,-0.107747,-0.045224,-0.056892,-0.080358,-0.147465,-0.173669,0.101906,
  -0.102396,-0.023153,-0.139243,-0.133228,-0.071938,-0.140531,-0.050731,-0.069861,0.088472,-0.050578,0.000061,-0.095724,-0.130813,0.134205,0.095301,-0.042471,
  -0.108984,0.013971,0.152319,-0.157539,0.036949,0.057657,0.012903,0.055087,-0.10384,-0.160835,-0.064764,0.318662,0.033305,0.072835,0.039674,0.123895,
  0.07991,0.458271,-0.005017,0.071314,-0.275382,0.028863,0.123883,0.044987,0.002739,-0.023143,-0.10669,-0.02964,-0.36606,-0.032158,0.160829,0.267741,
  -0.021744,0.008793,-0.007387,-0.054477,0.057153,-0.031424,-0.079156,-0.045143,-0.087621,-0.126161,-0.097381,-0.096777,0.006889,-0.084122,-0.010848,-0.004774,
  0.087839,-0.317058,0.035202,-0.035415,0.053547,0.06575,-0.085191,-0.167052,-0.046392,0.044076,0.068366,-0.053187,-0.196612,-0.074486,0.025043,0.103735,
  -0.19876,0.268438,0.031616,-0.206671,-0.075289,-0.029757,0.099977,0.247013,0.149461,0.074629,0.205534,0.18782,0.072561,-0.038624,0.079947,-0.185916,
  -0.12879,-0.200541,-0.007018,-0.078565,-0.333647,0.110806,-0.139748,-0.055557,-0.018296,0.033934,0.100668,0.147133,0.052835,-0.134705,-0.382049,0.010037,
  0.08571,-0.029146,0.052626,0.054993,-0.027942,-0.208853,-0.024,0.098681,-0.028179,-0.108878,-0.132802,-0.003581,-0.019102,-0.02832,-0.196423,0.005133,
  -0.015659,-0.060387,0.146984,-0.090033,-0.234005,0.205185,0.056055,0.012229,-0.104105,0.088605,0.06452,-0.060349,-0.157602,0.09429,-0.098773,-0.048633,
  -0.09792,0.113835,-0.053902,0.003193,0.093852,0.05905,-0.052647,0.021846,0.069274,0.076936,-0.045668,0.478748,-0.18764,0.161332,0.034363,0.106643,
  0.00388,-0.442525,0.180888,0.101012,0.202889,-0.058414,0.127996,0.012627,0.189347,-0.059857,0.203153,-0.176952,0.015813,0.080138,-0.014904,-0.096599,
  0.030213,-0.082658,0.296301,0.108034,0.09128,0.039069,-0.017743,-0.055998,-0.037524,-0.019622,0.035072,-0.172005,0.20132,-0.033491,0.106428,0.270608,
  0.074245,0.201758,0.03961,-0.13009,-0.205927,0.04569,-0.017974,0.37187,-0.119268,-0.126932,0.172028,-0.09048,0.155035,-0.300541,0.106072,-0.200699,
  -0.280513,0.328319,-0.101005,-0.278111,0.216585,0.168305,-0.046616,0.072962,0.064375,0.037859,-0.072129,-0.020197,-0.00096,-0.026997,-0.049019,-0.112638,
  0.034293,-0.260261,0.289548,0.123019,-0.040774,0.133838,-0.114903,0.057927,0.10418,0.132192,-0.100408,0.1404,0.091176,0.112907,0.032596,-0.201894,
  -0.023786,0.028712,0.098188,-0.021612,-0.022794,0.032743,-0.045418,0.020324,0.064484,0.047437,-0.022405,0.217126,0.050435,0.119441,0.067199,0.274265,
  -0.084535,0.012134,0.060594,-0.018556,0.227643,0.161258,0.200211,0.120118,-0.153854,-0.113827,0.054804,-0.134738,-0.036356,0.042886,0.113732,-0.125424,
  0.193321,-0.047767,0.109576,-0.04157,-0.00424,0.10075,0.179308,-0.051988,-0.013788,-0.058903,0.146413,0.071939,-0.105111,0.041046,0.059215,0.048711,
  -0.088246,0.158015,0.197274,-0.074233,0.155444,0.145075,0.146774,0.085766,-0.237256,-0.038811,0.333537,-0.063766,0.35962,0.003303,0.112286,-0.520227,
  -0.013269,-0.086889,-0.028755,-0.026975,0.024965,0.129668,-0.014489,-0.092363,-0.036242,0.072325,-0.070783,0.034615,-0.122932,-0.065033,-0.04445,-0.080389,
  -0.00903,0.021809,-0.213876,-0.145218,0.085952,0.144899,-0.20976,-0.379886,-0.212134,0.168925,-0.174153,-0.191739,0.069966,-0.101638,0.039047,-0.062118,
  -0.109982,-0.065405,-0.143585,-0.01243,0.075191,0.210669,0.305053,0.253735,0.45267,0.12378,0.078726,-0.253584,-0.134611,0.040747,0.012525,-0.177755,
  0.190579,0.27154,0.172321,0.076132,-0.004569,0.220363,0.010475,0.026712,0.049119,0.021685,0.001603,0.047035,0.211358,0.080238,0.123294,-0.12181,
  0.083932,0.028164,-0.1142,0.047127,0.156565,0.135949,0.002031,0.176875,0.160451,0.087107,-0.121011,-0.102616,0.045977,0.201759,-0.009659,-0.158012,
  -0.00971,0.066702,0.086854,0.310938,-0.105688,0.034111,0.061302,0.075782,0.009221,-0.056752,-0.195576,0.168278,0.372727,-0.083299,-0.086528,0.07167,
  0.118883,0.011148,0.151256,0.139013,0.302986,-0.021476,0.019206,0.203959,0.043182,-0.005912,-0.017626,-0.112005,0.162692,-0.018011,0.210003,-0.076545,
  0.100711,0.382461,0.180782,0.059155,0.093892,0.077283,0.07488,0.2019,0.071231,-0.021374,-0.190381,0.344703,-0.028021,-0.192671,0.229152,0.034719,
  0.07131,0.082631,0.080884,0.158304,-0.056486,-0.019186,0.246119,-0.043544,-0.143685,0.189331,0.119252,0.065913,0.084132,-0.076644,0.239088,0.210857,
  0.206279,-0.363024,-0.069804,0.035397,0.075388,-0.145232,0.156148,0.056961,0.029407,-0.015477,-0.223713,0.11151,-0.028134,-0.001418,0.127594,0.188021,
  0.168064,-0.091377,0.281318,0.012545,0.02773,-0.014945,-0.071255,0.095375,-0.0302,0.019,0.26998,0.009072,-0.045003,-0.139967,0.102727,0.063774,
  0.274591,0.482421,0.012879,-0.126766,-0.071294,0.093404,-0.083019,0.028606,-0.048548,0.024886,0.362624,0.003184,0.210367,0.117278,-0.027959,0.022524,
  -0.378866,0.25117,0.054584,-0.110958,0.040124,0.020865,0.254592,0.122697,0.065156,0.030348,-0.179447,-0.220989,-0.112509,-0.040885,-0.079683,-0.178322,
  0.038072,-0.36856,-0.128747,0.226546,-0.119327,0.045551,-0.132589,-0.013818,-0.00613,0.036021,-0.481655,0.260577,-0.152108,0.092761,-0.061527,0.169632,
  -0.100187,-0.057015,-0.206929,0.023253,-0.048882,0.010265,0.049483,-0.060672,-0.159851,-0.06942,-0.060749,-0.136825,0.110384,0.085681,-0.124503,0.108333,
  -0.150461,-0.050879,-0.012021,-0.138583,-0.091792,-0.076649,-0.112526,-0.083687,-0.014858,-0.028336,-0.123177,0.145531,-0.158203,0.059128,0.274061,0.004389,
  0.247986,0.04722,-0.101349,0.067979,-0.084674,0.099261,-0.034268,-0.115644,-0.078591,0.027502,0.119319,0.056898,-0.106591,0.111857,0.0937,0.098589,
  -0.153197,-0.044311,0.029636,0.029146,-0.001107,0.060172,0.26763,0.060109,0.140871,-0.043373,0.184363,0.111412,-0.168709,-0.035699,0.0345,0.403506,
  -0.080808,-0.112108,0.155598,0.016873,0.089853,-0.099936,-0.007089,-0.201913,-0.155456,-0.025679,-0.049292,-0.179807,0.058556,0.018496,-0.182257,0.032076,
  -0.206997,-0.222408,-0.028577,-0.200707,-0.111102,0.099952,-0.059926,-0.058513,-0.046798,0.040653,-0.200619,0.040154,0.049215,0.006305,-0.040759,0.031431,
  0.014196,-0.192518,-0.033304,-0.074418,0.183002,0.33359,-0.127663,0.090936,0.046574,-0.017906,0.038963,0.106257,0.11026,0.130695,-0.124576,0.156781,
  -0.183122,0.299324,0.086796,-0.158929,0.25688,0.221532,0.107649,0.098532,0.152477,-0.032519,0.378404,0.064482,0.264958,-0.081382,0.010676,-0.36853,
  0.188649,-0.260183,0.040341,-0.034231,-0.231942,0.045459,0.073402,-0.008628,0.054621,0.224824,0.143366,0.300878,0.034743,-0.041888,0.137248,-0.017864,
  -0.028253,0.076431,-0.011793,0.078978,0.038893,-0.113763,0.186642,0.10687,-0.001718,-0.038085,0.098892,0.016655,-0.005227,-0.090375,-0.205324,0.043071,
  0.293605,-0.062369,0.066015,0.055158,-0.146487,-0.070334,0.028199,-0.070267,-0.042899,0.019383,-0.032568,0.023612,-0.157988,0.155042,0.123905,-0.195908,
  -0.117099,0.336432,-0.006259,-0.072644,-0.047075,-0.02051,-0.035427,0.184616,0.125576,-0.174502,0.130052,0.078181,0.11705,0.154564,-0.119386,0.145112,
  0.107882,0.21008,0.178197,0.020058,0.111013,0.11415,-0.042111,0.09747,0.0833,0.138088,-0.071995,-0.14158,0.010101,-0.181825,0.019534,0.09975,
  0.160018,0.229898,0.140623,0.049715,0.231328,0.09812,-0.032907,0.203978,-0.092845,-0.04172,0.132551,0.255332,0.133166,0.000257,0.243179,-0.185746,
  -0.151359,-0.079365,0.067921,0.00127,-0.022996,-0.034371,0.236083,-0.070129,0.219431,0.100738,-0.24401,-0.502188,-0.067865,0.04942,0.17814,-0.238231,
  0.207342,0.688176,0.0871,-0.079765,-0.253919,-0.010159,0.069753,0.00318,0.045378,0.177506,0.034003,0.080172,0.158857,0.061974,-0.038373,-0.073746,
  -0.050741,0.112976,-0.114272,-0.163858,0.080471,0.019273,0.313143,0.111666,0.099068,-0.018116,0.171797,0.16403,0.001395,-0.035538,0.176044,-0.057906,
  -0.304881,0.125326,-0.175775,0.012521,-0.27917,0.016974,0.0369,0.002585,-0.158998,-0.00714,-0.099851,-0.052831,0.007654,0.088973,-0.317228,0.558094,
  0.073088,0.125264,-0.202804,-0.001043,0.121144,0.27938,0.192759,0.145207,0.088651,0.095195,0.111775,-0.011997,-0.016293,-0.112829,0.154448,-0.114517,
  -0.023321,-0.343404,0.13821,0.087591,0.198296,0.259375,0.126498,0.212086,0.00197,0.079538,-0.074543,0.197744,-0.086047,-0.05151,0.100981,-0.093788,
  0.067911,-0.098442,-0.143823,0.061727,0.061152,0.057599,-0.177365,0.030807,0.172986,0.051273,0.149037,0.223522,-0.047345,0.029403,0.07283,-0.016021,
  -0.068827,-0.448687,-0.123793,0.036338,0.115081,-0.033851,0.17459,-0.083172,-0.024941,0.130177,-0.189847,-0.039495,-0.014641,-0.081738,0.028824,0.238439,
  0.156592,0.327155,0.167312,0.059608,-0.109142,0.001643,0.010335,-0.369512,-0.258904,-0.260869,-0.100125,0.095018,0.122758,-0.15937,-0.11827,-0.094101,
  0.071758,0.220298,-0.121904,0.053957,0.30859,0.281901,0.183648,-0.021308,-0.113758,-0.016319,0.059233,0.213954,-0.101109,0.224023,0.074972,0.253017,
];
const B2 = [
  0.15068,0.006653,-0.050164,0,0.097282,-0.02665,0.125855,-0.038921,0.114361,-0.015069,0.09419,0.10771,0.033138,-0.043387,0.042105,0.142689,
  0.067408,0.081254,0.014065,0.081295,-0.042523,0.092416,-0.024581,-0.047407,0.039758,-0.017768,0.030649,-0.049549,0.081309,0.132831,0.056192,0.12082,
];
const W3 = [
  -0.00628,-0.242713,-0.023137,0.086747,-0.031212,0.208652,-0.298132,0.014903,0.149646,0.05241,0.303078,0.116206,0.143218,-0.032696,0.050374,0.016667,
  -0.095636,-0.0609,-0.171671,-0.126789,0.135752,-0.106161,0.032326,0.121938,-0.087422,-0.244922,0.091717,-0.133864,-0.263455,0.073893,0.052164,-0.34012,
  -0.194802,0.104213,-0.082109,0.143943,0.218933,0.113988,-0.158284,-0.106074,-0.062144,0.121103,-0.078129,0.038824,0.191298,-0.153942,0.081247,-0.034607,
  0.031089,-0.061038,0.276842,-0.22636,0.008512,-0.075759,-0.206176,0.209361,0.011992,0.100574,0.085841,0.219115,-0.242961,-0.088542,-0.24076,-0.004986,
  -0.166403,-0.147141,0.055112,0.008035,-0.185919,-0.052932,0.255617,-0.066725,-0.207522,-0.121917,0.197978,-0.315822,-0.176085,-0.107526,0.225279,0.191492,
  0.17727,-0.145458,-0.043542,0.155452,0.186537,-0.11484,0.076052,-0.05947,-0.108345,-0.074958,0.02457,0.301228,-0.175398,0.098927,-0.142059,-0.061479,
  -0.025591,-0.210127,0.084022,0.054836,0.078421,-0.019239,0.406239,-0.055403,0.32287,-0.126344,0.02995,0.230293,0.180383,-0.025628,0.017232,-0.008984,
  -0.191972,-0.366835,-0.033984,-0.190582,-0.140359,-0.00581,0.014044,0.29266,0.086692,0.077918,-0.084235,-0.17862,0.217269,0.059144,0.109515,-0.123727,
  0.387586,0.100662,-0.176698,-0.025821,0.263554,0.019903,0.228103,0.047349,0.208235,0.157852,0.184879,0.465255,0.406637,-0.104235,0.312414,0.608084,
  0.391836,0.274017,0.335818,0.100991,-0.097556,0.588099,-0.004221,0.135141,0.422577,0.055527,0.274635,0.140401,0.136017,0.372989,0.056386,0.046385,
];
const B3 = [
  0.00119,-0.117362,-0.022761,-0.033886,0.112898,
];

function relu(x){return x>0?x:0;}
function tanh(x){const e1=Math.exp(x), e2=Math.exp(-x); return (e1-e2)/(e1+e2);}
function sigmoid(x){return 1/(1+Math.exp(-x));}

function mlpForward(x){
  // x: length INPUT_SIZE
  const h1 = new Array(H1).fill(0);
  for(let i=0;i<H1;i++){
    let s = B1[i];
    for(let j=0;j<INPUT_SIZE;j++) s += W1[i*INPUT_SIZE + j]*x[j];
    h1[i] = relu(s);
  }
  const h2 = new Array(H2).fill(0);
  for(let i=0;i<H2;i++){
    let s = B2[i];
    for(let j=0;j<H1;j++) s += W2[i*H1 + j]*h1[j];
    h2[i] = relu(s);
  }
  const out = new Array(OUTPUT_SIZE).fill(0);
  for(let i=0;i<OUTPUT_SIZE;i++){
    let s = B3[i];
    for(let j=0;j<H2;j++) s += W3[i*H2 + j]*h2[j];
    out[i] = s;
  }
  // post-process
  const mvx = tanh(out[0]);
  const mvy = tanh(out[1]);
  const fx  = tanh(out[2]);
  const fy  = tanh(out[3]);
  const fireP = sigmoid(out[4]);
  // 각도 변환
  const mvAngle = Math.atan2(mvy, mvx) * 180/Math.PI;
  const fireAngle = Math.atan2(fy, fx) * 180/Math.PI;
  return { mvAngle, fireAngle, fireP };
}

function norm(x, a, b){ return (x - a) / (b - a); }
function clamp01(v){ return v<0?0:(v>1?1:v); }

function buildFeatures(tank, enemies, allies, bulletInfo){
  // 입력 피처 구성 (전부 사용)
  // - 탱크 자체 상태: x,y,health,energy,typeOneHot(3),size
  // - 적/아군 최근접 K명: 상대 위치(상대 좌표-자기 좌표), 거리, 각, 체력
  // - 총알 최근접 K발: 상대 위치/속도(상대 좌표-자기 좌표), 거리
  const W=900, H=600;
  const self = [
    norm(tank.x, 0, W),
    norm(tank.y, 0, H),
    clamp01(tank.health/200),
    clamp01(tank.energy/200),
    tank.type===0?1:0,
    tank.type===1?1:0,
    tank.type===2?1:0,
    clamp01(tank.size/60),
  ];

  // 정렬 및 K개 추출
  function topK(arr, k){
    const sorted = arr.slice().sort((a,b)=> (a.distance||1e9)-(b.distance||1e9));
    return sorted.slice(0,k);
  }
  const KE=4, KA=3, KB=5;
  const es = topK(enemies, KE);
  const as = topK(allies, KA);
  const bs = topK(bulletInfo, KB);

  const ef = [];
  for(let i=0;i<KE;i++){
    const e = es[i];
    if(e){
      const dx = e.x - tank.x; const dy = e.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI; // -1..1
      ef.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(e.health/200));
    }else{
      ef.push(0,0,0,0,0);
    }
  }
  const af = [];
  for(let i=0;i<KA;i++){
    const a = as[i];
    if(a){
      const dx = a.x - tank.x; const dy = a.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      af.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(a.health/200));
    }else{
      af.push(0,0,0,0,0);
    }
  }
  const bf = [];
  for(let i=0;i<KB;i++){
    const b = bs[i];
    if(b){
      const dx = b.x - tank.x; const dy = b.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      bf.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang,
              clamp01((b.vx+8)/16), clamp01((b.vy+8)/16));
    }else{
      bf.push(0,0,0,0,0,0);
    }
  }

  // 전역 통계(개수/합계)
  const stats = [
    clamp01(enemies.length/6),
    clamp01(allies.length/5),
    clamp01(bulletInfo.length/10),
  ];

  const x = self.concat(ef, af, bf, stats);
  // 길이 보정(정확히 INPUT_SIZE)
  if (x.length < INPUT_SIZE) {
    while (x.length < INPUT_SIZE) x.push(0);
  } else if (x.length > INPUT_SIZE) {
    x.length = INPUT_SIZE;
  }
  return x;
}

function policyStep(tank, enemies, allies, bulletInfo){
  const feat = buildFeatures(tank, enemies, allies, bulletInfo);
  const out = mlpForward(feat);
  // 액션 적용
  // 발사 결정은 DNN의 fireP로만 제어
  if (out.fireP > 0.5) tank.fire(out.fireAngle);
  tank.move(out.mvAngle);
}


function name(){ return "DNN-T2"; }
function type(){ return Type.TANKER; }
function update(tank, enemies, allies, bulletInfo){
  policyStep(tank, enemies, allies, bulletInfo);
}


// ===== 다음 로봇 =====


const INPUT_SIZE = 76;
const H1 = 32;
const H2 = 32;
const OUTPUT_SIZE = 5; // [mvx, mvy, fx, fy, fire_logit]

const W1 = [
  0.231249,0.252307,0.277549,-0.080441,-0.056814,-0.017329,-0.03729,0.086753,0.122447,-0.381046,-0.012094,0.002491,-0.183581,0.097481,0.067492,0.057175,
  0.059112,0.214549,0.42343,0.303794,0.116437,-0.137641,0.138886,0.375197,0.177459,-0.137844,-0.354217,0.393907,-0.011193,0.021641,-0.025584,0.085705,
  -0.07592,-0.095949,-0.013901,-0.16592,0.090642,0.003898,-0.053293,0.001682,0.001988,0.043385,-0.01573,0.343829,-0.092087,-0.008471,0.222984,0.334922,
  -0.129952,0.158514,-0.017785,0.014144,0.159652,0.274476,0.004687,0.116878,-0.295685,-0.107057,0.265392,0.123549,0.182867,0.13654,-0.107376,0.062359,
  0.034339,0.027035,0.086895,0.002537,0.006179,0.021991,-0.112255,-0.035348,0.14066,0.07763,-0.073481,0.009612,-0.16441,0.07252,0.09489,0.282891,
  0.168923,0.002073,-0.04729,0.182894,-0.054457,0.054282,0.00975,0.021356,0.194464,-0.058447,0.209679,0.07782,0.094445,0.00661,-0.111975,0.042909,
  0.102029,0.095552,-0.035737,-0.074742,-0.210353,0.109379,0.01774,-0.485099,-0.127244,0.176676,0.027057,-0.140293,0.13579,-0.02035,-0.071361,0.030229,
  -0.099923,-0.036192,0.029663,-0.023531,-0.112156,0.144072,0.235565,-0.475378,-0.03504,-0.145612,0.0342,-0.063241,0.069014,-0.264007,0.047478,-0.115281,
  0.027475,-0.132847,0.341269,-0.126718,0.23187,0.268695,-0.080436,-0.063963,0.038427,-0.245087,0.130909,0.078642,0.017888,-0.23696,0.247609,-0.02891,
  0.115154,0.139652,0.100362,0.005329,0.11403,0.06441,0.029392,0.32734,0.083084,0.107289,0.060838,-0.055452,0.074276,0.056687,-0.065191,0.052332,
  -0.152936,-0.187324,0.017415,0.021242,-0.003169,0.026812,-0.063456,-0.178316,0.075306,0.390732,-0.019557,-0.068721,-0.049308,-0.079795,0.198757,0.128274,
  -0.119618,-0.036931,0.195009,-0.147944,0.192563,-0.087338,-0.114024,-0.315607,0.192127,-0.023869,-0.174601,-0.259945,-0.022001,0.021529,-0.069289,0.199371,
  -0.15614,-0.02703,-0.140107,0.123729,0.248163,0.023272,0.043381,0.18092,0.009153,-0.207206,0.109657,-0.01964,-0.01565,0.264206,0.19638,-0.170432,
  -0.152638,-0.110755,-0.114911,0.185059,0.218309,-0.248634,-0.012094,-0.067803,0.01673,0.260555,-0.167029,-0.056029,-0.15504,-0.108546,0.039792,0.11992,
  -0.08085,0.054533,0.155033,0.083988,0.107993,0.225401,-0.125344,0.170629,0.0079,0.059999,-0.17205,-0.010754,-0.016086,-0.230478,-0.177144,0.046707,
  0.043333,0.030807,-0.210242,-0.005623,-0.081899,0.108946,0.196994,-0.062466,0.066424,0.075504,-0.105066,0.022428,-0.036635,0.0508,-0.091117,0.193803,
  0.234642,-0.091593,-0.058831,-0.052719,-0.190395,-0.011782,-0.05412,-0.037195,0.047667,-0.106122,-0.094499,-0.012481,0.12228,0.120793,-0.124058,0.256646,
  -0.206133,-0.142556,0.034169,0.215976,0.166105,0.150425,-0.118902,0.013237,0.227881,0.404726,0.14554,0.123853,-0.211866,0.021287,0.069836,0.088628,
  0.266148,0.011142,-0.033858,-0.060848,0.069514,-0.001845,-0.164382,0.232031,-0.013076,0.088518,-0.024882,0.121853,-0.09547,0.129247,0.023822,0.0701,
  0.044805,-0.011508,-0.288175,0.007469,0.167103,0.127085,0.025522,0.197875,0.005763,0.194158,0.045954,0.055957,0.033337,-0.117676,-0.067896,0.009017,
  0.035343,-0.242824,-0.020475,-0.034971,-0.042475,0.07191,-0.047921,0.086175,-0.278755,-0.045365,0.123885,-0.184203,0.196427,-0.004445,0.062692,0.049139,
  0.042708,0.137667,-0.25662,0.083362,0.104321,0.124092,0.068975,-0.106787,0.235856,0.047117,0.038217,0.100415,0.223961,-0.033163,-0.014981,-0.002237,
  0.074313,-0.18447,0.203712,-0.063977,-0.106069,-0.139609,0.218535,-0.165839,0.237946,0.017028,-0.048425,-0.067711,-0.149326,0.061298,0.273153,0.072547,
  0.137193,0.015049,0.033872,-0.057425,0.211321,-0.108231,0.229444,0.031371,0.057188,0.037516,0.029653,0.132936,-0.059273,-0.037365,-0.026374,0.204505,
  0.123123,0.112858,0.084817,-0.160403,-0.002883,0.047882,0.266663,-0.027175,-0.118324,0.12456,-0.055469,0.069956,-0.077283,-0.138015,-0.073203,-0.010261,
  0.123227,-0.035158,0.081683,-0.066688,-0.167863,0.127134,0.127322,-0.194224,0.028522,0.134337,0.054119,-0.05296,0.006513,0.13624,-0.207391,0.21178,
  0.111596,-0.003922,0.029001,-0.197344,0.122451,-0.043228,-0.07487,0.17784,0.114142,0.115804,-0.15813,-0.052404,-0.087087,0.18943,0.171276,0.105773,
  0.040023,-0.083138,-0.072463,0.135607,0.46744,0.099743,-0.112477,-0.052892,-0.140221,-0.024942,0.011883,0.063352,0.049967,-0.007052,-0.050341,0.002863,
  0.035555,0.0147,0.100548,-0.04223,0.042134,-0.067829,-0.041812,-0.078869,-0.394323,0.179906,0.129637,0.047157,-0.194705,0.037108,0.064449,0.191894,
  0.159489,0.344247,-0.163247,0.293521,0.091716,0.136242,-0.010424,0.029076,0.132582,0.001106,-0.00891,-0.065589,-0.0567,0.042175,0.051132,-0.151723,
  -0.185627,0.021391,0.05772,-0.107138,-0.297818,0.040708,0.025775,-0.044988,0.356386,-0.174938,0.137028,-0.190978,-0.079992,-0.07614,-0.151951,0.398727,
  -0.222571,-0.081983,-0.153999,-0.495894,0.170703,0.103813,-0.017748,-0.060069,0.120527,-0.170282,0.006203,0.193054,-0.103065,0.006783,0.364155,-0.248314,
  0.012365,0.131644,-0.01555,-0.118559,0.011093,-0.234566,-0.103794,0.058922,0.066304,0.021402,0.124638,0.199293,-0.009892,0.018558,-0.055227,-0.095637,
  0.1006,-0.056904,0.102509,-0.097548,-0.16312,-0.24644,0.053525,-0.087985,0.257169,-0.14664,0.159833,0.249545,0.117496,0.424051,0.15791,0.078168,
  0.23759,0.043348,0.13577,-0.097177,0.205834,-0.017892,-0.037489,-0.045111,0.110127,0.122843,-0.194956,-0.051857,-0.084906,0.028587,0.110075,0.057819,
  -0.227617,0.186038,-0.070601,0.102921,0.178572,0.020583,0.084807,0.24937,0.336935,-0.156773,-0.209748,0.164419,0.041437,0.054865,0.083418,-0.268134,
  0.01835,0.3109,0.080148,-0.292869,-0.013107,-0.249624,0.052774,0.214961,-0.045026,-0.147196,-0.016502,0.020301,0.126772,0.01566,0.136218,-0.014523,
  -0.113181,0.031313,0.179802,0.304519,0.021748,-0.221606,0.136473,-0.202596,0.128974,0.324431,0.01175,-0.094097,-0.06924,0.156021,0.066631,0.057369,
  -0.242566,-0.263158,0.082489,0.274178,0.111404,-0.04734,-0.053722,0.183313,0.11506,0.458901,0.165932,0.103643,0.165155,-0.129389,0.108173,0.030912,
  -0.041097,-0.049275,-0.044234,0.206114,0.216834,0.026496,-0.044073,-0.117768,0.101188,-0.086122,0.050626,0.015543,-0.083579,0.047146,0.265658,0.110068,
  -0.147321,0.124068,0.048411,0.156616,-0.047327,-0.103875,0.048432,0.167079,-0.02982,0.020041,-0.061373,-0.035818,0.047782,0.090457,0.038209,-0.164425,
  -0.1612,-0.013872,0.273196,0.038358,-0.007351,-0.103647,0.093237,0.075898,0.333202,0.172131,0.032848,-0.222281,-0.00693,-0.013317,0.282612,0.126687,
  0.000137,-0.020772,-0.16813,-0.105393,0.139904,-0.095715,-0.020528,-0.243683,0.020324,-0.027296,0.090097,0.041266,-0.129351,-0.102434,0.107737,-0.114979,
  0.110835,-0.060537,0.108392,0.169065,0.076129,-0.013412,0.159818,0.016859,0.255534,0.116514,0.089879,0.223239,0.114398,-0.167365,0.27271,0.138146,
  -0.049266,0.185881,-0.312935,0.034765,0.076815,-0.058174,0.097009,-0.068336,-0.010557,0.067275,0.025777,0.096314,0.048628,0.123301,0.232706,0.263149,
  -0.031127,-0.121748,-0.063413,-0.011151,0.082827,0.099182,0.00125,-0.192035,-0.085239,0.118928,-0.142797,-0.025796,0.245366,0.073151,-0.08788,-0.119151,
  -0.007744,0.217453,0.038278,0.137262,-0.05669,-0.010127,0.07073,0.012979,0.03037,0.109622,0.063809,0.146466,0.137379,0.089216,0.033613,0.081829,
  0.080948,-0.035933,0.25701,-0.012283,0.137053,0.026079,-0.237186,0.038919,0.007233,0.129018,0.049523,0.1635,-0.141972,-0.000099,0.068541,-0.086505,
  0.284747,-0.196997,0.22773,0.323352,-0.013431,-0.208766,-0.132829,-0.074146,-0.005072,0.184256,-0.036847,-0.011007,-0.223028,0.069623,0.11758,0.004287,
  0.068281,-0.014497,0.140602,0.008066,-0.033605,0.086583,0.141954,0.059634,0.232638,0.004817,0.227604,0.08831,0.141897,-0.211777,-0.025257,0.216811,
  -0.131638,0.27112,-0.111228,-0.172998,-0.063589,0.182118,0.090233,0.098929,-0.040283,-0.006336,-0.270862,0.091016,0.1001,0.191659,-0.108384,-0.122747,
  -0.124232,-0.038024,-0.00844,0.063135,0.079876,0.048025,-0.073429,-0.083597,0.321103,0.156478,-0.159449,0.055817,-0.050203,-0.013741,0.31841,0.196692,
  0.073984,-0.11818,0.01651,0.088508,0.1312,-0.049206,0.025182,0.270474,0.04149,0.057806,0.170953,0.125773,0.108982,-0.428161,0.501593,-0.035524,
  -0.229812,-0.062461,0.124928,0.071849,-0.198539,0.021828,0.015555,-0.015806,0.12291,-0.155494,-0.071056,-0.10351,-0.376223,0.285575,-0.012232,-0.309168,
  -0.163037,-0.054532,0.059355,-0.15631,-0.007488,-0.093043,0.096893,-0.017635,0.229107,0.054752,0.430329,0.022831,0.019911,0.01221,0.230391,-0.321197,
  -0.067483,0.173704,-0.030813,0.008768,-0.140686,-0.006771,-0.139564,0.085783,0.131765,0.157433,-0.156106,-0.144944,-0.175705,0.089021,0.032312,0.253304,
  -0.264218,0.016791,-0.164803,0.075411,-0.095075,0.065935,-0.224484,-0.072137,-0.007324,0.095406,-0.055471,-0.01348,-0.003295,-0.207779,0.024338,0.220557,
  -0.01131,-0.040829,-0.045666,-0.009792,-0.047667,0.019947,-0.141142,0.112932,0.098531,-0.155702,-0.06235,0.020026,-0.24086,0.047655,-0.156088,-0.029996,
  -0.012707,0.112406,-0.047265,-0.247277,-0.12398,-0.035475,0.076738,0.196647,-0.02042,-0.212485,-0.026959,0.000509,-0.032713,0.041008,-0.09608,0.057868,
  0.077416,-0.063487,0.009248,-0.131312,-0.014471,-0.038847,-0.23589,0.060778,-0.235116,0.002525,-0.034374,0.065507,0.047786,-0.140224,0.074648,-0.154519,
  -0.063424,-0.051858,-0.112917,-0.169478,0.07843,0.118349,-0.032771,0.02241,0.063097,-0.040755,-0.027059,-0.009486,-0.030183,-0.052684,-0.036807,-0.041972,
  0.112568,-0.04201,0.056222,-0.015798,-0.083734,-0.107573,-0.065848,0.051922,0.168877,-0.107143,0.031732,0.087719,-0.044237,0.259588,0.011598,-0.176822,
  -0.087824,-0.025342,-0.044488,-0.030542,-0.035881,-0.059793,0.077038,-0.013054,0.084323,-0.177662,0.100376,0.090573,0.021363,-0.137889,0.002029,-0.040591,
  -0.169648,0.100885,-0.083715,-0.079903,0.099416,0.117757,0.031451,0.151117,0.058442,0.148265,-0.18171,0.025129,-0.032957,0.030822,-0.015311,0.079303,
  0.052091,0.123447,-0.072098,-0.068652,0.054241,-0.012486,-0.0877,-0.059705,0.104262,-0.114962,0.056872,-0.079227,-0.093722,0.030255,-0.238218,0.264626,
  -0.105171,-0.017901,-0.09722,0.224062,-0.063371,-0.121713,0.051567,-0.091224,0.067517,-0.022443,0.002278,-0.123503,0.094656,-0.169294,-0.045749,0.106478,
  0.060947,-0.005408,-0.046666,-0.151013,-0.108636,-0.146436,0.076293,-0.164829,-0.252168,0.12763,0.068211,0.047908,-0.118845,0.042705,0.104772,-0.046088,
  0.293642,0.110498,-0.006141,0.018687,0.104715,0.215198,0.020994,-0.047526,0.230854,-0.094183,0.122049,-0.055241,-0.008203,0.072597,0.100178,0.153761,
  -0.129105,-0.051451,-0.300395,0.031814,-0.19691,0.136036,-0.111743,0.125776,0.133838,-0.308571,0.275142,-0.12223,0.098991,-0.106475,-0.062149,0.285482,
  -0.127611,-0.138356,-0.036531,-0.1896,-0.134249,0.103184,0.151096,0.231216,0.097741,-0.332667,-0.110004,0.012097,0.188564,0.058663,-0.010191,-0.10409,
  -0.176691,0.190089,0.094647,-0.014375,0.078885,-0.233692,-0.079865,0.058007,0.346608,0.077517,0.128301,-0.069717,0.014468,-0.069687,-0.00217,0.143611,
  0.107017,0.169904,-0.002606,0.139565,0.264567,-0.016515,-0.098482,-0.061225,0.141139,-0.157378,-0.005566,0.090247,-0.021632,-0.465912,0.015436,-0.016422,
  -0.119552,-0.036511,-0.031651,0.130866,0.312093,-0.081712,-0.08465,-0.003825,-0.075407,0.138355,0.01341,0.024528,-0.057221,0.060176,0.361092,-0.047301,
  0.039085,0.021519,0.05674,0.029985,0.070953,0.096013,0.009388,0.155688,0.088055,0.079958,-0.144064,-0.073708,0.152551,-0.084822,-0.245671,0.23022,
  0.041439,-0.010651,-0.146087,0.135307,-0.021954,-0.072694,0.126127,0.13609,-0.133282,0.054119,-0.052929,0.073015,0.125644,0.098068,0.179271,0.135895,
  -0.115072,-0.171285,0.063126,-0.018851,-0.066138,0.22874,0.353637,-0.093403,0.044356,-0.069927,0.117645,0.017517,-0.033948,0.162918,-0.015424,0.018275,
  0.02999,0.253082,0.026516,0.105064,-0.145958,0.001426,0.051976,0.048404,0.031888,0.11401,-0.390715,0.078503,-0.11032,0.14476,-0.096537,-0.030558,
  -0.171358,0.119329,0.109711,0.072423,-0.156632,-0.00547,0.069661,0.064445,-0.051075,0.161723,-0.008072,0.261728,0.005339,-0.104106,0.01682,-0.121391,
  -0.119533,-0.250838,-0.016243,0.060196,0.128437,0.160761,0.091551,-0.162603,0.179386,0.053451,-0.129363,0.456084,0.234576,0.082433,-0.00484,0.298006,
  0.015022,0.180209,0.069208,0.005333,0.043549,0.057527,0.233714,0.102327,0.174938,-0.004207,0.001724,0.07617,0.074772,-0.071643,0.02412,0.001187,
  0.022076,0.001101,0.151454,-0.045538,-0.120631,-0.187954,0.11084,0.142723,0.177878,0.141847,0.083519,-0.187836,0.049642,0.232477,-0.49146,0.168312,
  0.324127,0.236365,-0.104342,-0.236557,-0.043496,0.151707,-0.174965,-0.033589,0.40112,0.177373,0.059479,-0.634521,-0.047593,-0.056437,-0.049573,0.093886,
  -0.381432,-0.123966,-0.080403,-0.041089,-0.167801,-0.240324,-0.026904,-0.344978,0.440128,-0.230873,0.063813,0.12372,-0.551605,0.285666,-0.053754,-0.364583,
  0.1587,0.378164,-0.076835,0.003641,-0.095415,0.056581,-0.061586,-0.337895,0.096557,0.104816,-0.000674,0.26084,-0.030362,-0.560106,0.08084,0.048814,
  -0.030243,0.065722,0.243499,-0.574315,0.001437,0.212859,-0.037226,0.08718,0.201659,-0.61275,0.026714,0.040482,0.00829,0.082255,-0.005173,-0.367604,
  -0.185855,-0.009291,0.104137,-0.133903,0.127311,-0.106831,0.147649,-0.091026,-0.155512,-0.151132,0.008815,0.166399,-0.148261,-0.010067,-0.061182,0.171586,
  -0.082352,0.09869,0.120564,0.11659,-0.020864,-0.200441,-0.170395,-0.116136,0.204477,-0.049442,-0.080469,0.054772,0.162816,-0.035917,-0.114014,0.080634,
  0.160954,0.050027,-0.067798,-0.008296,0.142028,-0.026042,-0.129346,0.108843,0.01569,0.250184,-0.291044,0.328341,0.054767,0.180088,0.00482,-0.156217,
  0.365521,0.137041,0.116294,0.450861,0.351417,-0.06388,-0.070691,0.004369,-0.232989,0.147382,0.398933,0.03098,-0.137181,0.035186,-0.050495,0.280716,
  0.048011,0.246648,-0.077772,0.159861,-0.144073,0.155794,0.385444,0.051325,-0.017374,-0.036376,-0.052038,0.182071,0.211273,0.071304,-0.078119,-0.025992,
  -0.007831,-0.038989,-0.004361,-0.118303,-0.151001,0.066386,-0.013928,0.268684,0.320682,-0.011067,0.057464,-0.068353,0.060232,0.178755,-0.203554,-0.183278,
  0.092728,0.267277,0.029154,0.09617,0.03438,0.031129,-0.088522,-0.154638,-0.122341,-0.024367,-0.18975,-0.080911,0.121143,0.025484,0.198213,0.046724,
  0.069033,-0.103163,-0.059692,-0.075387,0.048794,0.062677,-0.041834,-0.097214,-0.369671,-0.108412,-0.220765,-0.256188,0.029229,-0.357522,0.117161,0.210492,
  0.042929,0.017552,-0.302809,0.031708,0.036932,0.164805,0.083724,-0.245723,-0.339474,0.024472,0.125939,0.416281,0.041343,0.234249,-0.064447,0.18528,
  -0.099625,0.368503,0.00954,-0.149809,0.29379,-0.156937,-0.03357,0.369471,0.0036,-0.087215,-0.112337,0.108194,-0.012485,0.20583,-0.114557,-0.010514,
  0.202642,0.019993,0.205495,0.174633,0.01038,0.11552,-0.125581,0.14044,0.177419,-0.472359,0.096849,-0.196789,-0.229227,-0.235901,0.135284,0.162815,
  -0.118027,0.06867,0.18214,-0.00637,-0.114345,-0.226636,0.005466,-0.039743,-0.049391,-0.05501,0.103741,-0.117124,0.27604,0.047568,-0.047291,-0.046663,
  -0.208677,0.187502,-0.017776,0.179995,-0.795536,0.197374,0.213755,-0.093801,0.216948,-0.017772,-0.06756,0.499629,-0.015249,-0.03397,-0.126563,0.097885,
  0.001811,0.412455,0.06792,0.038216,-0.07157,0.264739,-0.13439,0.328751,0.045035,-0.201425,-0.188572,-0.12677,-0.204584,0.284147,0.062861,-0.047405,
  0.198029,0.070807,0.127515,0.327634,0.090598,0.116646,0.090506,-0.074941,-0.002909,-0.152051,-0.057482,0.078793,-0.109243,0.023333,-0.193755,0.089571,
  -0.117659,0.15889,0.066588,0.245789,0.068998,0.207969,0.459693,0.108012,-0.283561,-0.281696,-0.083744,-0.137432,0.136255,0.184129,-0.210616,-0.061803,
  -0.134742,-0.291462,0.136291,-0.105646,-0.061563,-0.037389,0.042818,0.140672,0.099423,-0.079597,-0.1803,-0.089714,-0.14486,0.208205,-0.324271,-0.138905,
  -0.149513,0.154236,0.005131,-0.068341,0.143287,-0.011274,0.230669,0.109559,0.075473,0.145356,0.079895,0.018144,-0.254082,-0.154986,0.297851,0.269916,
  0.074888,0.147117,0.060097,0.16507,0.070349,0.052277,-0.135362,-0.066878,0.03605,0.113878,0.138247,-0.032815,-0.205942,0.043104,0.073518,-0.245788,
  0.300566,0.051121,-0.065904,-0.160039,0.127095,0.017762,-0.046187,-0.147601,0.368348,0.291835,0.050018,0.224281,0.063789,0.061751,0.306495,0.147832,
  -0.035608,-0.450231,0.091021,0.016634,0.017377,0.007535,0.015216,0.021685,-0.038242,-0.118702,0.133683,-0.101182,-0.060815,-0.279207,0.077098,-0.131578,
  -0.063774,0.005525,-0.359706,-0.177908,0.103163,0.109195,0.014359,0.055491,-0.260193,0.132676,0.041345,0.006679,-0.06767,0.083446,0.129521,-0.022891,
  -0.252899,-0.005459,-0.251133,-0.10366,-0.045311,-0.128726,0.057803,0.232916,-0.073247,0.05861,-0.036079,0.00236,-0.051852,0.032749,-0.13472,-0.036096,
  -0.293232,0.030317,0.019155,0.070094,0.091628,0.120249,-0.078399,0.056661,-0.176257,0.002731,0.009736,0.229891,0.005751,-0.059217,-0.033037,0.062155,
  -0.077578,0.215279,-0.108624,0.06588,0.085295,0.171913,-0.130714,-0.01787,0.140335,-0.056024,-0.072895,0.090363,0.154561,-0.102061,-0.128275,0.088996,
  -0.098836,-0.035279,-0.098205,0.039511,0.292521,-0.099498,0.011681,-0.245973,0.11889,0.045635,0.106832,0.026157,0.129279,0.031545,0.211516,0.320973,
  0.114638,0.074734,-0.022691,0.13101,-0.056636,-0.091038,-0.205913,0.036502,0.249694,0.010803,0.144404,0.013548,0.291665,0.033482,0.020061,0.382667,
  0.278159,0.10709,0.160134,0.188052,0.044846,0.206205,0.167618,0.26543,-0.176481,0.128541,0.048759,-0.035405,0.012978,0.196214,0.055816,-0.009183,
  -0.122296,-0.136554,0.098187,0.073431,-0.108627,-0.029001,-0.053739,-0.190389,0.055946,-0.02209,-0.03812,-0.283581,-0.027063,0.168007,0.219836,0.151494,
  -0.206238,0.01557,0.069941,-0.060482,0.175927,0.040487,-0.075719,-0.244648,-0.049667,0.121101,0.012764,-0.060653,-0.059069,0.094431,-0.02095,-0.243353,
  0.099915,0.083931,0.172653,-0.035223,0.015547,0.013759,0.105458,-0.017677,-0.146267,-0.091747,-0.042258,0.023588,-0.113443,-0.022305,-0.068068,-0.034842,
  0.124089,0.103016,-0.026385,0.103981,-0.087407,-0.184251,0.09549,-0.025303,-0.098564,0.13871,0.037977,-0.127752,0.01961,0.107725,-0.085121,-0.199781,
  -0.059963,-0.035747,-0.056097,0.103505,-0.075079,-0.07806,-0.194611,-0.162447,-0.138005,0.016198,0.161673,0.001173,-0.0569,0.027746,-0.227454,-0.125547,
  0.03951,-0.122576,-0.018588,0.232801,-0.414942,-0.203266,0.170084,0.004483,-0.03968,0.062289,-0.196237,0.054531,0.059808,-0.016212,0.169828,-0.112318,
  0.066767,-0.055554,-0.100504,-0.029389,-0.119538,-0.037686,-0.118494,-0.137431,-0.087074,0.184611,-0.121871,0.071991,0.011813,-0.233933,-0.183065,-0.066154,
  0.009474,0.171572,0.027597,-0.044171,-0.194928,0.04891,0.099543,-0.052434,0.195009,-0.178167,0.052384,-0.099744,-0.121512,-0.030072,-0.130303,-0.105616,
  -0.005444,0.028517,-0.051878,-0.016004,-0.084651,-0.013279,-0.180031,-0.13109,0.076926,-0.005975,0.025526,-0.028332,-0.044107,0.020079,-0.035998,0.15064,
  0.05672,-0.045374,0.017524,-0.012966,-0.123735,0.084758,-0.004455,-0.255188,-0.081786,0.076731,-0.075103,0.077965,-0.183802,0.028917,-0.23372,-0.095854,
  -0.188645,-0.120784,-0.019877,0.039936,0.078472,0.050726,-0.13193,-0.104028,0.189017,0.097476,0.029758,-0.143815,-0.087933,0.052462,0.081989,0.107591,
  0.087167,-0.341964,0.239144,0.174196,-0.3209,-0.083675,0.023277,0.059589,-0.066475,-0.125093,-0.057551,-0.259747,0.246342,0.417886,0.028602,-0.026084,
  0.111006,0.229029,-0.066067,0.359963,0.151297,-0.030482,0.084389,-0.072022,-0.014328,-0.251579,-0.033951,-0.128142,-0.433163,-0.183167,-0.305858,-0.237147,
  -0.223377,-0.089275,-0.130285,0.246921,0.033224,0.092538,0.055141,0.114805,-0.482144,0.231133,-0.059321,0.03947,-0.028177,0.18968,-0.247092,0.367002,
  0.002427,0.220159,-0.083985,0.113169,-0.121353,0.389728,0.017396,0.00621,0.175777,0.083417,-0.216836,0.286057,0.177795,0.161042,0.033037,0.170054,
  -0.135758,-0.041059,0.006145,-0.082482,-0.104862,0.163285,0.140805,0.13244,-0.132287,-0.110372,0.09752,0.036729,0.071702,0.463405,-0.163387,-0.110108,
  0.338758,0.090087,-0.007403,0.016045,-0.02503,0.154497,0.090892,0.078223,0.099441,-0.103325,0.009966,-0.116179,0.124724,0.002804,-0.006737,-0.011918,
  -0.08433,-0.031069,0.093902,-0.073695,0.254218,0.029275,0.085313,-0.045893,-0.310046,0.100404,-0.103832,0.078251,-0.055285,-0.077886,0.06428,-0.078744,
  0.007237,-0.025221,-0.025405,0.004234,0.07769,-0.058424,-0.028284,0.057573,0.123351,0.095447,-0.052164,0.12972,0.15294,-0.019939,0.062453,-0.028,
  0.185075,-0.010751,0.028952,0.010386,-0.11617,-0.062377,0.106235,0.288426,0.058194,0.133961,-0.07767,0.142693,-0.021663,0.065387,0.028527,0.148809,
  -0.070497,0.068073,-0.033395,0.067811,0.031753,-0.057413,-0.113206,-0.000462,-0.069791,0.113041,0.342021,0.279622,-0.136135,-0.188659,-0.190483,-0.136818,
  0.108732,-0.062572,0.101706,0.016429,-0.025939,-0.269668,0.157792,0.072783,0.103896,0.002853,-0.265761,0.435082,0.167188,0.028651,0.2435,-0.220521,
  -0.033779,0.020167,-0.272172,0.359063,0.021511,0.01408,-0.012087,0.043662,0.162527,-0.217971,-0.069759,0.41794,0.221304,-0.048632,0.115692,0.115372,
  -0.1093,0.121678,0.345143,0.075094,0.236654,-0.157403,0.034503,0.3759,0.188933,0.164085,0.162642,-0.097126,0.041591,0.16691,0.114326,0.052351,
  0.217528,-0.017766,-0.139642,-0.130948,0.213907,0.056855,0.176212,-0.166916,0.039403,0.123305,0.002387,-0.18607,-0.021474,0.0038,0.2103,-0.02906,
  0.155387,-0.185832,-0.126466,0.093414,-0.175643,0.074865,-0.152313,0.065936,-0.063015,-0.129288,0.115857,-0.199718,-0.053951,0.017465,0.072656,0.105647,
  -0.066617,-0.085513,-0.080769,-0.055548,-0.128747,-0.077664,-0.073868,-0.07215,-0.042007,-0.10309,0.040622,-0.010955,-0.02096,0.120734,-0.1768,-0.059579,
  0.018119,-0.112939,0.25215,-0.143491,0.057468,-0.057879,-0.129945,-0.016714,-0.047107,0.029999,-0.030583,-0.013462,0.001587,0.064841,-0.141582,0.083357,
  -0.067419,0.176534,-0.083371,0.019587,-0.139999,-0.052522,-0.03767,-0.067997,0.11866,0.106663,-0.22396,-0.021064,-0.08439,-0.14621,-0.014542,0.067785,
  -0.033791,0.111819,-0.004731,0.032806,-0.160186,0.00092,-0.059901,0.021767,0.217786,0.089742,-0.351876,-0.238268,0.014128,0.091592,-0.174774,0.074924,
  0.112929,-0.234571,-0.391433,-0.201337,-0.065104,-0.024498,-0.08317,-0.026477,0.067171,0.116422,-0.036431,-0.138932,-0.098156,-0.177603,-0.07024,0.330166,
  -0.214848,-0.1596,-0.062481,-0.173879,0.10304,0.085288,0.023404,0.136002,0.104226,-0.071228,-0.138676,0.242607,0.404615,0.241891,0.100054,0.0356,
  0.258009,0.08388,-0.138709,0.815426,0.134791,-0.000784,-0.261682,0.155557,0.151283,0.461457,0.137215,0.019354,0.002717,0.145448,0.16618,0.36916,
  0.269387,0.047958,-0.261726,0.085328,0.138813,0.247776,0.135053,-0.046324,-0.066113,0.172392,0.05224,0.032272,0.075163,-0.032912,-0.010989,-0.010114,
  0.204752,0.186989,-0.044173,-0.022595,-0.305578,0.120008,0.087871,0.035703,0.380369,0.364476,-0.29209,0.006583,0.145938,0.211177,-0.166249,-0.399272,
  0.049003,-0.046967,0.173716,-0.348583,0.122156,0.124879,-0.036508,0.236849,-0.044744,0.158616,-0.087099,-0.055918,-0.052287,-0.196985,0.4197,-0.166885,
  0.318975,-0.023263,0.182229,-0.094116,-0.531847,0.190714,-0.045999,0.0246,-0.073474,-0.254116,0.010136,-0.267891,-0.03753,0.016724,0.114997,-0.653023,
  -0.032032,-0.114736,0.124275,-0.085857,0.096935,-0.585782,0.034724,0.107218,0.000049,-0.086267,0.3927,-0.379331,-0.181509,-0.031782,0.030197,-0.146112,
  0.049711,-0.151504,0.031813,0.110617,0.075343,0.340499,0.243868,-0.120276,0.061545,0.274671,0.227895,-0.143324,-0.11016,-0.002618,-0.081453,0.151874,
];
const B1 = [
  0.041228,0.16196,0.01143,0.002572,0.047116,0.02696,0.054485,0.069245,0.049041,0.051371,0.048428,0.142745,-0.024621,0,0.052184,0.049079,
  -0.025808,-0.005198,0.029472,0.03478,0.050998,0.037092,0.141056,0.016616,-0.028002,-0.028195,0.04635,0.090808,-0.016762,-0.041123,-0.004359,0.059757,
];
const W2 = [
  0.137515,0.156665,0.09304,0.132659,0.129343,0.042248,0.024748,0.1051,-0.091069,0.246137,0.362586,0.260252,0.136903,0.042272,0.105691,0.269656,
  -0.023661,-0.387288,0.036795,0.271689,0.188901,0.032848,0.244362,0.081021,0.018795,0.038664,-0.120394,0.156844,0.01655,0.058337,0.174036,0.280516,
  0.107849,-0.077,0.271097,0.173307,0.160242,-0.03981,-0.057241,-0.02478,-0.186818,0.010465,0.428188,0.019343,0.09374,0.187501,-0.093473,0.137802,
  0.077954,0.38846,-0.017058,0.175089,-0.024427,0.069301,0.141364,0.02539,-0.080072,-0.11295,0.22547,-0.118097,-0.15864,0.109636,-0.146126,0.469096,
  0.108774,-0.039821,0.037281,0.03825,0.029291,-0.070963,-0.034512,0.011212,0.140449,-0.060763,-0.209787,-0.142279,-0.056991,-0.123955,-0.13427,0.03826,
  -0.148541,-0.100298,0.034182,0.294613,-0.128773,-0.035009,-0.055893,-0.016095,0.124531,0.040128,-0.054246,-0.133939,-0.084278,-0.088676,0.03276,-0.085704,
  0.016381,0.095346,-0.003544,-0.008797,0.083138,0.021518,0.097751,-0.207628,0.03774,-0.107747,-0.045224,-0.056892,-0.080358,-0.147465,-0.173669,0.101906,
  -0.102396,-0.023153,-0.139243,-0.133228,-0.071938,-0.140531,-0.050731,-0.069861,0.088472,-0.050578,0.000061,-0.095724,-0.130813,0.134205,0.095301,-0.042471,
  -0.108984,0.013971,0.152319,-0.157539,0.036949,0.057657,0.012903,0.055087,-0.10384,-0.160835,-0.064764,0.318662,0.033305,0.072835,0.039674,0.123895,
  0.07991,0.458271,-0.005017,0.071314,-0.275382,0.028863,0.123883,0.044987,0.002739,-0.023143,-0.10669,-0.02964,-0.36606,-0.032158,0.160829,0.267741,
  -0.021744,0.008793,-0.007387,-0.054477,0.057153,-0.031424,-0.079156,-0.045143,-0.087621,-0.126161,-0.097381,-0.096777,0.006889,-0.084122,-0.010848,-0.004774,
  0.087839,-0.317058,0.035202,-0.035415,0.053547,0.06575,-0.085191,-0.167052,-0.046392,0.044076,0.068366,-0.053187,-0.196612,-0.074486,0.025043,0.103735,
  -0.19876,0.268438,0.031616,-0.206671,-0.075289,-0.029757,0.099977,0.247013,0.149461,0.074629,0.205534,0.18782,0.072561,-0.038624,0.079947,-0.185916,
  -0.12879,-0.200541,-0.007018,-0.078565,-0.333647,0.110806,-0.139748,-0.055557,-0.018296,0.033934,0.100668,0.147133,0.052835,-0.134705,-0.382049,0.010037,
  0.08571,-0.029146,0.052626,0.054993,-0.027942,-0.208853,-0.024,0.098681,-0.028179,-0.108878,-0.132802,-0.003581,-0.019102,-0.02832,-0.196423,0.005133,
  -0.015659,-0.060387,0.146984,-0.090033,-0.234005,0.205185,0.056055,0.012229,-0.104105,0.088605,0.06452,-0.060349,-0.157602,0.09429,-0.098773,-0.048633,
  -0.09792,0.113835,-0.053902,0.003193,0.093852,0.05905,-0.052647,0.021846,0.069274,0.076936,-0.045668,0.478748,-0.18764,0.161332,0.034363,0.106643,
  0.00388,-0.442525,0.180888,0.101012,0.202889,-0.058414,0.127996,0.012627,0.189347,-0.059857,0.203153,-0.176952,0.015813,0.080138,-0.014904,-0.096599,
  0.030213,-0.082658,0.296301,0.108034,0.09128,0.039069,-0.017743,-0.055998,-0.037524,-0.019622,0.035072,-0.172005,0.20132,-0.033491,0.106428,0.270608,
  0.074245,0.201758,0.03961,-0.13009,-0.205927,0.04569,-0.017974,0.37187,-0.119268,-0.126932,0.172028,-0.09048,0.155035,-0.300541,0.106072,-0.200699,
  -0.280513,0.328319,-0.101005,-0.278111,0.216585,0.168305,-0.046616,0.072962,0.064375,0.037859,-0.072129,-0.020197,-0.00096,-0.026997,-0.049019,-0.112638,
  0.034293,-0.260261,0.289548,0.123019,-0.040774,0.133838,-0.114903,0.057927,0.10418,0.132192,-0.100408,0.1404,0.091176,0.112907,0.032596,-0.201894,
  -0.023786,0.028712,0.098188,-0.021612,-0.022794,0.032743,-0.045418,0.020324,0.064484,0.047437,-0.022405,0.217126,0.050435,0.119441,0.067199,0.274265,
  -0.084535,0.012134,0.060594,-0.018556,0.227643,0.161258,0.200211,0.120118,-0.153854,-0.113827,0.054804,-0.134738,-0.036356,0.042886,0.113732,-0.125424,
  0.193321,-0.047767,0.109576,-0.04157,-0.00424,0.10075,0.179308,-0.051988,-0.013788,-0.058903,0.146413,0.071939,-0.105111,0.041046,0.059215,0.048711,
  -0.088246,0.158015,0.197274,-0.074233,0.155444,0.145075,0.146774,0.085766,-0.237256,-0.038811,0.333537,-0.063766,0.35962,0.003303,0.112286,-0.520227,
  -0.013269,-0.086889,-0.028755,-0.026975,0.024965,0.129668,-0.014489,-0.092363,-0.036242,0.072325,-0.070783,0.034615,-0.122932,-0.065033,-0.04445,-0.080389,
  -0.00903,0.021809,-0.213876,-0.145218,0.085952,0.144899,-0.20976,-0.379886,-0.212134,0.168925,-0.174153,-0.191739,0.069966,-0.101638,0.039047,-0.062118,
  -0.109982,-0.065405,-0.143585,-0.01243,0.075191,0.210669,0.305053,0.253735,0.45267,0.12378,0.078726,-0.253584,-0.134611,0.040747,0.012525,-0.177755,
  0.190579,0.27154,0.172321,0.076132,-0.004569,0.220363,0.010475,0.026712,0.049119,0.021685,0.001603,0.047035,0.211358,0.080238,0.123294,-0.12181,
  0.083932,0.028164,-0.1142,0.047127,0.156565,0.135949,0.002031,0.176875,0.160451,0.087107,-0.121011,-0.102616,0.045977,0.201759,-0.009659,-0.158012,
  -0.00971,0.066702,0.086854,0.310938,-0.105688,0.034111,0.061302,0.075782,0.009221,-0.056752,-0.195576,0.168278,0.372727,-0.083299,-0.086528,0.07167,
  0.118883,0.011148,0.151256,0.139013,0.302986,-0.021476,0.019206,0.203959,0.043182,-0.005912,-0.017626,-0.112005,0.162692,-0.018011,0.210003,-0.076545,
  0.100711,0.382461,0.180782,0.059155,0.093892,0.077283,0.07488,0.2019,0.071231,-0.021374,-0.190381,0.344703,-0.028021,-0.192671,0.229152,0.034719,
  0.07131,0.082631,0.080884,0.158304,-0.056486,-0.019186,0.246119,-0.043544,-0.143685,0.189331,0.119252,0.065913,0.084132,-0.076644,0.239088,0.210857,
  0.206279,-0.363024,-0.069804,0.035397,0.075388,-0.145232,0.156148,0.056961,0.029407,-0.015477,-0.223713,0.11151,-0.028134,-0.001418,0.127594,0.188021,
  0.168064,-0.091377,0.281318,0.012545,0.02773,-0.014945,-0.071255,0.095375,-0.0302,0.019,0.26998,0.009072,-0.045003,-0.139967,0.102727,0.063774,
  0.274591,0.482421,0.012879,-0.126766,-0.071294,0.093404,-0.083019,0.028606,-0.048548,0.024886,0.362624,0.003184,0.210367,0.117278,-0.027959,0.022524,
  -0.378866,0.25117,0.054584,-0.110958,0.040124,0.020865,0.254592,0.122697,0.065156,0.030348,-0.179447,-0.220989,-0.112509,-0.040885,-0.079683,-0.178322,
  0.038072,-0.36856,-0.128747,0.226546,-0.119327,0.045551,-0.132589,-0.013818,-0.00613,0.036021,-0.481655,0.260577,-0.152108,0.092761,-0.061527,0.169632,
  -0.100187,-0.057015,-0.206929,0.023253,-0.048882,0.010265,0.049483,-0.060672,-0.159851,-0.06942,-0.060749,-0.136825,0.110384,0.085681,-0.124503,0.108333,
  -0.150461,-0.050879,-0.012021,-0.138583,-0.091792,-0.076649,-0.112526,-0.083687,-0.014858,-0.028336,-0.123177,0.145531,-0.158203,0.059128,0.274061,0.004389,
  0.247986,0.04722,-0.101349,0.067979,-0.084674,0.099261,-0.034268,-0.115644,-0.078591,0.027502,0.119319,0.056898,-0.106591,0.111857,0.0937,0.098589,
  -0.153197,-0.044311,0.029636,0.029146,-0.001107,0.060172,0.26763,0.060109,0.140871,-0.043373,0.184363,0.111412,-0.168709,-0.035699,0.0345,0.403506,
  -0.080808,-0.112108,0.155598,0.016873,0.089853,-0.099936,-0.007089,-0.201913,-0.155456,-0.025679,-0.049292,-0.179807,0.058556,0.018496,-0.182257,0.032076,
  -0.206997,-0.222408,-0.028577,-0.200707,-0.111102,0.099952,-0.059926,-0.058513,-0.046798,0.040653,-0.200619,0.040154,0.049215,0.006305,-0.040759,0.031431,
  0.014196,-0.192518,-0.033304,-0.074418,0.183002,0.33359,-0.127663,0.090936,0.046574,-0.017906,0.038963,0.106257,0.11026,0.130695,-0.124576,0.156781,
  -0.183122,0.299324,0.086796,-0.158929,0.25688,0.221532,0.107649,0.098532,0.152477,-0.032519,0.378404,0.064482,0.264958,-0.081382,0.010676,-0.36853,
  0.188649,-0.260183,0.040341,-0.034231,-0.231942,0.045459,0.073402,-0.008628,0.054621,0.224824,0.143366,0.300878,0.034743,-0.041888,0.137248,-0.017864,
  -0.028253,0.076431,-0.011793,0.078978,0.038893,-0.113763,0.186642,0.10687,-0.001718,-0.038085,0.098892,0.016655,-0.005227,-0.090375,-0.205324,0.043071,
  0.293605,-0.062369,0.066015,0.055158,-0.146487,-0.070334,0.028199,-0.070267,-0.042899,0.019383,-0.032568,0.023612,-0.157988,0.155042,0.123905,-0.195908,
  -0.117099,0.336432,-0.006259,-0.072644,-0.047075,-0.02051,-0.035427,0.184616,0.125576,-0.174502,0.130052,0.078181,0.11705,0.154564,-0.119386,0.145112,
  0.107882,0.21008,0.178197,0.020058,0.111013,0.11415,-0.042111,0.09747,0.0833,0.138088,-0.071995,-0.14158,0.010101,-0.181825,0.019534,0.09975,
  0.160018,0.229898,0.140623,0.049715,0.231328,0.09812,-0.032907,0.203978,-0.092845,-0.04172,0.132551,0.255332,0.133166,0.000257,0.243179,-0.185746,
  -0.151359,-0.079365,0.067921,0.00127,-0.022996,-0.034371,0.236083,-0.070129,0.219431,0.100738,-0.24401,-0.502188,-0.067865,0.04942,0.17814,-0.238231,
  0.207342,0.688176,0.0871,-0.079765,-0.253919,-0.010159,0.069753,0.00318,0.045378,0.177506,0.034003,0.080172,0.158857,0.061974,-0.038373,-0.073746,
  -0.050741,0.112976,-0.114272,-0.163858,0.080471,0.019273,0.313143,0.111666,0.099068,-0.018116,0.171797,0.16403,0.001395,-0.035538,0.176044,-0.057906,
  -0.304881,0.125326,-0.175775,0.012521,-0.27917,0.016974,0.0369,0.002585,-0.158998,-0.00714,-0.099851,-0.052831,0.007654,0.088973,-0.317228,0.558094,
  0.073088,0.125264,-0.202804,-0.001043,0.121144,0.27938,0.192759,0.145207,0.088651,0.095195,0.111775,-0.011997,-0.016293,-0.112829,0.154448,-0.114517,
  -0.023321,-0.343404,0.13821,0.087591,0.198296,0.259375,0.126498,0.212086,0.00197,0.079538,-0.074543,0.197744,-0.086047,-0.05151,0.100981,-0.093788,
  0.067911,-0.098442,-0.143823,0.061727,0.061152,0.057599,-0.177365,0.030807,0.172986,0.051273,0.149037,0.223522,-0.047345,0.029403,0.07283,-0.016021,
  -0.068827,-0.448687,-0.123793,0.036338,0.115081,-0.033851,0.17459,-0.083172,-0.024941,0.130177,-0.189847,-0.039495,-0.014641,-0.081738,0.028824,0.238439,
  0.156592,0.327155,0.167312,0.059608,-0.109142,0.001643,0.010335,-0.369512,-0.258904,-0.260869,-0.100125,0.095018,0.122758,-0.15937,-0.11827,-0.094101,
  0.071758,0.220298,-0.121904,0.053957,0.30859,0.281901,0.183648,-0.021308,-0.113758,-0.016319,0.059233,0.213954,-0.101109,0.224023,0.074972,0.253017,
];
const B2 = [
  0.15068,0.006653,-0.050164,0,0.097282,-0.02665,0.125855,-0.038921,0.114361,-0.015069,0.09419,0.10771,0.033138,-0.043387,0.042105,0.142689,
  0.067408,0.081254,0.014065,0.081295,-0.042523,0.092416,-0.024581,-0.047407,0.039758,-0.017768,0.030649,-0.049549,0.081309,0.132831,0.056192,0.12082,
];
const W3 = [
  -0.00628,-0.242713,-0.023137,0.086747,-0.031212,0.208652,-0.298132,0.014903,0.149646,0.05241,0.303078,0.116206,0.143218,-0.032696,0.050374,0.016667,
  -0.095636,-0.0609,-0.171671,-0.126789,0.135752,-0.106161,0.032326,0.121938,-0.087422,-0.244922,0.091717,-0.133864,-0.263455,0.073893,0.052164,-0.34012,
  -0.194802,0.104213,-0.082109,0.143943,0.218933,0.113988,-0.158284,-0.106074,-0.062144,0.121103,-0.078129,0.038824,0.191298,-0.153942,0.081247,-0.034607,
  0.031089,-0.061038,0.276842,-0.22636,0.008512,-0.075759,-0.206176,0.209361,0.011992,0.100574,0.085841,0.219115,-0.242961,-0.088542,-0.24076,-0.004986,
  -0.166403,-0.147141,0.055112,0.008035,-0.185919,-0.052932,0.255617,-0.066725,-0.207522,-0.121917,0.197978,-0.315822,-0.176085,-0.107526,0.225279,0.191492,
  0.17727,-0.145458,-0.043542,0.155452,0.186537,-0.11484,0.076052,-0.05947,-0.108345,-0.074958,0.02457,0.301228,-0.175398,0.098927,-0.142059,-0.061479,
  -0.025591,-0.210127,0.084022,0.054836,0.078421,-0.019239,0.406239,-0.055403,0.32287,-0.126344,0.02995,0.230293,0.180383,-0.025628,0.017232,-0.008984,
  -0.191972,-0.366835,-0.033984,-0.190582,-0.140359,-0.00581,0.014044,0.29266,0.086692,0.077918,-0.084235,-0.17862,0.217269,0.059144,0.109515,-0.123727,
  0.387586,0.100662,-0.176698,-0.025821,0.263554,0.019903,0.228103,0.047349,0.208235,0.157852,0.184879,0.465255,0.406637,-0.104235,0.312414,0.608084,
  0.391836,0.274017,0.335818,0.100991,-0.097556,0.588099,-0.004221,0.135141,0.422577,0.055527,0.274635,0.140401,0.136017,0.372989,0.056386,0.046385,
];
const B3 = [
  0.00119,-0.117362,-0.022761,-0.033886,0.112898,
];

function relu(x){return x>0?x:0;}
function tanh(x){const e1=Math.exp(x), e2=Math.exp(-x); return (e1-e2)/(e1+e2);}
function sigmoid(x){return 1/(1+Math.exp(-x));}

function mlpForward(x){
  // x: length INPUT_SIZE
  const h1 = new Array(H1).fill(0);
  for(let i=0;i<H1;i++){
    let s = B1[i];
    for(let j=0;j<INPUT_SIZE;j++) s += W1[i*INPUT_SIZE + j]*x[j];
    h1[i] = relu(s);
  }
  const h2 = new Array(H2).fill(0);
  for(let i=0;i<H2;i++){
    let s = B2[i];
    for(let j=0;j<H1;j++) s += W2[i*H1 + j]*h1[j];
    h2[i] = relu(s);
  }
  const out = new Array(OUTPUT_SIZE).fill(0);
  for(let i=0;i<OUTPUT_SIZE;i++){
    let s = B3[i];
    for(let j=0;j<H2;j++) s += W3[i*H2 + j]*h2[j];
    out[i] = s;
  }
  // post-process
  const mvx = tanh(out[0]);
  const mvy = tanh(out[1]);
  const fx  = tanh(out[2]);
  const fy  = tanh(out[3]);
  const fireP = sigmoid(out[4]);
  // 각도 변환
  const mvAngle = Math.atan2(mvy, mvx) * 180/Math.PI;
  const fireAngle = Math.atan2(fy, fx) * 180/Math.PI;
  return { mvAngle, fireAngle, fireP };
}

function norm(x, a, b){ return (x - a) / (b - a); }
function clamp01(v){ return v<0?0:(v>1?1:v); }

function buildFeatures(tank, enemies, allies, bulletInfo){
  // 입력 피처 구성 (전부 사용)
  // - 탱크 자체 상태: x,y,health,energy,typeOneHot(3),size
  // - 적/아군 최근접 K명: 상대 위치(상대 좌표-자기 좌표), 거리, 각, 체력
  // - 총알 최근접 K발: 상대 위치/속도(상대 좌표-자기 좌표), 거리
  const W=900, H=600;
  const self = [
    norm(tank.x, 0, W),
    norm(tank.y, 0, H),
    clamp01(tank.health/200),
    clamp01(tank.energy/200),
    tank.type===0?1:0,
    tank.type===1?1:0,
    tank.type===2?1:0,
    clamp01(tank.size/60),
  ];

  // 정렬 및 K개 추출
  function topK(arr, k){
    const sorted = arr.slice().sort((a,b)=> (a.distance||1e9)-(b.distance||1e9));
    return sorted.slice(0,k);
  }
  const KE=4, KA=3, KB=5;
  const es = topK(enemies, KE);
  const as = topK(allies, KA);
  const bs = topK(bulletInfo, KB);

  const ef = [];
  for(let i=0;i<KE;i++){
    const e = es[i];
    if(e){
      const dx = e.x - tank.x; const dy = e.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI; // -1..1
      ef.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(e.health/200));
    }else{
      ef.push(0,0,0,0,0);
    }
  }
  const af = [];
  for(let i=0;i<KA;i++){
    const a = as[i];
    if(a){
      const dx = a.x - tank.x; const dy = a.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      af.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang, clamp01(a.health/200));
    }else{
      af.push(0,0,0,0,0);
    }
  }
  const bf = [];
  for(let i=0;i<KB;i++){
    const b = bs[i];
    if(b){
      const dx = b.x - tank.x; const dy = b.y - tank.y;
      const ang = Math.atan2(dy, dx)/Math.PI;
      bf.push(clamp01(Math.hypot(dx,dy)/1100), clamp01(dx/900 + 0.5), clamp01(dy/600 + 0.5), ang,
              clamp01((b.vx+8)/16), clamp01((b.vy+8)/16));
    }else{
      bf.push(0,0,0,0,0,0);
    }
  }

  // 전역 통계(개수/합계)
  const stats = [
    clamp01(enemies.length/6),
    clamp01(allies.length/5),
    clamp01(bulletInfo.length/10),
  ];

  const x = self.concat(ef, af, bf, stats);
  // 길이 보정(정확히 INPUT_SIZE)
  if (x.length < INPUT_SIZE) {
    while (x.length < INPUT_SIZE) x.push(0);
  } else if (x.length > INPUT_SIZE) {
    x.length = INPUT_SIZE;
  }
  return x;
}

function policyStep(tank, enemies, allies, bulletInfo){
  const feat = buildFeatures(tank, enemies, allies, bulletInfo);
  const out = mlpForward(feat);
  // 액션 적용
  // 발사 결정은 DNN의 fireP로만 제어
  if (out.fireP > 0.5) tank.fire(out.fireAngle);
  tank.move(out.mvAngle);
}


function name(){ return "DNN-D3"; }
function type(){ return Type.DEALER; }
function update(tank, enemies, allies, bulletInfo){
  policyStep(tank, enemies, allies, bulletInfo);
}
