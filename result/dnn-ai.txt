function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.90359643, 0.89349442, 0.04957289, 0.08743022, -1.8454155, -0.82878719, -0.87983553, -0.134381, -0.60636263, -0.69778397, -0.14807724, 0.75132619, 0.89645174, 0.24183907, -0.60701476, -0.44340639, -0.31965644, 0.05610465, 0.4455623, -0.53368952, 0.61679824, 0.28615061, -1.31305845, 0.41423849, 0.42741566, 0.05342415, 0.06567655, -0.35020656, 0.15411461, 0.22793669, 0.67485867, -0.35112825, -0.31695235, -0.10242266, 0.14508486, 0.9856674, -0.41007171, -0.94825231, -0.30662951, -0.13608729, 0.56217131, 0.31343612, 1.21048289, 0.10936584, 0.87900723, 0.1662101, -0.36370755, -0.29853346, -0.56048345, -0.74327357, 0.65106491, -0.52293955, 0.46158489, 1.04624972, 0.59728072, -1.02360689, -1.70310221, 0.86957424, -0.11964101, -1.99064077, -0.44684641, -0.5158244, -0.407172, -0.14529276, 0.4639493, -0.84208459, -0.64160476, 0.04155892, -1.36428184, -0.53309765, -0.25092378, 0.64410279, 0.6684488, 0.67340058, 0.34313323, -0.84853366, 0.50479216, -0.74550011, -1.08621808, -0.13982881, -0.41874448, -0.50980177, 0.93267184, 0.71174491, 0.25322283, 0.49080686, -0.56665893, 0.54617207, -0.1445592, 1.70314862, -0.63296559, -0.91048313, 0.46160408, -0.71462071, 0.44835445, 0.16222459, 0.72067127, -0.77499831, 0.62544856, 0.53549091, 1.12981976, -0.3707994, 0.92524124, 0.6771095, -0.23244233, -0.3476181, -1.13463197, -1.40613607, 0.47157517, 0.68803301, 1.82269145, 1.79189336, 0.50481263, -0.55981634, -1.39372013, -0.73608395, -0.34446371, 0.83453839, 0.74315683, -0.32212376, -1.67549663, -0.55745469, -0.3573323, -0.07757036, 0.4611693, -0.39881591, -0.5404616, 0.06827969, -1.29080068, 0.37028792, 0.6038951, 0.26826324, 0.27257345, -0.4661513, 0.25396945, -0.50278759, -0.47894509, 0.96792538, 0.50823379, 0.09736401, 0.39318202, -1.22439108, -1.03644419, 0.43520677, 0.1529969, -0.72484852, 1.10517341, -0.55529466, 0.87818818, -0.43190628, -0.16761389, 0.85310645, -0.31125, 0.45831506, 0.62629728, -0.26968756, 0.45490432, -1.1400148, -0.22315384, 0.12936247, 0.12265046, -0.1331749, 0.66209766, -0.48804924, 0.27635959, -1.08856148, 0.6221609, -0.84368061, -0.63570788, -0.24371238, 0.47080477, 1.02505131, 0.7663501, -0.62667481, -0.6172142, -0.7519107, 0.31502092, -1.85604045, 0.16838324, -0.57917279, 0.86173683, 0.39359544, 0.48048385, -0.2221504, 0.4734209, -0.02994776, 0.15389729, -0.19487792, -0.78648795, -0.59276262, 1.08691167, 0.15913024, -0.37188516, -0.40182288, -0.66424096, -0.67543462, 0.98083462, -0.68719361, 0.44992053, -0.32256603, -0.80667763, 0.9439827, -0.2583678, 0.24899836, -1.62191709, -0.55938253, -0.67010962, 0.07998438, 0.28113666, 0.78712812, 0.66224719, 1.34403337, 0.33573096, -0.25454834, 0.39411477, 0.57864545, -0.47659797, -0.2839782, -0.06313033, 0.37037057, 0.0308814, -0.42756839, -0.66738015, 0.04861556, -0.5326522, 0.3481198, 0.21322218, 0.00703293, 0.4785263, -0.22538812, -0.91653689, 1.30307146, -0.50723395, -0.58848768, -0.43917418, 1.59354496, -0.94851343, 0.24545711, -0.62198641, -1.85373582, -0.12403065, -2.63568773, -1.61800744, -0.6254986, 0.35797023, -0.98869105, -0.64823402, -1.0884566, -0.38163264, 0.12367017, -0.39331279, 0.03266502, -0.19338726, -1.23195773, -0.22766554, -1.1326141, -1.17884757, -0.18603309, -0.64566925, -0.06755378, -0.11267509, 0.68909307, 1.05574519, 0.06511791, -0.37128243, 0.63803511, 0.9261499, -0.20793908, 1.60527582, -2.3347344, -0.92326159, -0.59969809, -0.47791809, -0.7015215, 0.07149392, -0.46402163, -0.11785431, 0.12557569, -0.77536438, -0.75373192, -1.1744009, -0.69941857, 0.29257857, -0.90632601, -0.75851474, -0.04125091, -0.07871412, 0.46570424, 0.19240297, 0.63025103, -0.00654598, -0.56182025, 0.20083097, -0.76149205, 1.19034258, -0.29175814, 0.61675966, -0.39067853, 0.24754634, -0.05915669, 0.44446928, 0.40102534, 0.17742453, -0.92674023, 0.03710063, 0.13228865, -1.68415156, -0.23548321, 0.39147227, 1.09307483, -0.52409528, -0.89369076, 0.81950551, 0.45287926, 0.22416069, -0.6480729, 0.36376494, 1.40885498, 0.24475942, -0.64101476, -0.49944498, -0.23085023, 0.1188007, 0.31913653, -0.97104541, -0.886285, 0.15392372, -0.01110991, 0.01690542, -0.83438227, 0.67415965, 1.52574702, 0.39042469, 1.53075575, 0.18808267, 1.12729364, 0.64115541, 0.36158171, -1.71628396, 0.38952374, 1.35832331, 0.10235417, 0.11630661, 0.03581733, -0.6127751, 2.7363918, 0.11785807, 1.07857098, 0.95324957, -0.31300016, 0.77725349, 0.22833057, -0.51928513, -1.71948255, -0.84657199, -0.15062949, -0.4128615, 0.91400082, -0.11482955, -0.11245562, -0.89824522, 0.35983888, -1.49467663, 0.18290103, 0.4666928, -1.07869417, -0.37971559, 0.9959408, -0.14664443, -1.33831526, 0.49786503, 1.4252852, -0.70843323, 1.15169705, -0.16205604, -0.46566615, 0.67218311, 0.29089919, -0.6862955, 0.63096517, 0.70085961, 0.18603292, -0.44003535, -0.32013682, 1.17227242, -0.66107012, -0.00550025, -0.13168146, -0.90349801, 0.39975525, 1.04997284, -1.364288, 0.97499554, -0.14993244, 0.08349506, -0.26154993, 0.19792199, -0.65906871, 1.29500774, 0.46653783, 0.00789562, -1.23000877, 2.56764017, -0.09223225, 0.69106525, -0.80073, -0.97388302, 0.08611091, 0.7389657, 1.4245678, 0.74208422, -0.16101413, -1.02951166, -0.14937286, 0.44258856, -0.88251707, -0.18268053, 0.70784674, -0.10320719, 0.71930213, 0.14427284, 0.48769923, -0.88780412, 0.35584476, -0.91754977, -1.38952887, -0.06247966, 0.79868735, 0.10629785, -0.14867422, 1.62060367, 1.28694111, 0.21464597, 1.03687006, 0.76567074, 0.32099684, -0.53905136, 0.84355275, -0.48418366, -1.1060037, -0.4201436, -0.43914775, 0.07482209, 1.18749084, -1.12929607, 0.093327, -0.31157728, 0.82690981, -1.07396043, 0.20653979, -0.10117669, 0.52148172, -0.17735615, 1.21302175, -1.68445554, -0.98052755, 0.30236988, -0.1669214, 0.62724799, 1.31545614, -0.0317346, -1.1314614, -1.08388703, 0.0314917, -0.55552648, -0.71017459, 0.98861606, 1.74708233, -0.49810112, -0.49224772, 0.96433668, 0.75460385, -0.48704318, -0.26026318, 0.24189768, -0.13191207, -1.2000126, -1.50835938, 0.6623955, 0.01353638, -0.84737336, -0.58138871, -0.00161026, 0.17792767, 1.3536212, 1.01168518, -0.72224477, -0.42821178, -0.8122286, -0.54385066, 0.63861282, -0.81493548, 1.1094069, 0.2144904, -0.99543601, -1.64119161, -1.03630542, 0.25592178, 0.12017048, -0.66760402, 0.69581659, -0.13280771, 0.10556089, 1.33508116, 0.70851276, 0.20315195, -0.07789412, -0.15486419, 0.43326581, -0.79717945, 1.69731963, -0.02838722, 0.07202702, -0.83822777, 0.06086179, -0.41010772, 1.35534918, -0.02473134, -1.07087704, 0.42304222, -0.9027866, -0.21455583, 0.66024329, -0.31368634, 0.79110026, 1.6932598, -0.74350254, 0.16789374, -0.28272111, -0.04142504, -1.19896365, -1.33834908, -0.46989842, 0.00601124, 0.73028833, -1.39314054, 0.06792769, -0.85153035, -0.93143868, -0.77752074, -0.60910231, 1.10223638, 1.50677246, -0.66799525, -0.39776376, 0.51450602, 0.0692703, -0.03491472, -0.95669038, -1.10694158, -0.79085666, 0.9318639, -0.27760039, -0.02923176, -0.08813614, -1.25349881, 0.30583843, -0.40447983, -0.83068834, 1.32362798, 0.19340083, 0.0237453, -0.31541616, -0.58708282, 0.11188402, 0.43303559, -0.02016469, -0.17327859, -1.07234177, 0.36326551, -2.02041364, 0.69410398, 0.72974564, 0.62362027, -0.5427528, 0.34716325, -0.33930544, 1.48893151, -0.55326448, -0.84705042, -0.08250216, 0.28625436, -0.02485747, -1.72736747, 2.6374069, -0.88102056, -0.35932663, 0.76641204, 1.37224823, 0.80110491, -0.09383853, -1.06526571, -0.92089166, -1.25009631, 0.86933031, 1.08139317, -0.21389943, -0.29729696, -0.49108602, -1.44219054, -2.13272362, 0.43254361, -2.4264608, 0.03913172, -2.10207208, 0.325215, 0.39630265, -0.8688316, -1.50615675, -1.12863429, 1.44578632, 0.98606156, 0.31468314, 1.9911631, -0.55137319, 0.2621415, 0.1923737, -0.09810319, 0.0777448, -0.33885556, 0.33010266, 0.27951233, -0.22407961, 0.84554029, -0.32179483, 0.03726981, -1.85720211, 1.57028889, -0.5119088, 0.22556426, 0.36329416, -0.32248082, -0.42739916, 0.50612102, -1.15084928, 1.29595347, 0.53677532, 0.88692833, 0.7195164, 1.53105633, -0.08339601, 0.38519189, -0.54126359, 0.3934371, -0.04443134, -0.14034935, 0.1436576, -0.61173929, 0.96681837, -0.28618283, -0.21047137, -0.19563962, 0.81262444, 0.61645571, -1.07969066, 1.31448171, 0.42680564, 1.08448355, 0.28782214, -0.63957522, 0.29314069, 0.50515311, -1.10433621, -0.43289803, 0.06417455, -0.45411224, 0.58165425, -0.27067975, 0.0046516, -0.35161842, 0.90810965, 0.68131714, -0.27448056, 0.96869178, -0.28207738, -0.31350559, -1.08746962, 0.6799498, 0.52149289, -0.02936344, -0.32937853, 0.01274816, -0.78291918, 0.08112, 0.08591271, 0.23949015, -0.02862115, 0.17460996, 0.94803397, -0.25267182, -1.0105955, 1.14011552, -0.11998052, -0.05575614, -0.17656425, -0.60141018, 0.85825837, 1.832929, 0.11616123, -1.02215088, -0.06724747, -1.41497011, 0.33560761, 0.10838589, 0.59421062, 0.15319137, -0.48201249, -0.42874771, 0.93777082, -2.07946768, -0.2967969, -2.30779622, -0.44222149, -0.54041504, -0.28057714, -1.22404525, -0.11953355, -0.34037274, 0.2312471, -0.75812311, -0.2828213, 0.75609977, 0.87904485, -1.26489836, 1.52565116, -0.65033381, -0.84135509, -0.2485903, -0.16488935, -0.25172702, 0.3477329, -0.99844413, 0.0893855, 0.28780327, -0.96530619, -0.242358, -0.1519723, 0.10513381, 0.55730621, 0.79682517, -0.68507869, -0.13450629, -1.01287481, 0.18363007, 0.90383766, -0.26592925, -0.15490325, -1.39076443, -0.53548799, 0.16275516, -0.10039016, -0.56690137, 0.38538259, 1.20824846, 0.60377151, -0.7638251, 0.44327441, 1.44355722, -0.49587772, 0.22420225, 0.17182077, -0.42703656, 0.79308676, -0.47400368, -1.0624824, -0.42177568, -0.03035576, 0.41269387, 0.45629925, 0.25374674, 0.32283297, 0.13206298, -0.60402104, -0.91304635, -1.62745707, 1.09739213, -0.46382738, -0.28101515, -0.53787157, -1.24151289, 0.50175691, -0.97062501, -0.77019526, -1.71692645, 0.03282664, 2.32275073, -1.11813113, 0.70469066, -1.54230591, -1.1383385, -0.33706747, -0.93250757, 0.32217997, -0.41700553, 0.242251, 0.30650612, -0.58911651, 0.52589335, -0.46921787, 0.91418183, 0.21868418, 1.11369361, -0.63020996, 0.37841559, 0.73907324, 0.51378083, 0.15723263, -1.09187737, 0.51967648, 0.85048528, -1.13530689, 0.36395999, -0.89721453, 0.54664475, 0.6792137, 0.50477066, -0.50894378, -1.37194282, 0.15867105, 0.09239915, 0.37469814, 0.24994239, 0.50119091, 1.54269779, -0.6706416, 0.53790454, -0.63492337, 1.86457003, 0.58128414, 0.14945862, -0.24791515, 0.0420237, 0.0906615, -1.04183374, -0.54399736, -0.12757092, 2.07130542, -0.92584469, 0.59454027, 0.23487124, 0.39683206, -0.55942401, 0.51732529, 0.67701501, -0.80296143, -0.32576941, 0.92372405, 1.2175231, 0.38067386, 1.8684185, 0.11783921, -0.98170368, 0.55072023, 0.44510892, 0.36175759, -2.11172248, -0.8916535, 1.60434916, -0.58356423, 0.29668149, -0.02994974, -0.62444889, 0.1255661, 0.30686846, -1.35430336, 1.00883222, -0.74749257, -0.42370211, 0.18437552, -0.23553896, 1.20207397, 0.10308577, -0.90928516, 0.35294131, 0.12693428, -1.07397856, -0.59713218, -0.25705171, 0.27335295, 0.72726503, 0.58699804, -1.08700317, 0.05361932, -0.07838087, -0.24359964, 0.27206324, -1.9747832, 0.09044784, 0.23963839, 1.1210887, -0.34476586, -0.05390602, -0.97798433, -0.2580312, -0.46785939, -1.28640683, -0.48116196, -1.08511232, 0.91303967, -0.00981035, -0.19092695, 1.21165886, 0.79930205, -0.29222441, -1.20949773, 0.19549155, -0.67057537, -0.28368857, 0.33762435, -1.46314261, -0.52300149, 0.55728648, 0.6614403, -0.73736149, 0.60679283, 0.01322986, 0.10691289, 0.95144079, 1.14280532, 0.37810556, 0.7877654, 0.39875916, 0.54401124, -0.94842052, -0.58577268, 0.07336514, -0.02945687, 0.13338976, 0.23458857, -0.43544024, -0.23964248, -0.61324835, -0.64090124, 0.1430133, -0.00487549, 0.93319645, 0.55883759, 0.02950665, 0.21708047, -1.3840952, 0.01447969, -0.32766332, -0.65174139, 0.61389871, 0.53423373, 0.28791145, 0.57796969, 0.73634194, -0.34640685, -1.23122208, -0.40988897, 0.06962836, -0.58396723, 0.38203411, 0.09525111, 0.22925928, -1.16372368, -1.15540007, 1.67766596, -0.73288039, -1.25411198, -0.64515158, 1.96350625, 0.17202138, 0.35067004, -0.30376851, -0.44363068, 0.79980172, -1.29932015, 1.24662216, -0.37796555, 0.48784635, -0.452864, -1.02512885, 0.50969432, -0.44332496, 1.27764998, -0.80020406, 0.2701772, 0.02126923, -0.02164232, -0.43830262, -0.57008661, -1.40659458, -0.15879656, -0.15631167, -0.08277834, -0.09763538, 0.4118147, -0.26870572, -0.22553143, -0.0895887, 0.25321171, 0.05238375, 2.20891027, -1.06131454, -0.37405243, -0.31089764, 0.54375899, -0.34856757, -0.23066228, -0.44270574, 0.39664335, 0.81196829, 0.63450371, -1.43365069, 0.84786801, -0.3539834, 0.45190736, -0.01934647, 0.03358416, 0.86665387, 1.05958246, 1.33280375, 0.18920066, -0.0841888, 0.75624156, 0.04543624, -1.35132747, 0.76660726, 1.75344839, -1.01596493, 0.14541376, -1.61123373, -0.52468053, 0.14907125, 1.21939154, 0.23483468, 0.79496956, -0.33412805, -0.191458, 0.10226586]);
  const b1 = new Float64Array([-0.91355268, -0.87070198, 0.41124037, -1.66458568, -1.09202031, -0.94673716, 0.12325392, 1.10532947, 0.6029771, 0.43586794, 0.86991524, 0.94694866, -0.09989365, -0.15308725, -0.08878927, -0.4139521, 0.05640633, -0.18722887, 0.27566086, 1.04294795, 0.57061558, -0.11254251, 0.13120158, -0.51889912]);
  const W2 = new Float64Array([-0.39101005, 1.19772359, -0.19486322, -0.41842124, 0.21699621, 1.0673606, -0.17331125, 0.84637513, -1.29732562, 0.32609972, -0.53813354, 0.95599952, 0.45503628, 0.38170159, -0.82797458, 0.34066737, 0.52320909, -0.19998215, -0.04932509, 0.09570761, -0.54745287, -0.01473933, 0.60903973, -0.76915922, 0.53293917, -0.84165048, -1.12742268, 0.81135193, 0.23538672, -0.66166939, -1.7935203, -0.05970403, 0.12318274, 0.20608634, -2.44324465, -0.35511585, 0.09519606, 0.65790167, -0.31877675, 0.19846695, -1.4348369, 0.11971173, 1.89943336, -0.00832907, 1.74558264, 0.92096183, 0.09905133, 0.17456376, -1.78602134, -0.45840169, 0.36421512, 0.14650199, -0.95535866, -0.44832478, -0.02551332, 0.85972233, -0.24644041, -1.10765484, -0.53185249, 0.91308762, -0.63694861, -0.03685392, 0.34484216, -1.18818758, 0.76830778, -1.18234368, -0.24924705, 0.15613112, 0.19228246, 1.03564328, -1.20192194, -1.1492515, 0.23707356, 1.10827729, -0.60627964, -0.51220655, -1.45365101, -0.17954398, 0.55062773, 0.70419581, -1.17458023, 0.67053822, -0.9195385, -0.0304095, 1.10384981, 0.34893148, -0.63698147, -1.05865059, 0.19793153, -0.14145941, 0.5780783, 0.15900951, 1.0817889, 1.47972053, -0.34433412, 0.41947027, 1.25880016, -1.20531196, -0.19543132, -0.47090516, 0.66479872, 0.12301287, -0.20521629, -0.04141733, -1.01292904, 0.64230154, -0.11723859, -0.86454631, 1.0062113, -0.86331685, 0.89762959, 0.2563134, 0.66381251, -0.2767988, 0.19529085, 0.85572657, 1.20917564, -0.48632239, 0.8449259, 0.61322875, 0.05506075, 0.26667272, -0.28019898, 0.28371957, -0.67776057, 0.805545, 0.45669023, 0.16501652, 0.44845882, 0.16818634, 1.05596923, 0.59937922, 1.05904807, -0.48131244, -0.4641335, -0.43744222, -1.28673296, 0.17290186, -0.86016236, 0.08563316, -0.33879498, -0.23934364, -0.27013216, 0.94880382, -1.21670607, 0.93102684, -0.26926236, -0.70170043, -0.16027738, -0.35115506, -0.26145072, 2.01332327, 2.23790121, -0.06096779, -0.58100221, 0.13251493, -0.23499508, 0.19603137, -0.78430496, -0.73487433, 0.36634026, 0.68686482, -1.44588931, 1.1677849, -1.08861335, 0.78081935, 0.05768332, 0.24254049, -0.4105792, -0.44829249, 0.66037878, 0.51360438, -0.34304538, -0.43158583, 0.56727096, -1.2467341, 0.10431655, 1.03366846, -0.7070454, -0.17855006, -1.65119901, 0.49969941, -0.7020062, -0.00841413, 0.55009647, 0.03235827, -0.7289044, 0.33529386, 0.16619045, 0.16025567, -0.90203847, 0.38954317, 0.11420667, -1.01540325, -0.9998046, -0.29193176, -0.71543667, -0.83426144, -1.42647826, -0.50944955, 1.69930679, -0.9531359, -0.0881469, -0.89596168, -0.05697037, 0.19117627, -0.59262638, 0.62895525, -0.39637293, -0.19136155, -0.90641635, 1.37386457, -0.7650469, 0.21123596, 0.68246506, -0.08855019, -0.00179495, -0.4440947, -0.37358151, 0.77524949, -1.21019134, -0.01081283, -2.2468061, -0.41742993, 0.44541011, -0.02879125, -0.883017, -0.42028702, -0.18418398, -0.42523977, 0.55157451, 0.256177, 0.66748387, -0.66375502, 0.50224263, 0.38817544, 1.02275358, 0.68315557, -0.13082946, 0.1196848, -0.58391537, -0.49732442, 0.47418088, -0.67041222, -0.82388795, -0.7869437, 0.37597356, -0.02892626, -0.32466638, -1.60690768, 0.56701345, 0.30710392, -0.15586901, 0.70998681, 0.64431622, -0.49525933, 0.25914444, 0.06337661, -0.13631046, 0.59283474, 0.1997798, 0.58428025, -0.57907968, 0.81439319, -1.43485811, -1.41784912, -0.44055419, 0.96640439, -0.1853551, 0.59501819, -0.67797756, 0.40188138, -0.58240855, 1.58653835, -0.54020392, -0.44365852, 0.45794439, 1.07054881, -0.82598632, 0.24297082, 0.08897226, -0.58487712, 1.55396428, 0.10536166, 0.36037907, 1.37788924, -0.04296883, 0.01644336, 0.06803663, -1.45917471, -1.07931521, -0.10719955, -0.0666856, 0.10674127, -2.04722911, 0.53412468, -0.91875481, -0.33161022, -0.51875605, 0.66116491, 0.21080735, 0.32701681, -1.01521306, 0.25277114, -0.69437636, -0.29041846, -0.16703197, -0.70699259, -0.37424297, 0.25647941, 0.99423571, -0.80922827, 0.10076276, -0.55769158, -0.20010836, -0.44710712, 0.73350762, 0.9024919, 0.27399365, 1.02730211, -0.44314363, 0.57594137, 0.3143584, -0.22724377, -1.09079201, -0.98569955, -0.62836703, -0.74868993, -0.62246642, 0.28138704, 1.68750249, 0.62198314, 0.16221682, 0.03407235, -1.50886606, -0.05763024, -1.11914352, 0.71505442, -0.16318884, -0.82529562, 0.99253544, -0.44995929, 0.77366227, -0.05075338, 0.55611837, -0.17419227, 0.69696286, 0.82126117, 0.52144319, -0.70846481, 0.22355823, 0.43818369, 0.13823656, 1.01800172, 1.03639745, 0.22537657, 0.27254533, 0.54866374, 1.08363174, -0.81009257, 0.67157389, 0.57668907, 0.5341318, 0.08167226, 0.43659313, 0.88662754, -0.6163709, -0.77811463, 0.4200892, 0.03711952, -1.36094023, -1.47031612, 3.04469214, 0.81736596, -0.1702907, -0.96679893, 0.17491281, -1.50397131, 1.04129231, 1.53228621, 0.64936712, 0.29368134, -0.54792457, -0.05076702]);
  const b2 = new Float64Array([0.53650273, 0.43899001, -0.5399926, 0.57371228, -0.04237427, -0.03477971, -1.24436399, -0.47568171, -0.04294208, -0.11719525, 0.60658153, -1.04535481, 0.38062967, 0.4118214, -0.67819525, 0.22612087]);
  const W3 = new Float64Array([-1.34236789, 4.7910391, -3.16236796, 6.35912732, -3.11404252, -0.59455314, 3.62919724, -2.94227737, -1.96914449, -2.26977283, 0.88295064, 0.511257, -0.31304668, -1.77660542, -1.37439757, 3.80847703, 0.22327747, 5.34706316, 0.74653803, 9.42706366, -0.16314412, 1.18535867, 3.5342742, -1.95507176, -1.53742427, -1.67268726, 0.23459691, 1.86369691, 1.12076071, -0.46798693, 0.87922565, 1.32317368, -0.70669292, 0.6686808, -1.25783634, 2.29198085, -1.1133254, -0.19967089, 1.39002281, 1.19003418, 0.58681711, -2.88955933, 0.11167233, 0.99386488, -5.03316814, -0.32790194, -1.83781663, -1.22631643, -0.45576488, 0.37244254, -0.30202311, 6.45081659, 4.30647512, 2.30316532, 1.62710317, 5.26810776, -1.40458646, 4.40567122, 2.26522765, -0.06847686, 0.59498059, -3.31308458, 0.05470294, -5.52913296, -1.0095507, 7.3522182, -4.13212434, 9.85478382, -5.59380271, -0.0934431, 0.20167313, -1.2324226, -4.63393761, -0.7469662, 2.80866314, 2.61498793, -0.60258475, 0.57910842, -1.25070946, 0.51067688]);
  const b3 = new Float64Array([-0.03206237, 0.18140681, -0.20552047, -0.29580895, -1.16761373]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.90359643, 0.89349442, 0.04957289, 0.08743022, -1.8454155, -0.82878719, -0.87983553, -0.134381, -0.60636263, -0.69778397, -0.14807724, 0.75132619, 0.89645174, 0.24183907, -0.60701476, -0.44340639, -0.31965644, 0.05610465, 0.4455623, -0.53368952, 0.61679824, 0.28615061, -1.31305845, 0.41423849, 0.42741566, 0.05342415, 0.06567655, -0.35020656, 0.15411461, 0.22793669, 0.67485867, -0.35112825, -0.31695235, -0.10242266, 0.14508486, 0.9856674, -0.41007171, -0.94825231, -0.30662951, -0.13608729, 0.56217131, 0.31343612, 1.21048289, 0.10936584, 0.87900723, 0.1662101, -0.36370755, -0.29853346, -0.56048345, -0.74327357, 0.65106491, -0.52293955, 0.46158489, 1.04624972, 0.59728072, -1.02360689, -1.70310221, 0.86957424, -0.11964101, -1.99064077, -0.44684641, -0.5158244, -0.407172, -0.14529276, 0.4639493, -0.84208459, -0.64160476, 0.04155892, -1.36428184, -0.53309765, -0.25092378, 0.64410279, 0.6684488, 0.67340058, 0.34313323, -0.84853366, 0.50479216, -0.74550011, -1.08621808, -0.13982881, -0.41874448, -0.50980177, 0.93267184, 0.71174491, 0.25322283, 0.49080686, -0.56665893, 0.54617207, -0.1445592, 1.70314862, -0.63296559, -0.91048313, 0.46160408, -0.71462071, 0.44835445, 0.16222459, 0.72067127, -0.77499831, 0.62544856, 0.53549091, 1.12981976, -0.3707994, 0.92524124, 0.6771095, -0.23244233, -0.3476181, -1.13463197, -1.40613607, 0.47157517, 0.68803301, 1.82269145, 1.79189336, 0.50481263, -0.55981634, -1.39372013, -0.73608395, -0.34446371, 0.83453839, 0.74315683, -0.32212376, -1.67549663, -0.55745469, -0.3573323, -0.07757036, 0.4611693, -0.39881591, -0.5404616, 0.06827969, -1.29080068, 0.37028792, 0.6038951, 0.26826324, 0.27257345, -0.4661513, 0.25396945, -0.50278759, -0.47894509, 0.96792538, 0.50823379, 0.09736401, 0.39318202, -1.22439108, -1.03644419, 0.43520677, 0.1529969, -0.72484852, 1.10517341, -0.55529466, 0.87818818, -0.43190628, -0.16761389, 0.85310645, -0.31125, 0.45831506, 0.62629728, -0.26968756, 0.45490432, -1.1400148, -0.22315384, 0.12936247, 0.12265046, -0.1331749, 0.66209766, -0.48804924, 0.27635959, -1.08856148, 0.6221609, -0.84368061, -0.63570788, -0.24371238, 0.47080477, 1.02505131, 0.7663501, -0.62667481, -0.6172142, -0.7519107, 0.31502092, -1.85604045, 0.16838324, -0.57917279, 0.86173683, 0.39359544, 0.48048385, -0.2221504, 0.4734209, -0.02994776, 0.15389729, -0.19487792, -0.78648795, -0.59276262, 1.08691167, 0.15913024, -0.37188516, -0.40182288, -0.66424096, -0.67543462, 0.98083462, -0.68719361, 0.44992053, -0.32256603, -0.80667763, 0.9439827, -0.2583678, 0.24899836, -1.62191709, -0.55938253, -0.67010962, 0.07998438, 0.28113666, 0.78712812, 0.66224719, 1.34403337, 0.33573096, -0.25454834, 0.39411477, 0.57864545, -0.47659797, -0.2839782, -0.06313033, 0.37037057, 0.0308814, -0.42756839, -0.66738015, 0.04861556, -0.5326522, 0.3481198, 0.21322218, 0.00703293, 0.4785263, -0.22538812, -0.91653689, 1.30307146, -0.50723395, -0.58848768, -0.43917418, 1.59354496, -0.94851343, 0.24545711, -0.62198641, -1.85373582, -0.12403065, -2.63568773, -1.61800744, -0.6254986, 0.35797023, -0.98869105, -0.64823402, -1.0884566, -0.38163264, 0.12367017, -0.39331279, 0.03266502, -0.19338726, -1.23195773, -0.22766554, -1.1326141, -1.17884757, -0.18603309, -0.64566925, -0.06755378, -0.11267509, 0.68909307, 1.05574519, 0.06511791, -0.37128243, 0.63803511, 0.9261499, -0.20793908, 1.60527582, -2.3347344, -0.92326159, -0.59969809, -0.47791809, -0.7015215, 0.07149392, -0.46402163, -0.11785431, 0.12557569, -0.77536438, -0.75373192, -1.1744009, -0.69941857, 0.29257857, -0.90632601, -0.75851474, -0.04125091, -0.07871412, 0.46570424, 0.19240297, 0.63025103, -0.00654598, -0.56182025, 0.20083097, -0.76149205, 1.19034258, -0.29175814, 0.61675966, -0.39067853, 0.24754634, -0.05915669, 0.44446928, 0.40102534, 0.17742453, -0.92674023, 0.03710063, 0.13228865, -1.68415156, -0.23548321, 0.39147227, 1.09307483, -0.52409528, -0.89369076, 0.81950551, 0.45287926, 0.22416069, -0.6480729, 0.36376494, 1.40885498, 0.24475942, -0.64101476, -0.49944498, -0.23085023, 0.1188007, 0.31913653, -0.97104541, -0.886285, 0.15392372, -0.01110991, 0.01690542, -0.83438227, 0.67415965, 1.52574702, 0.39042469, 1.53075575, 0.18808267, 1.12729364, 0.64115541, 0.36158171, -1.71628396, 0.38952374, 1.35832331, 0.10235417, 0.11630661, 0.03581733, -0.6127751, 2.7363918, 0.11785807, 1.07857098, 0.95324957, -0.31300016, 0.77725349, 0.22833057, -0.51928513, -1.71948255, -0.84657199, -0.15062949, -0.4128615, 0.91400082, -0.11482955, -0.11245562, -0.89824522, 0.35983888, -1.49467663, 0.18290103, 0.4666928, -1.07869417, -0.37971559, 0.9959408, -0.14664443, -1.33831526, 0.49786503, 1.4252852, -0.70843323, 1.15169705, -0.16205604, -0.46566615, 0.67218311, 0.29089919, -0.6862955, 0.63096517, 0.70085961, 0.18603292, -0.44003535, -0.32013682, 1.17227242, -0.66107012, -0.00550025, -0.13168146, -0.90349801, 0.39975525, 1.04997284, -1.364288, 0.97499554, -0.14993244, 0.08349506, -0.26154993, 0.19792199, -0.65906871, 1.29500774, 0.46653783, 0.00789562, -1.23000877, 2.56764017, -0.09223225, 0.69106525, -0.80073, -0.97388302, 0.08611091, 0.7389657, 1.4245678, 0.74208422, -0.16101413, -1.02951166, -0.14937286, 0.44258856, -0.88251707, -0.18268053, 0.70784674, -0.10320719, 0.71930213, 0.14427284, 0.48769923, -0.88780412, 0.35584476, -0.91754977, -1.38952887, -0.06247966, 0.79868735, 0.10629785, -0.14867422, 1.62060367, 1.28694111, 0.21464597, 1.03687006, 0.76567074, 0.32099684, -0.53905136, 0.84355275, -0.48418366, -1.1060037, -0.4201436, -0.43914775, 0.07482209, 1.18749084, -1.12929607, 0.093327, -0.31157728, 0.82690981, -1.07396043, 0.20653979, -0.10117669, 0.52148172, -0.17735615, 1.21302175, -1.68445554, -0.98052755, 0.30236988, -0.1669214, 0.62724799, 1.31545614, -0.0317346, -1.1314614, -1.08388703, 0.0314917, -0.55552648, -0.71017459, 0.98861606, 1.74708233, -0.49810112, -0.49224772, 0.96433668, 0.75460385, -0.48704318, -0.26026318, 0.24189768, -0.13191207, -1.2000126, -1.50835938, 0.6623955, 0.01353638, -0.84737336, -0.58138871, -0.00161026, 0.17792767, 1.3536212, 1.01168518, -0.72224477, -0.42821178, -0.8122286, -0.54385066, 0.63861282, -0.81493548, 1.1094069, 0.2144904, -0.99543601, -1.64119161, -1.03630542, 0.25592178, 0.12017048, -0.66760402, 0.69581659, -0.13280771, 0.10556089, 1.33508116, 0.70851276, 0.20315195, -0.07789412, -0.15486419, 0.43326581, -0.79717945, 1.69731963, -0.02838722, 0.07202702, -0.83822777, 0.06086179, -0.41010772, 1.35534918, -0.02473134, -1.07087704, 0.42304222, -0.9027866, -0.21455583, 0.66024329, -0.31368634, 0.79110026, 1.6932598, -0.74350254, 0.16789374, -0.28272111, -0.04142504, -1.19896365, -1.33834908, -0.46989842, 0.00601124, 0.73028833, -1.39314054, 0.06792769, -0.85153035, -0.93143868, -0.77752074, -0.60910231, 1.10223638, 1.50677246, -0.66799525, -0.39776376, 0.51450602, 0.0692703, -0.03491472, -0.95669038, -1.10694158, -0.79085666, 0.9318639, -0.27760039, -0.02923176, -0.08813614, -1.25349881, 0.30583843, -0.40447983, -0.83068834, 1.32362798, 0.19340083, 0.0237453, -0.31541616, -0.58708282, 0.11188402, 0.43303559, -0.02016469, -0.17327859, -1.07234177, 0.36326551, -2.02041364, 0.69410398, 0.72974564, 0.62362027, -0.5427528, 0.34716325, -0.33930544, 1.48893151, -0.55326448, -0.84705042, -0.08250216, 0.28625436, -0.02485747, -1.72736747, 2.6374069, -0.88102056, -0.35932663, 0.76641204, 1.37224823, 0.80110491, -0.09383853, -1.06526571, -0.92089166, -1.25009631, 0.86933031, 1.08139317, -0.21389943, -0.29729696, -0.49108602, -1.44219054, -2.13272362, 0.43254361, -2.4264608, 0.03913172, -2.10207208, 0.325215, 0.39630265, -0.8688316, -1.50615675, -1.12863429, 1.44578632, 0.98606156, 0.31468314, 1.9911631, -0.55137319, 0.2621415, 0.1923737, -0.09810319, 0.0777448, -0.33885556, 0.33010266, 0.27951233, -0.22407961, 0.84554029, -0.32179483, 0.03726981, -1.85720211, 1.57028889, -0.5119088, 0.22556426, 0.36329416, -0.32248082, -0.42739916, 0.50612102, -1.15084928, 1.29595347, 0.53677532, 0.88692833, 0.7195164, 1.53105633, -0.08339601, 0.38519189, -0.54126359, 0.3934371, -0.04443134, -0.14034935, 0.1436576, -0.61173929, 0.96681837, -0.28618283, -0.21047137, -0.19563962, 0.81262444, 0.61645571, -1.07969066, 1.31448171, 0.42680564, 1.08448355, 0.28782214, -0.63957522, 0.29314069, 0.50515311, -1.10433621, -0.43289803, 0.06417455, -0.45411224, 0.58165425, -0.27067975, 0.0046516, -0.35161842, 0.90810965, 0.68131714, -0.27448056, 0.96869178, -0.28207738, -0.31350559, -1.08746962, 0.6799498, 0.52149289, -0.02936344, -0.32937853, 0.01274816, -0.78291918, 0.08112, 0.08591271, 0.23949015, -0.02862115, 0.17460996, 0.94803397, -0.25267182, -1.0105955, 1.14011552, -0.11998052, -0.05575614, -0.17656425, -0.60141018, 0.85825837, 1.832929, 0.11616123, -1.02215088, -0.06724747, -1.41497011, 0.33560761, 0.10838589, 0.59421062, 0.15319137, -0.48201249, -0.42874771, 0.93777082, -2.07946768, -0.2967969, -2.30779622, -0.44222149, -0.54041504, -0.28057714, -1.22404525, -0.11953355, -0.34037274, 0.2312471, -0.75812311, -0.2828213, 0.75609977, 0.87904485, -1.26489836, 1.52565116, -0.65033381, -0.84135509, -0.2485903, -0.16488935, -0.25172702, 0.3477329, -0.99844413, 0.0893855, 0.28780327, -0.96530619, -0.242358, -0.1519723, 0.10513381, 0.55730621, 0.79682517, -0.68507869, -0.13450629, -1.01287481, 0.18363007, 0.90383766, -0.26592925, -0.15490325, -1.39076443, -0.53548799, 0.16275516, -0.10039016, -0.56690137, 0.38538259, 1.20824846, 0.60377151, -0.7638251, 0.44327441, 1.44355722, -0.49587772, 0.22420225, 0.17182077, -0.42703656, 0.79308676, -0.47400368, -1.0624824, -0.42177568, -0.03035576, 0.41269387, 0.45629925, 0.25374674, 0.32283297, 0.13206298, -0.60402104, -0.91304635, -1.62745707, 1.09739213, -0.46382738, -0.28101515, -0.53787157, -1.24151289, 0.50175691, -0.97062501, -0.77019526, -1.71692645, 0.03282664, 2.32275073, -1.11813113, 0.70469066, -1.54230591, -1.1383385, -0.33706747, -0.93250757, 0.32217997, -0.41700553, 0.242251, 0.30650612, -0.58911651, 0.52589335, -0.46921787, 0.91418183, 0.21868418, 1.11369361, -0.63020996, 0.37841559, 0.73907324, 0.51378083, 0.15723263, -1.09187737, 0.51967648, 0.85048528, -1.13530689, 0.36395999, -0.89721453, 0.54664475, 0.6792137, 0.50477066, -0.50894378, -1.37194282, 0.15867105, 0.09239915, 0.37469814, 0.24994239, 0.50119091, 1.54269779, -0.6706416, 0.53790454, -0.63492337, 1.86457003, 0.58128414, 0.14945862, -0.24791515, 0.0420237, 0.0906615, -1.04183374, -0.54399736, -0.12757092, 2.07130542, -0.92584469, 0.59454027, 0.23487124, 0.39683206, -0.55942401, 0.51732529, 0.67701501, -0.80296143, -0.32576941, 0.92372405, 1.2175231, 0.38067386, 1.8684185, 0.11783921, -0.98170368, 0.55072023, 0.44510892, 0.36175759, -2.11172248, -0.8916535, 1.60434916, -0.58356423, 0.29668149, -0.02994974, -0.62444889, 0.1255661, 0.30686846, -1.35430336, 1.00883222, -0.74749257, -0.42370211, 0.18437552, -0.23553896, 1.20207397, 0.10308577, -0.90928516, 0.35294131, 0.12693428, -1.07397856, -0.59713218, -0.25705171, 0.27335295, 0.72726503, 0.58699804, -1.08700317, 0.05361932, -0.07838087, -0.24359964, 0.27206324, -1.9747832, 0.09044784, 0.23963839, 1.1210887, -0.34476586, -0.05390602, -0.97798433, -0.2580312, -0.46785939, -1.28640683, -0.48116196, -1.08511232, 0.91303967, -0.00981035, -0.19092695, 1.21165886, 0.79930205, -0.29222441, -1.20949773, 0.19549155, -0.67057537, -0.28368857, 0.33762435, -1.46314261, -0.52300149, 0.55728648, 0.6614403, -0.73736149, 0.60679283, 0.01322986, 0.10691289, 0.95144079, 1.14280532, 0.37810556, 0.7877654, 0.39875916, 0.54401124, -0.94842052, -0.58577268, 0.07336514, -0.02945687, 0.13338976, 0.23458857, -0.43544024, -0.23964248, -0.61324835, -0.64090124, 0.1430133, -0.00487549, 0.93319645, 0.55883759, 0.02950665, 0.21708047, -1.3840952, 0.01447969, -0.32766332, -0.65174139, 0.61389871, 0.53423373, 0.28791145, 0.57796969, 0.73634194, -0.34640685, -1.23122208, -0.40988897, 0.06962836, -0.58396723, 0.38203411, 0.09525111, 0.22925928, -1.16372368, -1.15540007, 1.67766596, -0.73288039, -1.25411198, -0.64515158, 1.96350625, 0.17202138, 0.35067004, -0.30376851, -0.44363068, 0.79980172, -1.29932015, 1.24662216, -0.37796555, 0.48784635, -0.452864, -1.02512885, 0.50969432, -0.44332496, 1.27764998, -0.80020406, 0.2701772, 0.02126923, -0.02164232, -0.43830262, -0.57008661, -1.40659458, -0.15879656, -0.15631167, -0.08277834, -0.09763538, 0.4118147, -0.26870572, -0.22553143, -0.0895887, 0.25321171, 0.05238375, 2.20891027, -1.06131454, -0.37405243, -0.31089764, 0.54375899, -0.34856757, -0.23066228, -0.44270574, 0.39664335, 0.81196829, 0.63450371, -1.43365069, 0.84786801, -0.3539834, 0.45190736, -0.01934647, 0.03358416, 0.86665387, 1.05958246, 1.33280375, 0.18920066, -0.0841888, 0.75624156, 0.04543624, -1.35132747, 0.76660726, 1.75344839, -1.01596493, 0.14541376, -1.61123373, -0.52468053, 0.14907125, 1.21939154, 0.23483468, 0.79496956, -0.33412805, -0.191458, 0.10226586]);
  const b1 = new Float64Array([-0.91355268, -0.87070198, 0.41124037, -1.66458568, -1.09202031, -0.94673716, 0.12325392, 1.10532947, 0.6029771, 0.43586794, 0.86991524, 0.94694866, -0.09989365, -0.15308725, -0.08878927, -0.4139521, 0.05640633, -0.18722887, 0.27566086, 1.04294795, 0.57061558, -0.11254251, 0.13120158, -0.51889912]);
  const W2 = new Float64Array([-0.39101005, 1.19772359, -0.19486322, -0.41842124, 0.21699621, 1.0673606, -0.17331125, 0.84637513, -1.29732562, 0.32609972, -0.53813354, 0.95599952, 0.45503628, 0.38170159, -0.82797458, 0.34066737, 0.52320909, -0.19998215, -0.04932509, 0.09570761, -0.54745287, -0.01473933, 0.60903973, -0.76915922, 0.53293917, -0.84165048, -1.12742268, 0.81135193, 0.23538672, -0.66166939, -1.7935203, -0.05970403, 0.12318274, 0.20608634, -2.44324465, -0.35511585, 0.09519606, 0.65790167, -0.31877675, 0.19846695, -1.4348369, 0.11971173, 1.89943336, -0.00832907, 1.74558264, 0.92096183, 0.09905133, 0.17456376, -1.78602134, -0.45840169, 0.36421512, 0.14650199, -0.95535866, -0.44832478, -0.02551332, 0.85972233, -0.24644041, -1.10765484, -0.53185249, 0.91308762, -0.63694861, -0.03685392, 0.34484216, -1.18818758, 0.76830778, -1.18234368, -0.24924705, 0.15613112, 0.19228246, 1.03564328, -1.20192194, -1.1492515, 0.23707356, 1.10827729, -0.60627964, -0.51220655, -1.45365101, -0.17954398, 0.55062773, 0.70419581, -1.17458023, 0.67053822, -0.9195385, -0.0304095, 1.10384981, 0.34893148, -0.63698147, -1.05865059, 0.19793153, -0.14145941, 0.5780783, 0.15900951, 1.0817889, 1.47972053, -0.34433412, 0.41947027, 1.25880016, -1.20531196, -0.19543132, -0.47090516, 0.66479872, 0.12301287, -0.20521629, -0.04141733, -1.01292904, 0.64230154, -0.11723859, -0.86454631, 1.0062113, -0.86331685, 0.89762959, 0.2563134, 0.66381251, -0.2767988, 0.19529085, 0.85572657, 1.20917564, -0.48632239, 0.8449259, 0.61322875, 0.05506075, 0.26667272, -0.28019898, 0.28371957, -0.67776057, 0.805545, 0.45669023, 0.16501652, 0.44845882, 0.16818634, 1.05596923, 0.59937922, 1.05904807, -0.48131244, -0.4641335, -0.43744222, -1.28673296, 0.17290186, -0.86016236, 0.08563316, -0.33879498, -0.23934364, -0.27013216, 0.94880382, -1.21670607, 0.93102684, -0.26926236, -0.70170043, -0.16027738, -0.35115506, -0.26145072, 2.01332327, 2.23790121, -0.06096779, -0.58100221, 0.13251493, -0.23499508, 0.19603137, -0.78430496, -0.73487433, 0.36634026, 0.68686482, -1.44588931, 1.1677849, -1.08861335, 0.78081935, 0.05768332, 0.24254049, -0.4105792, -0.44829249, 0.66037878, 0.51360438, -0.34304538, -0.43158583, 0.56727096, -1.2467341, 0.10431655, 1.03366846, -0.7070454, -0.17855006, -1.65119901, 0.49969941, -0.7020062, -0.00841413, 0.55009647, 0.03235827, -0.7289044, 0.33529386, 0.16619045, 0.16025567, -0.90203847, 0.38954317, 0.11420667, -1.01540325, -0.9998046, -0.29193176, -0.71543667, -0.83426144, -1.42647826, -0.50944955, 1.69930679, -0.9531359, -0.0881469, -0.89596168, -0.05697037, 0.19117627, -0.59262638, 0.62895525, -0.39637293, -0.19136155, -0.90641635, 1.37386457, -0.7650469, 0.21123596, 0.68246506, -0.08855019, -0.00179495, -0.4440947, -0.37358151, 0.77524949, -1.21019134, -0.01081283, -2.2468061, -0.41742993, 0.44541011, -0.02879125, -0.883017, -0.42028702, -0.18418398, -0.42523977, 0.55157451, 0.256177, 0.66748387, -0.66375502, 0.50224263, 0.38817544, 1.02275358, 0.68315557, -0.13082946, 0.1196848, -0.58391537, -0.49732442, 0.47418088, -0.67041222, -0.82388795, -0.7869437, 0.37597356, -0.02892626, -0.32466638, -1.60690768, 0.56701345, 0.30710392, -0.15586901, 0.70998681, 0.64431622, -0.49525933, 0.25914444, 0.06337661, -0.13631046, 0.59283474, 0.1997798, 0.58428025, -0.57907968, 0.81439319, -1.43485811, -1.41784912, -0.44055419, 0.96640439, -0.1853551, 0.59501819, -0.67797756, 0.40188138, -0.58240855, 1.58653835, -0.54020392, -0.44365852, 0.45794439, 1.07054881, -0.82598632, 0.24297082, 0.08897226, -0.58487712, 1.55396428, 0.10536166, 0.36037907, 1.37788924, -0.04296883, 0.01644336, 0.06803663, -1.45917471, -1.07931521, -0.10719955, -0.0666856, 0.10674127, -2.04722911, 0.53412468, -0.91875481, -0.33161022, -0.51875605, 0.66116491, 0.21080735, 0.32701681, -1.01521306, 0.25277114, -0.69437636, -0.29041846, -0.16703197, -0.70699259, -0.37424297, 0.25647941, 0.99423571, -0.80922827, 0.10076276, -0.55769158, -0.20010836, -0.44710712, 0.73350762, 0.9024919, 0.27399365, 1.02730211, -0.44314363, 0.57594137, 0.3143584, -0.22724377, -1.09079201, -0.98569955, -0.62836703, -0.74868993, -0.62246642, 0.28138704, 1.68750249, 0.62198314, 0.16221682, 0.03407235, -1.50886606, -0.05763024, -1.11914352, 0.71505442, -0.16318884, -0.82529562, 0.99253544, -0.44995929, 0.77366227, -0.05075338, 0.55611837, -0.17419227, 0.69696286, 0.82126117, 0.52144319, -0.70846481, 0.22355823, 0.43818369, 0.13823656, 1.01800172, 1.03639745, 0.22537657, 0.27254533, 0.54866374, 1.08363174, -0.81009257, 0.67157389, 0.57668907, 0.5341318, 0.08167226, 0.43659313, 0.88662754, -0.6163709, -0.77811463, 0.4200892, 0.03711952, -1.36094023, -1.47031612, 3.04469214, 0.81736596, -0.1702907, -0.96679893, 0.17491281, -1.50397131, 1.04129231, 1.53228621, 0.64936712, 0.29368134, -0.54792457, -0.05076702]);
  const b2 = new Float64Array([0.53650273, 0.43899001, -0.5399926, 0.57371228, -0.04237427, -0.03477971, -1.24436399, -0.47568171, -0.04294208, -0.11719525, 0.60658153, -1.04535481, 0.38062967, 0.4118214, -0.67819525, 0.22612087]);
  const W3 = new Float64Array([-1.34236789, 4.7910391, -3.16236796, 6.35912732, -3.11404252, -0.59455314, 3.62919724, -2.94227737, -1.96914449, -2.26977283, 0.88295064, 0.511257, -0.31304668, -1.77660542, -1.37439757, 3.80847703, 0.22327747, 5.34706316, 0.74653803, 9.42706366, -0.16314412, 1.18535867, 3.5342742, -1.95507176, -1.53742427, -1.67268726, 0.23459691, 1.86369691, 1.12076071, -0.46798693, 0.87922565, 1.32317368, -0.70669292, 0.6686808, -1.25783634, 2.29198085, -1.1133254, -0.19967089, 1.39002281, 1.19003418, 0.58681711, -2.88955933, 0.11167233, 0.99386488, -5.03316814, -0.32790194, -1.83781663, -1.22631643, -0.45576488, 0.37244254, -0.30202311, 6.45081659, 4.30647512, 2.30316532, 1.62710317, 5.26810776, -1.40458646, 4.40567122, 2.26522765, -0.06847686, 0.59498059, -3.31308458, 0.05470294, -5.52913296, -1.0095507, 7.3522182, -4.13212434, 9.85478382, -5.59380271, -0.0934431, 0.20167313, -1.2324226, -4.63393761, -0.7469662, 2.80866314, 2.61498793, -0.60258475, 0.57910842, -1.25070946, 0.51067688]);
  const b3 = new Float64Array([-0.03206237, 0.18140681, -0.20552047, -0.29580895, -1.16761373]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.90359643, 0.89349442, 0.04957289, 0.08743022, -1.8454155, -0.82878719, -0.87983553, -0.134381, -0.60636263, -0.69778397, -0.14807724, 0.75132619, 0.89645174, 0.24183907, -0.60701476, -0.44340639, -0.31965644, 0.05610465, 0.4455623, -0.53368952, 0.61679824, 0.28615061, -1.31305845, 0.41423849, 0.42741566, 0.05342415, 0.06567655, -0.35020656, 0.15411461, 0.22793669, 0.67485867, -0.35112825, -0.31695235, -0.10242266, 0.14508486, 0.9856674, -0.41007171, -0.94825231, -0.30662951, -0.13608729, 0.56217131, 0.31343612, 1.21048289, 0.10936584, 0.87900723, 0.1662101, -0.36370755, -0.29853346, -0.56048345, -0.74327357, 0.65106491, -0.52293955, 0.46158489, 1.04624972, 0.59728072, -1.02360689, -1.70310221, 0.86957424, -0.11964101, -1.99064077, -0.44684641, -0.5158244, -0.407172, -0.14529276, 0.4639493, -0.84208459, -0.64160476, 0.04155892, -1.36428184, -0.53309765, -0.25092378, 0.64410279, 0.6684488, 0.67340058, 0.34313323, -0.84853366, 0.50479216, -0.74550011, -1.08621808, -0.13982881, -0.41874448, -0.50980177, 0.93267184, 0.71174491, 0.25322283, 0.49080686, -0.56665893, 0.54617207, -0.1445592, 1.70314862, -0.63296559, -0.91048313, 0.46160408, -0.71462071, 0.44835445, 0.16222459, 0.72067127, -0.77499831, 0.62544856, 0.53549091, 1.12981976, -0.3707994, 0.92524124, 0.6771095, -0.23244233, -0.3476181, -1.13463197, -1.40613607, 0.47157517, 0.68803301, 1.82269145, 1.79189336, 0.50481263, -0.55981634, -1.39372013, -0.73608395, -0.34446371, 0.83453839, 0.74315683, -0.32212376, -1.67549663, -0.55745469, -0.3573323, -0.07757036, 0.4611693, -0.39881591, -0.5404616, 0.06827969, -1.29080068, 0.37028792, 0.6038951, 0.26826324, 0.27257345, -0.4661513, 0.25396945, -0.50278759, -0.47894509, 0.96792538, 0.50823379, 0.09736401, 0.39318202, -1.22439108, -1.03644419, 0.43520677, 0.1529969, -0.72484852, 1.10517341, -0.55529466, 0.87818818, -0.43190628, -0.16761389, 0.85310645, -0.31125, 0.45831506, 0.62629728, -0.26968756, 0.45490432, -1.1400148, -0.22315384, 0.12936247, 0.12265046, -0.1331749, 0.66209766, -0.48804924, 0.27635959, -1.08856148, 0.6221609, -0.84368061, -0.63570788, -0.24371238, 0.47080477, 1.02505131, 0.7663501, -0.62667481, -0.6172142, -0.7519107, 0.31502092, -1.85604045, 0.16838324, -0.57917279, 0.86173683, 0.39359544, 0.48048385, -0.2221504, 0.4734209, -0.02994776, 0.15389729, -0.19487792, -0.78648795, -0.59276262, 1.08691167, 0.15913024, -0.37188516, -0.40182288, -0.66424096, -0.67543462, 0.98083462, -0.68719361, 0.44992053, -0.32256603, -0.80667763, 0.9439827, -0.2583678, 0.24899836, -1.62191709, -0.55938253, -0.67010962, 0.07998438, 0.28113666, 0.78712812, 0.66224719, 1.34403337, 0.33573096, -0.25454834, 0.39411477, 0.57864545, -0.47659797, -0.2839782, -0.06313033, 0.37037057, 0.0308814, -0.42756839, -0.66738015, 0.04861556, -0.5326522, 0.3481198, 0.21322218, 0.00703293, 0.4785263, -0.22538812, -0.91653689, 1.30307146, -0.50723395, -0.58848768, -0.43917418, 1.59354496, -0.94851343, 0.24545711, -0.62198641, -1.85373582, -0.12403065, -2.63568773, -1.61800744, -0.6254986, 0.35797023, -0.98869105, -0.64823402, -1.0884566, -0.38163264, 0.12367017, -0.39331279, 0.03266502, -0.19338726, -1.23195773, -0.22766554, -1.1326141, -1.17884757, -0.18603309, -0.64566925, -0.06755378, -0.11267509, 0.68909307, 1.05574519, 0.06511791, -0.37128243, 0.63803511, 0.9261499, -0.20793908, 1.60527582, -2.3347344, -0.92326159, -0.59969809, -0.47791809, -0.7015215, 0.07149392, -0.46402163, -0.11785431, 0.12557569, -0.77536438, -0.75373192, -1.1744009, -0.69941857, 0.29257857, -0.90632601, -0.75851474, -0.04125091, -0.07871412, 0.46570424, 0.19240297, 0.63025103, -0.00654598, -0.56182025, 0.20083097, -0.76149205, 1.19034258, -0.29175814, 0.61675966, -0.39067853, 0.24754634, -0.05915669, 0.44446928, 0.40102534, 0.17742453, -0.92674023, 0.03710063, 0.13228865, -1.68415156, -0.23548321, 0.39147227, 1.09307483, -0.52409528, -0.89369076, 0.81950551, 0.45287926, 0.22416069, -0.6480729, 0.36376494, 1.40885498, 0.24475942, -0.64101476, -0.49944498, -0.23085023, 0.1188007, 0.31913653, -0.97104541, -0.886285, 0.15392372, -0.01110991, 0.01690542, -0.83438227, 0.67415965, 1.52574702, 0.39042469, 1.53075575, 0.18808267, 1.12729364, 0.64115541, 0.36158171, -1.71628396, 0.38952374, 1.35832331, 0.10235417, 0.11630661, 0.03581733, -0.6127751, 2.7363918, 0.11785807, 1.07857098, 0.95324957, -0.31300016, 0.77725349, 0.22833057, -0.51928513, -1.71948255, -0.84657199, -0.15062949, -0.4128615, 0.91400082, -0.11482955, -0.11245562, -0.89824522, 0.35983888, -1.49467663, 0.18290103, 0.4666928, -1.07869417, -0.37971559, 0.9959408, -0.14664443, -1.33831526, 0.49786503, 1.4252852, -0.70843323, 1.15169705, -0.16205604, -0.46566615, 0.67218311, 0.29089919, -0.6862955, 0.63096517, 0.70085961, 0.18603292, -0.44003535, -0.32013682, 1.17227242, -0.66107012, -0.00550025, -0.13168146, -0.90349801, 0.39975525, 1.04997284, -1.364288, 0.97499554, -0.14993244, 0.08349506, -0.26154993, 0.19792199, -0.65906871, 1.29500774, 0.46653783, 0.00789562, -1.23000877, 2.56764017, -0.09223225, 0.69106525, -0.80073, -0.97388302, 0.08611091, 0.7389657, 1.4245678, 0.74208422, -0.16101413, -1.02951166, -0.14937286, 0.44258856, -0.88251707, -0.18268053, 0.70784674, -0.10320719, 0.71930213, 0.14427284, 0.48769923, -0.88780412, 0.35584476, -0.91754977, -1.38952887, -0.06247966, 0.79868735, 0.10629785, -0.14867422, 1.62060367, 1.28694111, 0.21464597, 1.03687006, 0.76567074, 0.32099684, -0.53905136, 0.84355275, -0.48418366, -1.1060037, -0.4201436, -0.43914775, 0.07482209, 1.18749084, -1.12929607, 0.093327, -0.31157728, 0.82690981, -1.07396043, 0.20653979, -0.10117669, 0.52148172, -0.17735615, 1.21302175, -1.68445554, -0.98052755, 0.30236988, -0.1669214, 0.62724799, 1.31545614, -0.0317346, -1.1314614, -1.08388703, 0.0314917, -0.55552648, -0.71017459, 0.98861606, 1.74708233, -0.49810112, -0.49224772, 0.96433668, 0.75460385, -0.48704318, -0.26026318, 0.24189768, -0.13191207, -1.2000126, -1.50835938, 0.6623955, 0.01353638, -0.84737336, -0.58138871, -0.00161026, 0.17792767, 1.3536212, 1.01168518, -0.72224477, -0.42821178, -0.8122286, -0.54385066, 0.63861282, -0.81493548, 1.1094069, 0.2144904, -0.99543601, -1.64119161, -1.03630542, 0.25592178, 0.12017048, -0.66760402, 0.69581659, -0.13280771, 0.10556089, 1.33508116, 0.70851276, 0.20315195, -0.07789412, -0.15486419, 0.43326581, -0.79717945, 1.69731963, -0.02838722, 0.07202702, -0.83822777, 0.06086179, -0.41010772, 1.35534918, -0.02473134, -1.07087704, 0.42304222, -0.9027866, -0.21455583, 0.66024329, -0.31368634, 0.79110026, 1.6932598, -0.74350254, 0.16789374, -0.28272111, -0.04142504, -1.19896365, -1.33834908, -0.46989842, 0.00601124, 0.73028833, -1.39314054, 0.06792769, -0.85153035, -0.93143868, -0.77752074, -0.60910231, 1.10223638, 1.50677246, -0.66799525, -0.39776376, 0.51450602, 0.0692703, -0.03491472, -0.95669038, -1.10694158, -0.79085666, 0.9318639, -0.27760039, -0.02923176, -0.08813614, -1.25349881, 0.30583843, -0.40447983, -0.83068834, 1.32362798, 0.19340083, 0.0237453, -0.31541616, -0.58708282, 0.11188402, 0.43303559, -0.02016469, -0.17327859, -1.07234177, 0.36326551, -2.02041364, 0.69410398, 0.72974564, 0.62362027, -0.5427528, 0.34716325, -0.33930544, 1.48893151, -0.55326448, -0.84705042, -0.08250216, 0.28625436, -0.02485747, -1.72736747, 2.6374069, -0.88102056, -0.35932663, 0.76641204, 1.37224823, 0.80110491, -0.09383853, -1.06526571, -0.92089166, -1.25009631, 0.86933031, 1.08139317, -0.21389943, -0.29729696, -0.49108602, -1.44219054, -2.13272362, 0.43254361, -2.4264608, 0.03913172, -2.10207208, 0.325215, 0.39630265, -0.8688316, -1.50615675, -1.12863429, 1.44578632, 0.98606156, 0.31468314, 1.9911631, -0.55137319, 0.2621415, 0.1923737, -0.09810319, 0.0777448, -0.33885556, 0.33010266, 0.27951233, -0.22407961, 0.84554029, -0.32179483, 0.03726981, -1.85720211, 1.57028889, -0.5119088, 0.22556426, 0.36329416, -0.32248082, -0.42739916, 0.50612102, -1.15084928, 1.29595347, 0.53677532, 0.88692833, 0.7195164, 1.53105633, -0.08339601, 0.38519189, -0.54126359, 0.3934371, -0.04443134, -0.14034935, 0.1436576, -0.61173929, 0.96681837, -0.28618283, -0.21047137, -0.19563962, 0.81262444, 0.61645571, -1.07969066, 1.31448171, 0.42680564, 1.08448355, 0.28782214, -0.63957522, 0.29314069, 0.50515311, -1.10433621, -0.43289803, 0.06417455, -0.45411224, 0.58165425, -0.27067975, 0.0046516, -0.35161842, 0.90810965, 0.68131714, -0.27448056, 0.96869178, -0.28207738, -0.31350559, -1.08746962, 0.6799498, 0.52149289, -0.02936344, -0.32937853, 0.01274816, -0.78291918, 0.08112, 0.08591271, 0.23949015, -0.02862115, 0.17460996, 0.94803397, -0.25267182, -1.0105955, 1.14011552, -0.11998052, -0.05575614, -0.17656425, -0.60141018, 0.85825837, 1.832929, 0.11616123, -1.02215088, -0.06724747, -1.41497011, 0.33560761, 0.10838589, 0.59421062, 0.15319137, -0.48201249, -0.42874771, 0.93777082, -2.07946768, -0.2967969, -2.30779622, -0.44222149, -0.54041504, -0.28057714, -1.22404525, -0.11953355, -0.34037274, 0.2312471, -0.75812311, -0.2828213, 0.75609977, 0.87904485, -1.26489836, 1.52565116, -0.65033381, -0.84135509, -0.2485903, -0.16488935, -0.25172702, 0.3477329, -0.99844413, 0.0893855, 0.28780327, -0.96530619, -0.242358, -0.1519723, 0.10513381, 0.55730621, 0.79682517, -0.68507869, -0.13450629, -1.01287481, 0.18363007, 0.90383766, -0.26592925, -0.15490325, -1.39076443, -0.53548799, 0.16275516, -0.10039016, -0.56690137, 0.38538259, 1.20824846, 0.60377151, -0.7638251, 0.44327441, 1.44355722, -0.49587772, 0.22420225, 0.17182077, -0.42703656, 0.79308676, -0.47400368, -1.0624824, -0.42177568, -0.03035576, 0.41269387, 0.45629925, 0.25374674, 0.32283297, 0.13206298, -0.60402104, -0.91304635, -1.62745707, 1.09739213, -0.46382738, -0.28101515, -0.53787157, -1.24151289, 0.50175691, -0.97062501, -0.77019526, -1.71692645, 0.03282664, 2.32275073, -1.11813113, 0.70469066, -1.54230591, -1.1383385, -0.33706747, -0.93250757, 0.32217997, -0.41700553, 0.242251, 0.30650612, -0.58911651, 0.52589335, -0.46921787, 0.91418183, 0.21868418, 1.11369361, -0.63020996, 0.37841559, 0.73907324, 0.51378083, 0.15723263, -1.09187737, 0.51967648, 0.85048528, -1.13530689, 0.36395999, -0.89721453, 0.54664475, 0.6792137, 0.50477066, -0.50894378, -1.37194282, 0.15867105, 0.09239915, 0.37469814, 0.24994239, 0.50119091, 1.54269779, -0.6706416, 0.53790454, -0.63492337, 1.86457003, 0.58128414, 0.14945862, -0.24791515, 0.0420237, 0.0906615, -1.04183374, -0.54399736, -0.12757092, 2.07130542, -0.92584469, 0.59454027, 0.23487124, 0.39683206, -0.55942401, 0.51732529, 0.67701501, -0.80296143, -0.32576941, 0.92372405, 1.2175231, 0.38067386, 1.8684185, 0.11783921, -0.98170368, 0.55072023, 0.44510892, 0.36175759, -2.11172248, -0.8916535, 1.60434916, -0.58356423, 0.29668149, -0.02994974, -0.62444889, 0.1255661, 0.30686846, -1.35430336, 1.00883222, -0.74749257, -0.42370211, 0.18437552, -0.23553896, 1.20207397, 0.10308577, -0.90928516, 0.35294131, 0.12693428, -1.07397856, -0.59713218, -0.25705171, 0.27335295, 0.72726503, 0.58699804, -1.08700317, 0.05361932, -0.07838087, -0.24359964, 0.27206324, -1.9747832, 0.09044784, 0.23963839, 1.1210887, -0.34476586, -0.05390602, -0.97798433, -0.2580312, -0.46785939, -1.28640683, -0.48116196, -1.08511232, 0.91303967, -0.00981035, -0.19092695, 1.21165886, 0.79930205, -0.29222441, -1.20949773, 0.19549155, -0.67057537, -0.28368857, 0.33762435, -1.46314261, -0.52300149, 0.55728648, 0.6614403, -0.73736149, 0.60679283, 0.01322986, 0.10691289, 0.95144079, 1.14280532, 0.37810556, 0.7877654, 0.39875916, 0.54401124, -0.94842052, -0.58577268, 0.07336514, -0.02945687, 0.13338976, 0.23458857, -0.43544024, -0.23964248, -0.61324835, -0.64090124, 0.1430133, -0.00487549, 0.93319645, 0.55883759, 0.02950665, 0.21708047, -1.3840952, 0.01447969, -0.32766332, -0.65174139, 0.61389871, 0.53423373, 0.28791145, 0.57796969, 0.73634194, -0.34640685, -1.23122208, -0.40988897, 0.06962836, -0.58396723, 0.38203411, 0.09525111, 0.22925928, -1.16372368, -1.15540007, 1.67766596, -0.73288039, -1.25411198, -0.64515158, 1.96350625, 0.17202138, 0.35067004, -0.30376851, -0.44363068, 0.79980172, -1.29932015, 1.24662216, -0.37796555, 0.48784635, -0.452864, -1.02512885, 0.50969432, -0.44332496, 1.27764998, -0.80020406, 0.2701772, 0.02126923, -0.02164232, -0.43830262, -0.57008661, -1.40659458, -0.15879656, -0.15631167, -0.08277834, -0.09763538, 0.4118147, -0.26870572, -0.22553143, -0.0895887, 0.25321171, 0.05238375, 2.20891027, -1.06131454, -0.37405243, -0.31089764, 0.54375899, -0.34856757, -0.23066228, -0.44270574, 0.39664335, 0.81196829, 0.63450371, -1.43365069, 0.84786801, -0.3539834, 0.45190736, -0.01934647, 0.03358416, 0.86665387, 1.05958246, 1.33280375, 0.18920066, -0.0841888, 0.75624156, 0.04543624, -1.35132747, 0.76660726, 1.75344839, -1.01596493, 0.14541376, -1.61123373, -0.52468053, 0.14907125, 1.21939154, 0.23483468, 0.79496956, -0.33412805, -0.191458, 0.10226586]);
  const b1 = new Float64Array([-0.91355268, -0.87070198, 0.41124037, -1.66458568, -1.09202031, -0.94673716, 0.12325392, 1.10532947, 0.6029771, 0.43586794, 0.86991524, 0.94694866, -0.09989365, -0.15308725, -0.08878927, -0.4139521, 0.05640633, -0.18722887, 0.27566086, 1.04294795, 0.57061558, -0.11254251, 0.13120158, -0.51889912]);
  const W2 = new Float64Array([-0.39101005, 1.19772359, -0.19486322, -0.41842124, 0.21699621, 1.0673606, -0.17331125, 0.84637513, -1.29732562, 0.32609972, -0.53813354, 0.95599952, 0.45503628, 0.38170159, -0.82797458, 0.34066737, 0.52320909, -0.19998215, -0.04932509, 0.09570761, -0.54745287, -0.01473933, 0.60903973, -0.76915922, 0.53293917, -0.84165048, -1.12742268, 0.81135193, 0.23538672, -0.66166939, -1.7935203, -0.05970403, 0.12318274, 0.20608634, -2.44324465, -0.35511585, 0.09519606, 0.65790167, -0.31877675, 0.19846695, -1.4348369, 0.11971173, 1.89943336, -0.00832907, 1.74558264, 0.92096183, 0.09905133, 0.17456376, -1.78602134, -0.45840169, 0.36421512, 0.14650199, -0.95535866, -0.44832478, -0.02551332, 0.85972233, -0.24644041, -1.10765484, -0.53185249, 0.91308762, -0.63694861, -0.03685392, 0.34484216, -1.18818758, 0.76830778, -1.18234368, -0.24924705, 0.15613112, 0.19228246, 1.03564328, -1.20192194, -1.1492515, 0.23707356, 1.10827729, -0.60627964, -0.51220655, -1.45365101, -0.17954398, 0.55062773, 0.70419581, -1.17458023, 0.67053822, -0.9195385, -0.0304095, 1.10384981, 0.34893148, -0.63698147, -1.05865059, 0.19793153, -0.14145941, 0.5780783, 0.15900951, 1.0817889, 1.47972053, -0.34433412, 0.41947027, 1.25880016, -1.20531196, -0.19543132, -0.47090516, 0.66479872, 0.12301287, -0.20521629, -0.04141733, -1.01292904, 0.64230154, -0.11723859, -0.86454631, 1.0062113, -0.86331685, 0.89762959, 0.2563134, 0.66381251, -0.2767988, 0.19529085, 0.85572657, 1.20917564, -0.48632239, 0.8449259, 0.61322875, 0.05506075, 0.26667272, -0.28019898, 0.28371957, -0.67776057, 0.805545, 0.45669023, 0.16501652, 0.44845882, 0.16818634, 1.05596923, 0.59937922, 1.05904807, -0.48131244, -0.4641335, -0.43744222, -1.28673296, 0.17290186, -0.86016236, 0.08563316, -0.33879498, -0.23934364, -0.27013216, 0.94880382, -1.21670607, 0.93102684, -0.26926236, -0.70170043, -0.16027738, -0.35115506, -0.26145072, 2.01332327, 2.23790121, -0.06096779, -0.58100221, 0.13251493, -0.23499508, 0.19603137, -0.78430496, -0.73487433, 0.36634026, 0.68686482, -1.44588931, 1.1677849, -1.08861335, 0.78081935, 0.05768332, 0.24254049, -0.4105792, -0.44829249, 0.66037878, 0.51360438, -0.34304538, -0.43158583, 0.56727096, -1.2467341, 0.10431655, 1.03366846, -0.7070454, -0.17855006, -1.65119901, 0.49969941, -0.7020062, -0.00841413, 0.55009647, 0.03235827, -0.7289044, 0.33529386, 0.16619045, 0.16025567, -0.90203847, 0.38954317, 0.11420667, -1.01540325, -0.9998046, -0.29193176, -0.71543667, -0.83426144, -1.42647826, -0.50944955, 1.69930679, -0.9531359, -0.0881469, -0.89596168, -0.05697037, 0.19117627, -0.59262638, 0.62895525, -0.39637293, -0.19136155, -0.90641635, 1.37386457, -0.7650469, 0.21123596, 0.68246506, -0.08855019, -0.00179495, -0.4440947, -0.37358151, 0.77524949, -1.21019134, -0.01081283, -2.2468061, -0.41742993, 0.44541011, -0.02879125, -0.883017, -0.42028702, -0.18418398, -0.42523977, 0.55157451, 0.256177, 0.66748387, -0.66375502, 0.50224263, 0.38817544, 1.02275358, 0.68315557, -0.13082946, 0.1196848, -0.58391537, -0.49732442, 0.47418088, -0.67041222, -0.82388795, -0.7869437, 0.37597356, -0.02892626, -0.32466638, -1.60690768, 0.56701345, 0.30710392, -0.15586901, 0.70998681, 0.64431622, -0.49525933, 0.25914444, 0.06337661, -0.13631046, 0.59283474, 0.1997798, 0.58428025, -0.57907968, 0.81439319, -1.43485811, -1.41784912, -0.44055419, 0.96640439, -0.1853551, 0.59501819, -0.67797756, 0.40188138, -0.58240855, 1.58653835, -0.54020392, -0.44365852, 0.45794439, 1.07054881, -0.82598632, 0.24297082, 0.08897226, -0.58487712, 1.55396428, 0.10536166, 0.36037907, 1.37788924, -0.04296883, 0.01644336, 0.06803663, -1.45917471, -1.07931521, -0.10719955, -0.0666856, 0.10674127, -2.04722911, 0.53412468, -0.91875481, -0.33161022, -0.51875605, 0.66116491, 0.21080735, 0.32701681, -1.01521306, 0.25277114, -0.69437636, -0.29041846, -0.16703197, -0.70699259, -0.37424297, 0.25647941, 0.99423571, -0.80922827, 0.10076276, -0.55769158, -0.20010836, -0.44710712, 0.73350762, 0.9024919, 0.27399365, 1.02730211, -0.44314363, 0.57594137, 0.3143584, -0.22724377, -1.09079201, -0.98569955, -0.62836703, -0.74868993, -0.62246642, 0.28138704, 1.68750249, 0.62198314, 0.16221682, 0.03407235, -1.50886606, -0.05763024, -1.11914352, 0.71505442, -0.16318884, -0.82529562, 0.99253544, -0.44995929, 0.77366227, -0.05075338, 0.55611837, -0.17419227, 0.69696286, 0.82126117, 0.52144319, -0.70846481, 0.22355823, 0.43818369, 0.13823656, 1.01800172, 1.03639745, 0.22537657, 0.27254533, 0.54866374, 1.08363174, -0.81009257, 0.67157389, 0.57668907, 0.5341318, 0.08167226, 0.43659313, 0.88662754, -0.6163709, -0.77811463, 0.4200892, 0.03711952, -1.36094023, -1.47031612, 3.04469214, 0.81736596, -0.1702907, -0.96679893, 0.17491281, -1.50397131, 1.04129231, 1.53228621, 0.64936712, 0.29368134, -0.54792457, -0.05076702]);
  const b2 = new Float64Array([0.53650273, 0.43899001, -0.5399926, 0.57371228, -0.04237427, -0.03477971, -1.24436399, -0.47568171, -0.04294208, -0.11719525, 0.60658153, -1.04535481, 0.38062967, 0.4118214, -0.67819525, 0.22612087]);
  const W3 = new Float64Array([-1.34236789, 4.7910391, -3.16236796, 6.35912732, -3.11404252, -0.59455314, 3.62919724, -2.94227737, -1.96914449, -2.26977283, 0.88295064, 0.511257, -0.31304668, -1.77660542, -1.37439757, 3.80847703, 0.22327747, 5.34706316, 0.74653803, 9.42706366, -0.16314412, 1.18535867, 3.5342742, -1.95507176, -1.53742427, -1.67268726, 0.23459691, 1.86369691, 1.12076071, -0.46798693, 0.87922565, 1.32317368, -0.70669292, 0.6686808, -1.25783634, 2.29198085, -1.1133254, -0.19967089, 1.39002281, 1.19003418, 0.58681711, -2.88955933, 0.11167233, 0.99386488, -5.03316814, -0.32790194, -1.83781663, -1.22631643, -0.45576488, 0.37244254, -0.30202311, 6.45081659, 4.30647512, 2.30316532, 1.62710317, 5.26810776, -1.40458646, 4.40567122, 2.26522765, -0.06847686, 0.59498059, -3.31308458, 0.05470294, -5.52913296, -1.0095507, 7.3522182, -4.13212434, 9.85478382, -5.59380271, -0.0934431, 0.20167313, -1.2324226, -4.63393761, -0.7469662, 2.80866314, 2.61498793, -0.60258475, 0.57910842, -1.25070946, 0.51067688]);
  const b3 = new Float64Array([-0.03206237, 0.18140681, -0.20552047, -0.29580895, -1.16761373]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.90359643, 0.89349442, 0.04957289, 0.08743022, -1.8454155, -0.82878719, -0.87983553, -0.134381, -0.60636263, -0.69778397, -0.14807724, 0.75132619, 0.89645174, 0.24183907, -0.60701476, -0.44340639, -0.31965644, 0.05610465, 0.4455623, -0.53368952, 0.61679824, 0.28615061, -1.31305845, 0.41423849, 0.42741566, 0.05342415, 0.06567655, -0.35020656, 0.15411461, 0.22793669, 0.67485867, -0.35112825, -0.31695235, -0.10242266, 0.14508486, 0.9856674, -0.41007171, -0.94825231, -0.30662951, -0.13608729, 0.56217131, 0.31343612, 1.21048289, 0.10936584, 0.87900723, 0.1662101, -0.36370755, -0.29853346, -0.56048345, -0.74327357, 0.65106491, -0.52293955, 0.46158489, 1.04624972, 0.59728072, -1.02360689, -1.70310221, 0.86957424, -0.11964101, -1.99064077, -0.44684641, -0.5158244, -0.407172, -0.14529276, 0.4639493, -0.84208459, -0.64160476, 0.04155892, -1.36428184, -0.53309765, -0.25092378, 0.64410279, 0.6684488, 0.67340058, 0.34313323, -0.84853366, 0.50479216, -0.74550011, -1.08621808, -0.13982881, -0.41874448, -0.50980177, 0.93267184, 0.71174491, 0.25322283, 0.49080686, -0.56665893, 0.54617207, -0.1445592, 1.70314862, -0.63296559, -0.91048313, 0.46160408, -0.71462071, 0.44835445, 0.16222459, 0.72067127, -0.77499831, 0.62544856, 0.53549091, 1.12981976, -0.3707994, 0.92524124, 0.6771095, -0.23244233, -0.3476181, -1.13463197, -1.40613607, 0.47157517, 0.68803301, 1.82269145, 1.79189336, 0.50481263, -0.55981634, -1.39372013, -0.73608395, -0.34446371, 0.83453839, 0.74315683, -0.32212376, -1.67549663, -0.55745469, -0.3573323, -0.07757036, 0.4611693, -0.39881591, -0.5404616, 0.06827969, -1.29080068, 0.37028792, 0.6038951, 0.26826324, 0.27257345, -0.4661513, 0.25396945, -0.50278759, -0.47894509, 0.96792538, 0.50823379, 0.09736401, 0.39318202, -1.22439108, -1.03644419, 0.43520677, 0.1529969, -0.72484852, 1.10517341, -0.55529466, 0.87818818, -0.43190628, -0.16761389, 0.85310645, -0.31125, 0.45831506, 0.62629728, -0.26968756, 0.45490432, -1.1400148, -0.22315384, 0.12936247, 0.12265046, -0.1331749, 0.66209766, -0.48804924, 0.27635959, -1.08856148, 0.6221609, -0.84368061, -0.63570788, -0.24371238, 0.47080477, 1.02505131, 0.7663501, -0.62667481, -0.6172142, -0.7519107, 0.31502092, -1.85604045, 0.16838324, -0.57917279, 0.86173683, 0.39359544, 0.48048385, -0.2221504, 0.4734209, -0.02994776, 0.15389729, -0.19487792, -0.78648795, -0.59276262, 1.08691167, 0.15913024, -0.37188516, -0.40182288, -0.66424096, -0.67543462, 0.98083462, -0.68719361, 0.44992053, -0.32256603, -0.80667763, 0.9439827, -0.2583678, 0.24899836, -1.62191709, -0.55938253, -0.67010962, 0.07998438, 0.28113666, 0.78712812, 0.66224719, 1.34403337, 0.33573096, -0.25454834, 0.39411477, 0.57864545, -0.47659797, -0.2839782, -0.06313033, 0.37037057, 0.0308814, -0.42756839, -0.66738015, 0.04861556, -0.5326522, 0.3481198, 0.21322218, 0.00703293, 0.4785263, -0.22538812, -0.91653689, 1.30307146, -0.50723395, -0.58848768, -0.43917418, 1.59354496, -0.94851343, 0.24545711, -0.62198641, -1.85373582, -0.12403065, -2.63568773, -1.61800744, -0.6254986, 0.35797023, -0.98869105, -0.64823402, -1.0884566, -0.38163264, 0.12367017, -0.39331279, 0.03266502, -0.19338726, -1.23195773, -0.22766554, -1.1326141, -1.17884757, -0.18603309, -0.64566925, -0.06755378, -0.11267509, 0.68909307, 1.05574519, 0.06511791, -0.37128243, 0.63803511, 0.9261499, -0.20793908, 1.60527582, -2.3347344, -0.92326159, -0.59969809, -0.47791809, -0.7015215, 0.07149392, -0.46402163, -0.11785431, 0.12557569, -0.77536438, -0.75373192, -1.1744009, -0.69941857, 0.29257857, -0.90632601, -0.75851474, -0.04125091, -0.07871412, 0.46570424, 0.19240297, 0.63025103, -0.00654598, -0.56182025, 0.20083097, -0.76149205, 1.19034258, -0.29175814, 0.61675966, -0.39067853, 0.24754634, -0.05915669, 0.44446928, 0.40102534, 0.17742453, -0.92674023, 0.03710063, 0.13228865, -1.68415156, -0.23548321, 0.39147227, 1.09307483, -0.52409528, -0.89369076, 0.81950551, 0.45287926, 0.22416069, -0.6480729, 0.36376494, 1.40885498, 0.24475942, -0.64101476, -0.49944498, -0.23085023, 0.1188007, 0.31913653, -0.97104541, -0.886285, 0.15392372, -0.01110991, 0.01690542, -0.83438227, 0.67415965, 1.52574702, 0.39042469, 1.53075575, 0.18808267, 1.12729364, 0.64115541, 0.36158171, -1.71628396, 0.38952374, 1.35832331, 0.10235417, 0.11630661, 0.03581733, -0.6127751, 2.7363918, 0.11785807, 1.07857098, 0.95324957, -0.31300016, 0.77725349, 0.22833057, -0.51928513, -1.71948255, -0.84657199, -0.15062949, -0.4128615, 0.91400082, -0.11482955, -0.11245562, -0.89824522, 0.35983888, -1.49467663, 0.18290103, 0.4666928, -1.07869417, -0.37971559, 0.9959408, -0.14664443, -1.33831526, 0.49786503, 1.4252852, -0.70843323, 1.15169705, -0.16205604, -0.46566615, 0.67218311, 0.29089919, -0.6862955, 0.63096517, 0.70085961, 0.18603292, -0.44003535, -0.32013682, 1.17227242, -0.66107012, -0.00550025, -0.13168146, -0.90349801, 0.39975525, 1.04997284, -1.364288, 0.97499554, -0.14993244, 0.08349506, -0.26154993, 0.19792199, -0.65906871, 1.29500774, 0.46653783, 0.00789562, -1.23000877, 2.56764017, -0.09223225, 0.69106525, -0.80073, -0.97388302, 0.08611091, 0.7389657, 1.4245678, 0.74208422, -0.16101413, -1.02951166, -0.14937286, 0.44258856, -0.88251707, -0.18268053, 0.70784674, -0.10320719, 0.71930213, 0.14427284, 0.48769923, -0.88780412, 0.35584476, -0.91754977, -1.38952887, -0.06247966, 0.79868735, 0.10629785, -0.14867422, 1.62060367, 1.28694111, 0.21464597, 1.03687006, 0.76567074, 0.32099684, -0.53905136, 0.84355275, -0.48418366, -1.1060037, -0.4201436, -0.43914775, 0.07482209, 1.18749084, -1.12929607, 0.093327, -0.31157728, 0.82690981, -1.07396043, 0.20653979, -0.10117669, 0.52148172, -0.17735615, 1.21302175, -1.68445554, -0.98052755, 0.30236988, -0.1669214, 0.62724799, 1.31545614, -0.0317346, -1.1314614, -1.08388703, 0.0314917, -0.55552648, -0.71017459, 0.98861606, 1.74708233, -0.49810112, -0.49224772, 0.96433668, 0.75460385, -0.48704318, -0.26026318, 0.24189768, -0.13191207, -1.2000126, -1.50835938, 0.6623955, 0.01353638, -0.84737336, -0.58138871, -0.00161026, 0.17792767, 1.3536212, 1.01168518, -0.72224477, -0.42821178, -0.8122286, -0.54385066, 0.63861282, -0.81493548, 1.1094069, 0.2144904, -0.99543601, -1.64119161, -1.03630542, 0.25592178, 0.12017048, -0.66760402, 0.69581659, -0.13280771, 0.10556089, 1.33508116, 0.70851276, 0.20315195, -0.07789412, -0.15486419, 0.43326581, -0.79717945, 1.69731963, -0.02838722, 0.07202702, -0.83822777, 0.06086179, -0.41010772, 1.35534918, -0.02473134, -1.07087704, 0.42304222, -0.9027866, -0.21455583, 0.66024329, -0.31368634, 0.79110026, 1.6932598, -0.74350254, 0.16789374, -0.28272111, -0.04142504, -1.19896365, -1.33834908, -0.46989842, 0.00601124, 0.73028833, -1.39314054, 0.06792769, -0.85153035, -0.93143868, -0.77752074, -0.60910231, 1.10223638, 1.50677246, -0.66799525, -0.39776376, 0.51450602, 0.0692703, -0.03491472, -0.95669038, -1.10694158, -0.79085666, 0.9318639, -0.27760039, -0.02923176, -0.08813614, -1.25349881, 0.30583843, -0.40447983, -0.83068834, 1.32362798, 0.19340083, 0.0237453, -0.31541616, -0.58708282, 0.11188402, 0.43303559, -0.02016469, -0.17327859, -1.07234177, 0.36326551, -2.02041364, 0.69410398, 0.72974564, 0.62362027, -0.5427528, 0.34716325, -0.33930544, 1.48893151, -0.55326448, -0.84705042, -0.08250216, 0.28625436, -0.02485747, -1.72736747, 2.6374069, -0.88102056, -0.35932663, 0.76641204, 1.37224823, 0.80110491, -0.09383853, -1.06526571, -0.92089166, -1.25009631, 0.86933031, 1.08139317, -0.21389943, -0.29729696, -0.49108602, -1.44219054, -2.13272362, 0.43254361, -2.4264608, 0.03913172, -2.10207208, 0.325215, 0.39630265, -0.8688316, -1.50615675, -1.12863429, 1.44578632, 0.98606156, 0.31468314, 1.9911631, -0.55137319, 0.2621415, 0.1923737, -0.09810319, 0.0777448, -0.33885556, 0.33010266, 0.27951233, -0.22407961, 0.84554029, -0.32179483, 0.03726981, -1.85720211, 1.57028889, -0.5119088, 0.22556426, 0.36329416, -0.32248082, -0.42739916, 0.50612102, -1.15084928, 1.29595347, 0.53677532, 0.88692833, 0.7195164, 1.53105633, -0.08339601, 0.38519189, -0.54126359, 0.3934371, -0.04443134, -0.14034935, 0.1436576, -0.61173929, 0.96681837, -0.28618283, -0.21047137, -0.19563962, 0.81262444, 0.61645571, -1.07969066, 1.31448171, 0.42680564, 1.08448355, 0.28782214, -0.63957522, 0.29314069, 0.50515311, -1.10433621, -0.43289803, 0.06417455, -0.45411224, 0.58165425, -0.27067975, 0.0046516, -0.35161842, 0.90810965, 0.68131714, -0.27448056, 0.96869178, -0.28207738, -0.31350559, -1.08746962, 0.6799498, 0.52149289, -0.02936344, -0.32937853, 0.01274816, -0.78291918, 0.08112, 0.08591271, 0.23949015, -0.02862115, 0.17460996, 0.94803397, -0.25267182, -1.0105955, 1.14011552, -0.11998052, -0.05575614, -0.17656425, -0.60141018, 0.85825837, 1.832929, 0.11616123, -1.02215088, -0.06724747, -1.41497011, 0.33560761, 0.10838589, 0.59421062, 0.15319137, -0.48201249, -0.42874771, 0.93777082, -2.07946768, -0.2967969, -2.30779622, -0.44222149, -0.54041504, -0.28057714, -1.22404525, -0.11953355, -0.34037274, 0.2312471, -0.75812311, -0.2828213, 0.75609977, 0.87904485, -1.26489836, 1.52565116, -0.65033381, -0.84135509, -0.2485903, -0.16488935, -0.25172702, 0.3477329, -0.99844413, 0.0893855, 0.28780327, -0.96530619, -0.242358, -0.1519723, 0.10513381, 0.55730621, 0.79682517, -0.68507869, -0.13450629, -1.01287481, 0.18363007, 0.90383766, -0.26592925, -0.15490325, -1.39076443, -0.53548799, 0.16275516, -0.10039016, -0.56690137, 0.38538259, 1.20824846, 0.60377151, -0.7638251, 0.44327441, 1.44355722, -0.49587772, 0.22420225, 0.17182077, -0.42703656, 0.79308676, -0.47400368, -1.0624824, -0.42177568, -0.03035576, 0.41269387, 0.45629925, 0.25374674, 0.32283297, 0.13206298, -0.60402104, -0.91304635, -1.62745707, 1.09739213, -0.46382738, -0.28101515, -0.53787157, -1.24151289, 0.50175691, -0.97062501, -0.77019526, -1.71692645, 0.03282664, 2.32275073, -1.11813113, 0.70469066, -1.54230591, -1.1383385, -0.33706747, -0.93250757, 0.32217997, -0.41700553, 0.242251, 0.30650612, -0.58911651, 0.52589335, -0.46921787, 0.91418183, 0.21868418, 1.11369361, -0.63020996, 0.37841559, 0.73907324, 0.51378083, 0.15723263, -1.09187737, 0.51967648, 0.85048528, -1.13530689, 0.36395999, -0.89721453, 0.54664475, 0.6792137, 0.50477066, -0.50894378, -1.37194282, 0.15867105, 0.09239915, 0.37469814, 0.24994239, 0.50119091, 1.54269779, -0.6706416, 0.53790454, -0.63492337, 1.86457003, 0.58128414, 0.14945862, -0.24791515, 0.0420237, 0.0906615, -1.04183374, -0.54399736, -0.12757092, 2.07130542, -0.92584469, 0.59454027, 0.23487124, 0.39683206, -0.55942401, 0.51732529, 0.67701501, -0.80296143, -0.32576941, 0.92372405, 1.2175231, 0.38067386, 1.8684185, 0.11783921, -0.98170368, 0.55072023, 0.44510892, 0.36175759, -2.11172248, -0.8916535, 1.60434916, -0.58356423, 0.29668149, -0.02994974, -0.62444889, 0.1255661, 0.30686846, -1.35430336, 1.00883222, -0.74749257, -0.42370211, 0.18437552, -0.23553896, 1.20207397, 0.10308577, -0.90928516, 0.35294131, 0.12693428, -1.07397856, -0.59713218, -0.25705171, 0.27335295, 0.72726503, 0.58699804, -1.08700317, 0.05361932, -0.07838087, -0.24359964, 0.27206324, -1.9747832, 0.09044784, 0.23963839, 1.1210887, -0.34476586, -0.05390602, -0.97798433, -0.2580312, -0.46785939, -1.28640683, -0.48116196, -1.08511232, 0.91303967, -0.00981035, -0.19092695, 1.21165886, 0.79930205, -0.29222441, -1.20949773, 0.19549155, -0.67057537, -0.28368857, 0.33762435, -1.46314261, -0.52300149, 0.55728648, 0.6614403, -0.73736149, 0.60679283, 0.01322986, 0.10691289, 0.95144079, 1.14280532, 0.37810556, 0.7877654, 0.39875916, 0.54401124, -0.94842052, -0.58577268, 0.07336514, -0.02945687, 0.13338976, 0.23458857, -0.43544024, -0.23964248, -0.61324835, -0.64090124, 0.1430133, -0.00487549, 0.93319645, 0.55883759, 0.02950665, 0.21708047, -1.3840952, 0.01447969, -0.32766332, -0.65174139, 0.61389871, 0.53423373, 0.28791145, 0.57796969, 0.73634194, -0.34640685, -1.23122208, -0.40988897, 0.06962836, -0.58396723, 0.38203411, 0.09525111, 0.22925928, -1.16372368, -1.15540007, 1.67766596, -0.73288039, -1.25411198, -0.64515158, 1.96350625, 0.17202138, 0.35067004, -0.30376851, -0.44363068, 0.79980172, -1.29932015, 1.24662216, -0.37796555, 0.48784635, -0.452864, -1.02512885, 0.50969432, -0.44332496, 1.27764998, -0.80020406, 0.2701772, 0.02126923, -0.02164232, -0.43830262, -0.57008661, -1.40659458, -0.15879656, -0.15631167, -0.08277834, -0.09763538, 0.4118147, -0.26870572, -0.22553143, -0.0895887, 0.25321171, 0.05238375, 2.20891027, -1.06131454, -0.37405243, -0.31089764, 0.54375899, -0.34856757, -0.23066228, -0.44270574, 0.39664335, 0.81196829, 0.63450371, -1.43365069, 0.84786801, -0.3539834, 0.45190736, -0.01934647, 0.03358416, 0.86665387, 1.05958246, 1.33280375, 0.18920066, -0.0841888, 0.75624156, 0.04543624, -1.35132747, 0.76660726, 1.75344839, -1.01596493, 0.14541376, -1.61123373, -0.52468053, 0.14907125, 1.21939154, 0.23483468, 0.79496956, -0.33412805, -0.191458, 0.10226586]);
  const b1 = new Float64Array([-0.91355268, -0.87070198, 0.41124037, -1.66458568, -1.09202031, -0.94673716, 0.12325392, 1.10532947, 0.6029771, 0.43586794, 0.86991524, 0.94694866, -0.09989365, -0.15308725, -0.08878927, -0.4139521, 0.05640633, -0.18722887, 0.27566086, 1.04294795, 0.57061558, -0.11254251, 0.13120158, -0.51889912]);
  const W2 = new Float64Array([-0.39101005, 1.19772359, -0.19486322, -0.41842124, 0.21699621, 1.0673606, -0.17331125, 0.84637513, -1.29732562, 0.32609972, -0.53813354, 0.95599952, 0.45503628, 0.38170159, -0.82797458, 0.34066737, 0.52320909, -0.19998215, -0.04932509, 0.09570761, -0.54745287, -0.01473933, 0.60903973, -0.76915922, 0.53293917, -0.84165048, -1.12742268, 0.81135193, 0.23538672, -0.66166939, -1.7935203, -0.05970403, 0.12318274, 0.20608634, -2.44324465, -0.35511585, 0.09519606, 0.65790167, -0.31877675, 0.19846695, -1.4348369, 0.11971173, 1.89943336, -0.00832907, 1.74558264, 0.92096183, 0.09905133, 0.17456376, -1.78602134, -0.45840169, 0.36421512, 0.14650199, -0.95535866, -0.44832478, -0.02551332, 0.85972233, -0.24644041, -1.10765484, -0.53185249, 0.91308762, -0.63694861, -0.03685392, 0.34484216, -1.18818758, 0.76830778, -1.18234368, -0.24924705, 0.15613112, 0.19228246, 1.03564328, -1.20192194, -1.1492515, 0.23707356, 1.10827729, -0.60627964, -0.51220655, -1.45365101, -0.17954398, 0.55062773, 0.70419581, -1.17458023, 0.67053822, -0.9195385, -0.0304095, 1.10384981, 0.34893148, -0.63698147, -1.05865059, 0.19793153, -0.14145941, 0.5780783, 0.15900951, 1.0817889, 1.47972053, -0.34433412, 0.41947027, 1.25880016, -1.20531196, -0.19543132, -0.47090516, 0.66479872, 0.12301287, -0.20521629, -0.04141733, -1.01292904, 0.64230154, -0.11723859, -0.86454631, 1.0062113, -0.86331685, 0.89762959, 0.2563134, 0.66381251, -0.2767988, 0.19529085, 0.85572657, 1.20917564, -0.48632239, 0.8449259, 0.61322875, 0.05506075, 0.26667272, -0.28019898, 0.28371957, -0.67776057, 0.805545, 0.45669023, 0.16501652, 0.44845882, 0.16818634, 1.05596923, 0.59937922, 1.05904807, -0.48131244, -0.4641335, -0.43744222, -1.28673296, 0.17290186, -0.86016236, 0.08563316, -0.33879498, -0.23934364, -0.27013216, 0.94880382, -1.21670607, 0.93102684, -0.26926236, -0.70170043, -0.16027738, -0.35115506, -0.26145072, 2.01332327, 2.23790121, -0.06096779, -0.58100221, 0.13251493, -0.23499508, 0.19603137, -0.78430496, -0.73487433, 0.36634026, 0.68686482, -1.44588931, 1.1677849, -1.08861335, 0.78081935, 0.05768332, 0.24254049, -0.4105792, -0.44829249, 0.66037878, 0.51360438, -0.34304538, -0.43158583, 0.56727096, -1.2467341, 0.10431655, 1.03366846, -0.7070454, -0.17855006, -1.65119901, 0.49969941, -0.7020062, -0.00841413, 0.55009647, 0.03235827, -0.7289044, 0.33529386, 0.16619045, 0.16025567, -0.90203847, 0.38954317, 0.11420667, -1.01540325, -0.9998046, -0.29193176, -0.71543667, -0.83426144, -1.42647826, -0.50944955, 1.69930679, -0.9531359, -0.0881469, -0.89596168, -0.05697037, 0.19117627, -0.59262638, 0.62895525, -0.39637293, -0.19136155, -0.90641635, 1.37386457, -0.7650469, 0.21123596, 0.68246506, -0.08855019, -0.00179495, -0.4440947, -0.37358151, 0.77524949, -1.21019134, -0.01081283, -2.2468061, -0.41742993, 0.44541011, -0.02879125, -0.883017, -0.42028702, -0.18418398, -0.42523977, 0.55157451, 0.256177, 0.66748387, -0.66375502, 0.50224263, 0.38817544, 1.02275358, 0.68315557, -0.13082946, 0.1196848, -0.58391537, -0.49732442, 0.47418088, -0.67041222, -0.82388795, -0.7869437, 0.37597356, -0.02892626, -0.32466638, -1.60690768, 0.56701345, 0.30710392, -0.15586901, 0.70998681, 0.64431622, -0.49525933, 0.25914444, 0.06337661, -0.13631046, 0.59283474, 0.1997798, 0.58428025, -0.57907968, 0.81439319, -1.43485811, -1.41784912, -0.44055419, 0.96640439, -0.1853551, 0.59501819, -0.67797756, 0.40188138, -0.58240855, 1.58653835, -0.54020392, -0.44365852, 0.45794439, 1.07054881, -0.82598632, 0.24297082, 0.08897226, -0.58487712, 1.55396428, 0.10536166, 0.36037907, 1.37788924, -0.04296883, 0.01644336, 0.06803663, -1.45917471, -1.07931521, -0.10719955, -0.0666856, 0.10674127, -2.04722911, 0.53412468, -0.91875481, -0.33161022, -0.51875605, 0.66116491, 0.21080735, 0.32701681, -1.01521306, 0.25277114, -0.69437636, -0.29041846, -0.16703197, -0.70699259, -0.37424297, 0.25647941, 0.99423571, -0.80922827, 0.10076276, -0.55769158, -0.20010836, -0.44710712, 0.73350762, 0.9024919, 0.27399365, 1.02730211, -0.44314363, 0.57594137, 0.3143584, -0.22724377, -1.09079201, -0.98569955, -0.62836703, -0.74868993, -0.62246642, 0.28138704, 1.68750249, 0.62198314, 0.16221682, 0.03407235, -1.50886606, -0.05763024, -1.11914352, 0.71505442, -0.16318884, -0.82529562, 0.99253544, -0.44995929, 0.77366227, -0.05075338, 0.55611837, -0.17419227, 0.69696286, 0.82126117, 0.52144319, -0.70846481, 0.22355823, 0.43818369, 0.13823656, 1.01800172, 1.03639745, 0.22537657, 0.27254533, 0.54866374, 1.08363174, -0.81009257, 0.67157389, 0.57668907, 0.5341318, 0.08167226, 0.43659313, 0.88662754, -0.6163709, -0.77811463, 0.4200892, 0.03711952, -1.36094023, -1.47031612, 3.04469214, 0.81736596, -0.1702907, -0.96679893, 0.17491281, -1.50397131, 1.04129231, 1.53228621, 0.64936712, 0.29368134, -0.54792457, -0.05076702]);
  const b2 = new Float64Array([0.53650273, 0.43899001, -0.5399926, 0.57371228, -0.04237427, -0.03477971, -1.24436399, -0.47568171, -0.04294208, -0.11719525, 0.60658153, -1.04535481, 0.38062967, 0.4118214, -0.67819525, 0.22612087]);
  const W3 = new Float64Array([-1.34236789, 4.7910391, -3.16236796, 6.35912732, -3.11404252, -0.59455314, 3.62919724, -2.94227737, -1.96914449, -2.26977283, 0.88295064, 0.511257, -0.31304668, -1.77660542, -1.37439757, 3.80847703, 0.22327747, 5.34706316, 0.74653803, 9.42706366, -0.16314412, 1.18535867, 3.5342742, -1.95507176, -1.53742427, -1.67268726, 0.23459691, 1.86369691, 1.12076071, -0.46798693, 0.87922565, 1.32317368, -0.70669292, 0.6686808, -1.25783634, 2.29198085, -1.1133254, -0.19967089, 1.39002281, 1.19003418, 0.58681711, -2.88955933, 0.11167233, 0.99386488, -5.03316814, -0.32790194, -1.83781663, -1.22631643, -0.45576488, 0.37244254, -0.30202311, 6.45081659, 4.30647512, 2.30316532, 1.62710317, 5.26810776, -1.40458646, 4.40567122, 2.26522765, -0.06847686, 0.59498059, -3.31308458, 0.05470294, -5.52913296, -1.0095507, 7.3522182, -4.13212434, 9.85478382, -5.59380271, -0.0934431, 0.20167313, -1.2324226, -4.63393761, -0.7469662, 2.80866314, 2.61498793, -0.60258475, 0.57910842, -1.25070946, 0.51067688]);
  const b3 = new Float64Array([-0.03206237, 0.18140681, -0.20552047, -0.29580895, -1.16761373]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.90359643, 0.89349442, 0.04957289, 0.08743022, -1.8454155, -0.82878719, -0.87983553, -0.134381, -0.60636263, -0.69778397, -0.14807724, 0.75132619, 0.89645174, 0.24183907, -0.60701476, -0.44340639, -0.31965644, 0.05610465, 0.4455623, -0.53368952, 0.61679824, 0.28615061, -1.31305845, 0.41423849, 0.42741566, 0.05342415, 0.06567655, -0.35020656, 0.15411461, 0.22793669, 0.67485867, -0.35112825, -0.31695235, -0.10242266, 0.14508486, 0.9856674, -0.41007171, -0.94825231, -0.30662951, -0.13608729, 0.56217131, 0.31343612, 1.21048289, 0.10936584, 0.87900723, 0.1662101, -0.36370755, -0.29853346, -0.56048345, -0.74327357, 0.65106491, -0.52293955, 0.46158489, 1.04624972, 0.59728072, -1.02360689, -1.70310221, 0.86957424, -0.11964101, -1.99064077, -0.44684641, -0.5158244, -0.407172, -0.14529276, 0.4639493, -0.84208459, -0.64160476, 0.04155892, -1.36428184, -0.53309765, -0.25092378, 0.64410279, 0.6684488, 0.67340058, 0.34313323, -0.84853366, 0.50479216, -0.74550011, -1.08621808, -0.13982881, -0.41874448, -0.50980177, 0.93267184, 0.71174491, 0.25322283, 0.49080686, -0.56665893, 0.54617207, -0.1445592, 1.70314862, -0.63296559, -0.91048313, 0.46160408, -0.71462071, 0.44835445, 0.16222459, 0.72067127, -0.77499831, 0.62544856, 0.53549091, 1.12981976, -0.3707994, 0.92524124, 0.6771095, -0.23244233, -0.3476181, -1.13463197, -1.40613607, 0.47157517, 0.68803301, 1.82269145, 1.79189336, 0.50481263, -0.55981634, -1.39372013, -0.73608395, -0.34446371, 0.83453839, 0.74315683, -0.32212376, -1.67549663, -0.55745469, -0.3573323, -0.07757036, 0.4611693, -0.39881591, -0.5404616, 0.06827969, -1.29080068, 0.37028792, 0.6038951, 0.26826324, 0.27257345, -0.4661513, 0.25396945, -0.50278759, -0.47894509, 0.96792538, 0.50823379, 0.09736401, 0.39318202, -1.22439108, -1.03644419, 0.43520677, 0.1529969, -0.72484852, 1.10517341, -0.55529466, 0.87818818, -0.43190628, -0.16761389, 0.85310645, -0.31125, 0.45831506, 0.62629728, -0.26968756, 0.45490432, -1.1400148, -0.22315384, 0.12936247, 0.12265046, -0.1331749, 0.66209766, -0.48804924, 0.27635959, -1.08856148, 0.6221609, -0.84368061, -0.63570788, -0.24371238, 0.47080477, 1.02505131, 0.7663501, -0.62667481, -0.6172142, -0.7519107, 0.31502092, -1.85604045, 0.16838324, -0.57917279, 0.86173683, 0.39359544, 0.48048385, -0.2221504, 0.4734209, -0.02994776, 0.15389729, -0.19487792, -0.78648795, -0.59276262, 1.08691167, 0.15913024, -0.37188516, -0.40182288, -0.66424096, -0.67543462, 0.98083462, -0.68719361, 0.44992053, -0.32256603, -0.80667763, 0.9439827, -0.2583678, 0.24899836, -1.62191709, -0.55938253, -0.67010962, 0.07998438, 0.28113666, 0.78712812, 0.66224719, 1.34403337, 0.33573096, -0.25454834, 0.39411477, 0.57864545, -0.47659797, -0.2839782, -0.06313033, 0.37037057, 0.0308814, -0.42756839, -0.66738015, 0.04861556, -0.5326522, 0.3481198, 0.21322218, 0.00703293, 0.4785263, -0.22538812, -0.91653689, 1.30307146, -0.50723395, -0.58848768, -0.43917418, 1.59354496, -0.94851343, 0.24545711, -0.62198641, -1.85373582, -0.12403065, -2.63568773, -1.61800744, -0.6254986, 0.35797023, -0.98869105, -0.64823402, -1.0884566, -0.38163264, 0.12367017, -0.39331279, 0.03266502, -0.19338726, -1.23195773, -0.22766554, -1.1326141, -1.17884757, -0.18603309, -0.64566925, -0.06755378, -0.11267509, 0.68909307, 1.05574519, 0.06511791, -0.37128243, 0.63803511, 0.9261499, -0.20793908, 1.60527582, -2.3347344, -0.92326159, -0.59969809, -0.47791809, -0.7015215, 0.07149392, -0.46402163, -0.11785431, 0.12557569, -0.77536438, -0.75373192, -1.1744009, -0.69941857, 0.29257857, -0.90632601, -0.75851474, -0.04125091, -0.07871412, 0.46570424, 0.19240297, 0.63025103, -0.00654598, -0.56182025, 0.20083097, -0.76149205, 1.19034258, -0.29175814, 0.61675966, -0.39067853, 0.24754634, -0.05915669, 0.44446928, 0.40102534, 0.17742453, -0.92674023, 0.03710063, 0.13228865, -1.68415156, -0.23548321, 0.39147227, 1.09307483, -0.52409528, -0.89369076, 0.81950551, 0.45287926, 0.22416069, -0.6480729, 0.36376494, 1.40885498, 0.24475942, -0.64101476, -0.49944498, -0.23085023, 0.1188007, 0.31913653, -0.97104541, -0.886285, 0.15392372, -0.01110991, 0.01690542, -0.83438227, 0.67415965, 1.52574702, 0.39042469, 1.53075575, 0.18808267, 1.12729364, 0.64115541, 0.36158171, -1.71628396, 0.38952374, 1.35832331, 0.10235417, 0.11630661, 0.03581733, -0.6127751, 2.7363918, 0.11785807, 1.07857098, 0.95324957, -0.31300016, 0.77725349, 0.22833057, -0.51928513, -1.71948255, -0.84657199, -0.15062949, -0.4128615, 0.91400082, -0.11482955, -0.11245562, -0.89824522, 0.35983888, -1.49467663, 0.18290103, 0.4666928, -1.07869417, -0.37971559, 0.9959408, -0.14664443, -1.33831526, 0.49786503, 1.4252852, -0.70843323, 1.15169705, -0.16205604, -0.46566615, 0.67218311, 0.29089919, -0.6862955, 0.63096517, 0.70085961, 0.18603292, -0.44003535, -0.32013682, 1.17227242, -0.66107012, -0.00550025, -0.13168146, -0.90349801, 0.39975525, 1.04997284, -1.364288, 0.97499554, -0.14993244, 0.08349506, -0.26154993, 0.19792199, -0.65906871, 1.29500774, 0.46653783, 0.00789562, -1.23000877, 2.56764017, -0.09223225, 0.69106525, -0.80073, -0.97388302, 0.08611091, 0.7389657, 1.4245678, 0.74208422, -0.16101413, -1.02951166, -0.14937286, 0.44258856, -0.88251707, -0.18268053, 0.70784674, -0.10320719, 0.71930213, 0.14427284, 0.48769923, -0.88780412, 0.35584476, -0.91754977, -1.38952887, -0.06247966, 0.79868735, 0.10629785, -0.14867422, 1.62060367, 1.28694111, 0.21464597, 1.03687006, 0.76567074, 0.32099684, -0.53905136, 0.84355275, -0.48418366, -1.1060037, -0.4201436, -0.43914775, 0.07482209, 1.18749084, -1.12929607, 0.093327, -0.31157728, 0.82690981, -1.07396043, 0.20653979, -0.10117669, 0.52148172, -0.17735615, 1.21302175, -1.68445554, -0.98052755, 0.30236988, -0.1669214, 0.62724799, 1.31545614, -0.0317346, -1.1314614, -1.08388703, 0.0314917, -0.55552648, -0.71017459, 0.98861606, 1.74708233, -0.49810112, -0.49224772, 0.96433668, 0.75460385, -0.48704318, -0.26026318, 0.24189768, -0.13191207, -1.2000126, -1.50835938, 0.6623955, 0.01353638, -0.84737336, -0.58138871, -0.00161026, 0.17792767, 1.3536212, 1.01168518, -0.72224477, -0.42821178, -0.8122286, -0.54385066, 0.63861282, -0.81493548, 1.1094069, 0.2144904, -0.99543601, -1.64119161, -1.03630542, 0.25592178, 0.12017048, -0.66760402, 0.69581659, -0.13280771, 0.10556089, 1.33508116, 0.70851276, 0.20315195, -0.07789412, -0.15486419, 0.43326581, -0.79717945, 1.69731963, -0.02838722, 0.07202702, -0.83822777, 0.06086179, -0.41010772, 1.35534918, -0.02473134, -1.07087704, 0.42304222, -0.9027866, -0.21455583, 0.66024329, -0.31368634, 0.79110026, 1.6932598, -0.74350254, 0.16789374, -0.28272111, -0.04142504, -1.19896365, -1.33834908, -0.46989842, 0.00601124, 0.73028833, -1.39314054, 0.06792769, -0.85153035, -0.93143868, -0.77752074, -0.60910231, 1.10223638, 1.50677246, -0.66799525, -0.39776376, 0.51450602, 0.0692703, -0.03491472, -0.95669038, -1.10694158, -0.79085666, 0.9318639, -0.27760039, -0.02923176, -0.08813614, -1.25349881, 0.30583843, -0.40447983, -0.83068834, 1.32362798, 0.19340083, 0.0237453, -0.31541616, -0.58708282, 0.11188402, 0.43303559, -0.02016469, -0.17327859, -1.07234177, 0.36326551, -2.02041364, 0.69410398, 0.72974564, 0.62362027, -0.5427528, 0.34716325, -0.33930544, 1.48893151, -0.55326448, -0.84705042, -0.08250216, 0.28625436, -0.02485747, -1.72736747, 2.6374069, -0.88102056, -0.35932663, 0.76641204, 1.37224823, 0.80110491, -0.09383853, -1.06526571, -0.92089166, -1.25009631, 0.86933031, 1.08139317, -0.21389943, -0.29729696, -0.49108602, -1.44219054, -2.13272362, 0.43254361, -2.4264608, 0.03913172, -2.10207208, 0.325215, 0.39630265, -0.8688316, -1.50615675, -1.12863429, 1.44578632, 0.98606156, 0.31468314, 1.9911631, -0.55137319, 0.2621415, 0.1923737, -0.09810319, 0.0777448, -0.33885556, 0.33010266, 0.27951233, -0.22407961, 0.84554029, -0.32179483, 0.03726981, -1.85720211, 1.57028889, -0.5119088, 0.22556426, 0.36329416, -0.32248082, -0.42739916, 0.50612102, -1.15084928, 1.29595347, 0.53677532, 0.88692833, 0.7195164, 1.53105633, -0.08339601, 0.38519189, -0.54126359, 0.3934371, -0.04443134, -0.14034935, 0.1436576, -0.61173929, 0.96681837, -0.28618283, -0.21047137, -0.19563962, 0.81262444, 0.61645571, -1.07969066, 1.31448171, 0.42680564, 1.08448355, 0.28782214, -0.63957522, 0.29314069, 0.50515311, -1.10433621, -0.43289803, 0.06417455, -0.45411224, 0.58165425, -0.27067975, 0.0046516, -0.35161842, 0.90810965, 0.68131714, -0.27448056, 0.96869178, -0.28207738, -0.31350559, -1.08746962, 0.6799498, 0.52149289, -0.02936344, -0.32937853, 0.01274816, -0.78291918, 0.08112, 0.08591271, 0.23949015, -0.02862115, 0.17460996, 0.94803397, -0.25267182, -1.0105955, 1.14011552, -0.11998052, -0.05575614, -0.17656425, -0.60141018, 0.85825837, 1.832929, 0.11616123, -1.02215088, -0.06724747, -1.41497011, 0.33560761, 0.10838589, 0.59421062, 0.15319137, -0.48201249, -0.42874771, 0.93777082, -2.07946768, -0.2967969, -2.30779622, -0.44222149, -0.54041504, -0.28057714, -1.22404525, -0.11953355, -0.34037274, 0.2312471, -0.75812311, -0.2828213, 0.75609977, 0.87904485, -1.26489836, 1.52565116, -0.65033381, -0.84135509, -0.2485903, -0.16488935, -0.25172702, 0.3477329, -0.99844413, 0.0893855, 0.28780327, -0.96530619, -0.242358, -0.1519723, 0.10513381, 0.55730621, 0.79682517, -0.68507869, -0.13450629, -1.01287481, 0.18363007, 0.90383766, -0.26592925, -0.15490325, -1.39076443, -0.53548799, 0.16275516, -0.10039016, -0.56690137, 0.38538259, 1.20824846, 0.60377151, -0.7638251, 0.44327441, 1.44355722, -0.49587772, 0.22420225, 0.17182077, -0.42703656, 0.79308676, -0.47400368, -1.0624824, -0.42177568, -0.03035576, 0.41269387, 0.45629925, 0.25374674, 0.32283297, 0.13206298, -0.60402104, -0.91304635, -1.62745707, 1.09739213, -0.46382738, -0.28101515, -0.53787157, -1.24151289, 0.50175691, -0.97062501, -0.77019526, -1.71692645, 0.03282664, 2.32275073, -1.11813113, 0.70469066, -1.54230591, -1.1383385, -0.33706747, -0.93250757, 0.32217997, -0.41700553, 0.242251, 0.30650612, -0.58911651, 0.52589335, -0.46921787, 0.91418183, 0.21868418, 1.11369361, -0.63020996, 0.37841559, 0.73907324, 0.51378083, 0.15723263, -1.09187737, 0.51967648, 0.85048528, -1.13530689, 0.36395999, -0.89721453, 0.54664475, 0.6792137, 0.50477066, -0.50894378, -1.37194282, 0.15867105, 0.09239915, 0.37469814, 0.24994239, 0.50119091, 1.54269779, -0.6706416, 0.53790454, -0.63492337, 1.86457003, 0.58128414, 0.14945862, -0.24791515, 0.0420237, 0.0906615, -1.04183374, -0.54399736, -0.12757092, 2.07130542, -0.92584469, 0.59454027, 0.23487124, 0.39683206, -0.55942401, 0.51732529, 0.67701501, -0.80296143, -0.32576941, 0.92372405, 1.2175231, 0.38067386, 1.8684185, 0.11783921, -0.98170368, 0.55072023, 0.44510892, 0.36175759, -2.11172248, -0.8916535, 1.60434916, -0.58356423, 0.29668149, -0.02994974, -0.62444889, 0.1255661, 0.30686846, -1.35430336, 1.00883222, -0.74749257, -0.42370211, 0.18437552, -0.23553896, 1.20207397, 0.10308577, -0.90928516, 0.35294131, 0.12693428, -1.07397856, -0.59713218, -0.25705171, 0.27335295, 0.72726503, 0.58699804, -1.08700317, 0.05361932, -0.07838087, -0.24359964, 0.27206324, -1.9747832, 0.09044784, 0.23963839, 1.1210887, -0.34476586, -0.05390602, -0.97798433, -0.2580312, -0.46785939, -1.28640683, -0.48116196, -1.08511232, 0.91303967, -0.00981035, -0.19092695, 1.21165886, 0.79930205, -0.29222441, -1.20949773, 0.19549155, -0.67057537, -0.28368857, 0.33762435, -1.46314261, -0.52300149, 0.55728648, 0.6614403, -0.73736149, 0.60679283, 0.01322986, 0.10691289, 0.95144079, 1.14280532, 0.37810556, 0.7877654, 0.39875916, 0.54401124, -0.94842052, -0.58577268, 0.07336514, -0.02945687, 0.13338976, 0.23458857, -0.43544024, -0.23964248, -0.61324835, -0.64090124, 0.1430133, -0.00487549, 0.93319645, 0.55883759, 0.02950665, 0.21708047, -1.3840952, 0.01447969, -0.32766332, -0.65174139, 0.61389871, 0.53423373, 0.28791145, 0.57796969, 0.73634194, -0.34640685, -1.23122208, -0.40988897, 0.06962836, -0.58396723, 0.38203411, 0.09525111, 0.22925928, -1.16372368, -1.15540007, 1.67766596, -0.73288039, -1.25411198, -0.64515158, 1.96350625, 0.17202138, 0.35067004, -0.30376851, -0.44363068, 0.79980172, -1.29932015, 1.24662216, -0.37796555, 0.48784635, -0.452864, -1.02512885, 0.50969432, -0.44332496, 1.27764998, -0.80020406, 0.2701772, 0.02126923, -0.02164232, -0.43830262, -0.57008661, -1.40659458, -0.15879656, -0.15631167, -0.08277834, -0.09763538, 0.4118147, -0.26870572, -0.22553143, -0.0895887, 0.25321171, 0.05238375, 2.20891027, -1.06131454, -0.37405243, -0.31089764, 0.54375899, -0.34856757, -0.23066228, -0.44270574, 0.39664335, 0.81196829, 0.63450371, -1.43365069, 0.84786801, -0.3539834, 0.45190736, -0.01934647, 0.03358416, 0.86665387, 1.05958246, 1.33280375, 0.18920066, -0.0841888, 0.75624156, 0.04543624, -1.35132747, 0.76660726, 1.75344839, -1.01596493, 0.14541376, -1.61123373, -0.52468053, 0.14907125, 1.21939154, 0.23483468, 0.79496956, -0.33412805, -0.191458, 0.10226586]);
  const b1 = new Float64Array([-0.91355268, -0.87070198, 0.41124037, -1.66458568, -1.09202031, -0.94673716, 0.12325392, 1.10532947, 0.6029771, 0.43586794, 0.86991524, 0.94694866, -0.09989365, -0.15308725, -0.08878927, -0.4139521, 0.05640633, -0.18722887, 0.27566086, 1.04294795, 0.57061558, -0.11254251, 0.13120158, -0.51889912]);
  const W2 = new Float64Array([-0.39101005, 1.19772359, -0.19486322, -0.41842124, 0.21699621, 1.0673606, -0.17331125, 0.84637513, -1.29732562, 0.32609972, -0.53813354, 0.95599952, 0.45503628, 0.38170159, -0.82797458, 0.34066737, 0.52320909, -0.19998215, -0.04932509, 0.09570761, -0.54745287, -0.01473933, 0.60903973, -0.76915922, 0.53293917, -0.84165048, -1.12742268, 0.81135193, 0.23538672, -0.66166939, -1.7935203, -0.05970403, 0.12318274, 0.20608634, -2.44324465, -0.35511585, 0.09519606, 0.65790167, -0.31877675, 0.19846695, -1.4348369, 0.11971173, 1.89943336, -0.00832907, 1.74558264, 0.92096183, 0.09905133, 0.17456376, -1.78602134, -0.45840169, 0.36421512, 0.14650199, -0.95535866, -0.44832478, -0.02551332, 0.85972233, -0.24644041, -1.10765484, -0.53185249, 0.91308762, -0.63694861, -0.03685392, 0.34484216, -1.18818758, 0.76830778, -1.18234368, -0.24924705, 0.15613112, 0.19228246, 1.03564328, -1.20192194, -1.1492515, 0.23707356, 1.10827729, -0.60627964, -0.51220655, -1.45365101, -0.17954398, 0.55062773, 0.70419581, -1.17458023, 0.67053822, -0.9195385, -0.0304095, 1.10384981, 0.34893148, -0.63698147, -1.05865059, 0.19793153, -0.14145941, 0.5780783, 0.15900951, 1.0817889, 1.47972053, -0.34433412, 0.41947027, 1.25880016, -1.20531196, -0.19543132, -0.47090516, 0.66479872, 0.12301287, -0.20521629, -0.04141733, -1.01292904, 0.64230154, -0.11723859, -0.86454631, 1.0062113, -0.86331685, 0.89762959, 0.2563134, 0.66381251, -0.2767988, 0.19529085, 0.85572657, 1.20917564, -0.48632239, 0.8449259, 0.61322875, 0.05506075, 0.26667272, -0.28019898, 0.28371957, -0.67776057, 0.805545, 0.45669023, 0.16501652, 0.44845882, 0.16818634, 1.05596923, 0.59937922, 1.05904807, -0.48131244, -0.4641335, -0.43744222, -1.28673296, 0.17290186, -0.86016236, 0.08563316, -0.33879498, -0.23934364, -0.27013216, 0.94880382, -1.21670607, 0.93102684, -0.26926236, -0.70170043, -0.16027738, -0.35115506, -0.26145072, 2.01332327, 2.23790121, -0.06096779, -0.58100221, 0.13251493, -0.23499508, 0.19603137, -0.78430496, -0.73487433, 0.36634026, 0.68686482, -1.44588931, 1.1677849, -1.08861335, 0.78081935, 0.05768332, 0.24254049, -0.4105792, -0.44829249, 0.66037878, 0.51360438, -0.34304538, -0.43158583, 0.56727096, -1.2467341, 0.10431655, 1.03366846, -0.7070454, -0.17855006, -1.65119901, 0.49969941, -0.7020062, -0.00841413, 0.55009647, 0.03235827, -0.7289044, 0.33529386, 0.16619045, 0.16025567, -0.90203847, 0.38954317, 0.11420667, -1.01540325, -0.9998046, -0.29193176, -0.71543667, -0.83426144, -1.42647826, -0.50944955, 1.69930679, -0.9531359, -0.0881469, -0.89596168, -0.05697037, 0.19117627, -0.59262638, 0.62895525, -0.39637293, -0.19136155, -0.90641635, 1.37386457, -0.7650469, 0.21123596, 0.68246506, -0.08855019, -0.00179495, -0.4440947, -0.37358151, 0.77524949, -1.21019134, -0.01081283, -2.2468061, -0.41742993, 0.44541011, -0.02879125, -0.883017, -0.42028702, -0.18418398, -0.42523977, 0.55157451, 0.256177, 0.66748387, -0.66375502, 0.50224263, 0.38817544, 1.02275358, 0.68315557, -0.13082946, 0.1196848, -0.58391537, -0.49732442, 0.47418088, -0.67041222, -0.82388795, -0.7869437, 0.37597356, -0.02892626, -0.32466638, -1.60690768, 0.56701345, 0.30710392, -0.15586901, 0.70998681, 0.64431622, -0.49525933, 0.25914444, 0.06337661, -0.13631046, 0.59283474, 0.1997798, 0.58428025, -0.57907968, 0.81439319, -1.43485811, -1.41784912, -0.44055419, 0.96640439, -0.1853551, 0.59501819, -0.67797756, 0.40188138, -0.58240855, 1.58653835, -0.54020392, -0.44365852, 0.45794439, 1.07054881, -0.82598632, 0.24297082, 0.08897226, -0.58487712, 1.55396428, 0.10536166, 0.36037907, 1.37788924, -0.04296883, 0.01644336, 0.06803663, -1.45917471, -1.07931521, -0.10719955, -0.0666856, 0.10674127, -2.04722911, 0.53412468, -0.91875481, -0.33161022, -0.51875605, 0.66116491, 0.21080735, 0.32701681, -1.01521306, 0.25277114, -0.69437636, -0.29041846, -0.16703197, -0.70699259, -0.37424297, 0.25647941, 0.99423571, -0.80922827, 0.10076276, -0.55769158, -0.20010836, -0.44710712, 0.73350762, 0.9024919, 0.27399365, 1.02730211, -0.44314363, 0.57594137, 0.3143584, -0.22724377, -1.09079201, -0.98569955, -0.62836703, -0.74868993, -0.62246642, 0.28138704, 1.68750249, 0.62198314, 0.16221682, 0.03407235, -1.50886606, -0.05763024, -1.11914352, 0.71505442, -0.16318884, -0.82529562, 0.99253544, -0.44995929, 0.77366227, -0.05075338, 0.55611837, -0.17419227, 0.69696286, 0.82126117, 0.52144319, -0.70846481, 0.22355823, 0.43818369, 0.13823656, 1.01800172, 1.03639745, 0.22537657, 0.27254533, 0.54866374, 1.08363174, -0.81009257, 0.67157389, 0.57668907, 0.5341318, 0.08167226, 0.43659313, 0.88662754, -0.6163709, -0.77811463, 0.4200892, 0.03711952, -1.36094023, -1.47031612, 3.04469214, 0.81736596, -0.1702907, -0.96679893, 0.17491281, -1.50397131, 1.04129231, 1.53228621, 0.64936712, 0.29368134, -0.54792457, -0.05076702]);
  const b2 = new Float64Array([0.53650273, 0.43899001, -0.5399926, 0.57371228, -0.04237427, -0.03477971, -1.24436399, -0.47568171, -0.04294208, -0.11719525, 0.60658153, -1.04535481, 0.38062967, 0.4118214, -0.67819525, 0.22612087]);
  const W3 = new Float64Array([-1.34236789, 4.7910391, -3.16236796, 6.35912732, -3.11404252, -0.59455314, 3.62919724, -2.94227737, -1.96914449, -2.26977283, 0.88295064, 0.511257, -0.31304668, -1.77660542, -1.37439757, 3.80847703, 0.22327747, 5.34706316, 0.74653803, 9.42706366, -0.16314412, 1.18535867, 3.5342742, -1.95507176, -1.53742427, -1.67268726, 0.23459691, 1.86369691, 1.12076071, -0.46798693, 0.87922565, 1.32317368, -0.70669292, 0.6686808, -1.25783634, 2.29198085, -1.1133254, -0.19967089, 1.39002281, 1.19003418, 0.58681711, -2.88955933, 0.11167233, 0.99386488, -5.03316814, -0.32790194, -1.83781663, -1.22631643, -0.45576488, 0.37244254, -0.30202311, 6.45081659, 4.30647512, 2.30316532, 1.62710317, 5.26810776, -1.40458646, 4.40567122, 2.26522765, -0.06847686, 0.59498059, -3.31308458, 0.05470294, -5.52913296, -1.0095507, 7.3522182, -4.13212434, 9.85478382, -5.59380271, -0.0934431, 0.20167313, -1.2324226, -4.63393761, -0.7469662, 2.80866314, 2.61498793, -0.60258475, 0.57910842, -1.25070946, 0.51067688]);
  const b3 = new Float64Array([-0.03206237, 0.18140681, -0.20552047, -0.29580895, -1.16761373]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.90359643, 0.89349442, 0.04957289, 0.08743022, -1.8454155, -0.82878719, -0.87983553, -0.134381, -0.60636263, -0.69778397, -0.14807724, 0.75132619, 0.89645174, 0.24183907, -0.60701476, -0.44340639, -0.31965644, 0.05610465, 0.4455623, -0.53368952, 0.61679824, 0.28615061, -1.31305845, 0.41423849, 0.42741566, 0.05342415, 0.06567655, -0.35020656, 0.15411461, 0.22793669, 0.67485867, -0.35112825, -0.31695235, -0.10242266, 0.14508486, 0.9856674, -0.41007171, -0.94825231, -0.30662951, -0.13608729, 0.56217131, 0.31343612, 1.21048289, 0.10936584, 0.87900723, 0.1662101, -0.36370755, -0.29853346, -0.56048345, -0.74327357, 0.65106491, -0.52293955, 0.46158489, 1.04624972, 0.59728072, -1.02360689, -1.70310221, 0.86957424, -0.11964101, -1.99064077, -0.44684641, -0.5158244, -0.407172, -0.14529276, 0.4639493, -0.84208459, -0.64160476, 0.04155892, -1.36428184, -0.53309765, -0.25092378, 0.64410279, 0.6684488, 0.67340058, 0.34313323, -0.84853366, 0.50479216, -0.74550011, -1.08621808, -0.13982881, -0.41874448, -0.50980177, 0.93267184, 0.71174491, 0.25322283, 0.49080686, -0.56665893, 0.54617207, -0.1445592, 1.70314862, -0.63296559, -0.91048313, 0.46160408, -0.71462071, 0.44835445, 0.16222459, 0.72067127, -0.77499831, 0.62544856, 0.53549091, 1.12981976, -0.3707994, 0.92524124, 0.6771095, -0.23244233, -0.3476181, -1.13463197, -1.40613607, 0.47157517, 0.68803301, 1.82269145, 1.79189336, 0.50481263, -0.55981634, -1.39372013, -0.73608395, -0.34446371, 0.83453839, 0.74315683, -0.32212376, -1.67549663, -0.55745469, -0.3573323, -0.07757036, 0.4611693, -0.39881591, -0.5404616, 0.06827969, -1.29080068, 0.37028792, 0.6038951, 0.26826324, 0.27257345, -0.4661513, 0.25396945, -0.50278759, -0.47894509, 0.96792538, 0.50823379, 0.09736401, 0.39318202, -1.22439108, -1.03644419, 0.43520677, 0.1529969, -0.72484852, 1.10517341, -0.55529466, 0.87818818, -0.43190628, -0.16761389, 0.85310645, -0.31125, 0.45831506, 0.62629728, -0.26968756, 0.45490432, -1.1400148, -0.22315384, 0.12936247, 0.12265046, -0.1331749, 0.66209766, -0.48804924, 0.27635959, -1.08856148, 0.6221609, -0.84368061, -0.63570788, -0.24371238, 0.47080477, 1.02505131, 0.7663501, -0.62667481, -0.6172142, -0.7519107, 0.31502092, -1.85604045, 0.16838324, -0.57917279, 0.86173683, 0.39359544, 0.48048385, -0.2221504, 0.4734209, -0.02994776, 0.15389729, -0.19487792, -0.78648795, -0.59276262, 1.08691167, 0.15913024, -0.37188516, -0.40182288, -0.66424096, -0.67543462, 0.98083462, -0.68719361, 0.44992053, -0.32256603, -0.80667763, 0.9439827, -0.2583678, 0.24899836, -1.62191709, -0.55938253, -0.67010962, 0.07998438, 0.28113666, 0.78712812, 0.66224719, 1.34403337, 0.33573096, -0.25454834, 0.39411477, 0.57864545, -0.47659797, -0.2839782, -0.06313033, 0.37037057, 0.0308814, -0.42756839, -0.66738015, 0.04861556, -0.5326522, 0.3481198, 0.21322218, 0.00703293, 0.4785263, -0.22538812, -0.91653689, 1.30307146, -0.50723395, -0.58848768, -0.43917418, 1.59354496, -0.94851343, 0.24545711, -0.62198641, -1.85373582, -0.12403065, -2.63568773, -1.61800744, -0.6254986, 0.35797023, -0.98869105, -0.64823402, -1.0884566, -0.38163264, 0.12367017, -0.39331279, 0.03266502, -0.19338726, -1.23195773, -0.22766554, -1.1326141, -1.17884757, -0.18603309, -0.64566925, -0.06755378, -0.11267509, 0.68909307, 1.05574519, 0.06511791, -0.37128243, 0.63803511, 0.9261499, -0.20793908, 1.60527582, -2.3347344, -0.92326159, -0.59969809, -0.47791809, -0.7015215, 0.07149392, -0.46402163, -0.11785431, 0.12557569, -0.77536438, -0.75373192, -1.1744009, -0.69941857, 0.29257857, -0.90632601, -0.75851474, -0.04125091, -0.07871412, 0.46570424, 0.19240297, 0.63025103, -0.00654598, -0.56182025, 0.20083097, -0.76149205, 1.19034258, -0.29175814, 0.61675966, -0.39067853, 0.24754634, -0.05915669, 0.44446928, 0.40102534, 0.17742453, -0.92674023, 0.03710063, 0.13228865, -1.68415156, -0.23548321, 0.39147227, 1.09307483, -0.52409528, -0.89369076, 0.81950551, 0.45287926, 0.22416069, -0.6480729, 0.36376494, 1.40885498, 0.24475942, -0.64101476, -0.49944498, -0.23085023, 0.1188007, 0.31913653, -0.97104541, -0.886285, 0.15392372, -0.01110991, 0.01690542, -0.83438227, 0.67415965, 1.52574702, 0.39042469, 1.53075575, 0.18808267, 1.12729364, 0.64115541, 0.36158171, -1.71628396, 0.38952374, 1.35832331, 0.10235417, 0.11630661, 0.03581733, -0.6127751, 2.7363918, 0.11785807, 1.07857098, 0.95324957, -0.31300016, 0.77725349, 0.22833057, -0.51928513, -1.71948255, -0.84657199, -0.15062949, -0.4128615, 0.91400082, -0.11482955, -0.11245562, -0.89824522, 0.35983888, -1.49467663, 0.18290103, 0.4666928, -1.07869417, -0.37971559, 0.9959408, -0.14664443, -1.33831526, 0.49786503, 1.4252852, -0.70843323, 1.15169705, -0.16205604, -0.46566615, 0.67218311, 0.29089919, -0.6862955, 0.63096517, 0.70085961, 0.18603292, -0.44003535, -0.32013682, 1.17227242, -0.66107012, -0.00550025, -0.13168146, -0.90349801, 0.39975525, 1.04997284, -1.364288, 0.97499554, -0.14993244, 0.08349506, -0.26154993, 0.19792199, -0.65906871, 1.29500774, 0.46653783, 0.00789562, -1.23000877, 2.56764017, -0.09223225, 0.69106525, -0.80073, -0.97388302, 0.08611091, 0.7389657, 1.4245678, 0.74208422, -0.16101413, -1.02951166, -0.14937286, 0.44258856, -0.88251707, -0.18268053, 0.70784674, -0.10320719, 0.71930213, 0.14427284, 0.48769923, -0.88780412, 0.35584476, -0.91754977, -1.38952887, -0.06247966, 0.79868735, 0.10629785, -0.14867422, 1.62060367, 1.28694111, 0.21464597, 1.03687006, 0.76567074, 0.32099684, -0.53905136, 0.84355275, -0.48418366, -1.1060037, -0.4201436, -0.43914775, 0.07482209, 1.18749084, -1.12929607, 0.093327, -0.31157728, 0.82690981, -1.07396043, 0.20653979, -0.10117669, 0.52148172, -0.17735615, 1.21302175, -1.68445554, -0.98052755, 0.30236988, -0.1669214, 0.62724799, 1.31545614, -0.0317346, -1.1314614, -1.08388703, 0.0314917, -0.55552648, -0.71017459, 0.98861606, 1.74708233, -0.49810112, -0.49224772, 0.96433668, 0.75460385, -0.48704318, -0.26026318, 0.24189768, -0.13191207, -1.2000126, -1.50835938, 0.6623955, 0.01353638, -0.84737336, -0.58138871, -0.00161026, 0.17792767, 1.3536212, 1.01168518, -0.72224477, -0.42821178, -0.8122286, -0.54385066, 0.63861282, -0.81493548, 1.1094069, 0.2144904, -0.99543601, -1.64119161, -1.03630542, 0.25592178, 0.12017048, -0.66760402, 0.69581659, -0.13280771, 0.10556089, 1.33508116, 0.70851276, 0.20315195, -0.07789412, -0.15486419, 0.43326581, -0.79717945, 1.69731963, -0.02838722, 0.07202702, -0.83822777, 0.06086179, -0.41010772, 1.35534918, -0.02473134, -1.07087704, 0.42304222, -0.9027866, -0.21455583, 0.66024329, -0.31368634, 0.79110026, 1.6932598, -0.74350254, 0.16789374, -0.28272111, -0.04142504, -1.19896365, -1.33834908, -0.46989842, 0.00601124, 0.73028833, -1.39314054, 0.06792769, -0.85153035, -0.93143868, -0.77752074, -0.60910231, 1.10223638, 1.50677246, -0.66799525, -0.39776376, 0.51450602, 0.0692703, -0.03491472, -0.95669038, -1.10694158, -0.79085666, 0.9318639, -0.27760039, -0.02923176, -0.08813614, -1.25349881, 0.30583843, -0.40447983, -0.83068834, 1.32362798, 0.19340083, 0.0237453, -0.31541616, -0.58708282, 0.11188402, 0.43303559, -0.02016469, -0.17327859, -1.07234177, 0.36326551, -2.02041364, 0.69410398, 0.72974564, 0.62362027, -0.5427528, 0.34716325, -0.33930544, 1.48893151, -0.55326448, -0.84705042, -0.08250216, 0.28625436, -0.02485747, -1.72736747, 2.6374069, -0.88102056, -0.35932663, 0.76641204, 1.37224823, 0.80110491, -0.09383853, -1.06526571, -0.92089166, -1.25009631, 0.86933031, 1.08139317, -0.21389943, -0.29729696, -0.49108602, -1.44219054, -2.13272362, 0.43254361, -2.4264608, 0.03913172, -2.10207208, 0.325215, 0.39630265, -0.8688316, -1.50615675, -1.12863429, 1.44578632, 0.98606156, 0.31468314, 1.9911631, -0.55137319, 0.2621415, 0.1923737, -0.09810319, 0.0777448, -0.33885556, 0.33010266, 0.27951233, -0.22407961, 0.84554029, -0.32179483, 0.03726981, -1.85720211, 1.57028889, -0.5119088, 0.22556426, 0.36329416, -0.32248082, -0.42739916, 0.50612102, -1.15084928, 1.29595347, 0.53677532, 0.88692833, 0.7195164, 1.53105633, -0.08339601, 0.38519189, -0.54126359, 0.3934371, -0.04443134, -0.14034935, 0.1436576, -0.61173929, 0.96681837, -0.28618283, -0.21047137, -0.19563962, 0.81262444, 0.61645571, -1.07969066, 1.31448171, 0.42680564, 1.08448355, 0.28782214, -0.63957522, 0.29314069, 0.50515311, -1.10433621, -0.43289803, 0.06417455, -0.45411224, 0.58165425, -0.27067975, 0.0046516, -0.35161842, 0.90810965, 0.68131714, -0.27448056, 0.96869178, -0.28207738, -0.31350559, -1.08746962, 0.6799498, 0.52149289, -0.02936344, -0.32937853, 0.01274816, -0.78291918, 0.08112, 0.08591271, 0.23949015, -0.02862115, 0.17460996, 0.94803397, -0.25267182, -1.0105955, 1.14011552, -0.11998052, -0.05575614, -0.17656425, -0.60141018, 0.85825837, 1.832929, 0.11616123, -1.02215088, -0.06724747, -1.41497011, 0.33560761, 0.10838589, 0.59421062, 0.15319137, -0.48201249, -0.42874771, 0.93777082, -2.07946768, -0.2967969, -2.30779622, -0.44222149, -0.54041504, -0.28057714, -1.22404525, -0.11953355, -0.34037274, 0.2312471, -0.75812311, -0.2828213, 0.75609977, 0.87904485, -1.26489836, 1.52565116, -0.65033381, -0.84135509, -0.2485903, -0.16488935, -0.25172702, 0.3477329, -0.99844413, 0.0893855, 0.28780327, -0.96530619, -0.242358, -0.1519723, 0.10513381, 0.55730621, 0.79682517, -0.68507869, -0.13450629, -1.01287481, 0.18363007, 0.90383766, -0.26592925, -0.15490325, -1.39076443, -0.53548799, 0.16275516, -0.10039016, -0.56690137, 0.38538259, 1.20824846, 0.60377151, -0.7638251, 0.44327441, 1.44355722, -0.49587772, 0.22420225, 0.17182077, -0.42703656, 0.79308676, -0.47400368, -1.0624824, -0.42177568, -0.03035576, 0.41269387, 0.45629925, 0.25374674, 0.32283297, 0.13206298, -0.60402104, -0.91304635, -1.62745707, 1.09739213, -0.46382738, -0.28101515, -0.53787157, -1.24151289, 0.50175691, -0.97062501, -0.77019526, -1.71692645, 0.03282664, 2.32275073, -1.11813113, 0.70469066, -1.54230591, -1.1383385, -0.33706747, -0.93250757, 0.32217997, -0.41700553, 0.242251, 0.30650612, -0.58911651, 0.52589335, -0.46921787, 0.91418183, 0.21868418, 1.11369361, -0.63020996, 0.37841559, 0.73907324, 0.51378083, 0.15723263, -1.09187737, 0.51967648, 0.85048528, -1.13530689, 0.36395999, -0.89721453, 0.54664475, 0.6792137, 0.50477066, -0.50894378, -1.37194282, 0.15867105, 0.09239915, 0.37469814, 0.24994239, 0.50119091, 1.54269779, -0.6706416, 0.53790454, -0.63492337, 1.86457003, 0.58128414, 0.14945862, -0.24791515, 0.0420237, 0.0906615, -1.04183374, -0.54399736, -0.12757092, 2.07130542, -0.92584469, 0.59454027, 0.23487124, 0.39683206, -0.55942401, 0.51732529, 0.67701501, -0.80296143, -0.32576941, 0.92372405, 1.2175231, 0.38067386, 1.8684185, 0.11783921, -0.98170368, 0.55072023, 0.44510892, 0.36175759, -2.11172248, -0.8916535, 1.60434916, -0.58356423, 0.29668149, -0.02994974, -0.62444889, 0.1255661, 0.30686846, -1.35430336, 1.00883222, -0.74749257, -0.42370211, 0.18437552, -0.23553896, 1.20207397, 0.10308577, -0.90928516, 0.35294131, 0.12693428, -1.07397856, -0.59713218, -0.25705171, 0.27335295, 0.72726503, 0.58699804, -1.08700317, 0.05361932, -0.07838087, -0.24359964, 0.27206324, -1.9747832, 0.09044784, 0.23963839, 1.1210887, -0.34476586, -0.05390602, -0.97798433, -0.2580312, -0.46785939, -1.28640683, -0.48116196, -1.08511232, 0.91303967, -0.00981035, -0.19092695, 1.21165886, 0.79930205, -0.29222441, -1.20949773, 0.19549155, -0.67057537, -0.28368857, 0.33762435, -1.46314261, -0.52300149, 0.55728648, 0.6614403, -0.73736149, 0.60679283, 0.01322986, 0.10691289, 0.95144079, 1.14280532, 0.37810556, 0.7877654, 0.39875916, 0.54401124, -0.94842052, -0.58577268, 0.07336514, -0.02945687, 0.13338976, 0.23458857, -0.43544024, -0.23964248, -0.61324835, -0.64090124, 0.1430133, -0.00487549, 0.93319645, 0.55883759, 0.02950665, 0.21708047, -1.3840952, 0.01447969, -0.32766332, -0.65174139, 0.61389871, 0.53423373, 0.28791145, 0.57796969, 0.73634194, -0.34640685, -1.23122208, -0.40988897, 0.06962836, -0.58396723, 0.38203411, 0.09525111, 0.22925928, -1.16372368, -1.15540007, 1.67766596, -0.73288039, -1.25411198, -0.64515158, 1.96350625, 0.17202138, 0.35067004, -0.30376851, -0.44363068, 0.79980172, -1.29932015, 1.24662216, -0.37796555, 0.48784635, -0.452864, -1.02512885, 0.50969432, -0.44332496, 1.27764998, -0.80020406, 0.2701772, 0.02126923, -0.02164232, -0.43830262, -0.57008661, -1.40659458, -0.15879656, -0.15631167, -0.08277834, -0.09763538, 0.4118147, -0.26870572, -0.22553143, -0.0895887, 0.25321171, 0.05238375, 2.20891027, -1.06131454, -0.37405243, -0.31089764, 0.54375899, -0.34856757, -0.23066228, -0.44270574, 0.39664335, 0.81196829, 0.63450371, -1.43365069, 0.84786801, -0.3539834, 0.45190736, -0.01934647, 0.03358416, 0.86665387, 1.05958246, 1.33280375, 0.18920066, -0.0841888, 0.75624156, 0.04543624, -1.35132747, 0.76660726, 1.75344839, -1.01596493, 0.14541376, -1.61123373, -0.52468053, 0.14907125, 1.21939154, 0.23483468, 0.79496956, -0.33412805, -0.191458, 0.10226586]);
  const b1 = new Float64Array([-0.91355268, -0.87070198, 0.41124037, -1.66458568, -1.09202031, -0.94673716, 0.12325392, 1.10532947, 0.6029771, 0.43586794, 0.86991524, 0.94694866, -0.09989365, -0.15308725, -0.08878927, -0.4139521, 0.05640633, -0.18722887, 0.27566086, 1.04294795, 0.57061558, -0.11254251, 0.13120158, -0.51889912]);
  const W2 = new Float64Array([-0.39101005, 1.19772359, -0.19486322, -0.41842124, 0.21699621, 1.0673606, -0.17331125, 0.84637513, -1.29732562, 0.32609972, -0.53813354, 0.95599952, 0.45503628, 0.38170159, -0.82797458, 0.34066737, 0.52320909, -0.19998215, -0.04932509, 0.09570761, -0.54745287, -0.01473933, 0.60903973, -0.76915922, 0.53293917, -0.84165048, -1.12742268, 0.81135193, 0.23538672, -0.66166939, -1.7935203, -0.05970403, 0.12318274, 0.20608634, -2.44324465, -0.35511585, 0.09519606, 0.65790167, -0.31877675, 0.19846695, -1.4348369, 0.11971173, 1.89943336, -0.00832907, 1.74558264, 0.92096183, 0.09905133, 0.17456376, -1.78602134, -0.45840169, 0.36421512, 0.14650199, -0.95535866, -0.44832478, -0.02551332, 0.85972233, -0.24644041, -1.10765484, -0.53185249, 0.91308762, -0.63694861, -0.03685392, 0.34484216, -1.18818758, 0.76830778, -1.18234368, -0.24924705, 0.15613112, 0.19228246, 1.03564328, -1.20192194, -1.1492515, 0.23707356, 1.10827729, -0.60627964, -0.51220655, -1.45365101, -0.17954398, 0.55062773, 0.70419581, -1.17458023, 0.67053822, -0.9195385, -0.0304095, 1.10384981, 0.34893148, -0.63698147, -1.05865059, 0.19793153, -0.14145941, 0.5780783, 0.15900951, 1.0817889, 1.47972053, -0.34433412, 0.41947027, 1.25880016, -1.20531196, -0.19543132, -0.47090516, 0.66479872, 0.12301287, -0.20521629, -0.04141733, -1.01292904, 0.64230154, -0.11723859, -0.86454631, 1.0062113, -0.86331685, 0.89762959, 0.2563134, 0.66381251, -0.2767988, 0.19529085, 0.85572657, 1.20917564, -0.48632239, 0.8449259, 0.61322875, 0.05506075, 0.26667272, -0.28019898, 0.28371957, -0.67776057, 0.805545, 0.45669023, 0.16501652, 0.44845882, 0.16818634, 1.05596923, 0.59937922, 1.05904807, -0.48131244, -0.4641335, -0.43744222, -1.28673296, 0.17290186, -0.86016236, 0.08563316, -0.33879498, -0.23934364, -0.27013216, 0.94880382, -1.21670607, 0.93102684, -0.26926236, -0.70170043, -0.16027738, -0.35115506, -0.26145072, 2.01332327, 2.23790121, -0.06096779, -0.58100221, 0.13251493, -0.23499508, 0.19603137, -0.78430496, -0.73487433, 0.36634026, 0.68686482, -1.44588931, 1.1677849, -1.08861335, 0.78081935, 0.05768332, 0.24254049, -0.4105792, -0.44829249, 0.66037878, 0.51360438, -0.34304538, -0.43158583, 0.56727096, -1.2467341, 0.10431655, 1.03366846, -0.7070454, -0.17855006, -1.65119901, 0.49969941, -0.7020062, -0.00841413, 0.55009647, 0.03235827, -0.7289044, 0.33529386, 0.16619045, 0.16025567, -0.90203847, 0.38954317, 0.11420667, -1.01540325, -0.9998046, -0.29193176, -0.71543667, -0.83426144, -1.42647826, -0.50944955, 1.69930679, -0.9531359, -0.0881469, -0.89596168, -0.05697037, 0.19117627, -0.59262638, 0.62895525, -0.39637293, -0.19136155, -0.90641635, 1.37386457, -0.7650469, 0.21123596, 0.68246506, -0.08855019, -0.00179495, -0.4440947, -0.37358151, 0.77524949, -1.21019134, -0.01081283, -2.2468061, -0.41742993, 0.44541011, -0.02879125, -0.883017, -0.42028702, -0.18418398, -0.42523977, 0.55157451, 0.256177, 0.66748387, -0.66375502, 0.50224263, 0.38817544, 1.02275358, 0.68315557, -0.13082946, 0.1196848, -0.58391537, -0.49732442, 0.47418088, -0.67041222, -0.82388795, -0.7869437, 0.37597356, -0.02892626, -0.32466638, -1.60690768, 0.56701345, 0.30710392, -0.15586901, 0.70998681, 0.64431622, -0.49525933, 0.25914444, 0.06337661, -0.13631046, 0.59283474, 0.1997798, 0.58428025, -0.57907968, 0.81439319, -1.43485811, -1.41784912, -0.44055419, 0.96640439, -0.1853551, 0.59501819, -0.67797756, 0.40188138, -0.58240855, 1.58653835, -0.54020392, -0.44365852, 0.45794439, 1.07054881, -0.82598632, 0.24297082, 0.08897226, -0.58487712, 1.55396428, 0.10536166, 0.36037907, 1.37788924, -0.04296883, 0.01644336, 0.06803663, -1.45917471, -1.07931521, -0.10719955, -0.0666856, 0.10674127, -2.04722911, 0.53412468, -0.91875481, -0.33161022, -0.51875605, 0.66116491, 0.21080735, 0.32701681, -1.01521306, 0.25277114, -0.69437636, -0.29041846, -0.16703197, -0.70699259, -0.37424297, 0.25647941, 0.99423571, -0.80922827, 0.10076276, -0.55769158, -0.20010836, -0.44710712, 0.73350762, 0.9024919, 0.27399365, 1.02730211, -0.44314363, 0.57594137, 0.3143584, -0.22724377, -1.09079201, -0.98569955, -0.62836703, -0.74868993, -0.62246642, 0.28138704, 1.68750249, 0.62198314, 0.16221682, 0.03407235, -1.50886606, -0.05763024, -1.11914352, 0.71505442, -0.16318884, -0.82529562, 0.99253544, -0.44995929, 0.77366227, -0.05075338, 0.55611837, -0.17419227, 0.69696286, 0.82126117, 0.52144319, -0.70846481, 0.22355823, 0.43818369, 0.13823656, 1.01800172, 1.03639745, 0.22537657, 0.27254533, 0.54866374, 1.08363174, -0.81009257, 0.67157389, 0.57668907, 0.5341318, 0.08167226, 0.43659313, 0.88662754, -0.6163709, -0.77811463, 0.4200892, 0.03711952, -1.36094023, -1.47031612, 3.04469214, 0.81736596, -0.1702907, -0.96679893, 0.17491281, -1.50397131, 1.04129231, 1.53228621, 0.64936712, 0.29368134, -0.54792457, -0.05076702]);
  const b2 = new Float64Array([0.53650273, 0.43899001, -0.5399926, 0.57371228, -0.04237427, -0.03477971, -1.24436399, -0.47568171, -0.04294208, -0.11719525, 0.60658153, -1.04535481, 0.38062967, 0.4118214, -0.67819525, 0.22612087]);
  const W3 = new Float64Array([-1.34236789, 4.7910391, -3.16236796, 6.35912732, -3.11404252, -0.59455314, 3.62919724, -2.94227737, -1.96914449, -2.26977283, 0.88295064, 0.511257, -0.31304668, -1.77660542, -1.37439757, 3.80847703, 0.22327747, 5.34706316, 0.74653803, 9.42706366, -0.16314412, 1.18535867, 3.5342742, -1.95507176, -1.53742427, -1.67268726, 0.23459691, 1.86369691, 1.12076071, -0.46798693, 0.87922565, 1.32317368, -0.70669292, 0.6686808, -1.25783634, 2.29198085, -1.1133254, -0.19967089, 1.39002281, 1.19003418, 0.58681711, -2.88955933, 0.11167233, 0.99386488, -5.03316814, -0.32790194, -1.83781663, -1.22631643, -0.45576488, 0.37244254, -0.30202311, 6.45081659, 4.30647512, 2.30316532, 1.62710317, 5.26810776, -1.40458646, 4.40567122, 2.26522765, -0.06847686, 0.59498059, -3.31308458, 0.05470294, -5.52913296, -1.0095507, 7.3522182, -4.13212434, 9.85478382, -5.59380271, -0.0934431, 0.20167313, -1.2324226, -4.63393761, -0.7469662, 2.80866314, 2.61498793, -0.60258475, 0.57910842, -1.25070946, 0.51067688]);
  const b3 = new Float64Array([-0.03206237, 0.18140681, -0.20552047, -0.29580895, -1.16761373]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
