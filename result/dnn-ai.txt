function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.41431055, 0.1338646, 0.55125613, -0.06895575, -0.06835756, 0.05331997, 0.06857526, -0.14395597, 1.21813192, -5.12542594, 0.31925965, 0.07665982, 0.38424277, 0.14916191, -0.36962622, -0.44703312, 0.16872953, -0.0854955, -0.03949504, -0.66054972, -1.9185536, -1.11083333, 0.30913522, 0.3730612, 2.97253396, 0.6472466, 0.20059331, 0.42651631, 0.94783723, -0.517167, 0.26846972, 0.41084199, -1.52272934, 2.3738246, 1.21123546, 0.14337352, 0.15023066, -1.04911612, 1.00836258, -0.21475508, -0.03610315, 0.62343677, -0.49988797, -0.93496687, -0.12984244, -0.84099928, -0.21567879, -0.43947192, -1.23279242, 0.05282233, -0.25328222, 0.80116723, 0.64037293, -0.39225099, 0.30158138, -0.94047182, 0.03355886, -0.00047208, -0.10423673, -0.25502409, 0.65850808, 0.65766512, -0.27156693, -0.29301184, -0.29960504, -0.63245265, 0.74327879, 0.85258121, 1.17816536, -0.6805901, 0.24750862, 0.83212748, 0.56825779, 0.17784877, -0.36086999, 0.33168088, 0.51650557, 0.76206268, -0.052468, -0.01018024, 1.03601023, -0.09345558, 0.51415384, -0.56865428, -0.07378277, -0.10224367, 0.11243758, 0.35146254, -0.10536201, -0.00165517, 0.27272122, 0.10284289, -0.53502643, 0.21751092, -0.15990307, -1.029625, -0.41324882, 0.50601471, 0.10125505, -0.24225844, 0.22948454, 0.18013721, 0.65515115, -0.62939425, -0.56162344, 0.21342572, 0.94726643, -0.72814546, 0.79665017, 0.03708925, -0.18671571, -0.44393631, -0.24495466, -0.17335064, 3.32287773, 2.91461075, 0.62810635, -0.87469265, 3.05703989, 0.44548581, 0.35591438, 0.55084036, 0.24098162, 3.95039206, 0.54725333, 0.24625632, 0.5983237, 0.0881038, 0.95223547, -0.04220454, 0.32035429, 0.74974993, 0.02975341, -0.14233331, 0.64226266, 0.33667054, -0.32672714, 0.55420472, 0.41442452, -0.1652329, 0.36496469, 0.20613541, -0.60575785, 0.67512675, 0.18668144, -0.72989976, -0.59984573, -0.59043776, -0.49517479, -1.20559055, -2.2714996, 0.27452443, -0.69693279, 1.98451562, -1.66181581, 0.0061461, -0.46487493, -3.48266625, 1.95537972, 0.3823426, 0.61422536, 2.19144452, -1.84727928, -0.36967461, -0.31658236, 0.25652157, 3.90092146, -0.17632282, -0.22007593, 0.26951451, 0.45315514, 1.38427063, 0.00617474, 0.22349211, 0.28629142, 0.05830829, -0.08883917, 0.1481828, 0.20163197, -0.35244654, 0.93190337, 3.46794025, 0.01780869, -0.83142438, 0.06719809, -0.7512425, 0.18028516, -0.28772844, 0.55574899, 0.60403409, -0.31096245, 0.25065075, 1.55879722, -0.02253252, -0.083896, -1.01095283, 0.15442946, 0.8934827, 0.2843392, -1.31087744, 0.31578311, -0.12239319, -0.60576064, 0.77119534, -0.96230708, 0.15817031, 0.55971357, -0.01068014, 0.61411007, -0.84778617, 0.08014234, 0.86540469, -0.06253241, 0.32157832, -1.97632652, 0.31647146, 0.26098276, -1.1463497, -0.4525229, -0.50075443, -0.52522839, -0.13478346, -0.01816299, 0.49159591, 2.12631374, 1.69492559, 0.0043757, 0.15482931, 1.5403557, 0.94202833, -0.55742933, 0.23036741, 0.28619115, 1.22849986, -1.0595339, -0.49866533, 0.98238437, 0.71277788, 0.74771426, -1.54932901, -0.42897939, 0.07017483, -0.43655942, 2.07124682, 0.39072843, 0.1139163, 0.22897339, 2.06398077, 1.07880945, -0.19356135, -0.00245439, 0.21489013, 2.47817577, 0.10006068, 0.02585234, 0.15646854, 0.06613783, -0.38883083, 0.08357023, -0.06615162, -0.44600362, -0.38214517, -0.14815454, 0.01984833, 0.05990736, -0.47456113, 0.93816774, -0.59785345, -0.09637677, -0.49659337, 0.5418502, 0.84400845, 0.33090672, -0.41695291, -0.05445189, 0.78316076, -0.06257269, 0.52211548, 1.00193246, -2.4635729, 1.47726944, -0.3011682, -2.46602005, -0.10297709, -0.40169155, -0.88465581, 3.63111632, 1.11632943, 1.1265963, -0.13834992, -1.13904361, 0.88367592, 0.01713461, 0.79096455, -0.53839698, -3.8438593, -0.63254875, 0.2209145, 0.79499508, -0.49467358, -2.1234711, 0.31618373, -0.14861714, -1.67301482, -0.0430027, -0.03973439, -0.81625803, -0.31088222, 0.0503036, -0.51296021, 1.69240569, -0.21593775, 0.19022818, 0.1562194, 1.28111027, -0.2006924, 0.47281203, 0.14976824, 0.54234227, 0.16115976, 0.43709008, -0.68955746, 1.30919846, -0.06849192, -0.12745657, 0.14896356, 0.33840539, 0.42213877, 0.27768615, -0.89369225, 0.32876205, -0.94998583, -0.53786447, -0.56487816, -0.46177294, -1.08575532, -0.90788282, -0.58033364, -1.76228832, -0.77946578, 0.44743783, -0.42711793, -0.3069655, -0.9566285, -0.35333777, 0.24157408, -0.00169409, -0.36198144, -0.4627298, 0.6208236, 0.32532496, -0.48100807, 0.54999197, 2.89675842, -0.99075047, -0.46385789, 0.02357837, -0.61648305, -0.24394852, -0.68776736, 0.45973213, 0.04803183, 0.08147616, -0.44014468, -0.78568717, -0.40114569, -0.60982667, 0.12393029, 0.84176092, -1.03225214, -0.21904517, 0.11598549, 1.60438538, 0.59304788, -0.03945008, 0.0638448, 0.42544023, 1.79528776, 0.93874719, 0.01591335, -0.0820694, 1.14837002, 1.41947168, -0.26666462, -0.20724218, 0.64483762, -0.29063514, 0.01062903, -0.49902738, -0.92800397, 0.15962131, -0.0369205, -0.24601863, -0.84185485, 0.00241492, -0.98228396, -2.77105081, 0.25487039, -0.34419557, 0.27218269, 1.10593801, 0.2751315, 0.35608456, 0.39856254, -0.12743373, -0.34257429, 0.09077456, -0.94626722, 1.60412025, 1.45214365, 0.63320399, -0.08618569, -0.56156225, 0.42024177, 1.18662471, 1.79775834, 0.14570018, 0.30572068, 0.48136718, -0.21028086, 0.2519183, -0.29526641, 0.63023283, 0.70474289, 0.18073645, 0.01713545, -0.02686142, 0.24467893, 0.6560063, 0.45540367, -0.05006056, 0.21543358, 0.38948099, 0.08828946, 0.46294624, 0.23996366, -0.08823862, 0.33817829, 0.3976901, -2.72802476, 0.0068949, -0.27794135, 0.45142053, 0.58466634, -0.28088127, 0.30351011, 0.146066, 0.20509973, -0.1769003, 0.12591536, -0.33116034, 0.26158276, 0.18089159, -1.815569, -0.10876111, -0.27299534, 0.1564564, -0.56617963, 0.82010933, 0.19543072, 0.19663253, -0.29710614, -0.69630058, -0.05687886, -0.92855694, -0.19750134, -0.02739075, -0.24973589, -0.06220542, -0.4750565, -0.07086285, -0.19416382, -0.22141262, 0.7945132, 0.1481213, 0.73522059, 0.42546783, 0.210102, 0.47486147, 0.56083563, 0.11428976, -1.62750928, -0.04695249, -0.68164379, 0.10721919, 1.38023401, 1.19326509, 0.51961765, 0.4248779, 0.47770273, 1.23172101, -0.02078277, 0.44493876, 1.15651255, -1.45824392, 0.03453537, 0.22962453, 0.75718512, 0.33438966, 0.14504503, -0.40848526, 0.34710397, -1.62026372, 0.23600815, 0.15544018, 0.40816362, 0.54396385, -0.22570969, 0.19379232, -0.30378815, -0.11873641, -0.03531658, -0.11296825, 0.08629851, -0.59913098, 0.1388571, -0.60201648, -0.01310579, -0.22245659, 0.31517463, 0.31252883, 0.43893411, 0.79391082, -0.23804095, -0.96502886, -1.78322012, 0.72699413, 0.26973056, -0.37204634, 0.13524862, 0.16264076, 0.40411689, -0.42583001, -0.59603223, -0.5351199, -0.04681252, -0.93068803, -1.84717096, 0.76784495, 0.4292352, -0.03229981, -0.19735882, -0.25662815, 1.09472733, -0.19671989, -2.38051393, -0.34018065, -0.79945229, -0.54088839, 1.02844975, -0.85753644, 0.40767118, -0.21903651, -0.75286196, -0.51832948, -0.21397817, 0.35579157, 0.48666188, -0.08600408, 0.6800381, 0.29537087, 0.10178861, -0.21969043, -0.2535218, 0.26513312, 0.72841581, -0.33590025, 1.78836899, -0.31406448, 1.36588304, 0.37380913, 0.14716618, -0.80771755, 0.67789402, -0.08274023, -1.14932884, 1.13671903, -0.2508064, 1.03048668, -1.20648331, 0.4354311, -0.18429172, 0.36781426, -0.10745065, -1.48693973, 0.73506596, 0.17914616, -1.10861116, 1.11730461, 0.12089034, -0.23022552, -0.04197887, -1.28095261, 1.70020034, -0.10919253, 0.67415265, -0.20073798, -0.31987314, 0.37086582, -0.62051046, -0.93989693, -0.2894304, 0.18743281, 0.13988605, -0.02900841, 0.27442256, 0.18817036, 0.44266005, 0.50978663, -0.1113706, 1.63065048, -1.7794332, -0.31755634, 0.09149346, -0.46010379, 1.46413991, -0.24923504, 0.44701008, 0.09635991, 0.58698104, -0.53907032, 1.24045955, -0.10591311, 1.00801789, -0.22661149, 1.28446669, -2.8095573, 1.17680675, -0.06701236, -0.01990484, -0.51560264, -1.14516203, -0.23764702, 0.81047644, 1.79982418, 1.19716403, 0.16623353, 0.35066638, 1.10690571, 0.98648507, -0.9968568, -0.00612548, 0.19600697, 0.17386572, -0.66936196, 0.16435581, 0.46417075, -0.23163808, 0.08849883, 0.37779653, 0.2921898, -0.14028622, 0.32142587, -2.06041542, -1.09561448, -0.04968134, 0.34530372, -0.44565326, 0.11759497, -0.95701023, 0.05189071, -0.43232802, 0.96330441, -0.71786567, -0.23226502, -1.08902189, 0.35000344, 0.00936262, 0.29995859, -1.13913389, -0.42963059, 0.53860205, 0.66050068, -1.56572283, 0.2368823, 0.27883436, -0.07449156, -0.01935263, -1.61315198, -0.24264134, 0.12093699, -0.04601659, -0.69183312, -1.2029798, -0.26144411, 0.09437148, -0.03456878, 0.45136178, -0.83172562, 0.36505256, -0.10972521, -0.4936375, -0.12591957, -0.30848856, 0.14179548, -0.52202029, -0.34149257, -11.44233145, 0.21743096, -0.06073572, 0.10010776, 1.10199669, 0.28717459, 0.06949337, 0.23600876, 0.47602561, -0.32925783, -0.0016577, 1.27153257, 1.32392172, 0.11550364, -0.32289366, -1.1922201, -0.2709502, 0.1080917, 0.46015201, 0.88130263, -0.86302285, -0.20809276, 0.77834935, -0.58328786, 0.33132333, -0.83337201, 0.04437454, 0.65973918, -0.02983118, 0.57055484, -0.01308596, -0.39364507, 0.80760088, 0.14232149, -0.39719289, -0.02643312, -0.34085203, -0.16401716, 0.03327453, -1.02408205, 0.54551109, 0.17450207, -0.64479388, 1.30813425, -0.30510551, -1.09374132, -1.27060897, -0.03530879, -0.39200235, -0.79347232, -1.34533568, 0.63094185, -1.27625243, 0.04758732, 1.74847994, -1.8317252, -1.32967512, 0.15067975, 3.07330619, -1.03382097, -0.2417216, 0.09428424, 0.93683506, -0.11407725, 0.03155272, 0.18271949, -0.62009912, -0.71446058, -0.13345956, 0.24530664, 0.47118164, -0.53844005, -0.09995274, -0.54718436, -0.18947263, 0.36362266, -0.09746967, 0.56297139, 0.95566598, 0.98109626, 0.36730153, 0.1223493, 1.03933386, -0.07573748, 0.0974063, -0.82272998, -3.3434064, -0.69488298, 0.12337046, -0.26254483, -0.11935374, 0.56196698, 0.32012027, -0.25802748, -0.46687177, -0.18041931, 0.24454685, 0.301645, -2.45143869, -0.00681073, -0.33728652, -0.28102715, 0.27258895, -0.53504559, -0.24737824, 0.56898945, 0.59232843, 0.94171739, -0.3464817, 0.1573015, 0.71980677, -0.47262825, 0.34545721, -0.09408882, 0.39931424, 0.34844177, -0.05739015, 0.40740549, 0.26136298, 1.12446804, -0.08651147, 0.20382725, 0.65606577, -0.10565869, -0.00253925, 0.41868805, -0.80448133, 0.16362807, 0.75552517, -2.72022837, -1.28437338, 0.19215537, -0.34104523, 0.97708778, -0.10493557, -0.45867167, 0.23274852, -0.47934946, -0.41275191, -1.15299783, 2.7221585, 1.19192999, -0.29265869, -0.24976708, -0.78523194, -0.52973708, 0.02547175, -0.56988914, 0.29043001, -1.97265521, -0.5843083, -0.30737171, -0.49131435, 0.55398667, -1.62760353, -0.64356462, -0.21687425, -0.94507082, -0.31807524, -0.21478074, -0.20855819, -0.33365496, 0.38204097, -0.80013858, -0.82297974, 0.05258077, -0.31870118, -0.25110974, -0.50211974, 0.29698319, 0.04581618, 2.41558834, 0.09596117, 0.56715426, 1.90984353, -1.18092071, 1.27172204, -0.22243659, -0.20357627, 0.35116691, 0.85339517, -0.30202846, -1.16119985, 1.8293847, 1.85268541, -0.29313823, 0.5392384, 1.5102688, -0.46452768, 0.08787849, 0.9728476, 2.44164243, 2.68063574, -1.30264046, -0.16233608, 1.18751724, 2.7872606, 0.69834599, -0.34720624, -0.45259697, 1.50555043, 2.35057583, 0.17289977, -0.62186635, -0.12100033, -0.45087125, 0.45620133, 0.5546763, 0.76706356, 0.40146435, 0.20418496, 0.27163724, -0.00184938, 0.27317098, -1.8143833, -1.49807462, 0.2973864, 0.49411261, -0.32380854, -1.49689409, -0.18529611, -0.26512734, 0.14091963, -2.22418345, 0.42121402, -0.11520493, 0.17393191, 1.55169366, 0.93310092, -0.1923104, -0.10200088, -1.23576217, 0.54293279, -0.65611634, 1.44167301, -6.12170038, -0.43654819, 0.48868381, 0.06097207, 2.20517109, -0.9439845, -0.59449794, 0.07717987, -2.29667323, 0.87196156, -0.69415557, 0.27519304, 0.38792836, 0.83695642, -0.19630959, 0.3574806, -1.30304218, 0.02589824, -0.06161191, 0.38803615, 0.50950035, -0.00305887, 1.96660702, 0.74423141, -0.50337323, -1.14168687, -0.35467361, -0.99863412, -0.1408182, -0.45203795, 0.67413641, 0.91255984, 0.12468415, -1.11853351, 0.12870135, -1.25552306, 0.76404657, 2.30039335, -0.21573798, -0.04531546, 0.29982952, 0.58676628, 1.60869622, 0.39983816, 0.10677758, 1.03271956, 1.66590484, 0.75121973, 0.0002115, 0.82925399, -0.04006286, -1.13720009, 0.65797377, -1.15547489, -0.26313096, -0.01387821, -0.30231485, -0.07652224, -0.05477199, -0.32745688, 0.20159912, 0.00885946, -0.28584158, -2.08377599, 0.47155331, -0.30365669, 1.44081169, -0.03047458, -0.74700213, -0.62909711, 0.47266167, -1.10285844, -0.05196693, 0.03678704, 0.58297878, 0.08457563, 0.12513379, 1.57131672, 0.53310932, -0.13498084, 0.00067699, 1.13828326, 0.43464785, -0.82219928, 0.01966246, -1.90722651, 1.68734658, -0.2759657, 0.42721997, -1.82997624, -2.01008725, -0.31674878, -0.0038825, -0.01217038, -2.08008473, 0.06012928, 0.6788653, 0.31542592, 0.65656559, 0.00001411]);
  const b1 = new Float64Array([-0.15907511, -0.1929051, 0.10945751, -0.21092067, 0.04034448, -0.30029714, -0.20900182, -0.10178228, -0.20780551, 0.10209124, 0.18191291, 0.12001367, 0.070962, -0.17468521, 0.13430898, 0.20659673, -0.40249072, 0.01675714, 0.28446659, -0.16478239, -0.22467173, 0.28978399, 0.10560347, 0.26652285]);
  const W2 = new Float64Array([-1.06636007, -0.9190176, -0.9880083, -0.35530867, -0.08899307, -1.69870637, 0.01220959, 0.09350449, -1.1651912, 0.13830163, -0.14143865, 0.1817375, 0.34855759, 0.46334024, -0.54418244, 0.28463261, 1.09606241, 0.03632454, 1.68348322, 1.4883562, 0.04363201, 1.31636666, -0.68501627, 0.03175811, 0.36471258, 0.66178477, 1.18589667, 0.80571672, 0.1888786, -0.11836566, 0.09893024, 0.06179218, 0.71066674, -0.36287968, -0.1064925, -0.40859712, -0.4215175, -0.58632844, -0.68420745, -0.55557224, 0.55006761, 0.21302886, -0.39896691, 0.03294153, 0.08188296, -0.66677837, -0.47631594, 0.1283534, 0.03231145, 0.51188022, 0.03458735, -0.37872805, 0.99093232, -0.09349266, 0.48906059, 0.07385758, 0.56976018, -0.09113388, -0.46888558, -0.39745289, -0.05222727, -1.01176235, -0.10587054, -0.37683798, 0.87894271, 1.09608087, 0.11028256, 0.28244313, -0.78961705, -0.19327519, 0.41660429, 0.64677505, -0.57763378, -0.14187799, 0.31931852, -0.17893321, -0.1052134, -0.26276642, 0.22673011, -0.29032388, -0.15508991, 0.32140468, -0.62552615, -0.12244431, 0.4430931, 0.28272648, -0.33711309, 0.77692119, 1.3327882, -0.32980567, 0.09392896, -0.36823786, 0.57180358, -0.33167606, -0.30915636, -0.0301393, 1.5204984, 0.50403415, 0.91787832, -0.71484875, 0.09642167, 0.83226803, 0.0377348, 0.41422052, 1.45311684, -0.59202403, -0.9823554, -0.1361235, 0.50204823, 0.08987324, 0.34131219, -0.49477002, -1.83099733, 0.39757269, 0.22414437, 0.22020696, -0.93904678, 1.57251293, 0.02618352, -0.8243548, -0.09878735, -0.28404156, 0.09511452, -0.03864435, -0.06619242, -0.32489413, 0.18103445, -0.67042187, 0.06641501, 0.49091602, 1.15105489, -0.03124252, 0.29284833, -0.07068988, 0.18520357, 0.05663937, 0.117698, -0.0797537, -0.33787976, -0.04743768, -0.39996365, -0.46597293, -0.02634516, -0.0964922, 0.37484397, 0.41337386, -0.5388731, 0.05072256, -0.01660806, -0.34263423, 0.39648123, 0.49761053, 0.21517297, -0.17741354, 0.2828262, -0.90036219, 0.15542189, -0.54295006, 0.03839443, -0.24938647, -0.19099852, -0.24707483, 0.4310102, 0.1716582, -0.21609417, -0.47396357, 0.64833543, 0.13416627, 0.51955328, 0.32756169, 1.44459655, 0.45706039, -0.18778061, 0.42820058, 0.61110126, -1.3664041, 0.60192903, -1.07354476, -0.44862069, -0.05646726, -1.3273419, 0.87264658, 0.18648687, 0.4046214, -0.83832859, 0.55344986, 0.43776764, -1.25358137, -1.02852542, -0.38953627, -0.1098615, -0.06735816, 0.13221443, -0.05011555, 0.23659837, 1.06796277, 0.23111975, 0.16534329, -1.73893576, 0.42179463, 0.43795234, -0.74172042, -0.58225356, 0.82913229, -0.0061605, 0.14352363, 0.68626179, -0.47791533, -1.18425093, -0.86687171, 0.13670141, 1.3497123, 0.1870161, -0.15197923, -0.14197344, -1.48606292, 0.759968, -0.78261921, 0.86541666, 0.49401549, -1.00070819, -0.87567447, 0.47184199, 0.05707999, 0.28663265, 0.57849863, 0.45998443, 0.57073688, 0.62550341, -0.59592951, 0.30839136, 1.16268514, 0.46135021, -0.16642006, 0.9698602, 1.01061643, -0.60635468, -0.12549207, -0.04484992, -0.79689827, -0.09897471, -0.64850121, 0.70027939, 0.33297784, -1.04378598, -0.28438728, -0.3963471, -0.0030868, -1.10497942, -0.38022961, 0.09077478, 0.32667395, 0.59005625, 1.03490529, 0.35289898, 0.07765075, -0.50261793, -1.06121045, -0.00453313, -0.38053407, 1.35021785, -0.28493185, -0.09606505, -0.67572982, -0.13474524, -0.12426026, -0.07336407, 0.88524838, -0.00078716, 0.81413289, -1.030188, 0.04768998, -0.19906243, -0.58877772, -0.58348167, 0.25562227, -0.46262391, 0.29961826, -0.16890995, -0.07276982, 0.0386313, -1.22748869, 0.27623303, 0.52627614, -0.06246282, 0.57380885, -1.16333763, -1.00636065, 0.78842963, 0.66658387, 0.0864282, -1.35076353, 0.34379365, -0.03387986, -0.02327315, 0.55144792, 1.25927518, -1.18115354, -0.2735233, -0.2034306, 0.70141231, 0.02625898, 0.43513017, -0.42636147, -1.36533786, 0.25487186, 0.58849371, 0.17550897, -0.61778176, 1.52055962, 0.34922819, -0.90630038, -1.3268624, -0.2776963, -0.53731126, 0.03874003, 1.8093392, 0.17853993, -0.03630116, 0.45842332, 1.09878117, -0.39164164, -0.61933352, 0.20103481, -0.24118892, -0.00344222, 0.04404278, -0.70625417, -3.06268001, 0.39331597, -0.77555831, -0.42094925, -0.12266971, 0.24322597, 0.20764888, 0.13823716, -0.4869097, 0.05074555, -0.05776163, 1.34533581, -0.53936717, 1.77920668, -1.21569102, -0.69992965, 0.9377622, -0.01419624, -0.72646094, -0.22733931, -0.00897031, 0.44336358, -0.72956401, 0.25746792, -0.06084525, 0.13093694, -0.48404722, -0.83407745, 0.11298876, -0.7265127, 1.07638829, 0.05064864, -1.11875352, -0.76518293, 0.22344272, 0.1992795, -0.02284234, 0.03587222, -0.16635103, -0.2079402, 0.99594145, -0.71155991, -0.3595612, 0.67544504, -0.02880367, -0.30229637, 1.09523003, 0.80242019, -1.99040455, 0.11941035, -0.93049676, -1.0701498, -1.27559322, 0.29859456, -0.42368542, 0.21916323]);
  const b2 = new Float64Array([0.42401962, -0.15526196, -0.20935103, 0.37684314, -0.3962977, -0.14583154, -0.2090909, -0.12138925, -0.0466035, 0.11940856, 0.2488065, 0.08022293, -0.1910896, -0.10880616, 0.09888873, 0.39354428]);
  const W3 = new Float64Array([1.26124454, -0.65319858, -0.17077544, 0.11036791, -0.61442015, 0.24028936, -0.22961459, -1.09522736, 0.62007109, -0.93996106, -0.01092359, 0.76652377, -0.46148229, -0.3793807, 0.82534505, 0.19656298, 0.00001615, -0.00131499, 0.06900849, 0.0003891, -0.00014329, 0.00120203, 0.01659016, 0.00087973, 0.00057459, -0.00048635, 0.05999357, 0.00138296, 0.00007018, 0.00070735, 0.00007993, 0.00071559, 0.0012782, -0.00064121, 0.28044171, -0.00194282, -0.0005933, 0.0013636, -0.03993883, 0.00146348, 0.00054601, -0.00111742, 0.26163712, 0.00302233, -0.00004194, 0.00097757, -0.00039643, -0.00003672, 0.00067284, -0.00047046, 0.17866526, -0.00112832, -0.00024521, 0.00113972, -0.02224619, 0.00089898, 0.00037566, -0.0007047, 0.16630316, 0.00189986, 0.00008513, 0.00052058, -0.00022396, -0.00010026, -0.02493241, -0.05365352, -0.67760733, 0.6432918, -0.1426055, -1.04640718, -0.65120678, -0.02487318, -0.03472516, 0.19076929, 1.05013304, 0.28704301, 0.10847837, -1.81147378, 0.047731, -0.92739122]);
  const b3 = new Float64Array([0.04979021, 0.02188968, -0.02374768, -0.01209304, 0.27876574]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.41431055, 0.1338646, 0.55125613, -0.06895575, -0.06835756, 0.05331997, 0.06857526, -0.14395597, 1.21813192, -5.12542594, 0.31925965, 0.07665982, 0.38424277, 0.14916191, -0.36962622, -0.44703312, 0.16872953, -0.0854955, -0.03949504, -0.66054972, -1.9185536, -1.11083333, 0.30913522, 0.3730612, 2.97253396, 0.6472466, 0.20059331, 0.42651631, 0.94783723, -0.517167, 0.26846972, 0.41084199, -1.52272934, 2.3738246, 1.21123546, 0.14337352, 0.15023066, -1.04911612, 1.00836258, -0.21475508, -0.03610315, 0.62343677, -0.49988797, -0.93496687, -0.12984244, -0.84099928, -0.21567879, -0.43947192, -1.23279242, 0.05282233, -0.25328222, 0.80116723, 0.64037293, -0.39225099, 0.30158138, -0.94047182, 0.03355886, -0.00047208, -0.10423673, -0.25502409, 0.65850808, 0.65766512, -0.27156693, -0.29301184, -0.29960504, -0.63245265, 0.74327879, 0.85258121, 1.17816536, -0.6805901, 0.24750862, 0.83212748, 0.56825779, 0.17784877, -0.36086999, 0.33168088, 0.51650557, 0.76206268, -0.052468, -0.01018024, 1.03601023, -0.09345558, 0.51415384, -0.56865428, -0.07378277, -0.10224367, 0.11243758, 0.35146254, -0.10536201, -0.00165517, 0.27272122, 0.10284289, -0.53502643, 0.21751092, -0.15990307, -1.029625, -0.41324882, 0.50601471, 0.10125505, -0.24225844, 0.22948454, 0.18013721, 0.65515115, -0.62939425, -0.56162344, 0.21342572, 0.94726643, -0.72814546, 0.79665017, 0.03708925, -0.18671571, -0.44393631, -0.24495466, -0.17335064, 3.32287773, 2.91461075, 0.62810635, -0.87469265, 3.05703989, 0.44548581, 0.35591438, 0.55084036, 0.24098162, 3.95039206, 0.54725333, 0.24625632, 0.5983237, 0.0881038, 0.95223547, -0.04220454, 0.32035429, 0.74974993, 0.02975341, -0.14233331, 0.64226266, 0.33667054, -0.32672714, 0.55420472, 0.41442452, -0.1652329, 0.36496469, 0.20613541, -0.60575785, 0.67512675, 0.18668144, -0.72989976, -0.59984573, -0.59043776, -0.49517479, -1.20559055, -2.2714996, 0.27452443, -0.69693279, 1.98451562, -1.66181581, 0.0061461, -0.46487493, -3.48266625, 1.95537972, 0.3823426, 0.61422536, 2.19144452, -1.84727928, -0.36967461, -0.31658236, 0.25652157, 3.90092146, -0.17632282, -0.22007593, 0.26951451, 0.45315514, 1.38427063, 0.00617474, 0.22349211, 0.28629142, 0.05830829, -0.08883917, 0.1481828, 0.20163197, -0.35244654, 0.93190337, 3.46794025, 0.01780869, -0.83142438, 0.06719809, -0.7512425, 0.18028516, -0.28772844, 0.55574899, 0.60403409, -0.31096245, 0.25065075, 1.55879722, -0.02253252, -0.083896, -1.01095283, 0.15442946, 0.8934827, 0.2843392, -1.31087744, 0.31578311, -0.12239319, -0.60576064, 0.77119534, -0.96230708, 0.15817031, 0.55971357, -0.01068014, 0.61411007, -0.84778617, 0.08014234, 0.86540469, -0.06253241, 0.32157832, -1.97632652, 0.31647146, 0.26098276, -1.1463497, -0.4525229, -0.50075443, -0.52522839, -0.13478346, -0.01816299, 0.49159591, 2.12631374, 1.69492559, 0.0043757, 0.15482931, 1.5403557, 0.94202833, -0.55742933, 0.23036741, 0.28619115, 1.22849986, -1.0595339, -0.49866533, 0.98238437, 0.71277788, 0.74771426, -1.54932901, -0.42897939, 0.07017483, -0.43655942, 2.07124682, 0.39072843, 0.1139163, 0.22897339, 2.06398077, 1.07880945, -0.19356135, -0.00245439, 0.21489013, 2.47817577, 0.10006068, 0.02585234, 0.15646854, 0.06613783, -0.38883083, 0.08357023, -0.06615162, -0.44600362, -0.38214517, -0.14815454, 0.01984833, 0.05990736, -0.47456113, 0.93816774, -0.59785345, -0.09637677, -0.49659337, 0.5418502, 0.84400845, 0.33090672, -0.41695291, -0.05445189, 0.78316076, -0.06257269, 0.52211548, 1.00193246, -2.4635729, 1.47726944, -0.3011682, -2.46602005, -0.10297709, -0.40169155, -0.88465581, 3.63111632, 1.11632943, 1.1265963, -0.13834992, -1.13904361, 0.88367592, 0.01713461, 0.79096455, -0.53839698, -3.8438593, -0.63254875, 0.2209145, 0.79499508, -0.49467358, -2.1234711, 0.31618373, -0.14861714, -1.67301482, -0.0430027, -0.03973439, -0.81625803, -0.31088222, 0.0503036, -0.51296021, 1.69240569, -0.21593775, 0.19022818, 0.1562194, 1.28111027, -0.2006924, 0.47281203, 0.14976824, 0.54234227, 0.16115976, 0.43709008, -0.68955746, 1.30919846, -0.06849192, -0.12745657, 0.14896356, 0.33840539, 0.42213877, 0.27768615, -0.89369225, 0.32876205, -0.94998583, -0.53786447, -0.56487816, -0.46177294, -1.08575532, -0.90788282, -0.58033364, -1.76228832, -0.77946578, 0.44743783, -0.42711793, -0.3069655, -0.9566285, -0.35333777, 0.24157408, -0.00169409, -0.36198144, -0.4627298, 0.6208236, 0.32532496, -0.48100807, 0.54999197, 2.89675842, -0.99075047, -0.46385789, 0.02357837, -0.61648305, -0.24394852, -0.68776736, 0.45973213, 0.04803183, 0.08147616, -0.44014468, -0.78568717, -0.40114569, -0.60982667, 0.12393029, 0.84176092, -1.03225214, -0.21904517, 0.11598549, 1.60438538, 0.59304788, -0.03945008, 0.0638448, 0.42544023, 1.79528776, 0.93874719, 0.01591335, -0.0820694, 1.14837002, 1.41947168, -0.26666462, -0.20724218, 0.64483762, -0.29063514, 0.01062903, -0.49902738, -0.92800397, 0.15962131, -0.0369205, -0.24601863, -0.84185485, 0.00241492, -0.98228396, -2.77105081, 0.25487039, -0.34419557, 0.27218269, 1.10593801, 0.2751315, 0.35608456, 0.39856254, -0.12743373, -0.34257429, 0.09077456, -0.94626722, 1.60412025, 1.45214365, 0.63320399, -0.08618569, -0.56156225, 0.42024177, 1.18662471, 1.79775834, 0.14570018, 0.30572068, 0.48136718, -0.21028086, 0.2519183, -0.29526641, 0.63023283, 0.70474289, 0.18073645, 0.01713545, -0.02686142, 0.24467893, 0.6560063, 0.45540367, -0.05006056, 0.21543358, 0.38948099, 0.08828946, 0.46294624, 0.23996366, -0.08823862, 0.33817829, 0.3976901, -2.72802476, 0.0068949, -0.27794135, 0.45142053, 0.58466634, -0.28088127, 0.30351011, 0.146066, 0.20509973, -0.1769003, 0.12591536, -0.33116034, 0.26158276, 0.18089159, -1.815569, -0.10876111, -0.27299534, 0.1564564, -0.56617963, 0.82010933, 0.19543072, 0.19663253, -0.29710614, -0.69630058, -0.05687886, -0.92855694, -0.19750134, -0.02739075, -0.24973589, -0.06220542, -0.4750565, -0.07086285, -0.19416382, -0.22141262, 0.7945132, 0.1481213, 0.73522059, 0.42546783, 0.210102, 0.47486147, 0.56083563, 0.11428976, -1.62750928, -0.04695249, -0.68164379, 0.10721919, 1.38023401, 1.19326509, 0.51961765, 0.4248779, 0.47770273, 1.23172101, -0.02078277, 0.44493876, 1.15651255, -1.45824392, 0.03453537, 0.22962453, 0.75718512, 0.33438966, 0.14504503, -0.40848526, 0.34710397, -1.62026372, 0.23600815, 0.15544018, 0.40816362, 0.54396385, -0.22570969, 0.19379232, -0.30378815, -0.11873641, -0.03531658, -0.11296825, 0.08629851, -0.59913098, 0.1388571, -0.60201648, -0.01310579, -0.22245659, 0.31517463, 0.31252883, 0.43893411, 0.79391082, -0.23804095, -0.96502886, -1.78322012, 0.72699413, 0.26973056, -0.37204634, 0.13524862, 0.16264076, 0.40411689, -0.42583001, -0.59603223, -0.5351199, -0.04681252, -0.93068803, -1.84717096, 0.76784495, 0.4292352, -0.03229981, -0.19735882, -0.25662815, 1.09472733, -0.19671989, -2.38051393, -0.34018065, -0.79945229, -0.54088839, 1.02844975, -0.85753644, 0.40767118, -0.21903651, -0.75286196, -0.51832948, -0.21397817, 0.35579157, 0.48666188, -0.08600408, 0.6800381, 0.29537087, 0.10178861, -0.21969043, -0.2535218, 0.26513312, 0.72841581, -0.33590025, 1.78836899, -0.31406448, 1.36588304, 0.37380913, 0.14716618, -0.80771755, 0.67789402, -0.08274023, -1.14932884, 1.13671903, -0.2508064, 1.03048668, -1.20648331, 0.4354311, -0.18429172, 0.36781426, -0.10745065, -1.48693973, 0.73506596, 0.17914616, -1.10861116, 1.11730461, 0.12089034, -0.23022552, -0.04197887, -1.28095261, 1.70020034, -0.10919253, 0.67415265, -0.20073798, -0.31987314, 0.37086582, -0.62051046, -0.93989693, -0.2894304, 0.18743281, 0.13988605, -0.02900841, 0.27442256, 0.18817036, 0.44266005, 0.50978663, -0.1113706, 1.63065048, -1.7794332, -0.31755634, 0.09149346, -0.46010379, 1.46413991, -0.24923504, 0.44701008, 0.09635991, 0.58698104, -0.53907032, 1.24045955, -0.10591311, 1.00801789, -0.22661149, 1.28446669, -2.8095573, 1.17680675, -0.06701236, -0.01990484, -0.51560264, -1.14516203, -0.23764702, 0.81047644, 1.79982418, 1.19716403, 0.16623353, 0.35066638, 1.10690571, 0.98648507, -0.9968568, -0.00612548, 0.19600697, 0.17386572, -0.66936196, 0.16435581, 0.46417075, -0.23163808, 0.08849883, 0.37779653, 0.2921898, -0.14028622, 0.32142587, -2.06041542, -1.09561448, -0.04968134, 0.34530372, -0.44565326, 0.11759497, -0.95701023, 0.05189071, -0.43232802, 0.96330441, -0.71786567, -0.23226502, -1.08902189, 0.35000344, 0.00936262, 0.29995859, -1.13913389, -0.42963059, 0.53860205, 0.66050068, -1.56572283, 0.2368823, 0.27883436, -0.07449156, -0.01935263, -1.61315198, -0.24264134, 0.12093699, -0.04601659, -0.69183312, -1.2029798, -0.26144411, 0.09437148, -0.03456878, 0.45136178, -0.83172562, 0.36505256, -0.10972521, -0.4936375, -0.12591957, -0.30848856, 0.14179548, -0.52202029, -0.34149257, -11.44233145, 0.21743096, -0.06073572, 0.10010776, 1.10199669, 0.28717459, 0.06949337, 0.23600876, 0.47602561, -0.32925783, -0.0016577, 1.27153257, 1.32392172, 0.11550364, -0.32289366, -1.1922201, -0.2709502, 0.1080917, 0.46015201, 0.88130263, -0.86302285, -0.20809276, 0.77834935, -0.58328786, 0.33132333, -0.83337201, 0.04437454, 0.65973918, -0.02983118, 0.57055484, -0.01308596, -0.39364507, 0.80760088, 0.14232149, -0.39719289, -0.02643312, -0.34085203, -0.16401716, 0.03327453, -1.02408205, 0.54551109, 0.17450207, -0.64479388, 1.30813425, -0.30510551, -1.09374132, -1.27060897, -0.03530879, -0.39200235, -0.79347232, -1.34533568, 0.63094185, -1.27625243, 0.04758732, 1.74847994, -1.8317252, -1.32967512, 0.15067975, 3.07330619, -1.03382097, -0.2417216, 0.09428424, 0.93683506, -0.11407725, 0.03155272, 0.18271949, -0.62009912, -0.71446058, -0.13345956, 0.24530664, 0.47118164, -0.53844005, -0.09995274, -0.54718436, -0.18947263, 0.36362266, -0.09746967, 0.56297139, 0.95566598, 0.98109626, 0.36730153, 0.1223493, 1.03933386, -0.07573748, 0.0974063, -0.82272998, -3.3434064, -0.69488298, 0.12337046, -0.26254483, -0.11935374, 0.56196698, 0.32012027, -0.25802748, -0.46687177, -0.18041931, 0.24454685, 0.301645, -2.45143869, -0.00681073, -0.33728652, -0.28102715, 0.27258895, -0.53504559, -0.24737824, 0.56898945, 0.59232843, 0.94171739, -0.3464817, 0.1573015, 0.71980677, -0.47262825, 0.34545721, -0.09408882, 0.39931424, 0.34844177, -0.05739015, 0.40740549, 0.26136298, 1.12446804, -0.08651147, 0.20382725, 0.65606577, -0.10565869, -0.00253925, 0.41868805, -0.80448133, 0.16362807, 0.75552517, -2.72022837, -1.28437338, 0.19215537, -0.34104523, 0.97708778, -0.10493557, -0.45867167, 0.23274852, -0.47934946, -0.41275191, -1.15299783, 2.7221585, 1.19192999, -0.29265869, -0.24976708, -0.78523194, -0.52973708, 0.02547175, -0.56988914, 0.29043001, -1.97265521, -0.5843083, -0.30737171, -0.49131435, 0.55398667, -1.62760353, -0.64356462, -0.21687425, -0.94507082, -0.31807524, -0.21478074, -0.20855819, -0.33365496, 0.38204097, -0.80013858, -0.82297974, 0.05258077, -0.31870118, -0.25110974, -0.50211974, 0.29698319, 0.04581618, 2.41558834, 0.09596117, 0.56715426, 1.90984353, -1.18092071, 1.27172204, -0.22243659, -0.20357627, 0.35116691, 0.85339517, -0.30202846, -1.16119985, 1.8293847, 1.85268541, -0.29313823, 0.5392384, 1.5102688, -0.46452768, 0.08787849, 0.9728476, 2.44164243, 2.68063574, -1.30264046, -0.16233608, 1.18751724, 2.7872606, 0.69834599, -0.34720624, -0.45259697, 1.50555043, 2.35057583, 0.17289977, -0.62186635, -0.12100033, -0.45087125, 0.45620133, 0.5546763, 0.76706356, 0.40146435, 0.20418496, 0.27163724, -0.00184938, 0.27317098, -1.8143833, -1.49807462, 0.2973864, 0.49411261, -0.32380854, -1.49689409, -0.18529611, -0.26512734, 0.14091963, -2.22418345, 0.42121402, -0.11520493, 0.17393191, 1.55169366, 0.93310092, -0.1923104, -0.10200088, -1.23576217, 0.54293279, -0.65611634, 1.44167301, -6.12170038, -0.43654819, 0.48868381, 0.06097207, 2.20517109, -0.9439845, -0.59449794, 0.07717987, -2.29667323, 0.87196156, -0.69415557, 0.27519304, 0.38792836, 0.83695642, -0.19630959, 0.3574806, -1.30304218, 0.02589824, -0.06161191, 0.38803615, 0.50950035, -0.00305887, 1.96660702, 0.74423141, -0.50337323, -1.14168687, -0.35467361, -0.99863412, -0.1408182, -0.45203795, 0.67413641, 0.91255984, 0.12468415, -1.11853351, 0.12870135, -1.25552306, 0.76404657, 2.30039335, -0.21573798, -0.04531546, 0.29982952, 0.58676628, 1.60869622, 0.39983816, 0.10677758, 1.03271956, 1.66590484, 0.75121973, 0.0002115, 0.82925399, -0.04006286, -1.13720009, 0.65797377, -1.15547489, -0.26313096, -0.01387821, -0.30231485, -0.07652224, -0.05477199, -0.32745688, 0.20159912, 0.00885946, -0.28584158, -2.08377599, 0.47155331, -0.30365669, 1.44081169, -0.03047458, -0.74700213, -0.62909711, 0.47266167, -1.10285844, -0.05196693, 0.03678704, 0.58297878, 0.08457563, 0.12513379, 1.57131672, 0.53310932, -0.13498084, 0.00067699, 1.13828326, 0.43464785, -0.82219928, 0.01966246, -1.90722651, 1.68734658, -0.2759657, 0.42721997, -1.82997624, -2.01008725, -0.31674878, -0.0038825, -0.01217038, -2.08008473, 0.06012928, 0.6788653, 0.31542592, 0.65656559, 0.00001411]);
  const b1 = new Float64Array([-0.15907511, -0.1929051, 0.10945751, -0.21092067, 0.04034448, -0.30029714, -0.20900182, -0.10178228, -0.20780551, 0.10209124, 0.18191291, 0.12001367, 0.070962, -0.17468521, 0.13430898, 0.20659673, -0.40249072, 0.01675714, 0.28446659, -0.16478239, -0.22467173, 0.28978399, 0.10560347, 0.26652285]);
  const W2 = new Float64Array([-1.06636007, -0.9190176, -0.9880083, -0.35530867, -0.08899307, -1.69870637, 0.01220959, 0.09350449, -1.1651912, 0.13830163, -0.14143865, 0.1817375, 0.34855759, 0.46334024, -0.54418244, 0.28463261, 1.09606241, 0.03632454, 1.68348322, 1.4883562, 0.04363201, 1.31636666, -0.68501627, 0.03175811, 0.36471258, 0.66178477, 1.18589667, 0.80571672, 0.1888786, -0.11836566, 0.09893024, 0.06179218, 0.71066674, -0.36287968, -0.1064925, -0.40859712, -0.4215175, -0.58632844, -0.68420745, -0.55557224, 0.55006761, 0.21302886, -0.39896691, 0.03294153, 0.08188296, -0.66677837, -0.47631594, 0.1283534, 0.03231145, 0.51188022, 0.03458735, -0.37872805, 0.99093232, -0.09349266, 0.48906059, 0.07385758, 0.56976018, -0.09113388, -0.46888558, -0.39745289, -0.05222727, -1.01176235, -0.10587054, -0.37683798, 0.87894271, 1.09608087, 0.11028256, 0.28244313, -0.78961705, -0.19327519, 0.41660429, 0.64677505, -0.57763378, -0.14187799, 0.31931852, -0.17893321, -0.1052134, -0.26276642, 0.22673011, -0.29032388, -0.15508991, 0.32140468, -0.62552615, -0.12244431, 0.4430931, 0.28272648, -0.33711309, 0.77692119, 1.3327882, -0.32980567, 0.09392896, -0.36823786, 0.57180358, -0.33167606, -0.30915636, -0.0301393, 1.5204984, 0.50403415, 0.91787832, -0.71484875, 0.09642167, 0.83226803, 0.0377348, 0.41422052, 1.45311684, -0.59202403, -0.9823554, -0.1361235, 0.50204823, 0.08987324, 0.34131219, -0.49477002, -1.83099733, 0.39757269, 0.22414437, 0.22020696, -0.93904678, 1.57251293, 0.02618352, -0.8243548, -0.09878735, -0.28404156, 0.09511452, -0.03864435, -0.06619242, -0.32489413, 0.18103445, -0.67042187, 0.06641501, 0.49091602, 1.15105489, -0.03124252, 0.29284833, -0.07068988, 0.18520357, 0.05663937, 0.117698, -0.0797537, -0.33787976, -0.04743768, -0.39996365, -0.46597293, -0.02634516, -0.0964922, 0.37484397, 0.41337386, -0.5388731, 0.05072256, -0.01660806, -0.34263423, 0.39648123, 0.49761053, 0.21517297, -0.17741354, 0.2828262, -0.90036219, 0.15542189, -0.54295006, 0.03839443, -0.24938647, -0.19099852, -0.24707483, 0.4310102, 0.1716582, -0.21609417, -0.47396357, 0.64833543, 0.13416627, 0.51955328, 0.32756169, 1.44459655, 0.45706039, -0.18778061, 0.42820058, 0.61110126, -1.3664041, 0.60192903, -1.07354476, -0.44862069, -0.05646726, -1.3273419, 0.87264658, 0.18648687, 0.4046214, -0.83832859, 0.55344986, 0.43776764, -1.25358137, -1.02852542, -0.38953627, -0.1098615, -0.06735816, 0.13221443, -0.05011555, 0.23659837, 1.06796277, 0.23111975, 0.16534329, -1.73893576, 0.42179463, 0.43795234, -0.74172042, -0.58225356, 0.82913229, -0.0061605, 0.14352363, 0.68626179, -0.47791533, -1.18425093, -0.86687171, 0.13670141, 1.3497123, 0.1870161, -0.15197923, -0.14197344, -1.48606292, 0.759968, -0.78261921, 0.86541666, 0.49401549, -1.00070819, -0.87567447, 0.47184199, 0.05707999, 0.28663265, 0.57849863, 0.45998443, 0.57073688, 0.62550341, -0.59592951, 0.30839136, 1.16268514, 0.46135021, -0.16642006, 0.9698602, 1.01061643, -0.60635468, -0.12549207, -0.04484992, -0.79689827, -0.09897471, -0.64850121, 0.70027939, 0.33297784, -1.04378598, -0.28438728, -0.3963471, -0.0030868, -1.10497942, -0.38022961, 0.09077478, 0.32667395, 0.59005625, 1.03490529, 0.35289898, 0.07765075, -0.50261793, -1.06121045, -0.00453313, -0.38053407, 1.35021785, -0.28493185, -0.09606505, -0.67572982, -0.13474524, -0.12426026, -0.07336407, 0.88524838, -0.00078716, 0.81413289, -1.030188, 0.04768998, -0.19906243, -0.58877772, -0.58348167, 0.25562227, -0.46262391, 0.29961826, -0.16890995, -0.07276982, 0.0386313, -1.22748869, 0.27623303, 0.52627614, -0.06246282, 0.57380885, -1.16333763, -1.00636065, 0.78842963, 0.66658387, 0.0864282, -1.35076353, 0.34379365, -0.03387986, -0.02327315, 0.55144792, 1.25927518, -1.18115354, -0.2735233, -0.2034306, 0.70141231, 0.02625898, 0.43513017, -0.42636147, -1.36533786, 0.25487186, 0.58849371, 0.17550897, -0.61778176, 1.52055962, 0.34922819, -0.90630038, -1.3268624, -0.2776963, -0.53731126, 0.03874003, 1.8093392, 0.17853993, -0.03630116, 0.45842332, 1.09878117, -0.39164164, -0.61933352, 0.20103481, -0.24118892, -0.00344222, 0.04404278, -0.70625417, -3.06268001, 0.39331597, -0.77555831, -0.42094925, -0.12266971, 0.24322597, 0.20764888, 0.13823716, -0.4869097, 0.05074555, -0.05776163, 1.34533581, -0.53936717, 1.77920668, -1.21569102, -0.69992965, 0.9377622, -0.01419624, -0.72646094, -0.22733931, -0.00897031, 0.44336358, -0.72956401, 0.25746792, -0.06084525, 0.13093694, -0.48404722, -0.83407745, 0.11298876, -0.7265127, 1.07638829, 0.05064864, -1.11875352, -0.76518293, 0.22344272, 0.1992795, -0.02284234, 0.03587222, -0.16635103, -0.2079402, 0.99594145, -0.71155991, -0.3595612, 0.67544504, -0.02880367, -0.30229637, 1.09523003, 0.80242019, -1.99040455, 0.11941035, -0.93049676, -1.0701498, -1.27559322, 0.29859456, -0.42368542, 0.21916323]);
  const b2 = new Float64Array([0.42401962, -0.15526196, -0.20935103, 0.37684314, -0.3962977, -0.14583154, -0.2090909, -0.12138925, -0.0466035, 0.11940856, 0.2488065, 0.08022293, -0.1910896, -0.10880616, 0.09888873, 0.39354428]);
  const W3 = new Float64Array([1.26124454, -0.65319858, -0.17077544, 0.11036791, -0.61442015, 0.24028936, -0.22961459, -1.09522736, 0.62007109, -0.93996106, -0.01092359, 0.76652377, -0.46148229, -0.3793807, 0.82534505, 0.19656298, 0.00001615, -0.00131499, 0.06900849, 0.0003891, -0.00014329, 0.00120203, 0.01659016, 0.00087973, 0.00057459, -0.00048635, 0.05999357, 0.00138296, 0.00007018, 0.00070735, 0.00007993, 0.00071559, 0.0012782, -0.00064121, 0.28044171, -0.00194282, -0.0005933, 0.0013636, -0.03993883, 0.00146348, 0.00054601, -0.00111742, 0.26163712, 0.00302233, -0.00004194, 0.00097757, -0.00039643, -0.00003672, 0.00067284, -0.00047046, 0.17866526, -0.00112832, -0.00024521, 0.00113972, -0.02224619, 0.00089898, 0.00037566, -0.0007047, 0.16630316, 0.00189986, 0.00008513, 0.00052058, -0.00022396, -0.00010026, -0.02493241, -0.05365352, -0.67760733, 0.6432918, -0.1426055, -1.04640718, -0.65120678, -0.02487318, -0.03472516, 0.19076929, 1.05013304, 0.28704301, 0.10847837, -1.81147378, 0.047731, -0.92739122]);
  const b3 = new Float64Array([0.04979021, 0.02188968, -0.02374768, -0.01209304, 0.27876574]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.41431055, 0.1338646, 0.55125613, -0.06895575, -0.06835756, 0.05331997, 0.06857526, -0.14395597, 1.21813192, -5.12542594, 0.31925965, 0.07665982, 0.38424277, 0.14916191, -0.36962622, -0.44703312, 0.16872953, -0.0854955, -0.03949504, -0.66054972, -1.9185536, -1.11083333, 0.30913522, 0.3730612, 2.97253396, 0.6472466, 0.20059331, 0.42651631, 0.94783723, -0.517167, 0.26846972, 0.41084199, -1.52272934, 2.3738246, 1.21123546, 0.14337352, 0.15023066, -1.04911612, 1.00836258, -0.21475508, -0.03610315, 0.62343677, -0.49988797, -0.93496687, -0.12984244, -0.84099928, -0.21567879, -0.43947192, -1.23279242, 0.05282233, -0.25328222, 0.80116723, 0.64037293, -0.39225099, 0.30158138, -0.94047182, 0.03355886, -0.00047208, -0.10423673, -0.25502409, 0.65850808, 0.65766512, -0.27156693, -0.29301184, -0.29960504, -0.63245265, 0.74327879, 0.85258121, 1.17816536, -0.6805901, 0.24750862, 0.83212748, 0.56825779, 0.17784877, -0.36086999, 0.33168088, 0.51650557, 0.76206268, -0.052468, -0.01018024, 1.03601023, -0.09345558, 0.51415384, -0.56865428, -0.07378277, -0.10224367, 0.11243758, 0.35146254, -0.10536201, -0.00165517, 0.27272122, 0.10284289, -0.53502643, 0.21751092, -0.15990307, -1.029625, -0.41324882, 0.50601471, 0.10125505, -0.24225844, 0.22948454, 0.18013721, 0.65515115, -0.62939425, -0.56162344, 0.21342572, 0.94726643, -0.72814546, 0.79665017, 0.03708925, -0.18671571, -0.44393631, -0.24495466, -0.17335064, 3.32287773, 2.91461075, 0.62810635, -0.87469265, 3.05703989, 0.44548581, 0.35591438, 0.55084036, 0.24098162, 3.95039206, 0.54725333, 0.24625632, 0.5983237, 0.0881038, 0.95223547, -0.04220454, 0.32035429, 0.74974993, 0.02975341, -0.14233331, 0.64226266, 0.33667054, -0.32672714, 0.55420472, 0.41442452, -0.1652329, 0.36496469, 0.20613541, -0.60575785, 0.67512675, 0.18668144, -0.72989976, -0.59984573, -0.59043776, -0.49517479, -1.20559055, -2.2714996, 0.27452443, -0.69693279, 1.98451562, -1.66181581, 0.0061461, -0.46487493, -3.48266625, 1.95537972, 0.3823426, 0.61422536, 2.19144452, -1.84727928, -0.36967461, -0.31658236, 0.25652157, 3.90092146, -0.17632282, -0.22007593, 0.26951451, 0.45315514, 1.38427063, 0.00617474, 0.22349211, 0.28629142, 0.05830829, -0.08883917, 0.1481828, 0.20163197, -0.35244654, 0.93190337, 3.46794025, 0.01780869, -0.83142438, 0.06719809, -0.7512425, 0.18028516, -0.28772844, 0.55574899, 0.60403409, -0.31096245, 0.25065075, 1.55879722, -0.02253252, -0.083896, -1.01095283, 0.15442946, 0.8934827, 0.2843392, -1.31087744, 0.31578311, -0.12239319, -0.60576064, 0.77119534, -0.96230708, 0.15817031, 0.55971357, -0.01068014, 0.61411007, -0.84778617, 0.08014234, 0.86540469, -0.06253241, 0.32157832, -1.97632652, 0.31647146, 0.26098276, -1.1463497, -0.4525229, -0.50075443, -0.52522839, -0.13478346, -0.01816299, 0.49159591, 2.12631374, 1.69492559, 0.0043757, 0.15482931, 1.5403557, 0.94202833, -0.55742933, 0.23036741, 0.28619115, 1.22849986, -1.0595339, -0.49866533, 0.98238437, 0.71277788, 0.74771426, -1.54932901, -0.42897939, 0.07017483, -0.43655942, 2.07124682, 0.39072843, 0.1139163, 0.22897339, 2.06398077, 1.07880945, -0.19356135, -0.00245439, 0.21489013, 2.47817577, 0.10006068, 0.02585234, 0.15646854, 0.06613783, -0.38883083, 0.08357023, -0.06615162, -0.44600362, -0.38214517, -0.14815454, 0.01984833, 0.05990736, -0.47456113, 0.93816774, -0.59785345, -0.09637677, -0.49659337, 0.5418502, 0.84400845, 0.33090672, -0.41695291, -0.05445189, 0.78316076, -0.06257269, 0.52211548, 1.00193246, -2.4635729, 1.47726944, -0.3011682, -2.46602005, -0.10297709, -0.40169155, -0.88465581, 3.63111632, 1.11632943, 1.1265963, -0.13834992, -1.13904361, 0.88367592, 0.01713461, 0.79096455, -0.53839698, -3.8438593, -0.63254875, 0.2209145, 0.79499508, -0.49467358, -2.1234711, 0.31618373, -0.14861714, -1.67301482, -0.0430027, -0.03973439, -0.81625803, -0.31088222, 0.0503036, -0.51296021, 1.69240569, -0.21593775, 0.19022818, 0.1562194, 1.28111027, -0.2006924, 0.47281203, 0.14976824, 0.54234227, 0.16115976, 0.43709008, -0.68955746, 1.30919846, -0.06849192, -0.12745657, 0.14896356, 0.33840539, 0.42213877, 0.27768615, -0.89369225, 0.32876205, -0.94998583, -0.53786447, -0.56487816, -0.46177294, -1.08575532, -0.90788282, -0.58033364, -1.76228832, -0.77946578, 0.44743783, -0.42711793, -0.3069655, -0.9566285, -0.35333777, 0.24157408, -0.00169409, -0.36198144, -0.4627298, 0.6208236, 0.32532496, -0.48100807, 0.54999197, 2.89675842, -0.99075047, -0.46385789, 0.02357837, -0.61648305, -0.24394852, -0.68776736, 0.45973213, 0.04803183, 0.08147616, -0.44014468, -0.78568717, -0.40114569, -0.60982667, 0.12393029, 0.84176092, -1.03225214, -0.21904517, 0.11598549, 1.60438538, 0.59304788, -0.03945008, 0.0638448, 0.42544023, 1.79528776, 0.93874719, 0.01591335, -0.0820694, 1.14837002, 1.41947168, -0.26666462, -0.20724218, 0.64483762, -0.29063514, 0.01062903, -0.49902738, -0.92800397, 0.15962131, -0.0369205, -0.24601863, -0.84185485, 0.00241492, -0.98228396, -2.77105081, 0.25487039, -0.34419557, 0.27218269, 1.10593801, 0.2751315, 0.35608456, 0.39856254, -0.12743373, -0.34257429, 0.09077456, -0.94626722, 1.60412025, 1.45214365, 0.63320399, -0.08618569, -0.56156225, 0.42024177, 1.18662471, 1.79775834, 0.14570018, 0.30572068, 0.48136718, -0.21028086, 0.2519183, -0.29526641, 0.63023283, 0.70474289, 0.18073645, 0.01713545, -0.02686142, 0.24467893, 0.6560063, 0.45540367, -0.05006056, 0.21543358, 0.38948099, 0.08828946, 0.46294624, 0.23996366, -0.08823862, 0.33817829, 0.3976901, -2.72802476, 0.0068949, -0.27794135, 0.45142053, 0.58466634, -0.28088127, 0.30351011, 0.146066, 0.20509973, -0.1769003, 0.12591536, -0.33116034, 0.26158276, 0.18089159, -1.815569, -0.10876111, -0.27299534, 0.1564564, -0.56617963, 0.82010933, 0.19543072, 0.19663253, -0.29710614, -0.69630058, -0.05687886, -0.92855694, -0.19750134, -0.02739075, -0.24973589, -0.06220542, -0.4750565, -0.07086285, -0.19416382, -0.22141262, 0.7945132, 0.1481213, 0.73522059, 0.42546783, 0.210102, 0.47486147, 0.56083563, 0.11428976, -1.62750928, -0.04695249, -0.68164379, 0.10721919, 1.38023401, 1.19326509, 0.51961765, 0.4248779, 0.47770273, 1.23172101, -0.02078277, 0.44493876, 1.15651255, -1.45824392, 0.03453537, 0.22962453, 0.75718512, 0.33438966, 0.14504503, -0.40848526, 0.34710397, -1.62026372, 0.23600815, 0.15544018, 0.40816362, 0.54396385, -0.22570969, 0.19379232, -0.30378815, -0.11873641, -0.03531658, -0.11296825, 0.08629851, -0.59913098, 0.1388571, -0.60201648, -0.01310579, -0.22245659, 0.31517463, 0.31252883, 0.43893411, 0.79391082, -0.23804095, -0.96502886, -1.78322012, 0.72699413, 0.26973056, -0.37204634, 0.13524862, 0.16264076, 0.40411689, -0.42583001, -0.59603223, -0.5351199, -0.04681252, -0.93068803, -1.84717096, 0.76784495, 0.4292352, -0.03229981, -0.19735882, -0.25662815, 1.09472733, -0.19671989, -2.38051393, -0.34018065, -0.79945229, -0.54088839, 1.02844975, -0.85753644, 0.40767118, -0.21903651, -0.75286196, -0.51832948, -0.21397817, 0.35579157, 0.48666188, -0.08600408, 0.6800381, 0.29537087, 0.10178861, -0.21969043, -0.2535218, 0.26513312, 0.72841581, -0.33590025, 1.78836899, -0.31406448, 1.36588304, 0.37380913, 0.14716618, -0.80771755, 0.67789402, -0.08274023, -1.14932884, 1.13671903, -0.2508064, 1.03048668, -1.20648331, 0.4354311, -0.18429172, 0.36781426, -0.10745065, -1.48693973, 0.73506596, 0.17914616, -1.10861116, 1.11730461, 0.12089034, -0.23022552, -0.04197887, -1.28095261, 1.70020034, -0.10919253, 0.67415265, -0.20073798, -0.31987314, 0.37086582, -0.62051046, -0.93989693, -0.2894304, 0.18743281, 0.13988605, -0.02900841, 0.27442256, 0.18817036, 0.44266005, 0.50978663, -0.1113706, 1.63065048, -1.7794332, -0.31755634, 0.09149346, -0.46010379, 1.46413991, -0.24923504, 0.44701008, 0.09635991, 0.58698104, -0.53907032, 1.24045955, -0.10591311, 1.00801789, -0.22661149, 1.28446669, -2.8095573, 1.17680675, -0.06701236, -0.01990484, -0.51560264, -1.14516203, -0.23764702, 0.81047644, 1.79982418, 1.19716403, 0.16623353, 0.35066638, 1.10690571, 0.98648507, -0.9968568, -0.00612548, 0.19600697, 0.17386572, -0.66936196, 0.16435581, 0.46417075, -0.23163808, 0.08849883, 0.37779653, 0.2921898, -0.14028622, 0.32142587, -2.06041542, -1.09561448, -0.04968134, 0.34530372, -0.44565326, 0.11759497, -0.95701023, 0.05189071, -0.43232802, 0.96330441, -0.71786567, -0.23226502, -1.08902189, 0.35000344, 0.00936262, 0.29995859, -1.13913389, -0.42963059, 0.53860205, 0.66050068, -1.56572283, 0.2368823, 0.27883436, -0.07449156, -0.01935263, -1.61315198, -0.24264134, 0.12093699, -0.04601659, -0.69183312, -1.2029798, -0.26144411, 0.09437148, -0.03456878, 0.45136178, -0.83172562, 0.36505256, -0.10972521, -0.4936375, -0.12591957, -0.30848856, 0.14179548, -0.52202029, -0.34149257, -11.44233145, 0.21743096, -0.06073572, 0.10010776, 1.10199669, 0.28717459, 0.06949337, 0.23600876, 0.47602561, -0.32925783, -0.0016577, 1.27153257, 1.32392172, 0.11550364, -0.32289366, -1.1922201, -0.2709502, 0.1080917, 0.46015201, 0.88130263, -0.86302285, -0.20809276, 0.77834935, -0.58328786, 0.33132333, -0.83337201, 0.04437454, 0.65973918, -0.02983118, 0.57055484, -0.01308596, -0.39364507, 0.80760088, 0.14232149, -0.39719289, -0.02643312, -0.34085203, -0.16401716, 0.03327453, -1.02408205, 0.54551109, 0.17450207, -0.64479388, 1.30813425, -0.30510551, -1.09374132, -1.27060897, -0.03530879, -0.39200235, -0.79347232, -1.34533568, 0.63094185, -1.27625243, 0.04758732, 1.74847994, -1.8317252, -1.32967512, 0.15067975, 3.07330619, -1.03382097, -0.2417216, 0.09428424, 0.93683506, -0.11407725, 0.03155272, 0.18271949, -0.62009912, -0.71446058, -0.13345956, 0.24530664, 0.47118164, -0.53844005, -0.09995274, -0.54718436, -0.18947263, 0.36362266, -0.09746967, 0.56297139, 0.95566598, 0.98109626, 0.36730153, 0.1223493, 1.03933386, -0.07573748, 0.0974063, -0.82272998, -3.3434064, -0.69488298, 0.12337046, -0.26254483, -0.11935374, 0.56196698, 0.32012027, -0.25802748, -0.46687177, -0.18041931, 0.24454685, 0.301645, -2.45143869, -0.00681073, -0.33728652, -0.28102715, 0.27258895, -0.53504559, -0.24737824, 0.56898945, 0.59232843, 0.94171739, -0.3464817, 0.1573015, 0.71980677, -0.47262825, 0.34545721, -0.09408882, 0.39931424, 0.34844177, -0.05739015, 0.40740549, 0.26136298, 1.12446804, -0.08651147, 0.20382725, 0.65606577, -0.10565869, -0.00253925, 0.41868805, -0.80448133, 0.16362807, 0.75552517, -2.72022837, -1.28437338, 0.19215537, -0.34104523, 0.97708778, -0.10493557, -0.45867167, 0.23274852, -0.47934946, -0.41275191, -1.15299783, 2.7221585, 1.19192999, -0.29265869, -0.24976708, -0.78523194, -0.52973708, 0.02547175, -0.56988914, 0.29043001, -1.97265521, -0.5843083, -0.30737171, -0.49131435, 0.55398667, -1.62760353, -0.64356462, -0.21687425, -0.94507082, -0.31807524, -0.21478074, -0.20855819, -0.33365496, 0.38204097, -0.80013858, -0.82297974, 0.05258077, -0.31870118, -0.25110974, -0.50211974, 0.29698319, 0.04581618, 2.41558834, 0.09596117, 0.56715426, 1.90984353, -1.18092071, 1.27172204, -0.22243659, -0.20357627, 0.35116691, 0.85339517, -0.30202846, -1.16119985, 1.8293847, 1.85268541, -0.29313823, 0.5392384, 1.5102688, -0.46452768, 0.08787849, 0.9728476, 2.44164243, 2.68063574, -1.30264046, -0.16233608, 1.18751724, 2.7872606, 0.69834599, -0.34720624, -0.45259697, 1.50555043, 2.35057583, 0.17289977, -0.62186635, -0.12100033, -0.45087125, 0.45620133, 0.5546763, 0.76706356, 0.40146435, 0.20418496, 0.27163724, -0.00184938, 0.27317098, -1.8143833, -1.49807462, 0.2973864, 0.49411261, -0.32380854, -1.49689409, -0.18529611, -0.26512734, 0.14091963, -2.22418345, 0.42121402, -0.11520493, 0.17393191, 1.55169366, 0.93310092, -0.1923104, -0.10200088, -1.23576217, 0.54293279, -0.65611634, 1.44167301, -6.12170038, -0.43654819, 0.48868381, 0.06097207, 2.20517109, -0.9439845, -0.59449794, 0.07717987, -2.29667323, 0.87196156, -0.69415557, 0.27519304, 0.38792836, 0.83695642, -0.19630959, 0.3574806, -1.30304218, 0.02589824, -0.06161191, 0.38803615, 0.50950035, -0.00305887, 1.96660702, 0.74423141, -0.50337323, -1.14168687, -0.35467361, -0.99863412, -0.1408182, -0.45203795, 0.67413641, 0.91255984, 0.12468415, -1.11853351, 0.12870135, -1.25552306, 0.76404657, 2.30039335, -0.21573798, -0.04531546, 0.29982952, 0.58676628, 1.60869622, 0.39983816, 0.10677758, 1.03271956, 1.66590484, 0.75121973, 0.0002115, 0.82925399, -0.04006286, -1.13720009, 0.65797377, -1.15547489, -0.26313096, -0.01387821, -0.30231485, -0.07652224, -0.05477199, -0.32745688, 0.20159912, 0.00885946, -0.28584158, -2.08377599, 0.47155331, -0.30365669, 1.44081169, -0.03047458, -0.74700213, -0.62909711, 0.47266167, -1.10285844, -0.05196693, 0.03678704, 0.58297878, 0.08457563, 0.12513379, 1.57131672, 0.53310932, -0.13498084, 0.00067699, 1.13828326, 0.43464785, -0.82219928, 0.01966246, -1.90722651, 1.68734658, -0.2759657, 0.42721997, -1.82997624, -2.01008725, -0.31674878, -0.0038825, -0.01217038, -2.08008473, 0.06012928, 0.6788653, 0.31542592, 0.65656559, 0.00001411]);
  const b1 = new Float64Array([-0.15907511, -0.1929051, 0.10945751, -0.21092067, 0.04034448, -0.30029714, -0.20900182, -0.10178228, -0.20780551, 0.10209124, 0.18191291, 0.12001367, 0.070962, -0.17468521, 0.13430898, 0.20659673, -0.40249072, 0.01675714, 0.28446659, -0.16478239, -0.22467173, 0.28978399, 0.10560347, 0.26652285]);
  const W2 = new Float64Array([-1.06636007, -0.9190176, -0.9880083, -0.35530867, -0.08899307, -1.69870637, 0.01220959, 0.09350449, -1.1651912, 0.13830163, -0.14143865, 0.1817375, 0.34855759, 0.46334024, -0.54418244, 0.28463261, 1.09606241, 0.03632454, 1.68348322, 1.4883562, 0.04363201, 1.31636666, -0.68501627, 0.03175811, 0.36471258, 0.66178477, 1.18589667, 0.80571672, 0.1888786, -0.11836566, 0.09893024, 0.06179218, 0.71066674, -0.36287968, -0.1064925, -0.40859712, -0.4215175, -0.58632844, -0.68420745, -0.55557224, 0.55006761, 0.21302886, -0.39896691, 0.03294153, 0.08188296, -0.66677837, -0.47631594, 0.1283534, 0.03231145, 0.51188022, 0.03458735, -0.37872805, 0.99093232, -0.09349266, 0.48906059, 0.07385758, 0.56976018, -0.09113388, -0.46888558, -0.39745289, -0.05222727, -1.01176235, -0.10587054, -0.37683798, 0.87894271, 1.09608087, 0.11028256, 0.28244313, -0.78961705, -0.19327519, 0.41660429, 0.64677505, -0.57763378, -0.14187799, 0.31931852, -0.17893321, -0.1052134, -0.26276642, 0.22673011, -0.29032388, -0.15508991, 0.32140468, -0.62552615, -0.12244431, 0.4430931, 0.28272648, -0.33711309, 0.77692119, 1.3327882, -0.32980567, 0.09392896, -0.36823786, 0.57180358, -0.33167606, -0.30915636, -0.0301393, 1.5204984, 0.50403415, 0.91787832, -0.71484875, 0.09642167, 0.83226803, 0.0377348, 0.41422052, 1.45311684, -0.59202403, -0.9823554, -0.1361235, 0.50204823, 0.08987324, 0.34131219, -0.49477002, -1.83099733, 0.39757269, 0.22414437, 0.22020696, -0.93904678, 1.57251293, 0.02618352, -0.8243548, -0.09878735, -0.28404156, 0.09511452, -0.03864435, -0.06619242, -0.32489413, 0.18103445, -0.67042187, 0.06641501, 0.49091602, 1.15105489, -0.03124252, 0.29284833, -0.07068988, 0.18520357, 0.05663937, 0.117698, -0.0797537, -0.33787976, -0.04743768, -0.39996365, -0.46597293, -0.02634516, -0.0964922, 0.37484397, 0.41337386, -0.5388731, 0.05072256, -0.01660806, -0.34263423, 0.39648123, 0.49761053, 0.21517297, -0.17741354, 0.2828262, -0.90036219, 0.15542189, -0.54295006, 0.03839443, -0.24938647, -0.19099852, -0.24707483, 0.4310102, 0.1716582, -0.21609417, -0.47396357, 0.64833543, 0.13416627, 0.51955328, 0.32756169, 1.44459655, 0.45706039, -0.18778061, 0.42820058, 0.61110126, -1.3664041, 0.60192903, -1.07354476, -0.44862069, -0.05646726, -1.3273419, 0.87264658, 0.18648687, 0.4046214, -0.83832859, 0.55344986, 0.43776764, -1.25358137, -1.02852542, -0.38953627, -0.1098615, -0.06735816, 0.13221443, -0.05011555, 0.23659837, 1.06796277, 0.23111975, 0.16534329, -1.73893576, 0.42179463, 0.43795234, -0.74172042, -0.58225356, 0.82913229, -0.0061605, 0.14352363, 0.68626179, -0.47791533, -1.18425093, -0.86687171, 0.13670141, 1.3497123, 0.1870161, -0.15197923, -0.14197344, -1.48606292, 0.759968, -0.78261921, 0.86541666, 0.49401549, -1.00070819, -0.87567447, 0.47184199, 0.05707999, 0.28663265, 0.57849863, 0.45998443, 0.57073688, 0.62550341, -0.59592951, 0.30839136, 1.16268514, 0.46135021, -0.16642006, 0.9698602, 1.01061643, -0.60635468, -0.12549207, -0.04484992, -0.79689827, -0.09897471, -0.64850121, 0.70027939, 0.33297784, -1.04378598, -0.28438728, -0.3963471, -0.0030868, -1.10497942, -0.38022961, 0.09077478, 0.32667395, 0.59005625, 1.03490529, 0.35289898, 0.07765075, -0.50261793, -1.06121045, -0.00453313, -0.38053407, 1.35021785, -0.28493185, -0.09606505, -0.67572982, -0.13474524, -0.12426026, -0.07336407, 0.88524838, -0.00078716, 0.81413289, -1.030188, 0.04768998, -0.19906243, -0.58877772, -0.58348167, 0.25562227, -0.46262391, 0.29961826, -0.16890995, -0.07276982, 0.0386313, -1.22748869, 0.27623303, 0.52627614, -0.06246282, 0.57380885, -1.16333763, -1.00636065, 0.78842963, 0.66658387, 0.0864282, -1.35076353, 0.34379365, -0.03387986, -0.02327315, 0.55144792, 1.25927518, -1.18115354, -0.2735233, -0.2034306, 0.70141231, 0.02625898, 0.43513017, -0.42636147, -1.36533786, 0.25487186, 0.58849371, 0.17550897, -0.61778176, 1.52055962, 0.34922819, -0.90630038, -1.3268624, -0.2776963, -0.53731126, 0.03874003, 1.8093392, 0.17853993, -0.03630116, 0.45842332, 1.09878117, -0.39164164, -0.61933352, 0.20103481, -0.24118892, -0.00344222, 0.04404278, -0.70625417, -3.06268001, 0.39331597, -0.77555831, -0.42094925, -0.12266971, 0.24322597, 0.20764888, 0.13823716, -0.4869097, 0.05074555, -0.05776163, 1.34533581, -0.53936717, 1.77920668, -1.21569102, -0.69992965, 0.9377622, -0.01419624, -0.72646094, -0.22733931, -0.00897031, 0.44336358, -0.72956401, 0.25746792, -0.06084525, 0.13093694, -0.48404722, -0.83407745, 0.11298876, -0.7265127, 1.07638829, 0.05064864, -1.11875352, -0.76518293, 0.22344272, 0.1992795, -0.02284234, 0.03587222, -0.16635103, -0.2079402, 0.99594145, -0.71155991, -0.3595612, 0.67544504, -0.02880367, -0.30229637, 1.09523003, 0.80242019, -1.99040455, 0.11941035, -0.93049676, -1.0701498, -1.27559322, 0.29859456, -0.42368542, 0.21916323]);
  const b2 = new Float64Array([0.42401962, -0.15526196, -0.20935103, 0.37684314, -0.3962977, -0.14583154, -0.2090909, -0.12138925, -0.0466035, 0.11940856, 0.2488065, 0.08022293, -0.1910896, -0.10880616, 0.09888873, 0.39354428]);
  const W3 = new Float64Array([1.26124454, -0.65319858, -0.17077544, 0.11036791, -0.61442015, 0.24028936, -0.22961459, -1.09522736, 0.62007109, -0.93996106, -0.01092359, 0.76652377, -0.46148229, -0.3793807, 0.82534505, 0.19656298, 0.00001615, -0.00131499, 0.06900849, 0.0003891, -0.00014329, 0.00120203, 0.01659016, 0.00087973, 0.00057459, -0.00048635, 0.05999357, 0.00138296, 0.00007018, 0.00070735, 0.00007993, 0.00071559, 0.0012782, -0.00064121, 0.28044171, -0.00194282, -0.0005933, 0.0013636, -0.03993883, 0.00146348, 0.00054601, -0.00111742, 0.26163712, 0.00302233, -0.00004194, 0.00097757, -0.00039643, -0.00003672, 0.00067284, -0.00047046, 0.17866526, -0.00112832, -0.00024521, 0.00113972, -0.02224619, 0.00089898, 0.00037566, -0.0007047, 0.16630316, 0.00189986, 0.00008513, 0.00052058, -0.00022396, -0.00010026, -0.02493241, -0.05365352, -0.67760733, 0.6432918, -0.1426055, -1.04640718, -0.65120678, -0.02487318, -0.03472516, 0.19076929, 1.05013304, 0.28704301, 0.10847837, -1.81147378, 0.047731, -0.92739122]);
  const b3 = new Float64Array([0.04979021, 0.02188968, -0.02374768, -0.01209304, 0.27876574]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.41431055, 0.1338646, 0.55125613, -0.06895575, -0.06835756, 0.05331997, 0.06857526, -0.14395597, 1.21813192, -5.12542594, 0.31925965, 0.07665982, 0.38424277, 0.14916191, -0.36962622, -0.44703312, 0.16872953, -0.0854955, -0.03949504, -0.66054972, -1.9185536, -1.11083333, 0.30913522, 0.3730612, 2.97253396, 0.6472466, 0.20059331, 0.42651631, 0.94783723, -0.517167, 0.26846972, 0.41084199, -1.52272934, 2.3738246, 1.21123546, 0.14337352, 0.15023066, -1.04911612, 1.00836258, -0.21475508, -0.03610315, 0.62343677, -0.49988797, -0.93496687, -0.12984244, -0.84099928, -0.21567879, -0.43947192, -1.23279242, 0.05282233, -0.25328222, 0.80116723, 0.64037293, -0.39225099, 0.30158138, -0.94047182, 0.03355886, -0.00047208, -0.10423673, -0.25502409, 0.65850808, 0.65766512, -0.27156693, -0.29301184, -0.29960504, -0.63245265, 0.74327879, 0.85258121, 1.17816536, -0.6805901, 0.24750862, 0.83212748, 0.56825779, 0.17784877, -0.36086999, 0.33168088, 0.51650557, 0.76206268, -0.052468, -0.01018024, 1.03601023, -0.09345558, 0.51415384, -0.56865428, -0.07378277, -0.10224367, 0.11243758, 0.35146254, -0.10536201, -0.00165517, 0.27272122, 0.10284289, -0.53502643, 0.21751092, -0.15990307, -1.029625, -0.41324882, 0.50601471, 0.10125505, -0.24225844, 0.22948454, 0.18013721, 0.65515115, -0.62939425, -0.56162344, 0.21342572, 0.94726643, -0.72814546, 0.79665017, 0.03708925, -0.18671571, -0.44393631, -0.24495466, -0.17335064, 3.32287773, 2.91461075, 0.62810635, -0.87469265, 3.05703989, 0.44548581, 0.35591438, 0.55084036, 0.24098162, 3.95039206, 0.54725333, 0.24625632, 0.5983237, 0.0881038, 0.95223547, -0.04220454, 0.32035429, 0.74974993, 0.02975341, -0.14233331, 0.64226266, 0.33667054, -0.32672714, 0.55420472, 0.41442452, -0.1652329, 0.36496469, 0.20613541, -0.60575785, 0.67512675, 0.18668144, -0.72989976, -0.59984573, -0.59043776, -0.49517479, -1.20559055, -2.2714996, 0.27452443, -0.69693279, 1.98451562, -1.66181581, 0.0061461, -0.46487493, -3.48266625, 1.95537972, 0.3823426, 0.61422536, 2.19144452, -1.84727928, -0.36967461, -0.31658236, 0.25652157, 3.90092146, -0.17632282, -0.22007593, 0.26951451, 0.45315514, 1.38427063, 0.00617474, 0.22349211, 0.28629142, 0.05830829, -0.08883917, 0.1481828, 0.20163197, -0.35244654, 0.93190337, 3.46794025, 0.01780869, -0.83142438, 0.06719809, -0.7512425, 0.18028516, -0.28772844, 0.55574899, 0.60403409, -0.31096245, 0.25065075, 1.55879722, -0.02253252, -0.083896, -1.01095283, 0.15442946, 0.8934827, 0.2843392, -1.31087744, 0.31578311, -0.12239319, -0.60576064, 0.77119534, -0.96230708, 0.15817031, 0.55971357, -0.01068014, 0.61411007, -0.84778617, 0.08014234, 0.86540469, -0.06253241, 0.32157832, -1.97632652, 0.31647146, 0.26098276, -1.1463497, -0.4525229, -0.50075443, -0.52522839, -0.13478346, -0.01816299, 0.49159591, 2.12631374, 1.69492559, 0.0043757, 0.15482931, 1.5403557, 0.94202833, -0.55742933, 0.23036741, 0.28619115, 1.22849986, -1.0595339, -0.49866533, 0.98238437, 0.71277788, 0.74771426, -1.54932901, -0.42897939, 0.07017483, -0.43655942, 2.07124682, 0.39072843, 0.1139163, 0.22897339, 2.06398077, 1.07880945, -0.19356135, -0.00245439, 0.21489013, 2.47817577, 0.10006068, 0.02585234, 0.15646854, 0.06613783, -0.38883083, 0.08357023, -0.06615162, -0.44600362, -0.38214517, -0.14815454, 0.01984833, 0.05990736, -0.47456113, 0.93816774, -0.59785345, -0.09637677, -0.49659337, 0.5418502, 0.84400845, 0.33090672, -0.41695291, -0.05445189, 0.78316076, -0.06257269, 0.52211548, 1.00193246, -2.4635729, 1.47726944, -0.3011682, -2.46602005, -0.10297709, -0.40169155, -0.88465581, 3.63111632, 1.11632943, 1.1265963, -0.13834992, -1.13904361, 0.88367592, 0.01713461, 0.79096455, -0.53839698, -3.8438593, -0.63254875, 0.2209145, 0.79499508, -0.49467358, -2.1234711, 0.31618373, -0.14861714, -1.67301482, -0.0430027, -0.03973439, -0.81625803, -0.31088222, 0.0503036, -0.51296021, 1.69240569, -0.21593775, 0.19022818, 0.1562194, 1.28111027, -0.2006924, 0.47281203, 0.14976824, 0.54234227, 0.16115976, 0.43709008, -0.68955746, 1.30919846, -0.06849192, -0.12745657, 0.14896356, 0.33840539, 0.42213877, 0.27768615, -0.89369225, 0.32876205, -0.94998583, -0.53786447, -0.56487816, -0.46177294, -1.08575532, -0.90788282, -0.58033364, -1.76228832, -0.77946578, 0.44743783, -0.42711793, -0.3069655, -0.9566285, -0.35333777, 0.24157408, -0.00169409, -0.36198144, -0.4627298, 0.6208236, 0.32532496, -0.48100807, 0.54999197, 2.89675842, -0.99075047, -0.46385789, 0.02357837, -0.61648305, -0.24394852, -0.68776736, 0.45973213, 0.04803183, 0.08147616, -0.44014468, -0.78568717, -0.40114569, -0.60982667, 0.12393029, 0.84176092, -1.03225214, -0.21904517, 0.11598549, 1.60438538, 0.59304788, -0.03945008, 0.0638448, 0.42544023, 1.79528776, 0.93874719, 0.01591335, -0.0820694, 1.14837002, 1.41947168, -0.26666462, -0.20724218, 0.64483762, -0.29063514, 0.01062903, -0.49902738, -0.92800397, 0.15962131, -0.0369205, -0.24601863, -0.84185485, 0.00241492, -0.98228396, -2.77105081, 0.25487039, -0.34419557, 0.27218269, 1.10593801, 0.2751315, 0.35608456, 0.39856254, -0.12743373, -0.34257429, 0.09077456, -0.94626722, 1.60412025, 1.45214365, 0.63320399, -0.08618569, -0.56156225, 0.42024177, 1.18662471, 1.79775834, 0.14570018, 0.30572068, 0.48136718, -0.21028086, 0.2519183, -0.29526641, 0.63023283, 0.70474289, 0.18073645, 0.01713545, -0.02686142, 0.24467893, 0.6560063, 0.45540367, -0.05006056, 0.21543358, 0.38948099, 0.08828946, 0.46294624, 0.23996366, -0.08823862, 0.33817829, 0.3976901, -2.72802476, 0.0068949, -0.27794135, 0.45142053, 0.58466634, -0.28088127, 0.30351011, 0.146066, 0.20509973, -0.1769003, 0.12591536, -0.33116034, 0.26158276, 0.18089159, -1.815569, -0.10876111, -0.27299534, 0.1564564, -0.56617963, 0.82010933, 0.19543072, 0.19663253, -0.29710614, -0.69630058, -0.05687886, -0.92855694, -0.19750134, -0.02739075, -0.24973589, -0.06220542, -0.4750565, -0.07086285, -0.19416382, -0.22141262, 0.7945132, 0.1481213, 0.73522059, 0.42546783, 0.210102, 0.47486147, 0.56083563, 0.11428976, -1.62750928, -0.04695249, -0.68164379, 0.10721919, 1.38023401, 1.19326509, 0.51961765, 0.4248779, 0.47770273, 1.23172101, -0.02078277, 0.44493876, 1.15651255, -1.45824392, 0.03453537, 0.22962453, 0.75718512, 0.33438966, 0.14504503, -0.40848526, 0.34710397, -1.62026372, 0.23600815, 0.15544018, 0.40816362, 0.54396385, -0.22570969, 0.19379232, -0.30378815, -0.11873641, -0.03531658, -0.11296825, 0.08629851, -0.59913098, 0.1388571, -0.60201648, -0.01310579, -0.22245659, 0.31517463, 0.31252883, 0.43893411, 0.79391082, -0.23804095, -0.96502886, -1.78322012, 0.72699413, 0.26973056, -0.37204634, 0.13524862, 0.16264076, 0.40411689, -0.42583001, -0.59603223, -0.5351199, -0.04681252, -0.93068803, -1.84717096, 0.76784495, 0.4292352, -0.03229981, -0.19735882, -0.25662815, 1.09472733, -0.19671989, -2.38051393, -0.34018065, -0.79945229, -0.54088839, 1.02844975, -0.85753644, 0.40767118, -0.21903651, -0.75286196, -0.51832948, -0.21397817, 0.35579157, 0.48666188, -0.08600408, 0.6800381, 0.29537087, 0.10178861, -0.21969043, -0.2535218, 0.26513312, 0.72841581, -0.33590025, 1.78836899, -0.31406448, 1.36588304, 0.37380913, 0.14716618, -0.80771755, 0.67789402, -0.08274023, -1.14932884, 1.13671903, -0.2508064, 1.03048668, -1.20648331, 0.4354311, -0.18429172, 0.36781426, -0.10745065, -1.48693973, 0.73506596, 0.17914616, -1.10861116, 1.11730461, 0.12089034, -0.23022552, -0.04197887, -1.28095261, 1.70020034, -0.10919253, 0.67415265, -0.20073798, -0.31987314, 0.37086582, -0.62051046, -0.93989693, -0.2894304, 0.18743281, 0.13988605, -0.02900841, 0.27442256, 0.18817036, 0.44266005, 0.50978663, -0.1113706, 1.63065048, -1.7794332, -0.31755634, 0.09149346, -0.46010379, 1.46413991, -0.24923504, 0.44701008, 0.09635991, 0.58698104, -0.53907032, 1.24045955, -0.10591311, 1.00801789, -0.22661149, 1.28446669, -2.8095573, 1.17680675, -0.06701236, -0.01990484, -0.51560264, -1.14516203, -0.23764702, 0.81047644, 1.79982418, 1.19716403, 0.16623353, 0.35066638, 1.10690571, 0.98648507, -0.9968568, -0.00612548, 0.19600697, 0.17386572, -0.66936196, 0.16435581, 0.46417075, -0.23163808, 0.08849883, 0.37779653, 0.2921898, -0.14028622, 0.32142587, -2.06041542, -1.09561448, -0.04968134, 0.34530372, -0.44565326, 0.11759497, -0.95701023, 0.05189071, -0.43232802, 0.96330441, -0.71786567, -0.23226502, -1.08902189, 0.35000344, 0.00936262, 0.29995859, -1.13913389, -0.42963059, 0.53860205, 0.66050068, -1.56572283, 0.2368823, 0.27883436, -0.07449156, -0.01935263, -1.61315198, -0.24264134, 0.12093699, -0.04601659, -0.69183312, -1.2029798, -0.26144411, 0.09437148, -0.03456878, 0.45136178, -0.83172562, 0.36505256, -0.10972521, -0.4936375, -0.12591957, -0.30848856, 0.14179548, -0.52202029, -0.34149257, -11.44233145, 0.21743096, -0.06073572, 0.10010776, 1.10199669, 0.28717459, 0.06949337, 0.23600876, 0.47602561, -0.32925783, -0.0016577, 1.27153257, 1.32392172, 0.11550364, -0.32289366, -1.1922201, -0.2709502, 0.1080917, 0.46015201, 0.88130263, -0.86302285, -0.20809276, 0.77834935, -0.58328786, 0.33132333, -0.83337201, 0.04437454, 0.65973918, -0.02983118, 0.57055484, -0.01308596, -0.39364507, 0.80760088, 0.14232149, -0.39719289, -0.02643312, -0.34085203, -0.16401716, 0.03327453, -1.02408205, 0.54551109, 0.17450207, -0.64479388, 1.30813425, -0.30510551, -1.09374132, -1.27060897, -0.03530879, -0.39200235, -0.79347232, -1.34533568, 0.63094185, -1.27625243, 0.04758732, 1.74847994, -1.8317252, -1.32967512, 0.15067975, 3.07330619, -1.03382097, -0.2417216, 0.09428424, 0.93683506, -0.11407725, 0.03155272, 0.18271949, -0.62009912, -0.71446058, -0.13345956, 0.24530664, 0.47118164, -0.53844005, -0.09995274, -0.54718436, -0.18947263, 0.36362266, -0.09746967, 0.56297139, 0.95566598, 0.98109626, 0.36730153, 0.1223493, 1.03933386, -0.07573748, 0.0974063, -0.82272998, -3.3434064, -0.69488298, 0.12337046, -0.26254483, -0.11935374, 0.56196698, 0.32012027, -0.25802748, -0.46687177, -0.18041931, 0.24454685, 0.301645, -2.45143869, -0.00681073, -0.33728652, -0.28102715, 0.27258895, -0.53504559, -0.24737824, 0.56898945, 0.59232843, 0.94171739, -0.3464817, 0.1573015, 0.71980677, -0.47262825, 0.34545721, -0.09408882, 0.39931424, 0.34844177, -0.05739015, 0.40740549, 0.26136298, 1.12446804, -0.08651147, 0.20382725, 0.65606577, -0.10565869, -0.00253925, 0.41868805, -0.80448133, 0.16362807, 0.75552517, -2.72022837, -1.28437338, 0.19215537, -0.34104523, 0.97708778, -0.10493557, -0.45867167, 0.23274852, -0.47934946, -0.41275191, -1.15299783, 2.7221585, 1.19192999, -0.29265869, -0.24976708, -0.78523194, -0.52973708, 0.02547175, -0.56988914, 0.29043001, -1.97265521, -0.5843083, -0.30737171, -0.49131435, 0.55398667, -1.62760353, -0.64356462, -0.21687425, -0.94507082, -0.31807524, -0.21478074, -0.20855819, -0.33365496, 0.38204097, -0.80013858, -0.82297974, 0.05258077, -0.31870118, -0.25110974, -0.50211974, 0.29698319, 0.04581618, 2.41558834, 0.09596117, 0.56715426, 1.90984353, -1.18092071, 1.27172204, -0.22243659, -0.20357627, 0.35116691, 0.85339517, -0.30202846, -1.16119985, 1.8293847, 1.85268541, -0.29313823, 0.5392384, 1.5102688, -0.46452768, 0.08787849, 0.9728476, 2.44164243, 2.68063574, -1.30264046, -0.16233608, 1.18751724, 2.7872606, 0.69834599, -0.34720624, -0.45259697, 1.50555043, 2.35057583, 0.17289977, -0.62186635, -0.12100033, -0.45087125, 0.45620133, 0.5546763, 0.76706356, 0.40146435, 0.20418496, 0.27163724, -0.00184938, 0.27317098, -1.8143833, -1.49807462, 0.2973864, 0.49411261, -0.32380854, -1.49689409, -0.18529611, -0.26512734, 0.14091963, -2.22418345, 0.42121402, -0.11520493, 0.17393191, 1.55169366, 0.93310092, -0.1923104, -0.10200088, -1.23576217, 0.54293279, -0.65611634, 1.44167301, -6.12170038, -0.43654819, 0.48868381, 0.06097207, 2.20517109, -0.9439845, -0.59449794, 0.07717987, -2.29667323, 0.87196156, -0.69415557, 0.27519304, 0.38792836, 0.83695642, -0.19630959, 0.3574806, -1.30304218, 0.02589824, -0.06161191, 0.38803615, 0.50950035, -0.00305887, 1.96660702, 0.74423141, -0.50337323, -1.14168687, -0.35467361, -0.99863412, -0.1408182, -0.45203795, 0.67413641, 0.91255984, 0.12468415, -1.11853351, 0.12870135, -1.25552306, 0.76404657, 2.30039335, -0.21573798, -0.04531546, 0.29982952, 0.58676628, 1.60869622, 0.39983816, 0.10677758, 1.03271956, 1.66590484, 0.75121973, 0.0002115, 0.82925399, -0.04006286, -1.13720009, 0.65797377, -1.15547489, -0.26313096, -0.01387821, -0.30231485, -0.07652224, -0.05477199, -0.32745688, 0.20159912, 0.00885946, -0.28584158, -2.08377599, 0.47155331, -0.30365669, 1.44081169, -0.03047458, -0.74700213, -0.62909711, 0.47266167, -1.10285844, -0.05196693, 0.03678704, 0.58297878, 0.08457563, 0.12513379, 1.57131672, 0.53310932, -0.13498084, 0.00067699, 1.13828326, 0.43464785, -0.82219928, 0.01966246, -1.90722651, 1.68734658, -0.2759657, 0.42721997, -1.82997624, -2.01008725, -0.31674878, -0.0038825, -0.01217038, -2.08008473, 0.06012928, 0.6788653, 0.31542592, 0.65656559, 0.00001411]);
  const b1 = new Float64Array([-0.15907511, -0.1929051, 0.10945751, -0.21092067, 0.04034448, -0.30029714, -0.20900182, -0.10178228, -0.20780551, 0.10209124, 0.18191291, 0.12001367, 0.070962, -0.17468521, 0.13430898, 0.20659673, -0.40249072, 0.01675714, 0.28446659, -0.16478239, -0.22467173, 0.28978399, 0.10560347, 0.26652285]);
  const W2 = new Float64Array([-1.06636007, -0.9190176, -0.9880083, -0.35530867, -0.08899307, -1.69870637, 0.01220959, 0.09350449, -1.1651912, 0.13830163, -0.14143865, 0.1817375, 0.34855759, 0.46334024, -0.54418244, 0.28463261, 1.09606241, 0.03632454, 1.68348322, 1.4883562, 0.04363201, 1.31636666, -0.68501627, 0.03175811, 0.36471258, 0.66178477, 1.18589667, 0.80571672, 0.1888786, -0.11836566, 0.09893024, 0.06179218, 0.71066674, -0.36287968, -0.1064925, -0.40859712, -0.4215175, -0.58632844, -0.68420745, -0.55557224, 0.55006761, 0.21302886, -0.39896691, 0.03294153, 0.08188296, -0.66677837, -0.47631594, 0.1283534, 0.03231145, 0.51188022, 0.03458735, -0.37872805, 0.99093232, -0.09349266, 0.48906059, 0.07385758, 0.56976018, -0.09113388, -0.46888558, -0.39745289, -0.05222727, -1.01176235, -0.10587054, -0.37683798, 0.87894271, 1.09608087, 0.11028256, 0.28244313, -0.78961705, -0.19327519, 0.41660429, 0.64677505, -0.57763378, -0.14187799, 0.31931852, -0.17893321, -0.1052134, -0.26276642, 0.22673011, -0.29032388, -0.15508991, 0.32140468, -0.62552615, -0.12244431, 0.4430931, 0.28272648, -0.33711309, 0.77692119, 1.3327882, -0.32980567, 0.09392896, -0.36823786, 0.57180358, -0.33167606, -0.30915636, -0.0301393, 1.5204984, 0.50403415, 0.91787832, -0.71484875, 0.09642167, 0.83226803, 0.0377348, 0.41422052, 1.45311684, -0.59202403, -0.9823554, -0.1361235, 0.50204823, 0.08987324, 0.34131219, -0.49477002, -1.83099733, 0.39757269, 0.22414437, 0.22020696, -0.93904678, 1.57251293, 0.02618352, -0.8243548, -0.09878735, -0.28404156, 0.09511452, -0.03864435, -0.06619242, -0.32489413, 0.18103445, -0.67042187, 0.06641501, 0.49091602, 1.15105489, -0.03124252, 0.29284833, -0.07068988, 0.18520357, 0.05663937, 0.117698, -0.0797537, -0.33787976, -0.04743768, -0.39996365, -0.46597293, -0.02634516, -0.0964922, 0.37484397, 0.41337386, -0.5388731, 0.05072256, -0.01660806, -0.34263423, 0.39648123, 0.49761053, 0.21517297, -0.17741354, 0.2828262, -0.90036219, 0.15542189, -0.54295006, 0.03839443, -0.24938647, -0.19099852, -0.24707483, 0.4310102, 0.1716582, -0.21609417, -0.47396357, 0.64833543, 0.13416627, 0.51955328, 0.32756169, 1.44459655, 0.45706039, -0.18778061, 0.42820058, 0.61110126, -1.3664041, 0.60192903, -1.07354476, -0.44862069, -0.05646726, -1.3273419, 0.87264658, 0.18648687, 0.4046214, -0.83832859, 0.55344986, 0.43776764, -1.25358137, -1.02852542, -0.38953627, -0.1098615, -0.06735816, 0.13221443, -0.05011555, 0.23659837, 1.06796277, 0.23111975, 0.16534329, -1.73893576, 0.42179463, 0.43795234, -0.74172042, -0.58225356, 0.82913229, -0.0061605, 0.14352363, 0.68626179, -0.47791533, -1.18425093, -0.86687171, 0.13670141, 1.3497123, 0.1870161, -0.15197923, -0.14197344, -1.48606292, 0.759968, -0.78261921, 0.86541666, 0.49401549, -1.00070819, -0.87567447, 0.47184199, 0.05707999, 0.28663265, 0.57849863, 0.45998443, 0.57073688, 0.62550341, -0.59592951, 0.30839136, 1.16268514, 0.46135021, -0.16642006, 0.9698602, 1.01061643, -0.60635468, -0.12549207, -0.04484992, -0.79689827, -0.09897471, -0.64850121, 0.70027939, 0.33297784, -1.04378598, -0.28438728, -0.3963471, -0.0030868, -1.10497942, -0.38022961, 0.09077478, 0.32667395, 0.59005625, 1.03490529, 0.35289898, 0.07765075, -0.50261793, -1.06121045, -0.00453313, -0.38053407, 1.35021785, -0.28493185, -0.09606505, -0.67572982, -0.13474524, -0.12426026, -0.07336407, 0.88524838, -0.00078716, 0.81413289, -1.030188, 0.04768998, -0.19906243, -0.58877772, -0.58348167, 0.25562227, -0.46262391, 0.29961826, -0.16890995, -0.07276982, 0.0386313, -1.22748869, 0.27623303, 0.52627614, -0.06246282, 0.57380885, -1.16333763, -1.00636065, 0.78842963, 0.66658387, 0.0864282, -1.35076353, 0.34379365, -0.03387986, -0.02327315, 0.55144792, 1.25927518, -1.18115354, -0.2735233, -0.2034306, 0.70141231, 0.02625898, 0.43513017, -0.42636147, -1.36533786, 0.25487186, 0.58849371, 0.17550897, -0.61778176, 1.52055962, 0.34922819, -0.90630038, -1.3268624, -0.2776963, -0.53731126, 0.03874003, 1.8093392, 0.17853993, -0.03630116, 0.45842332, 1.09878117, -0.39164164, -0.61933352, 0.20103481, -0.24118892, -0.00344222, 0.04404278, -0.70625417, -3.06268001, 0.39331597, -0.77555831, -0.42094925, -0.12266971, 0.24322597, 0.20764888, 0.13823716, -0.4869097, 0.05074555, -0.05776163, 1.34533581, -0.53936717, 1.77920668, -1.21569102, -0.69992965, 0.9377622, -0.01419624, -0.72646094, -0.22733931, -0.00897031, 0.44336358, -0.72956401, 0.25746792, -0.06084525, 0.13093694, -0.48404722, -0.83407745, 0.11298876, -0.7265127, 1.07638829, 0.05064864, -1.11875352, -0.76518293, 0.22344272, 0.1992795, -0.02284234, 0.03587222, -0.16635103, -0.2079402, 0.99594145, -0.71155991, -0.3595612, 0.67544504, -0.02880367, -0.30229637, 1.09523003, 0.80242019, -1.99040455, 0.11941035, -0.93049676, -1.0701498, -1.27559322, 0.29859456, -0.42368542, 0.21916323]);
  const b2 = new Float64Array([0.42401962, -0.15526196, -0.20935103, 0.37684314, -0.3962977, -0.14583154, -0.2090909, -0.12138925, -0.0466035, 0.11940856, 0.2488065, 0.08022293, -0.1910896, -0.10880616, 0.09888873, 0.39354428]);
  const W3 = new Float64Array([1.26124454, -0.65319858, -0.17077544, 0.11036791, -0.61442015, 0.24028936, -0.22961459, -1.09522736, 0.62007109, -0.93996106, -0.01092359, 0.76652377, -0.46148229, -0.3793807, 0.82534505, 0.19656298, 0.00001615, -0.00131499, 0.06900849, 0.0003891, -0.00014329, 0.00120203, 0.01659016, 0.00087973, 0.00057459, -0.00048635, 0.05999357, 0.00138296, 0.00007018, 0.00070735, 0.00007993, 0.00071559, 0.0012782, -0.00064121, 0.28044171, -0.00194282, -0.0005933, 0.0013636, -0.03993883, 0.00146348, 0.00054601, -0.00111742, 0.26163712, 0.00302233, -0.00004194, 0.00097757, -0.00039643, -0.00003672, 0.00067284, -0.00047046, 0.17866526, -0.00112832, -0.00024521, 0.00113972, -0.02224619, 0.00089898, 0.00037566, -0.0007047, 0.16630316, 0.00189986, 0.00008513, 0.00052058, -0.00022396, -0.00010026, -0.02493241, -0.05365352, -0.67760733, 0.6432918, -0.1426055, -1.04640718, -0.65120678, -0.02487318, -0.03472516, 0.19076929, 1.05013304, 0.28704301, 0.10847837, -1.81147378, 0.047731, -0.92739122]);
  const b3 = new Float64Array([0.04979021, 0.02188968, -0.02374768, -0.01209304, 0.27876574]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.41431055, 0.1338646, 0.55125613, -0.06895575, -0.06835756, 0.05331997, 0.06857526, -0.14395597, 1.21813192, -5.12542594, 0.31925965, 0.07665982, 0.38424277, 0.14916191, -0.36962622, -0.44703312, 0.16872953, -0.0854955, -0.03949504, -0.66054972, -1.9185536, -1.11083333, 0.30913522, 0.3730612, 2.97253396, 0.6472466, 0.20059331, 0.42651631, 0.94783723, -0.517167, 0.26846972, 0.41084199, -1.52272934, 2.3738246, 1.21123546, 0.14337352, 0.15023066, -1.04911612, 1.00836258, -0.21475508, -0.03610315, 0.62343677, -0.49988797, -0.93496687, -0.12984244, -0.84099928, -0.21567879, -0.43947192, -1.23279242, 0.05282233, -0.25328222, 0.80116723, 0.64037293, -0.39225099, 0.30158138, -0.94047182, 0.03355886, -0.00047208, -0.10423673, -0.25502409, 0.65850808, 0.65766512, -0.27156693, -0.29301184, -0.29960504, -0.63245265, 0.74327879, 0.85258121, 1.17816536, -0.6805901, 0.24750862, 0.83212748, 0.56825779, 0.17784877, -0.36086999, 0.33168088, 0.51650557, 0.76206268, -0.052468, -0.01018024, 1.03601023, -0.09345558, 0.51415384, -0.56865428, -0.07378277, -0.10224367, 0.11243758, 0.35146254, -0.10536201, -0.00165517, 0.27272122, 0.10284289, -0.53502643, 0.21751092, -0.15990307, -1.029625, -0.41324882, 0.50601471, 0.10125505, -0.24225844, 0.22948454, 0.18013721, 0.65515115, -0.62939425, -0.56162344, 0.21342572, 0.94726643, -0.72814546, 0.79665017, 0.03708925, -0.18671571, -0.44393631, -0.24495466, -0.17335064, 3.32287773, 2.91461075, 0.62810635, -0.87469265, 3.05703989, 0.44548581, 0.35591438, 0.55084036, 0.24098162, 3.95039206, 0.54725333, 0.24625632, 0.5983237, 0.0881038, 0.95223547, -0.04220454, 0.32035429, 0.74974993, 0.02975341, -0.14233331, 0.64226266, 0.33667054, -0.32672714, 0.55420472, 0.41442452, -0.1652329, 0.36496469, 0.20613541, -0.60575785, 0.67512675, 0.18668144, -0.72989976, -0.59984573, -0.59043776, -0.49517479, -1.20559055, -2.2714996, 0.27452443, -0.69693279, 1.98451562, -1.66181581, 0.0061461, -0.46487493, -3.48266625, 1.95537972, 0.3823426, 0.61422536, 2.19144452, -1.84727928, -0.36967461, -0.31658236, 0.25652157, 3.90092146, -0.17632282, -0.22007593, 0.26951451, 0.45315514, 1.38427063, 0.00617474, 0.22349211, 0.28629142, 0.05830829, -0.08883917, 0.1481828, 0.20163197, -0.35244654, 0.93190337, 3.46794025, 0.01780869, -0.83142438, 0.06719809, -0.7512425, 0.18028516, -0.28772844, 0.55574899, 0.60403409, -0.31096245, 0.25065075, 1.55879722, -0.02253252, -0.083896, -1.01095283, 0.15442946, 0.8934827, 0.2843392, -1.31087744, 0.31578311, -0.12239319, -0.60576064, 0.77119534, -0.96230708, 0.15817031, 0.55971357, -0.01068014, 0.61411007, -0.84778617, 0.08014234, 0.86540469, -0.06253241, 0.32157832, -1.97632652, 0.31647146, 0.26098276, -1.1463497, -0.4525229, -0.50075443, -0.52522839, -0.13478346, -0.01816299, 0.49159591, 2.12631374, 1.69492559, 0.0043757, 0.15482931, 1.5403557, 0.94202833, -0.55742933, 0.23036741, 0.28619115, 1.22849986, -1.0595339, -0.49866533, 0.98238437, 0.71277788, 0.74771426, -1.54932901, -0.42897939, 0.07017483, -0.43655942, 2.07124682, 0.39072843, 0.1139163, 0.22897339, 2.06398077, 1.07880945, -0.19356135, -0.00245439, 0.21489013, 2.47817577, 0.10006068, 0.02585234, 0.15646854, 0.06613783, -0.38883083, 0.08357023, -0.06615162, -0.44600362, -0.38214517, -0.14815454, 0.01984833, 0.05990736, -0.47456113, 0.93816774, -0.59785345, -0.09637677, -0.49659337, 0.5418502, 0.84400845, 0.33090672, -0.41695291, -0.05445189, 0.78316076, -0.06257269, 0.52211548, 1.00193246, -2.4635729, 1.47726944, -0.3011682, -2.46602005, -0.10297709, -0.40169155, -0.88465581, 3.63111632, 1.11632943, 1.1265963, -0.13834992, -1.13904361, 0.88367592, 0.01713461, 0.79096455, -0.53839698, -3.8438593, -0.63254875, 0.2209145, 0.79499508, -0.49467358, -2.1234711, 0.31618373, -0.14861714, -1.67301482, -0.0430027, -0.03973439, -0.81625803, -0.31088222, 0.0503036, -0.51296021, 1.69240569, -0.21593775, 0.19022818, 0.1562194, 1.28111027, -0.2006924, 0.47281203, 0.14976824, 0.54234227, 0.16115976, 0.43709008, -0.68955746, 1.30919846, -0.06849192, -0.12745657, 0.14896356, 0.33840539, 0.42213877, 0.27768615, -0.89369225, 0.32876205, -0.94998583, -0.53786447, -0.56487816, -0.46177294, -1.08575532, -0.90788282, -0.58033364, -1.76228832, -0.77946578, 0.44743783, -0.42711793, -0.3069655, -0.9566285, -0.35333777, 0.24157408, -0.00169409, -0.36198144, -0.4627298, 0.6208236, 0.32532496, -0.48100807, 0.54999197, 2.89675842, -0.99075047, -0.46385789, 0.02357837, -0.61648305, -0.24394852, -0.68776736, 0.45973213, 0.04803183, 0.08147616, -0.44014468, -0.78568717, -0.40114569, -0.60982667, 0.12393029, 0.84176092, -1.03225214, -0.21904517, 0.11598549, 1.60438538, 0.59304788, -0.03945008, 0.0638448, 0.42544023, 1.79528776, 0.93874719, 0.01591335, -0.0820694, 1.14837002, 1.41947168, -0.26666462, -0.20724218, 0.64483762, -0.29063514, 0.01062903, -0.49902738, -0.92800397, 0.15962131, -0.0369205, -0.24601863, -0.84185485, 0.00241492, -0.98228396, -2.77105081, 0.25487039, -0.34419557, 0.27218269, 1.10593801, 0.2751315, 0.35608456, 0.39856254, -0.12743373, -0.34257429, 0.09077456, -0.94626722, 1.60412025, 1.45214365, 0.63320399, -0.08618569, -0.56156225, 0.42024177, 1.18662471, 1.79775834, 0.14570018, 0.30572068, 0.48136718, -0.21028086, 0.2519183, -0.29526641, 0.63023283, 0.70474289, 0.18073645, 0.01713545, -0.02686142, 0.24467893, 0.6560063, 0.45540367, -0.05006056, 0.21543358, 0.38948099, 0.08828946, 0.46294624, 0.23996366, -0.08823862, 0.33817829, 0.3976901, -2.72802476, 0.0068949, -0.27794135, 0.45142053, 0.58466634, -0.28088127, 0.30351011, 0.146066, 0.20509973, -0.1769003, 0.12591536, -0.33116034, 0.26158276, 0.18089159, -1.815569, -0.10876111, -0.27299534, 0.1564564, -0.56617963, 0.82010933, 0.19543072, 0.19663253, -0.29710614, -0.69630058, -0.05687886, -0.92855694, -0.19750134, -0.02739075, -0.24973589, -0.06220542, -0.4750565, -0.07086285, -0.19416382, -0.22141262, 0.7945132, 0.1481213, 0.73522059, 0.42546783, 0.210102, 0.47486147, 0.56083563, 0.11428976, -1.62750928, -0.04695249, -0.68164379, 0.10721919, 1.38023401, 1.19326509, 0.51961765, 0.4248779, 0.47770273, 1.23172101, -0.02078277, 0.44493876, 1.15651255, -1.45824392, 0.03453537, 0.22962453, 0.75718512, 0.33438966, 0.14504503, -0.40848526, 0.34710397, -1.62026372, 0.23600815, 0.15544018, 0.40816362, 0.54396385, -0.22570969, 0.19379232, -0.30378815, -0.11873641, -0.03531658, -0.11296825, 0.08629851, -0.59913098, 0.1388571, -0.60201648, -0.01310579, -0.22245659, 0.31517463, 0.31252883, 0.43893411, 0.79391082, -0.23804095, -0.96502886, -1.78322012, 0.72699413, 0.26973056, -0.37204634, 0.13524862, 0.16264076, 0.40411689, -0.42583001, -0.59603223, -0.5351199, -0.04681252, -0.93068803, -1.84717096, 0.76784495, 0.4292352, -0.03229981, -0.19735882, -0.25662815, 1.09472733, -0.19671989, -2.38051393, -0.34018065, -0.79945229, -0.54088839, 1.02844975, -0.85753644, 0.40767118, -0.21903651, -0.75286196, -0.51832948, -0.21397817, 0.35579157, 0.48666188, -0.08600408, 0.6800381, 0.29537087, 0.10178861, -0.21969043, -0.2535218, 0.26513312, 0.72841581, -0.33590025, 1.78836899, -0.31406448, 1.36588304, 0.37380913, 0.14716618, -0.80771755, 0.67789402, -0.08274023, -1.14932884, 1.13671903, -0.2508064, 1.03048668, -1.20648331, 0.4354311, -0.18429172, 0.36781426, -0.10745065, -1.48693973, 0.73506596, 0.17914616, -1.10861116, 1.11730461, 0.12089034, -0.23022552, -0.04197887, -1.28095261, 1.70020034, -0.10919253, 0.67415265, -0.20073798, -0.31987314, 0.37086582, -0.62051046, -0.93989693, -0.2894304, 0.18743281, 0.13988605, -0.02900841, 0.27442256, 0.18817036, 0.44266005, 0.50978663, -0.1113706, 1.63065048, -1.7794332, -0.31755634, 0.09149346, -0.46010379, 1.46413991, -0.24923504, 0.44701008, 0.09635991, 0.58698104, -0.53907032, 1.24045955, -0.10591311, 1.00801789, -0.22661149, 1.28446669, -2.8095573, 1.17680675, -0.06701236, -0.01990484, -0.51560264, -1.14516203, -0.23764702, 0.81047644, 1.79982418, 1.19716403, 0.16623353, 0.35066638, 1.10690571, 0.98648507, -0.9968568, -0.00612548, 0.19600697, 0.17386572, -0.66936196, 0.16435581, 0.46417075, -0.23163808, 0.08849883, 0.37779653, 0.2921898, -0.14028622, 0.32142587, -2.06041542, -1.09561448, -0.04968134, 0.34530372, -0.44565326, 0.11759497, -0.95701023, 0.05189071, -0.43232802, 0.96330441, -0.71786567, -0.23226502, -1.08902189, 0.35000344, 0.00936262, 0.29995859, -1.13913389, -0.42963059, 0.53860205, 0.66050068, -1.56572283, 0.2368823, 0.27883436, -0.07449156, -0.01935263, -1.61315198, -0.24264134, 0.12093699, -0.04601659, -0.69183312, -1.2029798, -0.26144411, 0.09437148, -0.03456878, 0.45136178, -0.83172562, 0.36505256, -0.10972521, -0.4936375, -0.12591957, -0.30848856, 0.14179548, -0.52202029, -0.34149257, -11.44233145, 0.21743096, -0.06073572, 0.10010776, 1.10199669, 0.28717459, 0.06949337, 0.23600876, 0.47602561, -0.32925783, -0.0016577, 1.27153257, 1.32392172, 0.11550364, -0.32289366, -1.1922201, -0.2709502, 0.1080917, 0.46015201, 0.88130263, -0.86302285, -0.20809276, 0.77834935, -0.58328786, 0.33132333, -0.83337201, 0.04437454, 0.65973918, -0.02983118, 0.57055484, -0.01308596, -0.39364507, 0.80760088, 0.14232149, -0.39719289, -0.02643312, -0.34085203, -0.16401716, 0.03327453, -1.02408205, 0.54551109, 0.17450207, -0.64479388, 1.30813425, -0.30510551, -1.09374132, -1.27060897, -0.03530879, -0.39200235, -0.79347232, -1.34533568, 0.63094185, -1.27625243, 0.04758732, 1.74847994, -1.8317252, -1.32967512, 0.15067975, 3.07330619, -1.03382097, -0.2417216, 0.09428424, 0.93683506, -0.11407725, 0.03155272, 0.18271949, -0.62009912, -0.71446058, -0.13345956, 0.24530664, 0.47118164, -0.53844005, -0.09995274, -0.54718436, -0.18947263, 0.36362266, -0.09746967, 0.56297139, 0.95566598, 0.98109626, 0.36730153, 0.1223493, 1.03933386, -0.07573748, 0.0974063, -0.82272998, -3.3434064, -0.69488298, 0.12337046, -0.26254483, -0.11935374, 0.56196698, 0.32012027, -0.25802748, -0.46687177, -0.18041931, 0.24454685, 0.301645, -2.45143869, -0.00681073, -0.33728652, -0.28102715, 0.27258895, -0.53504559, -0.24737824, 0.56898945, 0.59232843, 0.94171739, -0.3464817, 0.1573015, 0.71980677, -0.47262825, 0.34545721, -0.09408882, 0.39931424, 0.34844177, -0.05739015, 0.40740549, 0.26136298, 1.12446804, -0.08651147, 0.20382725, 0.65606577, -0.10565869, -0.00253925, 0.41868805, -0.80448133, 0.16362807, 0.75552517, -2.72022837, -1.28437338, 0.19215537, -0.34104523, 0.97708778, -0.10493557, -0.45867167, 0.23274852, -0.47934946, -0.41275191, -1.15299783, 2.7221585, 1.19192999, -0.29265869, -0.24976708, -0.78523194, -0.52973708, 0.02547175, -0.56988914, 0.29043001, -1.97265521, -0.5843083, -0.30737171, -0.49131435, 0.55398667, -1.62760353, -0.64356462, -0.21687425, -0.94507082, -0.31807524, -0.21478074, -0.20855819, -0.33365496, 0.38204097, -0.80013858, -0.82297974, 0.05258077, -0.31870118, -0.25110974, -0.50211974, 0.29698319, 0.04581618, 2.41558834, 0.09596117, 0.56715426, 1.90984353, -1.18092071, 1.27172204, -0.22243659, -0.20357627, 0.35116691, 0.85339517, -0.30202846, -1.16119985, 1.8293847, 1.85268541, -0.29313823, 0.5392384, 1.5102688, -0.46452768, 0.08787849, 0.9728476, 2.44164243, 2.68063574, -1.30264046, -0.16233608, 1.18751724, 2.7872606, 0.69834599, -0.34720624, -0.45259697, 1.50555043, 2.35057583, 0.17289977, -0.62186635, -0.12100033, -0.45087125, 0.45620133, 0.5546763, 0.76706356, 0.40146435, 0.20418496, 0.27163724, -0.00184938, 0.27317098, -1.8143833, -1.49807462, 0.2973864, 0.49411261, -0.32380854, -1.49689409, -0.18529611, -0.26512734, 0.14091963, -2.22418345, 0.42121402, -0.11520493, 0.17393191, 1.55169366, 0.93310092, -0.1923104, -0.10200088, -1.23576217, 0.54293279, -0.65611634, 1.44167301, -6.12170038, -0.43654819, 0.48868381, 0.06097207, 2.20517109, -0.9439845, -0.59449794, 0.07717987, -2.29667323, 0.87196156, -0.69415557, 0.27519304, 0.38792836, 0.83695642, -0.19630959, 0.3574806, -1.30304218, 0.02589824, -0.06161191, 0.38803615, 0.50950035, -0.00305887, 1.96660702, 0.74423141, -0.50337323, -1.14168687, -0.35467361, -0.99863412, -0.1408182, -0.45203795, 0.67413641, 0.91255984, 0.12468415, -1.11853351, 0.12870135, -1.25552306, 0.76404657, 2.30039335, -0.21573798, -0.04531546, 0.29982952, 0.58676628, 1.60869622, 0.39983816, 0.10677758, 1.03271956, 1.66590484, 0.75121973, 0.0002115, 0.82925399, -0.04006286, -1.13720009, 0.65797377, -1.15547489, -0.26313096, -0.01387821, -0.30231485, -0.07652224, -0.05477199, -0.32745688, 0.20159912, 0.00885946, -0.28584158, -2.08377599, 0.47155331, -0.30365669, 1.44081169, -0.03047458, -0.74700213, -0.62909711, 0.47266167, -1.10285844, -0.05196693, 0.03678704, 0.58297878, 0.08457563, 0.12513379, 1.57131672, 0.53310932, -0.13498084, 0.00067699, 1.13828326, 0.43464785, -0.82219928, 0.01966246, -1.90722651, 1.68734658, -0.2759657, 0.42721997, -1.82997624, -2.01008725, -0.31674878, -0.0038825, -0.01217038, -2.08008473, 0.06012928, 0.6788653, 0.31542592, 0.65656559, 0.00001411]);
  const b1 = new Float64Array([-0.15907511, -0.1929051, 0.10945751, -0.21092067, 0.04034448, -0.30029714, -0.20900182, -0.10178228, -0.20780551, 0.10209124, 0.18191291, 0.12001367, 0.070962, -0.17468521, 0.13430898, 0.20659673, -0.40249072, 0.01675714, 0.28446659, -0.16478239, -0.22467173, 0.28978399, 0.10560347, 0.26652285]);
  const W2 = new Float64Array([-1.06636007, -0.9190176, -0.9880083, -0.35530867, -0.08899307, -1.69870637, 0.01220959, 0.09350449, -1.1651912, 0.13830163, -0.14143865, 0.1817375, 0.34855759, 0.46334024, -0.54418244, 0.28463261, 1.09606241, 0.03632454, 1.68348322, 1.4883562, 0.04363201, 1.31636666, -0.68501627, 0.03175811, 0.36471258, 0.66178477, 1.18589667, 0.80571672, 0.1888786, -0.11836566, 0.09893024, 0.06179218, 0.71066674, -0.36287968, -0.1064925, -0.40859712, -0.4215175, -0.58632844, -0.68420745, -0.55557224, 0.55006761, 0.21302886, -0.39896691, 0.03294153, 0.08188296, -0.66677837, -0.47631594, 0.1283534, 0.03231145, 0.51188022, 0.03458735, -0.37872805, 0.99093232, -0.09349266, 0.48906059, 0.07385758, 0.56976018, -0.09113388, -0.46888558, -0.39745289, -0.05222727, -1.01176235, -0.10587054, -0.37683798, 0.87894271, 1.09608087, 0.11028256, 0.28244313, -0.78961705, -0.19327519, 0.41660429, 0.64677505, -0.57763378, -0.14187799, 0.31931852, -0.17893321, -0.1052134, -0.26276642, 0.22673011, -0.29032388, -0.15508991, 0.32140468, -0.62552615, -0.12244431, 0.4430931, 0.28272648, -0.33711309, 0.77692119, 1.3327882, -0.32980567, 0.09392896, -0.36823786, 0.57180358, -0.33167606, -0.30915636, -0.0301393, 1.5204984, 0.50403415, 0.91787832, -0.71484875, 0.09642167, 0.83226803, 0.0377348, 0.41422052, 1.45311684, -0.59202403, -0.9823554, -0.1361235, 0.50204823, 0.08987324, 0.34131219, -0.49477002, -1.83099733, 0.39757269, 0.22414437, 0.22020696, -0.93904678, 1.57251293, 0.02618352, -0.8243548, -0.09878735, -0.28404156, 0.09511452, -0.03864435, -0.06619242, -0.32489413, 0.18103445, -0.67042187, 0.06641501, 0.49091602, 1.15105489, -0.03124252, 0.29284833, -0.07068988, 0.18520357, 0.05663937, 0.117698, -0.0797537, -0.33787976, -0.04743768, -0.39996365, -0.46597293, -0.02634516, -0.0964922, 0.37484397, 0.41337386, -0.5388731, 0.05072256, -0.01660806, -0.34263423, 0.39648123, 0.49761053, 0.21517297, -0.17741354, 0.2828262, -0.90036219, 0.15542189, -0.54295006, 0.03839443, -0.24938647, -0.19099852, -0.24707483, 0.4310102, 0.1716582, -0.21609417, -0.47396357, 0.64833543, 0.13416627, 0.51955328, 0.32756169, 1.44459655, 0.45706039, -0.18778061, 0.42820058, 0.61110126, -1.3664041, 0.60192903, -1.07354476, -0.44862069, -0.05646726, -1.3273419, 0.87264658, 0.18648687, 0.4046214, -0.83832859, 0.55344986, 0.43776764, -1.25358137, -1.02852542, -0.38953627, -0.1098615, -0.06735816, 0.13221443, -0.05011555, 0.23659837, 1.06796277, 0.23111975, 0.16534329, -1.73893576, 0.42179463, 0.43795234, -0.74172042, -0.58225356, 0.82913229, -0.0061605, 0.14352363, 0.68626179, -0.47791533, -1.18425093, -0.86687171, 0.13670141, 1.3497123, 0.1870161, -0.15197923, -0.14197344, -1.48606292, 0.759968, -0.78261921, 0.86541666, 0.49401549, -1.00070819, -0.87567447, 0.47184199, 0.05707999, 0.28663265, 0.57849863, 0.45998443, 0.57073688, 0.62550341, -0.59592951, 0.30839136, 1.16268514, 0.46135021, -0.16642006, 0.9698602, 1.01061643, -0.60635468, -0.12549207, -0.04484992, -0.79689827, -0.09897471, -0.64850121, 0.70027939, 0.33297784, -1.04378598, -0.28438728, -0.3963471, -0.0030868, -1.10497942, -0.38022961, 0.09077478, 0.32667395, 0.59005625, 1.03490529, 0.35289898, 0.07765075, -0.50261793, -1.06121045, -0.00453313, -0.38053407, 1.35021785, -0.28493185, -0.09606505, -0.67572982, -0.13474524, -0.12426026, -0.07336407, 0.88524838, -0.00078716, 0.81413289, -1.030188, 0.04768998, -0.19906243, -0.58877772, -0.58348167, 0.25562227, -0.46262391, 0.29961826, -0.16890995, -0.07276982, 0.0386313, -1.22748869, 0.27623303, 0.52627614, -0.06246282, 0.57380885, -1.16333763, -1.00636065, 0.78842963, 0.66658387, 0.0864282, -1.35076353, 0.34379365, -0.03387986, -0.02327315, 0.55144792, 1.25927518, -1.18115354, -0.2735233, -0.2034306, 0.70141231, 0.02625898, 0.43513017, -0.42636147, -1.36533786, 0.25487186, 0.58849371, 0.17550897, -0.61778176, 1.52055962, 0.34922819, -0.90630038, -1.3268624, -0.2776963, -0.53731126, 0.03874003, 1.8093392, 0.17853993, -0.03630116, 0.45842332, 1.09878117, -0.39164164, -0.61933352, 0.20103481, -0.24118892, -0.00344222, 0.04404278, -0.70625417, -3.06268001, 0.39331597, -0.77555831, -0.42094925, -0.12266971, 0.24322597, 0.20764888, 0.13823716, -0.4869097, 0.05074555, -0.05776163, 1.34533581, -0.53936717, 1.77920668, -1.21569102, -0.69992965, 0.9377622, -0.01419624, -0.72646094, -0.22733931, -0.00897031, 0.44336358, -0.72956401, 0.25746792, -0.06084525, 0.13093694, -0.48404722, -0.83407745, 0.11298876, -0.7265127, 1.07638829, 0.05064864, -1.11875352, -0.76518293, 0.22344272, 0.1992795, -0.02284234, 0.03587222, -0.16635103, -0.2079402, 0.99594145, -0.71155991, -0.3595612, 0.67544504, -0.02880367, -0.30229637, 1.09523003, 0.80242019, -1.99040455, 0.11941035, -0.93049676, -1.0701498, -1.27559322, 0.29859456, -0.42368542, 0.21916323]);
  const b2 = new Float64Array([0.42401962, -0.15526196, -0.20935103, 0.37684314, -0.3962977, -0.14583154, -0.2090909, -0.12138925, -0.0466035, 0.11940856, 0.2488065, 0.08022293, -0.1910896, -0.10880616, 0.09888873, 0.39354428]);
  const W3 = new Float64Array([1.26124454, -0.65319858, -0.17077544, 0.11036791, -0.61442015, 0.24028936, -0.22961459, -1.09522736, 0.62007109, -0.93996106, -0.01092359, 0.76652377, -0.46148229, -0.3793807, 0.82534505, 0.19656298, 0.00001615, -0.00131499, 0.06900849, 0.0003891, -0.00014329, 0.00120203, 0.01659016, 0.00087973, 0.00057459, -0.00048635, 0.05999357, 0.00138296, 0.00007018, 0.00070735, 0.00007993, 0.00071559, 0.0012782, -0.00064121, 0.28044171, -0.00194282, -0.0005933, 0.0013636, -0.03993883, 0.00146348, 0.00054601, -0.00111742, 0.26163712, 0.00302233, -0.00004194, 0.00097757, -0.00039643, -0.00003672, 0.00067284, -0.00047046, 0.17866526, -0.00112832, -0.00024521, 0.00113972, -0.02224619, 0.00089898, 0.00037566, -0.0007047, 0.16630316, 0.00189986, 0.00008513, 0.00052058, -0.00022396, -0.00010026, -0.02493241, -0.05365352, -0.67760733, 0.6432918, -0.1426055, -1.04640718, -0.65120678, -0.02487318, -0.03472516, 0.19076929, 1.05013304, 0.28704301, 0.10847837, -1.81147378, 0.047731, -0.92739122]);
  const b3 = new Float64Array([0.04979021, 0.02188968, -0.02374768, -0.01209304, 0.27876574]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.41431055, 0.1338646, 0.55125613, -0.06895575, -0.06835756, 0.05331997, 0.06857526, -0.14395597, 1.21813192, -5.12542594, 0.31925965, 0.07665982, 0.38424277, 0.14916191, -0.36962622, -0.44703312, 0.16872953, -0.0854955, -0.03949504, -0.66054972, -1.9185536, -1.11083333, 0.30913522, 0.3730612, 2.97253396, 0.6472466, 0.20059331, 0.42651631, 0.94783723, -0.517167, 0.26846972, 0.41084199, -1.52272934, 2.3738246, 1.21123546, 0.14337352, 0.15023066, -1.04911612, 1.00836258, -0.21475508, -0.03610315, 0.62343677, -0.49988797, -0.93496687, -0.12984244, -0.84099928, -0.21567879, -0.43947192, -1.23279242, 0.05282233, -0.25328222, 0.80116723, 0.64037293, -0.39225099, 0.30158138, -0.94047182, 0.03355886, -0.00047208, -0.10423673, -0.25502409, 0.65850808, 0.65766512, -0.27156693, -0.29301184, -0.29960504, -0.63245265, 0.74327879, 0.85258121, 1.17816536, -0.6805901, 0.24750862, 0.83212748, 0.56825779, 0.17784877, -0.36086999, 0.33168088, 0.51650557, 0.76206268, -0.052468, -0.01018024, 1.03601023, -0.09345558, 0.51415384, -0.56865428, -0.07378277, -0.10224367, 0.11243758, 0.35146254, -0.10536201, -0.00165517, 0.27272122, 0.10284289, -0.53502643, 0.21751092, -0.15990307, -1.029625, -0.41324882, 0.50601471, 0.10125505, -0.24225844, 0.22948454, 0.18013721, 0.65515115, -0.62939425, -0.56162344, 0.21342572, 0.94726643, -0.72814546, 0.79665017, 0.03708925, -0.18671571, -0.44393631, -0.24495466, -0.17335064, 3.32287773, 2.91461075, 0.62810635, -0.87469265, 3.05703989, 0.44548581, 0.35591438, 0.55084036, 0.24098162, 3.95039206, 0.54725333, 0.24625632, 0.5983237, 0.0881038, 0.95223547, -0.04220454, 0.32035429, 0.74974993, 0.02975341, -0.14233331, 0.64226266, 0.33667054, -0.32672714, 0.55420472, 0.41442452, -0.1652329, 0.36496469, 0.20613541, -0.60575785, 0.67512675, 0.18668144, -0.72989976, -0.59984573, -0.59043776, -0.49517479, -1.20559055, -2.2714996, 0.27452443, -0.69693279, 1.98451562, -1.66181581, 0.0061461, -0.46487493, -3.48266625, 1.95537972, 0.3823426, 0.61422536, 2.19144452, -1.84727928, -0.36967461, -0.31658236, 0.25652157, 3.90092146, -0.17632282, -0.22007593, 0.26951451, 0.45315514, 1.38427063, 0.00617474, 0.22349211, 0.28629142, 0.05830829, -0.08883917, 0.1481828, 0.20163197, -0.35244654, 0.93190337, 3.46794025, 0.01780869, -0.83142438, 0.06719809, -0.7512425, 0.18028516, -0.28772844, 0.55574899, 0.60403409, -0.31096245, 0.25065075, 1.55879722, -0.02253252, -0.083896, -1.01095283, 0.15442946, 0.8934827, 0.2843392, -1.31087744, 0.31578311, -0.12239319, -0.60576064, 0.77119534, -0.96230708, 0.15817031, 0.55971357, -0.01068014, 0.61411007, -0.84778617, 0.08014234, 0.86540469, -0.06253241, 0.32157832, -1.97632652, 0.31647146, 0.26098276, -1.1463497, -0.4525229, -0.50075443, -0.52522839, -0.13478346, -0.01816299, 0.49159591, 2.12631374, 1.69492559, 0.0043757, 0.15482931, 1.5403557, 0.94202833, -0.55742933, 0.23036741, 0.28619115, 1.22849986, -1.0595339, -0.49866533, 0.98238437, 0.71277788, 0.74771426, -1.54932901, -0.42897939, 0.07017483, -0.43655942, 2.07124682, 0.39072843, 0.1139163, 0.22897339, 2.06398077, 1.07880945, -0.19356135, -0.00245439, 0.21489013, 2.47817577, 0.10006068, 0.02585234, 0.15646854, 0.06613783, -0.38883083, 0.08357023, -0.06615162, -0.44600362, -0.38214517, -0.14815454, 0.01984833, 0.05990736, -0.47456113, 0.93816774, -0.59785345, -0.09637677, -0.49659337, 0.5418502, 0.84400845, 0.33090672, -0.41695291, -0.05445189, 0.78316076, -0.06257269, 0.52211548, 1.00193246, -2.4635729, 1.47726944, -0.3011682, -2.46602005, -0.10297709, -0.40169155, -0.88465581, 3.63111632, 1.11632943, 1.1265963, -0.13834992, -1.13904361, 0.88367592, 0.01713461, 0.79096455, -0.53839698, -3.8438593, -0.63254875, 0.2209145, 0.79499508, -0.49467358, -2.1234711, 0.31618373, -0.14861714, -1.67301482, -0.0430027, -0.03973439, -0.81625803, -0.31088222, 0.0503036, -0.51296021, 1.69240569, -0.21593775, 0.19022818, 0.1562194, 1.28111027, -0.2006924, 0.47281203, 0.14976824, 0.54234227, 0.16115976, 0.43709008, -0.68955746, 1.30919846, -0.06849192, -0.12745657, 0.14896356, 0.33840539, 0.42213877, 0.27768615, -0.89369225, 0.32876205, -0.94998583, -0.53786447, -0.56487816, -0.46177294, -1.08575532, -0.90788282, -0.58033364, -1.76228832, -0.77946578, 0.44743783, -0.42711793, -0.3069655, -0.9566285, -0.35333777, 0.24157408, -0.00169409, -0.36198144, -0.4627298, 0.6208236, 0.32532496, -0.48100807, 0.54999197, 2.89675842, -0.99075047, -0.46385789, 0.02357837, -0.61648305, -0.24394852, -0.68776736, 0.45973213, 0.04803183, 0.08147616, -0.44014468, -0.78568717, -0.40114569, -0.60982667, 0.12393029, 0.84176092, -1.03225214, -0.21904517, 0.11598549, 1.60438538, 0.59304788, -0.03945008, 0.0638448, 0.42544023, 1.79528776, 0.93874719, 0.01591335, -0.0820694, 1.14837002, 1.41947168, -0.26666462, -0.20724218, 0.64483762, -0.29063514, 0.01062903, -0.49902738, -0.92800397, 0.15962131, -0.0369205, -0.24601863, -0.84185485, 0.00241492, -0.98228396, -2.77105081, 0.25487039, -0.34419557, 0.27218269, 1.10593801, 0.2751315, 0.35608456, 0.39856254, -0.12743373, -0.34257429, 0.09077456, -0.94626722, 1.60412025, 1.45214365, 0.63320399, -0.08618569, -0.56156225, 0.42024177, 1.18662471, 1.79775834, 0.14570018, 0.30572068, 0.48136718, -0.21028086, 0.2519183, -0.29526641, 0.63023283, 0.70474289, 0.18073645, 0.01713545, -0.02686142, 0.24467893, 0.6560063, 0.45540367, -0.05006056, 0.21543358, 0.38948099, 0.08828946, 0.46294624, 0.23996366, -0.08823862, 0.33817829, 0.3976901, -2.72802476, 0.0068949, -0.27794135, 0.45142053, 0.58466634, -0.28088127, 0.30351011, 0.146066, 0.20509973, -0.1769003, 0.12591536, -0.33116034, 0.26158276, 0.18089159, -1.815569, -0.10876111, -0.27299534, 0.1564564, -0.56617963, 0.82010933, 0.19543072, 0.19663253, -0.29710614, -0.69630058, -0.05687886, -0.92855694, -0.19750134, -0.02739075, -0.24973589, -0.06220542, -0.4750565, -0.07086285, -0.19416382, -0.22141262, 0.7945132, 0.1481213, 0.73522059, 0.42546783, 0.210102, 0.47486147, 0.56083563, 0.11428976, -1.62750928, -0.04695249, -0.68164379, 0.10721919, 1.38023401, 1.19326509, 0.51961765, 0.4248779, 0.47770273, 1.23172101, -0.02078277, 0.44493876, 1.15651255, -1.45824392, 0.03453537, 0.22962453, 0.75718512, 0.33438966, 0.14504503, -0.40848526, 0.34710397, -1.62026372, 0.23600815, 0.15544018, 0.40816362, 0.54396385, -0.22570969, 0.19379232, -0.30378815, -0.11873641, -0.03531658, -0.11296825, 0.08629851, -0.59913098, 0.1388571, -0.60201648, -0.01310579, -0.22245659, 0.31517463, 0.31252883, 0.43893411, 0.79391082, -0.23804095, -0.96502886, -1.78322012, 0.72699413, 0.26973056, -0.37204634, 0.13524862, 0.16264076, 0.40411689, -0.42583001, -0.59603223, -0.5351199, -0.04681252, -0.93068803, -1.84717096, 0.76784495, 0.4292352, -0.03229981, -0.19735882, -0.25662815, 1.09472733, -0.19671989, -2.38051393, -0.34018065, -0.79945229, -0.54088839, 1.02844975, -0.85753644, 0.40767118, -0.21903651, -0.75286196, -0.51832948, -0.21397817, 0.35579157, 0.48666188, -0.08600408, 0.6800381, 0.29537087, 0.10178861, -0.21969043, -0.2535218, 0.26513312, 0.72841581, -0.33590025, 1.78836899, -0.31406448, 1.36588304, 0.37380913, 0.14716618, -0.80771755, 0.67789402, -0.08274023, -1.14932884, 1.13671903, -0.2508064, 1.03048668, -1.20648331, 0.4354311, -0.18429172, 0.36781426, -0.10745065, -1.48693973, 0.73506596, 0.17914616, -1.10861116, 1.11730461, 0.12089034, -0.23022552, -0.04197887, -1.28095261, 1.70020034, -0.10919253, 0.67415265, -0.20073798, -0.31987314, 0.37086582, -0.62051046, -0.93989693, -0.2894304, 0.18743281, 0.13988605, -0.02900841, 0.27442256, 0.18817036, 0.44266005, 0.50978663, -0.1113706, 1.63065048, -1.7794332, -0.31755634, 0.09149346, -0.46010379, 1.46413991, -0.24923504, 0.44701008, 0.09635991, 0.58698104, -0.53907032, 1.24045955, -0.10591311, 1.00801789, -0.22661149, 1.28446669, -2.8095573, 1.17680675, -0.06701236, -0.01990484, -0.51560264, -1.14516203, -0.23764702, 0.81047644, 1.79982418, 1.19716403, 0.16623353, 0.35066638, 1.10690571, 0.98648507, -0.9968568, -0.00612548, 0.19600697, 0.17386572, -0.66936196, 0.16435581, 0.46417075, -0.23163808, 0.08849883, 0.37779653, 0.2921898, -0.14028622, 0.32142587, -2.06041542, -1.09561448, -0.04968134, 0.34530372, -0.44565326, 0.11759497, -0.95701023, 0.05189071, -0.43232802, 0.96330441, -0.71786567, -0.23226502, -1.08902189, 0.35000344, 0.00936262, 0.29995859, -1.13913389, -0.42963059, 0.53860205, 0.66050068, -1.56572283, 0.2368823, 0.27883436, -0.07449156, -0.01935263, -1.61315198, -0.24264134, 0.12093699, -0.04601659, -0.69183312, -1.2029798, -0.26144411, 0.09437148, -0.03456878, 0.45136178, -0.83172562, 0.36505256, -0.10972521, -0.4936375, -0.12591957, -0.30848856, 0.14179548, -0.52202029, -0.34149257, -11.44233145, 0.21743096, -0.06073572, 0.10010776, 1.10199669, 0.28717459, 0.06949337, 0.23600876, 0.47602561, -0.32925783, -0.0016577, 1.27153257, 1.32392172, 0.11550364, -0.32289366, -1.1922201, -0.2709502, 0.1080917, 0.46015201, 0.88130263, -0.86302285, -0.20809276, 0.77834935, -0.58328786, 0.33132333, -0.83337201, 0.04437454, 0.65973918, -0.02983118, 0.57055484, -0.01308596, -0.39364507, 0.80760088, 0.14232149, -0.39719289, -0.02643312, -0.34085203, -0.16401716, 0.03327453, -1.02408205, 0.54551109, 0.17450207, -0.64479388, 1.30813425, -0.30510551, -1.09374132, -1.27060897, -0.03530879, -0.39200235, -0.79347232, -1.34533568, 0.63094185, -1.27625243, 0.04758732, 1.74847994, -1.8317252, -1.32967512, 0.15067975, 3.07330619, -1.03382097, -0.2417216, 0.09428424, 0.93683506, -0.11407725, 0.03155272, 0.18271949, -0.62009912, -0.71446058, -0.13345956, 0.24530664, 0.47118164, -0.53844005, -0.09995274, -0.54718436, -0.18947263, 0.36362266, -0.09746967, 0.56297139, 0.95566598, 0.98109626, 0.36730153, 0.1223493, 1.03933386, -0.07573748, 0.0974063, -0.82272998, -3.3434064, -0.69488298, 0.12337046, -0.26254483, -0.11935374, 0.56196698, 0.32012027, -0.25802748, -0.46687177, -0.18041931, 0.24454685, 0.301645, -2.45143869, -0.00681073, -0.33728652, -0.28102715, 0.27258895, -0.53504559, -0.24737824, 0.56898945, 0.59232843, 0.94171739, -0.3464817, 0.1573015, 0.71980677, -0.47262825, 0.34545721, -0.09408882, 0.39931424, 0.34844177, -0.05739015, 0.40740549, 0.26136298, 1.12446804, -0.08651147, 0.20382725, 0.65606577, -0.10565869, -0.00253925, 0.41868805, -0.80448133, 0.16362807, 0.75552517, -2.72022837, -1.28437338, 0.19215537, -0.34104523, 0.97708778, -0.10493557, -0.45867167, 0.23274852, -0.47934946, -0.41275191, -1.15299783, 2.7221585, 1.19192999, -0.29265869, -0.24976708, -0.78523194, -0.52973708, 0.02547175, -0.56988914, 0.29043001, -1.97265521, -0.5843083, -0.30737171, -0.49131435, 0.55398667, -1.62760353, -0.64356462, -0.21687425, -0.94507082, -0.31807524, -0.21478074, -0.20855819, -0.33365496, 0.38204097, -0.80013858, -0.82297974, 0.05258077, -0.31870118, -0.25110974, -0.50211974, 0.29698319, 0.04581618, 2.41558834, 0.09596117, 0.56715426, 1.90984353, -1.18092071, 1.27172204, -0.22243659, -0.20357627, 0.35116691, 0.85339517, -0.30202846, -1.16119985, 1.8293847, 1.85268541, -0.29313823, 0.5392384, 1.5102688, -0.46452768, 0.08787849, 0.9728476, 2.44164243, 2.68063574, -1.30264046, -0.16233608, 1.18751724, 2.7872606, 0.69834599, -0.34720624, -0.45259697, 1.50555043, 2.35057583, 0.17289977, -0.62186635, -0.12100033, -0.45087125, 0.45620133, 0.5546763, 0.76706356, 0.40146435, 0.20418496, 0.27163724, -0.00184938, 0.27317098, -1.8143833, -1.49807462, 0.2973864, 0.49411261, -0.32380854, -1.49689409, -0.18529611, -0.26512734, 0.14091963, -2.22418345, 0.42121402, -0.11520493, 0.17393191, 1.55169366, 0.93310092, -0.1923104, -0.10200088, -1.23576217, 0.54293279, -0.65611634, 1.44167301, -6.12170038, -0.43654819, 0.48868381, 0.06097207, 2.20517109, -0.9439845, -0.59449794, 0.07717987, -2.29667323, 0.87196156, -0.69415557, 0.27519304, 0.38792836, 0.83695642, -0.19630959, 0.3574806, -1.30304218, 0.02589824, -0.06161191, 0.38803615, 0.50950035, -0.00305887, 1.96660702, 0.74423141, -0.50337323, -1.14168687, -0.35467361, -0.99863412, -0.1408182, -0.45203795, 0.67413641, 0.91255984, 0.12468415, -1.11853351, 0.12870135, -1.25552306, 0.76404657, 2.30039335, -0.21573798, -0.04531546, 0.29982952, 0.58676628, 1.60869622, 0.39983816, 0.10677758, 1.03271956, 1.66590484, 0.75121973, 0.0002115, 0.82925399, -0.04006286, -1.13720009, 0.65797377, -1.15547489, -0.26313096, -0.01387821, -0.30231485, -0.07652224, -0.05477199, -0.32745688, 0.20159912, 0.00885946, -0.28584158, -2.08377599, 0.47155331, -0.30365669, 1.44081169, -0.03047458, -0.74700213, -0.62909711, 0.47266167, -1.10285844, -0.05196693, 0.03678704, 0.58297878, 0.08457563, 0.12513379, 1.57131672, 0.53310932, -0.13498084, 0.00067699, 1.13828326, 0.43464785, -0.82219928, 0.01966246, -1.90722651, 1.68734658, -0.2759657, 0.42721997, -1.82997624, -2.01008725, -0.31674878, -0.0038825, -0.01217038, -2.08008473, 0.06012928, 0.6788653, 0.31542592, 0.65656559, 0.00001411]);
  const b1 = new Float64Array([-0.15907511, -0.1929051, 0.10945751, -0.21092067, 0.04034448, -0.30029714, -0.20900182, -0.10178228, -0.20780551, 0.10209124, 0.18191291, 0.12001367, 0.070962, -0.17468521, 0.13430898, 0.20659673, -0.40249072, 0.01675714, 0.28446659, -0.16478239, -0.22467173, 0.28978399, 0.10560347, 0.26652285]);
  const W2 = new Float64Array([-1.06636007, -0.9190176, -0.9880083, -0.35530867, -0.08899307, -1.69870637, 0.01220959, 0.09350449, -1.1651912, 0.13830163, -0.14143865, 0.1817375, 0.34855759, 0.46334024, -0.54418244, 0.28463261, 1.09606241, 0.03632454, 1.68348322, 1.4883562, 0.04363201, 1.31636666, -0.68501627, 0.03175811, 0.36471258, 0.66178477, 1.18589667, 0.80571672, 0.1888786, -0.11836566, 0.09893024, 0.06179218, 0.71066674, -0.36287968, -0.1064925, -0.40859712, -0.4215175, -0.58632844, -0.68420745, -0.55557224, 0.55006761, 0.21302886, -0.39896691, 0.03294153, 0.08188296, -0.66677837, -0.47631594, 0.1283534, 0.03231145, 0.51188022, 0.03458735, -0.37872805, 0.99093232, -0.09349266, 0.48906059, 0.07385758, 0.56976018, -0.09113388, -0.46888558, -0.39745289, -0.05222727, -1.01176235, -0.10587054, -0.37683798, 0.87894271, 1.09608087, 0.11028256, 0.28244313, -0.78961705, -0.19327519, 0.41660429, 0.64677505, -0.57763378, -0.14187799, 0.31931852, -0.17893321, -0.1052134, -0.26276642, 0.22673011, -0.29032388, -0.15508991, 0.32140468, -0.62552615, -0.12244431, 0.4430931, 0.28272648, -0.33711309, 0.77692119, 1.3327882, -0.32980567, 0.09392896, -0.36823786, 0.57180358, -0.33167606, -0.30915636, -0.0301393, 1.5204984, 0.50403415, 0.91787832, -0.71484875, 0.09642167, 0.83226803, 0.0377348, 0.41422052, 1.45311684, -0.59202403, -0.9823554, -0.1361235, 0.50204823, 0.08987324, 0.34131219, -0.49477002, -1.83099733, 0.39757269, 0.22414437, 0.22020696, -0.93904678, 1.57251293, 0.02618352, -0.8243548, -0.09878735, -0.28404156, 0.09511452, -0.03864435, -0.06619242, -0.32489413, 0.18103445, -0.67042187, 0.06641501, 0.49091602, 1.15105489, -0.03124252, 0.29284833, -0.07068988, 0.18520357, 0.05663937, 0.117698, -0.0797537, -0.33787976, -0.04743768, -0.39996365, -0.46597293, -0.02634516, -0.0964922, 0.37484397, 0.41337386, -0.5388731, 0.05072256, -0.01660806, -0.34263423, 0.39648123, 0.49761053, 0.21517297, -0.17741354, 0.2828262, -0.90036219, 0.15542189, -0.54295006, 0.03839443, -0.24938647, -0.19099852, -0.24707483, 0.4310102, 0.1716582, -0.21609417, -0.47396357, 0.64833543, 0.13416627, 0.51955328, 0.32756169, 1.44459655, 0.45706039, -0.18778061, 0.42820058, 0.61110126, -1.3664041, 0.60192903, -1.07354476, -0.44862069, -0.05646726, -1.3273419, 0.87264658, 0.18648687, 0.4046214, -0.83832859, 0.55344986, 0.43776764, -1.25358137, -1.02852542, -0.38953627, -0.1098615, -0.06735816, 0.13221443, -0.05011555, 0.23659837, 1.06796277, 0.23111975, 0.16534329, -1.73893576, 0.42179463, 0.43795234, -0.74172042, -0.58225356, 0.82913229, -0.0061605, 0.14352363, 0.68626179, -0.47791533, -1.18425093, -0.86687171, 0.13670141, 1.3497123, 0.1870161, -0.15197923, -0.14197344, -1.48606292, 0.759968, -0.78261921, 0.86541666, 0.49401549, -1.00070819, -0.87567447, 0.47184199, 0.05707999, 0.28663265, 0.57849863, 0.45998443, 0.57073688, 0.62550341, -0.59592951, 0.30839136, 1.16268514, 0.46135021, -0.16642006, 0.9698602, 1.01061643, -0.60635468, -0.12549207, -0.04484992, -0.79689827, -0.09897471, -0.64850121, 0.70027939, 0.33297784, -1.04378598, -0.28438728, -0.3963471, -0.0030868, -1.10497942, -0.38022961, 0.09077478, 0.32667395, 0.59005625, 1.03490529, 0.35289898, 0.07765075, -0.50261793, -1.06121045, -0.00453313, -0.38053407, 1.35021785, -0.28493185, -0.09606505, -0.67572982, -0.13474524, -0.12426026, -0.07336407, 0.88524838, -0.00078716, 0.81413289, -1.030188, 0.04768998, -0.19906243, -0.58877772, -0.58348167, 0.25562227, -0.46262391, 0.29961826, -0.16890995, -0.07276982, 0.0386313, -1.22748869, 0.27623303, 0.52627614, -0.06246282, 0.57380885, -1.16333763, -1.00636065, 0.78842963, 0.66658387, 0.0864282, -1.35076353, 0.34379365, -0.03387986, -0.02327315, 0.55144792, 1.25927518, -1.18115354, -0.2735233, -0.2034306, 0.70141231, 0.02625898, 0.43513017, -0.42636147, -1.36533786, 0.25487186, 0.58849371, 0.17550897, -0.61778176, 1.52055962, 0.34922819, -0.90630038, -1.3268624, -0.2776963, -0.53731126, 0.03874003, 1.8093392, 0.17853993, -0.03630116, 0.45842332, 1.09878117, -0.39164164, -0.61933352, 0.20103481, -0.24118892, -0.00344222, 0.04404278, -0.70625417, -3.06268001, 0.39331597, -0.77555831, -0.42094925, -0.12266971, 0.24322597, 0.20764888, 0.13823716, -0.4869097, 0.05074555, -0.05776163, 1.34533581, -0.53936717, 1.77920668, -1.21569102, -0.69992965, 0.9377622, -0.01419624, -0.72646094, -0.22733931, -0.00897031, 0.44336358, -0.72956401, 0.25746792, -0.06084525, 0.13093694, -0.48404722, -0.83407745, 0.11298876, -0.7265127, 1.07638829, 0.05064864, -1.11875352, -0.76518293, 0.22344272, 0.1992795, -0.02284234, 0.03587222, -0.16635103, -0.2079402, 0.99594145, -0.71155991, -0.3595612, 0.67544504, -0.02880367, -0.30229637, 1.09523003, 0.80242019, -1.99040455, 0.11941035, -0.93049676, -1.0701498, -1.27559322, 0.29859456, -0.42368542, 0.21916323]);
  const b2 = new Float64Array([0.42401962, -0.15526196, -0.20935103, 0.37684314, -0.3962977, -0.14583154, -0.2090909, -0.12138925, -0.0466035, 0.11940856, 0.2488065, 0.08022293, -0.1910896, -0.10880616, 0.09888873, 0.39354428]);
  const W3 = new Float64Array([1.26124454, -0.65319858, -0.17077544, 0.11036791, -0.61442015, 0.24028936, -0.22961459, -1.09522736, 0.62007109, -0.93996106, -0.01092359, 0.76652377, -0.46148229, -0.3793807, 0.82534505, 0.19656298, 0.00001615, -0.00131499, 0.06900849, 0.0003891, -0.00014329, 0.00120203, 0.01659016, 0.00087973, 0.00057459, -0.00048635, 0.05999357, 0.00138296, 0.00007018, 0.00070735, 0.00007993, 0.00071559, 0.0012782, -0.00064121, 0.28044171, -0.00194282, -0.0005933, 0.0013636, -0.03993883, 0.00146348, 0.00054601, -0.00111742, 0.26163712, 0.00302233, -0.00004194, 0.00097757, -0.00039643, -0.00003672, 0.00067284, -0.00047046, 0.17866526, -0.00112832, -0.00024521, 0.00113972, -0.02224619, 0.00089898, 0.00037566, -0.0007047, 0.16630316, 0.00189986, 0.00008513, 0.00052058, -0.00022396, -0.00010026, -0.02493241, -0.05365352, -0.67760733, 0.6432918, -0.1426055, -1.04640718, -0.65120678, -0.02487318, -0.03472516, 0.19076929, 1.05013304, 0.28704301, 0.10847837, -1.81147378, 0.047731, -0.92739122]);
  const b3 = new Float64Array([0.04979021, 0.02188968, -0.02374768, -0.01209304, 0.27876574]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
