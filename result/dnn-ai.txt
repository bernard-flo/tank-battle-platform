function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.12919988, 0.53839085, -0.1060256, 0.18404706, -1.84451855, -0.2654118, -0.96417753, 0.19694201, -0.1316366, -1.09859573, 0.20089892, 0.4053082, 0.41059322, 0.34122344, -0.33941922, -0.60747516, -0.23366435, 0.3661617, 0.90760967, -0.20897337, 0.95617585, -0.52531092, -1.20260868, 0.25895174, 0.36075162, 0.66167732, 0.46454885, -0.409713, 0.96587258, 0.02635149, 0.67326605, -0.87727076, -1.08249929, 0.0675701, 0.68452451, 1.25444908, -0.36469147, -1.72830683, -0.3522396, -0.13956489, 0.46877731, 0.92153177, 1.20344287, -0.02614582, 0.8410064, 0.06633651, -0.26373905, -0.16140108, -0.35537125, -0.60195755, 0.81694713, -0.62569702, 0.49049964, 1.68547244, -0.61301157, -0.7394573, -1.54993101, 0.92090681, -0.09905171, -1.48434426, 0.06712329, -0.96920817, -0.32909871, -0.51625916, 0.51948175, -1.06373098, -0.94466859, -0.16711838, -1.67841318, -0.57880075, -0.44718282, 0.43136932, 1.09984914, 0.76879281, -0.29231537, -0.34075089, 0.13875126, -0.19083625, -0.58389058, 0.2990573, -0.43515077, 0.44894048, 1.5017857, 1.1124457, -0.02559045, 0.94510429, -0.19926982, -0.59673061, 0.4064476, 1.97965291, -0.523701, -1.10911585, -0.23396502, -0.94437975, 0.8450979, 0.429929, 1.16686847, -1.08792432, 0.18349473, 0.71557004, 1.25494788, -0.30248998, 1.43511725, 0.63203774, -0.31191915, -0.42858654, -0.84111098, -2.00535127, 0.08608713, 0.49598659, 2.07053847, 1.60597759, 0.3366828, -0.22281002, -1.35314547, -0.92101901, -1.16667447, 0.74056623, 0.94773047, -0.92817511, -1.86657268, -0.25997904, -0.77814528, -0.15708403, 0.37996977, -0.52248615, -0.96268558, -0.74393704, -1.04759005, 0.71810873, 0.75010374, 0.07684314, 0.61312677, -1.2752957, 0.07869385, -1.29272587, -0.84614424, 1.79130541, 0.41443751, -0.34436736, 0.85821302, -1.28706709, -1.57946258, 0.86588403, 0.34407335, -0.49242266, 1.61308089, -0.80075512, 1.00867526, -1.07276262, -0.19937004, 0.11348028, -1.04952927, -0.26357263, 0.502315, -0.32899089, 0.62314725, -0.82493827, -0.34373542, -0.41511676, -0.30028973, -0.14974018, 0.89107496, -0.2066916, 0.20511613, -2.26749236, -0.08907113, -1.46868928, -0.06046051, -0.20222232, 0.30067437, 0.90743619, 0.40532131, 0.18604324, -0.11580713, -0.48562792, -0.01031199, -0.77580853, 0.66895244, -0.45807735, 0.19890305, 1.04423572, 0.47897106, -0.44629131, 0.16680932, -0.39576426, -0.18037069, -0.43067111, -1.16346728, -0.5143305, 1.08291031, 0.27520681, -0.57399016, -0.69634947, -0.49470007, -0.23408483, 1.30774803, -1.24674451, 0.18855524, -0.61607742, -1.22255446, 1.71805393, -0.083574, 0.6934223, -1.8481099, -0.27376993, -1.17454895, 0.14272256, 0.11276265, 0.3157888, 0.94116905, 1.18179326, 0.80811847, -0.21125064, 0.29018061, 1.28514364, -0.57728162, -0.37644024, -0.85508952, 0.39502617, -0.16487126, -0.55399526, -0.93944557, 0.22304983, -0.40875941, 0.51243544, -0.26842774, -0.08311363, 0.42731917, 0.3331231, -1.49283208, 1.65904085, -0.63747887, -0.08686399, -0.21013847, 1.86649012, -1.10214724, 0.0265192, -0.26370607, -2.08958289, 0.14572481, -2.7562922, -1.63838789, -1.02839787, 0.436912, -0.77784546, -0.38244757, -1.50218174, -0.87980013, 0.6204392, -0.18685724, -0.25550805, 0.06538993, -1.88552871, 0.37356024, -1.07630368, -1.85175301, -0.12844573, -0.84957873, 0.19531525, -0.56409773, 0.11771226, 1.26912131, -0.42566036, -0.64689513, 0.32324206, -0.01811351, -0.4675068, 1.49441298, -2.40135195, -0.7709642, -0.07333278, -0.22380423, -1.23415325, -0.20548278, -0.40844235, 0.28129554, -0.05594934, -1.51964944, -0.86522298, -1.67468189, -1.27298165, 0.56246491, -0.7119768, -0.70566282, -0.15246681, -0.41107516, 0.63565999, -0.2236744, 0.94818793, 0.09433935, -0.40463127, -0.13317247, -0.48678278, 0.90130134, -0.49479485, 0.55181518, -0.72544249, 0.34669671, -0.21822634, 0.72478334, -0.00015779, 0.09494694, -1.33637406, 0.65897185, 0.37715712, -1.94359733, -0.15333243, 0.38681636, 0.99755587, -0.77918575, -0.88368053, 0.56937193, 1.0986412, -0.0063286, -1.19481331, 0.40327863, 1.74304513, -0.29062309, -0.12046315, -0.40488974, 0.06733586, -0.5864114, -0.03977954, -0.53943196, -0.93268546, 0.72747257, -0.50341872, -0.32455451, -0.19119688, 1.26203, 1.32115231, 0.58004996, 1.24379026, -0.09752867, 0.95456556, 1.01712524, 0.32199711, -1.67299999, -0.1203608, 1.43034142, -0.00249132, 0.07435869, 0.62077547, -0.5272084, 2.59266289, -0.14530446, 0.97571757, 0.95104164, -0.49587531, 1.12296808, 0.37678994, -0.32438995, -1.61782993, -0.49110977, 0.48054622, -0.57305494, 0.73637119, 0.59996627, -0.62513343, -0.93888143, 0.13973976, -0.93924959, -0.15394797, 0.86709815, -0.88680711, 0.42357626, 0.80393412, -0.63971255, -1.67282706, 0.33781738, 1.45378643, -1.07606707, 1.25920057, -0.1016934, -0.19269155, 0.98838125, 0.14495898, -0.89328348, 1.0522509, 0.50623302, 0.42726883, -0.68869639, -0.44018062, 1.84150782, -0.59408578, 0.34331978, -0.39553807, -0.9511237, 0.19410909, 1.44209698, -1.04005444, 2.00103385, -0.61206814, 0.3017591, -0.30243556, -0.20696573, -0.90748117, 1.17969408, 1.02747861, -0.50807734, -0.54017285, 3.35569838, -0.29054497, 1.35453779, -0.83753321, -1.07840614, 0.41798364, 0.66156192, 1.42321578, 0.3400416, -1.15941756, -0.47172295, -0.33638498, 0.69234623, -1.00583168, -0.66125072, 0.59734064, -0.109898, 0.64953168, 0.74382221, 0.56988032, -1.7669224, 0.03985264, -0.8884815, -1.8871374, 0.30804287, 1.047233, -0.00242477, -0.48541024, 2.0123724, 1.66439548, 0.10256516, 0.86625983, 0.69709549, 0.28621121, -0.93705224, 0.46101749, 0.42302368, -2.34677794, -1.34523253, -0.85369879, -0.85019653, 1.05960297, -0.35259578, 0.20540335, -0.01254739, 0.74453087, -1.00579491, 0.50553924, 0.20173546, 0.84004475, 0.94619881, 0.81654418, -2.3631754, -0.95024623, -0.12798009, 0.26052984, 0.12221493, 1.98934866, 0.06134287, -1.23755948, -1.55221303, 0.86905162, -0.33574497, -0.785917, 1.79821277, 1.99543148, -0.59893392, -0.72924345, 0.72594461, 0.88571702, -0.80652723, -0.18328393, 0.19164536, 0.39070334, -1.28511416, -1.48279908, 0.2255184, -0.02850824, -0.83065691, -0.92983366, 0.51613866, -0.51841491, 1.21304059, 1.19434286, -0.23825356, -0.78336346, -0.96941738, -1.01372181, 0.25071878, -0.81270147, 0.41247486, 0.04840887, -0.59708023, -1.70989936, -1.31540066, 0.43707815, 0.15903183, -0.65557914, 0.35488817, 0.30326477, 0.01417764, 1.78043017, -0.2347309, -0.00977352, -0.1452394, -0.31506725, 0.29124182, -0.56487455, 1.13568681, 0.60135936, 0.52472101, -0.96473102, -0.03204886, -0.74985515, 2.24862799, -0.47025752, -1.04800781, 1.06676979, -1.3332727, -1.10347546, 0.90924515, -0.9259584, 0.20510289, 1.8890085, -1.00018466, 0.32846825, -0.04377756, 0.1494981, -1.07726775, -2.00005095, -0.45746394, -0.88477777, 0.10832786, -0.96356527, -0.40846596, -1.22084067, -0.53498869, -0.60472866, -1.06906236, 1.43677127, 1.45554181, -0.29889496, -0.36577127, 0.62508352, 0.11447551, 0.7359401, -1.8138315, -1.38096985, -0.15439718, 0.49077554, 0.4435932, 0.11377517, 0.76599221, -0.61566495, 0.64040563, -0.41730931, -1.1750121, 1.12287294, -0.11695974, -0.79565246, 0.2371364, -0.6538574, -0.09239033, -0.35505938, -0.28133177, -0.76474658, -0.45523695, 0.05232185, -1.71427051, 0.70795835, 0.18788025, 0.1402817, -0.04253285, 0.48357989, -0.158762, 1.17951548, -0.8978362, -0.85566158, -0.05257799, 0.24895868, 0.16921378, -1.63488851, 2.69739057, -1.08452608, -0.54310743, 1.17133811, 1.44753404, 0.73664336, 0.06618319, -1.27041004, -1.44055942, -1.34714651, 0.22980032, 1.36565427, -0.89843346, -1.03469148, -0.5260749, -1.04141253, -2.58715189, -0.64862805, -2.4605015, 0.11164159, -1.98578827, -0.27168584, 0.76134712, -1.10234866, -1.26393187, -1.52201238, 1.92762706, 1.10086773, -0.29592203, 2.11028315, -0.73080732, -0.04952872, -0.13164604, 0.10436002, -0.4000255, 0.53312037, 0.33993857, 0.11626446, -0.38118197, 0.58863583, -0.43186347, 0.31776474, -1.49902242, 1.60618544, -0.26328119, 0.26105919, 1.08501939, -0.35544076, 0.231896, 0.69482221, -1.22858108, 1.76838236, 0.73305912, 1.1790418, 0.62004608, 0.83813702, -0.26037864, 0.74914484, -0.63434351, 1.16884393, -0.0964325, -0.21480496, 0.01332289, -1.26518912, 1.27050124, -0.69882411, -0.30036408, -0.56293061, 0.96131736, 0.85847888, -0.49317113, 1.51356688, 0.30091364, 1.13406852, 0.28256426, 0.06035321, 0.1246994, 0.369739, -1.28718044, -0.13159744, -0.52333476, -0.5361268, 0.64545506, 0.00684978, 0.06517127, -0.95655232, 0.54314332, 0.29707475, -0.24562592, 0.87235749, -1.07324121, 0.37826216, -1.14956194, 1.09818573, 0.6534194, -0.50697356, -0.16812413, -0.53556594, -0.35089977, -0.74195996, 0.40828665, 0.50061713, 0.31316687, -0.46757834, 0.74137266, 0.20571767, -1.47991406, 0.7365356, -0.22475025, -0.1339124, -0.24707552, -0.56605377, 1.47341579, 0.96407278, -0.4733757, -1.2013399, -0.05409567, -1.21358051, 0.23097913, -0.19379787, 0.1235754, 0.3835123, -0.37517917, -0.57059294, 0.71343865, -2.03077904, 0.46847596, -2.07172929, -0.1607105, -0.51679746, 0.03041401, -0.89220986, 0.21591287, -0.53424826, -0.20974912, -0.45488571, -0.16682064, 0.99676333, 0.36898972, -1.49944444, 1.26609206, -0.70696238, -1.44257274, -0.21845022, -0.142134, 0.05221587, 0.65404742, -1.19063154, 0.49702661, 0.27069621, -0.85208763, -0.09702888, -0.07301064, -0.23345152, 0.75322569, 1.19079231, -1.0815044, 0.81294245, -1.96665349, 0.31214446, 0.48393353, -0.68575822, 0.0471126, -1.17653192, -0.38780267, 0.21730394, -0.25193044, -0.87854116, 0.11271054, 1.22551277, 0.12495602, -1.08127796, -0.04506021, 1.30313618, -0.3125118, 0.34883724, 0.613603, -0.18576361, 0.68378918, -0.01534037, -1.06491078, -0.21837704, -0.33104125, -0.18588764, 0.0743747, 0.01562586, 0.44475956, -0.0665213, -0.14246049, -0.60873583, -1.73718055, 1.48320477, -0.37992238, 0.34982873, -0.84814653, -1.30667908, 0.64669505, -0.65278273, -0.29838735, -1.05872409, 0.00374465, 2.05352248, -0.71038278, 0.2053318, -1.54485771, -1.29339939, -0.25405769, -1.12565931, -0.1187875, -0.67166574, 0.42216063, 0.59332394, -0.49864246, 0.83970167, -0.71347409, 0.91632027, -0.15507512, 0.68759454, -1.29473366, 0.90841905, 0.14119616, 0.77744963, 0.25503965, -1.28097013, 0.44068451, 0.42463812, -1.22785289, -0.10194648, -1.12285549, 0.07192283, 0.75228205, 1.11411685, 0.27309675, -1.69726223, -0.40578211, -0.4449591, 0.1075989, 0.75152201, 0.42388041, 1.9716984, -0.85843986, 1.24664224, -0.7261308, 1.90043606, 0.6662498, -0.18650988, -0.41438609, -0.43799568, -0.20897853, -0.81612777, -0.84858067, -0.67087688, 2.31564426, -1.62657933, 0.23637944, 0.10345757, -0.07180217, -1.21673319, 0.55898607, 0.93956284, -0.86467198, -0.49894881, 0.89546923, 1.59090759, 0.60650188, 1.68495406, 0.01383839, -0.97293602, 0.35029413, 0.92358284, -0.29211078, -1.78971208, -1.08552769, 1.18669008, -0.28002439, 0.27405075, 0.0694624, -0.68740036, -0.4378249, 0.24358519, -0.83461123, 1.35030876, -0.23716267, -0.2452278, 0.34070813, -0.86693761, 1.48266399, 0.3284211, -0.7516317, 0.31527463, 0.17078875, -0.89807427, -1.14187877, -1.60856579, -0.2829414, 1.1932368, 0.10428649, -1.24914791, -0.31067368, -0.98027293, 0.18272194, -0.16717895, -1.58394599, -0.08220539, 0.3796718, 0.94435941, 0.09364688, -0.26796703, -0.98677443, -0.57043364, -0.13938946, -1.39233404, -0.51054892, -1.34285342, 0.89913058, -0.24026141, -0.26748228, 1.23028654, 0.80222044, -0.62086781, -1.05725053, 0.75431359, -1.3571881, -0.19296285, 0.67547503, -2.16736668, 0.02298493, 0.77733993, 1.07596213, -0.90262257, 0.52154025, 0.23264912, 0.43299946, 1.08888254, 0.70700848, -0.32155372, 0.97833133, 0.19432768, 1.03326106, -0.48738812, -0.51644813, 0.65837451, -0.01592093, 0.88540515, 1.52966435, -0.34930729, -0.93960365, -0.99854216, -0.51736691, -0.02839116, 0.02431064, 1.07381558, 0.01513503, -0.37656687, 0.31340886, -1.31398129, -0.65237506, 0.44979253, 0.09329471, 1.06427764, 0.44931727, 0.35209299, 0.35885106, 0.76910627, -1.06751773, -0.87780018, -0.72838127, 0.01398158, -0.66760187, 0.38354874, 0.90765758, 0.54995534, -1.82158927, -0.84665051, 1.41485362, 0.20534405, -0.78586975, -0.75601187, 1.78271281, -0.13753841, 0.38983535, -0.63615463, -0.6948763, 0.75618016, -1.26441318, 1.13034315, -1.09471196, -0.50284076, -0.6451668, -1.16220905, 1.11388721, -0.30927062, 1.65972238, -0.66007671, 0.23454014, -0.13631757, 0.13627083, -1.07727314, -0.50684795, -1.18287094, -0.40616086, -0.20126522, 0.16991968, 0.50217944, 0.1961915, 0.42198197, -0.92393261, 0.50688396, -0.16413714, -0.09814521, 2.68492743, -1.42601875, 0.52994631, -0.36144077, 0.52451237, -0.36552118, -0.79249003, 0.02199418, 0.56084089, 0.73804126, -0.445993, -1.40333584, 0.29517069, 0.08607819, 0.22432609, -0.22094706, -0.40955473, 0.7872725, 1.01902084, 1.15957053, 0.51434086, 0.84529203, 0.39028861, 0.12781729, -1.41811562, 0.57603583, 1.720511, -0.89654866, -0.32903768, -1.86364959, -0.61600145, 0.68426517, 1.25732209, 0.07710798, 0.85927664, -0.51732527, -0.46382923, 0.33701252]);
  const b1 = new Float64Array([-0.04501977, -0.06786464, 0.38517503, -2.00965485, -1.36006197, -0.90984871, -0.23903812, 1.69543252, 1.76357497, 0.17895431, 0.8791027, 1.19681084, -0.48453938, 0.0806035, -0.71477135, -0.60765939, 0.05872659, -0.17883368, 0.40503165, 1.20432928, 0.91815939, -0.7164548, 0.33941502, -1.29564506]);
  const W2 = new Float64Array([-0.36203105, 1.11444042, 0.28920704, -0.22715359, 0.00270962, 1.45586036, -0.77075687, 0.89857848, -1.46352403, 0.73593244, -0.81715742, 1.61900263, 0.57722728, 0.83162681, -0.73321608, 0.97808978, 1.11773662, 0.32548796, -0.39462803, -0.73667914, -0.59607671, -0.24226012, 0.25649527, -1.34262486, 0.03283518, -1.09171208, -1.88656586, 1.70260708, 0.58504755, -0.53323236, -2.04806689, -0.09521885, -0.30769222, -0.31355321, -1.8862895, 0.02278435, 0.31846112, 0.29290406, -0.75038541, 0.78915758, -0.55909132, 0.38077086, 1.71739705, -0.5260213, 1.96506615, 1.3470564, 0.2125017, 0.72912708, -1.90630018, 0.07590951, 0.71002739, -0.35346408, -1.05541509, -0.4163805, -0.02324588, 0.54953302, 0.20911513, -1.34690209, -0.48023958, 1.08527773, -1.18666397, 0.31494641, 0.86138801, -1.41629148, -0.05353487, -1.14293593, -0.68753118, -0.39283203, 0.2671172, 1.68963676, -1.08845957, -1.98094739, 0.01075708, 1.65126559, -0.08133203, -0.62815516, -0.31103716, -0.09027343, 0.64940858, 0.28259198, -1.18178605, 0.58665342, -0.57575918, -0.22535738, 1.35507036, 0.9915464, -0.52056709, -0.56266391, -0.40176792, -0.22699788, -0.12676844, 0.11992453, 1.41632987, 1.16211105, -0.50610153, 0.61528053, 0.91356906, -0.3925811, -0.73127091, -0.51968519, 1.1003368, 0.10000301, -1.26137213, 0.34369594, -0.56356163, 0.89075511, -0.0135315, -1.30178842, 1.41087358, -0.68499768, 0.01366404, 0.32507579, -0.09625499, -0.20816465, 0.33347069, 0.8862049, 1.26070943, -0.34157614, 0.81729894, 0.20543872, -0.21103876, 0.98311281, -0.63741953, 0.68976419, -0.19568339, 0.40472257, 0.54309838, -0.51200408, 0.52858669, -0.86846921, 0.99464118, 1.12978822, 1.19455755, -1.22806157, -0.05500492, -0.91016055, -1.65694966, 0.35652601, -0.71897884, -0.36048578, 0.10108922, -0.04715849, -0.3677025, 1.07281849, -1.19431563, 0.26561121, 0.13345755, -0.85930778, 0.02842402, 0.19571137, 0.59756238, 2.41538574, 2.32359599, -0.38358409, -0.21717573, 0.28939673, -0.43117385, 0.61475973, -0.61523519, -0.60340667, 0.29507391, 0.80205183, -1.24594185, 1.04027813, -1.61939228, 1.23979721, -0.28813965, -0.3861148, -0.86221249, -0.2220389, 0.06887766, -0.47672538, -0.43456517, 0.26197367, 0.75568015, -1.7019827, 0.25513592, 0.59381781, -0.7520223, 0.20593254, -1.08012467, 0.16865834, -0.60973157, -0.18826232, 0.5217142, -0.00328153, -0.99608961, 0.205683, 0.39597579, -0.34881315, -0.70503439, 0.26652402, 1.04581803, -1.5241366, -0.9393408, -0.69518474, -0.65903632, -0.96433342, -1.38817449, -0.64982999, 0.86033103, -0.99271215, 0.47439341, -0.57632501, 0.11059336, 0.24997572, -0.09321106, 0.90894957, -0.73228278, 0.37412336, -0.98320035, 1.75183524, -0.88956563, 0.12995636, 0.9505478, 0.11578967, -0.48724716, -0.95717149, -0.62536783, 1.27679098, -1.4419048, -0.20956439, -2.17584731, -0.69319636, 0.37043723, -1.12816826, -1.37334602, -0.82044366, -0.19347451, 0.23088948, 0.80113348, 0.14411953, 1.11029387, -0.51955156, -0.17202987, 0.51053749, 0.85386444, 0.39601311, -0.60352591, 0.11745979, -0.39188141, -0.44682297, 0.65676566, -0.50768162, -0.24124639, -1.15518148, 0.17612402, -0.76767696, -0.11091289, -0.77821176, 0.81234848, 0.37009811, -0.7010621, 0.83902131, 0.12094033, -0.7810462, -0.1332277, -0.03389862, -0.39428638, 1.14337448, 0.33159995, 1.03448594, -0.80235438, 1.24789609, -0.92480733, -1.5242533, -0.08531325, 0.48883467, -0.25473957, 0.06262591, -0.97318266, 0.41024863, -0.30896329, 2.15180933, -0.63072505, -0.39100527, 0.83211227, 1.26026154, -0.6556551, 0.61631494, -0.02888172, -0.09189633, 1.53665684, 0.1575344, 0.95175782, 1.35691282, 0.98454785, -0.1392527, 0.19864182, -1.14189014, -1.63201371, 0.13369249, -0.3291153, 0.40165933, -2.18481807, 0.6504763, -0.81479198, 0.75151765, -0.72908316, 0.29175708, -0.23806541, 0.06329758, -1.00491806, 0.4590159, -0.9329038, -0.43917329, 0.69736697, -0.68497323, 0.13183705, 0.10687794, 1.5750525, -0.59614241, 0.63789167, -0.58595206, -0.05270211, -0.84949346, 1.17826848, 1.32127682, -0.00467535, 1.40060059, 0.757025, 0.09849058, 0.02944816, -0.54012028, -1.40016106, -0.97348785, -0.6733093, -0.26210343, -0.97918476, 0.36894944, 0.9417323, 0.47074119, 0.6202772, -0.09401513, -2.10119479, -0.02145509, -1.42549668, 0.46424606, -0.12488351, 0.3038293, 0.66651838, -0.68854441, 1.6067379, 0.62734875, 1.14394337, -0.24149576, 0.65424192, 1.62719579, 0.97703151, -0.61650132, 0.16990306, 0.73970402, 0.17935936, 1.28145179, 0.71661582, 0.23285912, 0.63221769, 0.57523213, 1.41478324, -0.2802291, 0.32042282, 0.67366042, -0.04906987, 0.61704318, 0.79384694, 1.10959013, -0.36257566, -1.32063167, 0.56139142, 0.2317525, -1.59723844, -1.8584276, 2.56907729, 0.32345626, 0.65911366, -0.70140495, -0.07489592, -1.57833011, 1.06858397, 1.51780039, 0.7346972, 0.32760107, 0.03618043, 0.19593001]);
  const b2 = new Float64Array([0.89567392, 0.39791317, -0.57053053, 0.52263103, -0.54315672, 0.43907682, -1.05207441, -0.38643489, 0.17394048, -0.08847069, 0.8231733, -1.1758024, 0.14474272, -0.06573147, -0.65300272, 0.68912112]);
  const W3 = new Float64Array([-0.73318682, 5.36539283, -3.53490891, 5.90103767, -2.63806588, -0.59232742, 3.27827034, -3.55047722, -1.70372062, -1.53539041, 1.01197529, 0.94308066, 0.06252869, -1.97690767, -2.18696985, 3.80776275, 0.12836789, 5.68714188, -0.18236897, 9.60572463, -0.25151508, 1.25617159, 4.1496217, -1.68856561, -2.38913261, -1.01929024, 0.40192007, 0.98074291, 1.86815676, -0.05416323, 1.61387904, 0.53795982, -0.42596855, 0.62088318, -0.62067109, 2.5158814, -0.78244993, -0.06453228, 1.0634106, 1.84857413, 0.45275362, -2.75462688, 0.27071099, 0.53466477, -4.73197392, -0.49632036, -2.0222201, -1.28468241, -0.84320121, 0.53592403, -0.20404542, 6.07982336, 4.2558285, 2.62141053, 1.39801581, 5.13841093, -1.43188939, 4.51980592, 1.67193398, 0.39944905, 0.51520341, -3.62814928, 0.56838028, -6.17492122, -0.55230076, 7.01651921, -4.25641426, 9.97742156, -5.7867469, -0.23477681, -0.3762071, -1.02097498, -4.50295625, -0.876215, 3.27588154, 2.09851357, -0.90801454, 0.2844138, -0.56385995, 0.77840142]);
  const b3 = new Float64Array([1.0568041, -0.10669929, -0.88836877, -0.03010754, -0.46700424]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.12919988, 0.53839085, -0.1060256, 0.18404706, -1.84451855, -0.2654118, -0.96417753, 0.19694201, -0.1316366, -1.09859573, 0.20089892, 0.4053082, 0.41059322, 0.34122344, -0.33941922, -0.60747516, -0.23366435, 0.3661617, 0.90760967, -0.20897337, 0.95617585, -0.52531092, -1.20260868, 0.25895174, 0.36075162, 0.66167732, 0.46454885, -0.409713, 0.96587258, 0.02635149, 0.67326605, -0.87727076, -1.08249929, 0.0675701, 0.68452451, 1.25444908, -0.36469147, -1.72830683, -0.3522396, -0.13956489, 0.46877731, 0.92153177, 1.20344287, -0.02614582, 0.8410064, 0.06633651, -0.26373905, -0.16140108, -0.35537125, -0.60195755, 0.81694713, -0.62569702, 0.49049964, 1.68547244, -0.61301157, -0.7394573, -1.54993101, 0.92090681, -0.09905171, -1.48434426, 0.06712329, -0.96920817, -0.32909871, -0.51625916, 0.51948175, -1.06373098, -0.94466859, -0.16711838, -1.67841318, -0.57880075, -0.44718282, 0.43136932, 1.09984914, 0.76879281, -0.29231537, -0.34075089, 0.13875126, -0.19083625, -0.58389058, 0.2990573, -0.43515077, 0.44894048, 1.5017857, 1.1124457, -0.02559045, 0.94510429, -0.19926982, -0.59673061, 0.4064476, 1.97965291, -0.523701, -1.10911585, -0.23396502, -0.94437975, 0.8450979, 0.429929, 1.16686847, -1.08792432, 0.18349473, 0.71557004, 1.25494788, -0.30248998, 1.43511725, 0.63203774, -0.31191915, -0.42858654, -0.84111098, -2.00535127, 0.08608713, 0.49598659, 2.07053847, 1.60597759, 0.3366828, -0.22281002, -1.35314547, -0.92101901, -1.16667447, 0.74056623, 0.94773047, -0.92817511, -1.86657268, -0.25997904, -0.77814528, -0.15708403, 0.37996977, -0.52248615, -0.96268558, -0.74393704, -1.04759005, 0.71810873, 0.75010374, 0.07684314, 0.61312677, -1.2752957, 0.07869385, -1.29272587, -0.84614424, 1.79130541, 0.41443751, -0.34436736, 0.85821302, -1.28706709, -1.57946258, 0.86588403, 0.34407335, -0.49242266, 1.61308089, -0.80075512, 1.00867526, -1.07276262, -0.19937004, 0.11348028, -1.04952927, -0.26357263, 0.502315, -0.32899089, 0.62314725, -0.82493827, -0.34373542, -0.41511676, -0.30028973, -0.14974018, 0.89107496, -0.2066916, 0.20511613, -2.26749236, -0.08907113, -1.46868928, -0.06046051, -0.20222232, 0.30067437, 0.90743619, 0.40532131, 0.18604324, -0.11580713, -0.48562792, -0.01031199, -0.77580853, 0.66895244, -0.45807735, 0.19890305, 1.04423572, 0.47897106, -0.44629131, 0.16680932, -0.39576426, -0.18037069, -0.43067111, -1.16346728, -0.5143305, 1.08291031, 0.27520681, -0.57399016, -0.69634947, -0.49470007, -0.23408483, 1.30774803, -1.24674451, 0.18855524, -0.61607742, -1.22255446, 1.71805393, -0.083574, 0.6934223, -1.8481099, -0.27376993, -1.17454895, 0.14272256, 0.11276265, 0.3157888, 0.94116905, 1.18179326, 0.80811847, -0.21125064, 0.29018061, 1.28514364, -0.57728162, -0.37644024, -0.85508952, 0.39502617, -0.16487126, -0.55399526, -0.93944557, 0.22304983, -0.40875941, 0.51243544, -0.26842774, -0.08311363, 0.42731917, 0.3331231, -1.49283208, 1.65904085, -0.63747887, -0.08686399, -0.21013847, 1.86649012, -1.10214724, 0.0265192, -0.26370607, -2.08958289, 0.14572481, -2.7562922, -1.63838789, -1.02839787, 0.436912, -0.77784546, -0.38244757, -1.50218174, -0.87980013, 0.6204392, -0.18685724, -0.25550805, 0.06538993, -1.88552871, 0.37356024, -1.07630368, -1.85175301, -0.12844573, -0.84957873, 0.19531525, -0.56409773, 0.11771226, 1.26912131, -0.42566036, -0.64689513, 0.32324206, -0.01811351, -0.4675068, 1.49441298, -2.40135195, -0.7709642, -0.07333278, -0.22380423, -1.23415325, -0.20548278, -0.40844235, 0.28129554, -0.05594934, -1.51964944, -0.86522298, -1.67468189, -1.27298165, 0.56246491, -0.7119768, -0.70566282, -0.15246681, -0.41107516, 0.63565999, -0.2236744, 0.94818793, 0.09433935, -0.40463127, -0.13317247, -0.48678278, 0.90130134, -0.49479485, 0.55181518, -0.72544249, 0.34669671, -0.21822634, 0.72478334, -0.00015779, 0.09494694, -1.33637406, 0.65897185, 0.37715712, -1.94359733, -0.15333243, 0.38681636, 0.99755587, -0.77918575, -0.88368053, 0.56937193, 1.0986412, -0.0063286, -1.19481331, 0.40327863, 1.74304513, -0.29062309, -0.12046315, -0.40488974, 0.06733586, -0.5864114, -0.03977954, -0.53943196, -0.93268546, 0.72747257, -0.50341872, -0.32455451, -0.19119688, 1.26203, 1.32115231, 0.58004996, 1.24379026, -0.09752867, 0.95456556, 1.01712524, 0.32199711, -1.67299999, -0.1203608, 1.43034142, -0.00249132, 0.07435869, 0.62077547, -0.5272084, 2.59266289, -0.14530446, 0.97571757, 0.95104164, -0.49587531, 1.12296808, 0.37678994, -0.32438995, -1.61782993, -0.49110977, 0.48054622, -0.57305494, 0.73637119, 0.59996627, -0.62513343, -0.93888143, 0.13973976, -0.93924959, -0.15394797, 0.86709815, -0.88680711, 0.42357626, 0.80393412, -0.63971255, -1.67282706, 0.33781738, 1.45378643, -1.07606707, 1.25920057, -0.1016934, -0.19269155, 0.98838125, 0.14495898, -0.89328348, 1.0522509, 0.50623302, 0.42726883, -0.68869639, -0.44018062, 1.84150782, -0.59408578, 0.34331978, -0.39553807, -0.9511237, 0.19410909, 1.44209698, -1.04005444, 2.00103385, -0.61206814, 0.3017591, -0.30243556, -0.20696573, -0.90748117, 1.17969408, 1.02747861, -0.50807734, -0.54017285, 3.35569838, -0.29054497, 1.35453779, -0.83753321, -1.07840614, 0.41798364, 0.66156192, 1.42321578, 0.3400416, -1.15941756, -0.47172295, -0.33638498, 0.69234623, -1.00583168, -0.66125072, 0.59734064, -0.109898, 0.64953168, 0.74382221, 0.56988032, -1.7669224, 0.03985264, -0.8884815, -1.8871374, 0.30804287, 1.047233, -0.00242477, -0.48541024, 2.0123724, 1.66439548, 0.10256516, 0.86625983, 0.69709549, 0.28621121, -0.93705224, 0.46101749, 0.42302368, -2.34677794, -1.34523253, -0.85369879, -0.85019653, 1.05960297, -0.35259578, 0.20540335, -0.01254739, 0.74453087, -1.00579491, 0.50553924, 0.20173546, 0.84004475, 0.94619881, 0.81654418, -2.3631754, -0.95024623, -0.12798009, 0.26052984, 0.12221493, 1.98934866, 0.06134287, -1.23755948, -1.55221303, 0.86905162, -0.33574497, -0.785917, 1.79821277, 1.99543148, -0.59893392, -0.72924345, 0.72594461, 0.88571702, -0.80652723, -0.18328393, 0.19164536, 0.39070334, -1.28511416, -1.48279908, 0.2255184, -0.02850824, -0.83065691, -0.92983366, 0.51613866, -0.51841491, 1.21304059, 1.19434286, -0.23825356, -0.78336346, -0.96941738, -1.01372181, 0.25071878, -0.81270147, 0.41247486, 0.04840887, -0.59708023, -1.70989936, -1.31540066, 0.43707815, 0.15903183, -0.65557914, 0.35488817, 0.30326477, 0.01417764, 1.78043017, -0.2347309, -0.00977352, -0.1452394, -0.31506725, 0.29124182, -0.56487455, 1.13568681, 0.60135936, 0.52472101, -0.96473102, -0.03204886, -0.74985515, 2.24862799, -0.47025752, -1.04800781, 1.06676979, -1.3332727, -1.10347546, 0.90924515, -0.9259584, 0.20510289, 1.8890085, -1.00018466, 0.32846825, -0.04377756, 0.1494981, -1.07726775, -2.00005095, -0.45746394, -0.88477777, 0.10832786, -0.96356527, -0.40846596, -1.22084067, -0.53498869, -0.60472866, -1.06906236, 1.43677127, 1.45554181, -0.29889496, -0.36577127, 0.62508352, 0.11447551, 0.7359401, -1.8138315, -1.38096985, -0.15439718, 0.49077554, 0.4435932, 0.11377517, 0.76599221, -0.61566495, 0.64040563, -0.41730931, -1.1750121, 1.12287294, -0.11695974, -0.79565246, 0.2371364, -0.6538574, -0.09239033, -0.35505938, -0.28133177, -0.76474658, -0.45523695, 0.05232185, -1.71427051, 0.70795835, 0.18788025, 0.1402817, -0.04253285, 0.48357989, -0.158762, 1.17951548, -0.8978362, -0.85566158, -0.05257799, 0.24895868, 0.16921378, -1.63488851, 2.69739057, -1.08452608, -0.54310743, 1.17133811, 1.44753404, 0.73664336, 0.06618319, -1.27041004, -1.44055942, -1.34714651, 0.22980032, 1.36565427, -0.89843346, -1.03469148, -0.5260749, -1.04141253, -2.58715189, -0.64862805, -2.4605015, 0.11164159, -1.98578827, -0.27168584, 0.76134712, -1.10234866, -1.26393187, -1.52201238, 1.92762706, 1.10086773, -0.29592203, 2.11028315, -0.73080732, -0.04952872, -0.13164604, 0.10436002, -0.4000255, 0.53312037, 0.33993857, 0.11626446, -0.38118197, 0.58863583, -0.43186347, 0.31776474, -1.49902242, 1.60618544, -0.26328119, 0.26105919, 1.08501939, -0.35544076, 0.231896, 0.69482221, -1.22858108, 1.76838236, 0.73305912, 1.1790418, 0.62004608, 0.83813702, -0.26037864, 0.74914484, -0.63434351, 1.16884393, -0.0964325, -0.21480496, 0.01332289, -1.26518912, 1.27050124, -0.69882411, -0.30036408, -0.56293061, 0.96131736, 0.85847888, -0.49317113, 1.51356688, 0.30091364, 1.13406852, 0.28256426, 0.06035321, 0.1246994, 0.369739, -1.28718044, -0.13159744, -0.52333476, -0.5361268, 0.64545506, 0.00684978, 0.06517127, -0.95655232, 0.54314332, 0.29707475, -0.24562592, 0.87235749, -1.07324121, 0.37826216, -1.14956194, 1.09818573, 0.6534194, -0.50697356, -0.16812413, -0.53556594, -0.35089977, -0.74195996, 0.40828665, 0.50061713, 0.31316687, -0.46757834, 0.74137266, 0.20571767, -1.47991406, 0.7365356, -0.22475025, -0.1339124, -0.24707552, -0.56605377, 1.47341579, 0.96407278, -0.4733757, -1.2013399, -0.05409567, -1.21358051, 0.23097913, -0.19379787, 0.1235754, 0.3835123, -0.37517917, -0.57059294, 0.71343865, -2.03077904, 0.46847596, -2.07172929, -0.1607105, -0.51679746, 0.03041401, -0.89220986, 0.21591287, -0.53424826, -0.20974912, -0.45488571, -0.16682064, 0.99676333, 0.36898972, -1.49944444, 1.26609206, -0.70696238, -1.44257274, -0.21845022, -0.142134, 0.05221587, 0.65404742, -1.19063154, 0.49702661, 0.27069621, -0.85208763, -0.09702888, -0.07301064, -0.23345152, 0.75322569, 1.19079231, -1.0815044, 0.81294245, -1.96665349, 0.31214446, 0.48393353, -0.68575822, 0.0471126, -1.17653192, -0.38780267, 0.21730394, -0.25193044, -0.87854116, 0.11271054, 1.22551277, 0.12495602, -1.08127796, -0.04506021, 1.30313618, -0.3125118, 0.34883724, 0.613603, -0.18576361, 0.68378918, -0.01534037, -1.06491078, -0.21837704, -0.33104125, -0.18588764, 0.0743747, 0.01562586, 0.44475956, -0.0665213, -0.14246049, -0.60873583, -1.73718055, 1.48320477, -0.37992238, 0.34982873, -0.84814653, -1.30667908, 0.64669505, -0.65278273, -0.29838735, -1.05872409, 0.00374465, 2.05352248, -0.71038278, 0.2053318, -1.54485771, -1.29339939, -0.25405769, -1.12565931, -0.1187875, -0.67166574, 0.42216063, 0.59332394, -0.49864246, 0.83970167, -0.71347409, 0.91632027, -0.15507512, 0.68759454, -1.29473366, 0.90841905, 0.14119616, 0.77744963, 0.25503965, -1.28097013, 0.44068451, 0.42463812, -1.22785289, -0.10194648, -1.12285549, 0.07192283, 0.75228205, 1.11411685, 0.27309675, -1.69726223, -0.40578211, -0.4449591, 0.1075989, 0.75152201, 0.42388041, 1.9716984, -0.85843986, 1.24664224, -0.7261308, 1.90043606, 0.6662498, -0.18650988, -0.41438609, -0.43799568, -0.20897853, -0.81612777, -0.84858067, -0.67087688, 2.31564426, -1.62657933, 0.23637944, 0.10345757, -0.07180217, -1.21673319, 0.55898607, 0.93956284, -0.86467198, -0.49894881, 0.89546923, 1.59090759, 0.60650188, 1.68495406, 0.01383839, -0.97293602, 0.35029413, 0.92358284, -0.29211078, -1.78971208, -1.08552769, 1.18669008, -0.28002439, 0.27405075, 0.0694624, -0.68740036, -0.4378249, 0.24358519, -0.83461123, 1.35030876, -0.23716267, -0.2452278, 0.34070813, -0.86693761, 1.48266399, 0.3284211, -0.7516317, 0.31527463, 0.17078875, -0.89807427, -1.14187877, -1.60856579, -0.2829414, 1.1932368, 0.10428649, -1.24914791, -0.31067368, -0.98027293, 0.18272194, -0.16717895, -1.58394599, -0.08220539, 0.3796718, 0.94435941, 0.09364688, -0.26796703, -0.98677443, -0.57043364, -0.13938946, -1.39233404, -0.51054892, -1.34285342, 0.89913058, -0.24026141, -0.26748228, 1.23028654, 0.80222044, -0.62086781, -1.05725053, 0.75431359, -1.3571881, -0.19296285, 0.67547503, -2.16736668, 0.02298493, 0.77733993, 1.07596213, -0.90262257, 0.52154025, 0.23264912, 0.43299946, 1.08888254, 0.70700848, -0.32155372, 0.97833133, 0.19432768, 1.03326106, -0.48738812, -0.51644813, 0.65837451, -0.01592093, 0.88540515, 1.52966435, -0.34930729, -0.93960365, -0.99854216, -0.51736691, -0.02839116, 0.02431064, 1.07381558, 0.01513503, -0.37656687, 0.31340886, -1.31398129, -0.65237506, 0.44979253, 0.09329471, 1.06427764, 0.44931727, 0.35209299, 0.35885106, 0.76910627, -1.06751773, -0.87780018, -0.72838127, 0.01398158, -0.66760187, 0.38354874, 0.90765758, 0.54995534, -1.82158927, -0.84665051, 1.41485362, 0.20534405, -0.78586975, -0.75601187, 1.78271281, -0.13753841, 0.38983535, -0.63615463, -0.6948763, 0.75618016, -1.26441318, 1.13034315, -1.09471196, -0.50284076, -0.6451668, -1.16220905, 1.11388721, -0.30927062, 1.65972238, -0.66007671, 0.23454014, -0.13631757, 0.13627083, -1.07727314, -0.50684795, -1.18287094, -0.40616086, -0.20126522, 0.16991968, 0.50217944, 0.1961915, 0.42198197, -0.92393261, 0.50688396, -0.16413714, -0.09814521, 2.68492743, -1.42601875, 0.52994631, -0.36144077, 0.52451237, -0.36552118, -0.79249003, 0.02199418, 0.56084089, 0.73804126, -0.445993, -1.40333584, 0.29517069, 0.08607819, 0.22432609, -0.22094706, -0.40955473, 0.7872725, 1.01902084, 1.15957053, 0.51434086, 0.84529203, 0.39028861, 0.12781729, -1.41811562, 0.57603583, 1.720511, -0.89654866, -0.32903768, -1.86364959, -0.61600145, 0.68426517, 1.25732209, 0.07710798, 0.85927664, -0.51732527, -0.46382923, 0.33701252]);
  const b1 = new Float64Array([-0.04501977, -0.06786464, 0.38517503, -2.00965485, -1.36006197, -0.90984871, -0.23903812, 1.69543252, 1.76357497, 0.17895431, 0.8791027, 1.19681084, -0.48453938, 0.0806035, -0.71477135, -0.60765939, 0.05872659, -0.17883368, 0.40503165, 1.20432928, 0.91815939, -0.7164548, 0.33941502, -1.29564506]);
  const W2 = new Float64Array([-0.36203105, 1.11444042, 0.28920704, -0.22715359, 0.00270962, 1.45586036, -0.77075687, 0.89857848, -1.46352403, 0.73593244, -0.81715742, 1.61900263, 0.57722728, 0.83162681, -0.73321608, 0.97808978, 1.11773662, 0.32548796, -0.39462803, -0.73667914, -0.59607671, -0.24226012, 0.25649527, -1.34262486, 0.03283518, -1.09171208, -1.88656586, 1.70260708, 0.58504755, -0.53323236, -2.04806689, -0.09521885, -0.30769222, -0.31355321, -1.8862895, 0.02278435, 0.31846112, 0.29290406, -0.75038541, 0.78915758, -0.55909132, 0.38077086, 1.71739705, -0.5260213, 1.96506615, 1.3470564, 0.2125017, 0.72912708, -1.90630018, 0.07590951, 0.71002739, -0.35346408, -1.05541509, -0.4163805, -0.02324588, 0.54953302, 0.20911513, -1.34690209, -0.48023958, 1.08527773, -1.18666397, 0.31494641, 0.86138801, -1.41629148, -0.05353487, -1.14293593, -0.68753118, -0.39283203, 0.2671172, 1.68963676, -1.08845957, -1.98094739, 0.01075708, 1.65126559, -0.08133203, -0.62815516, -0.31103716, -0.09027343, 0.64940858, 0.28259198, -1.18178605, 0.58665342, -0.57575918, -0.22535738, 1.35507036, 0.9915464, -0.52056709, -0.56266391, -0.40176792, -0.22699788, -0.12676844, 0.11992453, 1.41632987, 1.16211105, -0.50610153, 0.61528053, 0.91356906, -0.3925811, -0.73127091, -0.51968519, 1.1003368, 0.10000301, -1.26137213, 0.34369594, -0.56356163, 0.89075511, -0.0135315, -1.30178842, 1.41087358, -0.68499768, 0.01366404, 0.32507579, -0.09625499, -0.20816465, 0.33347069, 0.8862049, 1.26070943, -0.34157614, 0.81729894, 0.20543872, -0.21103876, 0.98311281, -0.63741953, 0.68976419, -0.19568339, 0.40472257, 0.54309838, -0.51200408, 0.52858669, -0.86846921, 0.99464118, 1.12978822, 1.19455755, -1.22806157, -0.05500492, -0.91016055, -1.65694966, 0.35652601, -0.71897884, -0.36048578, 0.10108922, -0.04715849, -0.3677025, 1.07281849, -1.19431563, 0.26561121, 0.13345755, -0.85930778, 0.02842402, 0.19571137, 0.59756238, 2.41538574, 2.32359599, -0.38358409, -0.21717573, 0.28939673, -0.43117385, 0.61475973, -0.61523519, -0.60340667, 0.29507391, 0.80205183, -1.24594185, 1.04027813, -1.61939228, 1.23979721, -0.28813965, -0.3861148, -0.86221249, -0.2220389, 0.06887766, -0.47672538, -0.43456517, 0.26197367, 0.75568015, -1.7019827, 0.25513592, 0.59381781, -0.7520223, 0.20593254, -1.08012467, 0.16865834, -0.60973157, -0.18826232, 0.5217142, -0.00328153, -0.99608961, 0.205683, 0.39597579, -0.34881315, -0.70503439, 0.26652402, 1.04581803, -1.5241366, -0.9393408, -0.69518474, -0.65903632, -0.96433342, -1.38817449, -0.64982999, 0.86033103, -0.99271215, 0.47439341, -0.57632501, 0.11059336, 0.24997572, -0.09321106, 0.90894957, -0.73228278, 0.37412336, -0.98320035, 1.75183524, -0.88956563, 0.12995636, 0.9505478, 0.11578967, -0.48724716, -0.95717149, -0.62536783, 1.27679098, -1.4419048, -0.20956439, -2.17584731, -0.69319636, 0.37043723, -1.12816826, -1.37334602, -0.82044366, -0.19347451, 0.23088948, 0.80113348, 0.14411953, 1.11029387, -0.51955156, -0.17202987, 0.51053749, 0.85386444, 0.39601311, -0.60352591, 0.11745979, -0.39188141, -0.44682297, 0.65676566, -0.50768162, -0.24124639, -1.15518148, 0.17612402, -0.76767696, -0.11091289, -0.77821176, 0.81234848, 0.37009811, -0.7010621, 0.83902131, 0.12094033, -0.7810462, -0.1332277, -0.03389862, -0.39428638, 1.14337448, 0.33159995, 1.03448594, -0.80235438, 1.24789609, -0.92480733, -1.5242533, -0.08531325, 0.48883467, -0.25473957, 0.06262591, -0.97318266, 0.41024863, -0.30896329, 2.15180933, -0.63072505, -0.39100527, 0.83211227, 1.26026154, -0.6556551, 0.61631494, -0.02888172, -0.09189633, 1.53665684, 0.1575344, 0.95175782, 1.35691282, 0.98454785, -0.1392527, 0.19864182, -1.14189014, -1.63201371, 0.13369249, -0.3291153, 0.40165933, -2.18481807, 0.6504763, -0.81479198, 0.75151765, -0.72908316, 0.29175708, -0.23806541, 0.06329758, -1.00491806, 0.4590159, -0.9329038, -0.43917329, 0.69736697, -0.68497323, 0.13183705, 0.10687794, 1.5750525, -0.59614241, 0.63789167, -0.58595206, -0.05270211, -0.84949346, 1.17826848, 1.32127682, -0.00467535, 1.40060059, 0.757025, 0.09849058, 0.02944816, -0.54012028, -1.40016106, -0.97348785, -0.6733093, -0.26210343, -0.97918476, 0.36894944, 0.9417323, 0.47074119, 0.6202772, -0.09401513, -2.10119479, -0.02145509, -1.42549668, 0.46424606, -0.12488351, 0.3038293, 0.66651838, -0.68854441, 1.6067379, 0.62734875, 1.14394337, -0.24149576, 0.65424192, 1.62719579, 0.97703151, -0.61650132, 0.16990306, 0.73970402, 0.17935936, 1.28145179, 0.71661582, 0.23285912, 0.63221769, 0.57523213, 1.41478324, -0.2802291, 0.32042282, 0.67366042, -0.04906987, 0.61704318, 0.79384694, 1.10959013, -0.36257566, -1.32063167, 0.56139142, 0.2317525, -1.59723844, -1.8584276, 2.56907729, 0.32345626, 0.65911366, -0.70140495, -0.07489592, -1.57833011, 1.06858397, 1.51780039, 0.7346972, 0.32760107, 0.03618043, 0.19593001]);
  const b2 = new Float64Array([0.89567392, 0.39791317, -0.57053053, 0.52263103, -0.54315672, 0.43907682, -1.05207441, -0.38643489, 0.17394048, -0.08847069, 0.8231733, -1.1758024, 0.14474272, -0.06573147, -0.65300272, 0.68912112]);
  const W3 = new Float64Array([-0.73318682, 5.36539283, -3.53490891, 5.90103767, -2.63806588, -0.59232742, 3.27827034, -3.55047722, -1.70372062, -1.53539041, 1.01197529, 0.94308066, 0.06252869, -1.97690767, -2.18696985, 3.80776275, 0.12836789, 5.68714188, -0.18236897, 9.60572463, -0.25151508, 1.25617159, 4.1496217, -1.68856561, -2.38913261, -1.01929024, 0.40192007, 0.98074291, 1.86815676, -0.05416323, 1.61387904, 0.53795982, -0.42596855, 0.62088318, -0.62067109, 2.5158814, -0.78244993, -0.06453228, 1.0634106, 1.84857413, 0.45275362, -2.75462688, 0.27071099, 0.53466477, -4.73197392, -0.49632036, -2.0222201, -1.28468241, -0.84320121, 0.53592403, -0.20404542, 6.07982336, 4.2558285, 2.62141053, 1.39801581, 5.13841093, -1.43188939, 4.51980592, 1.67193398, 0.39944905, 0.51520341, -3.62814928, 0.56838028, -6.17492122, -0.55230076, 7.01651921, -4.25641426, 9.97742156, -5.7867469, -0.23477681, -0.3762071, -1.02097498, -4.50295625, -0.876215, 3.27588154, 2.09851357, -0.90801454, 0.2844138, -0.56385995, 0.77840142]);
  const b3 = new Float64Array([1.0568041, -0.10669929, -0.88836877, -0.03010754, -0.46700424]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.12919988, 0.53839085, -0.1060256, 0.18404706, -1.84451855, -0.2654118, -0.96417753, 0.19694201, -0.1316366, -1.09859573, 0.20089892, 0.4053082, 0.41059322, 0.34122344, -0.33941922, -0.60747516, -0.23366435, 0.3661617, 0.90760967, -0.20897337, 0.95617585, -0.52531092, -1.20260868, 0.25895174, 0.36075162, 0.66167732, 0.46454885, -0.409713, 0.96587258, 0.02635149, 0.67326605, -0.87727076, -1.08249929, 0.0675701, 0.68452451, 1.25444908, -0.36469147, -1.72830683, -0.3522396, -0.13956489, 0.46877731, 0.92153177, 1.20344287, -0.02614582, 0.8410064, 0.06633651, -0.26373905, -0.16140108, -0.35537125, -0.60195755, 0.81694713, -0.62569702, 0.49049964, 1.68547244, -0.61301157, -0.7394573, -1.54993101, 0.92090681, -0.09905171, -1.48434426, 0.06712329, -0.96920817, -0.32909871, -0.51625916, 0.51948175, -1.06373098, -0.94466859, -0.16711838, -1.67841318, -0.57880075, -0.44718282, 0.43136932, 1.09984914, 0.76879281, -0.29231537, -0.34075089, 0.13875126, -0.19083625, -0.58389058, 0.2990573, -0.43515077, 0.44894048, 1.5017857, 1.1124457, -0.02559045, 0.94510429, -0.19926982, -0.59673061, 0.4064476, 1.97965291, -0.523701, -1.10911585, -0.23396502, -0.94437975, 0.8450979, 0.429929, 1.16686847, -1.08792432, 0.18349473, 0.71557004, 1.25494788, -0.30248998, 1.43511725, 0.63203774, -0.31191915, -0.42858654, -0.84111098, -2.00535127, 0.08608713, 0.49598659, 2.07053847, 1.60597759, 0.3366828, -0.22281002, -1.35314547, -0.92101901, -1.16667447, 0.74056623, 0.94773047, -0.92817511, -1.86657268, -0.25997904, -0.77814528, -0.15708403, 0.37996977, -0.52248615, -0.96268558, -0.74393704, -1.04759005, 0.71810873, 0.75010374, 0.07684314, 0.61312677, -1.2752957, 0.07869385, -1.29272587, -0.84614424, 1.79130541, 0.41443751, -0.34436736, 0.85821302, -1.28706709, -1.57946258, 0.86588403, 0.34407335, -0.49242266, 1.61308089, -0.80075512, 1.00867526, -1.07276262, -0.19937004, 0.11348028, -1.04952927, -0.26357263, 0.502315, -0.32899089, 0.62314725, -0.82493827, -0.34373542, -0.41511676, -0.30028973, -0.14974018, 0.89107496, -0.2066916, 0.20511613, -2.26749236, -0.08907113, -1.46868928, -0.06046051, -0.20222232, 0.30067437, 0.90743619, 0.40532131, 0.18604324, -0.11580713, -0.48562792, -0.01031199, -0.77580853, 0.66895244, -0.45807735, 0.19890305, 1.04423572, 0.47897106, -0.44629131, 0.16680932, -0.39576426, -0.18037069, -0.43067111, -1.16346728, -0.5143305, 1.08291031, 0.27520681, -0.57399016, -0.69634947, -0.49470007, -0.23408483, 1.30774803, -1.24674451, 0.18855524, -0.61607742, -1.22255446, 1.71805393, -0.083574, 0.6934223, -1.8481099, -0.27376993, -1.17454895, 0.14272256, 0.11276265, 0.3157888, 0.94116905, 1.18179326, 0.80811847, -0.21125064, 0.29018061, 1.28514364, -0.57728162, -0.37644024, -0.85508952, 0.39502617, -0.16487126, -0.55399526, -0.93944557, 0.22304983, -0.40875941, 0.51243544, -0.26842774, -0.08311363, 0.42731917, 0.3331231, -1.49283208, 1.65904085, -0.63747887, -0.08686399, -0.21013847, 1.86649012, -1.10214724, 0.0265192, -0.26370607, -2.08958289, 0.14572481, -2.7562922, -1.63838789, -1.02839787, 0.436912, -0.77784546, -0.38244757, -1.50218174, -0.87980013, 0.6204392, -0.18685724, -0.25550805, 0.06538993, -1.88552871, 0.37356024, -1.07630368, -1.85175301, -0.12844573, -0.84957873, 0.19531525, -0.56409773, 0.11771226, 1.26912131, -0.42566036, -0.64689513, 0.32324206, -0.01811351, -0.4675068, 1.49441298, -2.40135195, -0.7709642, -0.07333278, -0.22380423, -1.23415325, -0.20548278, -0.40844235, 0.28129554, -0.05594934, -1.51964944, -0.86522298, -1.67468189, -1.27298165, 0.56246491, -0.7119768, -0.70566282, -0.15246681, -0.41107516, 0.63565999, -0.2236744, 0.94818793, 0.09433935, -0.40463127, -0.13317247, -0.48678278, 0.90130134, -0.49479485, 0.55181518, -0.72544249, 0.34669671, -0.21822634, 0.72478334, -0.00015779, 0.09494694, -1.33637406, 0.65897185, 0.37715712, -1.94359733, -0.15333243, 0.38681636, 0.99755587, -0.77918575, -0.88368053, 0.56937193, 1.0986412, -0.0063286, -1.19481331, 0.40327863, 1.74304513, -0.29062309, -0.12046315, -0.40488974, 0.06733586, -0.5864114, -0.03977954, -0.53943196, -0.93268546, 0.72747257, -0.50341872, -0.32455451, -0.19119688, 1.26203, 1.32115231, 0.58004996, 1.24379026, -0.09752867, 0.95456556, 1.01712524, 0.32199711, -1.67299999, -0.1203608, 1.43034142, -0.00249132, 0.07435869, 0.62077547, -0.5272084, 2.59266289, -0.14530446, 0.97571757, 0.95104164, -0.49587531, 1.12296808, 0.37678994, -0.32438995, -1.61782993, -0.49110977, 0.48054622, -0.57305494, 0.73637119, 0.59996627, -0.62513343, -0.93888143, 0.13973976, -0.93924959, -0.15394797, 0.86709815, -0.88680711, 0.42357626, 0.80393412, -0.63971255, -1.67282706, 0.33781738, 1.45378643, -1.07606707, 1.25920057, -0.1016934, -0.19269155, 0.98838125, 0.14495898, -0.89328348, 1.0522509, 0.50623302, 0.42726883, -0.68869639, -0.44018062, 1.84150782, -0.59408578, 0.34331978, -0.39553807, -0.9511237, 0.19410909, 1.44209698, -1.04005444, 2.00103385, -0.61206814, 0.3017591, -0.30243556, -0.20696573, -0.90748117, 1.17969408, 1.02747861, -0.50807734, -0.54017285, 3.35569838, -0.29054497, 1.35453779, -0.83753321, -1.07840614, 0.41798364, 0.66156192, 1.42321578, 0.3400416, -1.15941756, -0.47172295, -0.33638498, 0.69234623, -1.00583168, -0.66125072, 0.59734064, -0.109898, 0.64953168, 0.74382221, 0.56988032, -1.7669224, 0.03985264, -0.8884815, -1.8871374, 0.30804287, 1.047233, -0.00242477, -0.48541024, 2.0123724, 1.66439548, 0.10256516, 0.86625983, 0.69709549, 0.28621121, -0.93705224, 0.46101749, 0.42302368, -2.34677794, -1.34523253, -0.85369879, -0.85019653, 1.05960297, -0.35259578, 0.20540335, -0.01254739, 0.74453087, -1.00579491, 0.50553924, 0.20173546, 0.84004475, 0.94619881, 0.81654418, -2.3631754, -0.95024623, -0.12798009, 0.26052984, 0.12221493, 1.98934866, 0.06134287, -1.23755948, -1.55221303, 0.86905162, -0.33574497, -0.785917, 1.79821277, 1.99543148, -0.59893392, -0.72924345, 0.72594461, 0.88571702, -0.80652723, -0.18328393, 0.19164536, 0.39070334, -1.28511416, -1.48279908, 0.2255184, -0.02850824, -0.83065691, -0.92983366, 0.51613866, -0.51841491, 1.21304059, 1.19434286, -0.23825356, -0.78336346, -0.96941738, -1.01372181, 0.25071878, -0.81270147, 0.41247486, 0.04840887, -0.59708023, -1.70989936, -1.31540066, 0.43707815, 0.15903183, -0.65557914, 0.35488817, 0.30326477, 0.01417764, 1.78043017, -0.2347309, -0.00977352, -0.1452394, -0.31506725, 0.29124182, -0.56487455, 1.13568681, 0.60135936, 0.52472101, -0.96473102, -0.03204886, -0.74985515, 2.24862799, -0.47025752, -1.04800781, 1.06676979, -1.3332727, -1.10347546, 0.90924515, -0.9259584, 0.20510289, 1.8890085, -1.00018466, 0.32846825, -0.04377756, 0.1494981, -1.07726775, -2.00005095, -0.45746394, -0.88477777, 0.10832786, -0.96356527, -0.40846596, -1.22084067, -0.53498869, -0.60472866, -1.06906236, 1.43677127, 1.45554181, -0.29889496, -0.36577127, 0.62508352, 0.11447551, 0.7359401, -1.8138315, -1.38096985, -0.15439718, 0.49077554, 0.4435932, 0.11377517, 0.76599221, -0.61566495, 0.64040563, -0.41730931, -1.1750121, 1.12287294, -0.11695974, -0.79565246, 0.2371364, -0.6538574, -0.09239033, -0.35505938, -0.28133177, -0.76474658, -0.45523695, 0.05232185, -1.71427051, 0.70795835, 0.18788025, 0.1402817, -0.04253285, 0.48357989, -0.158762, 1.17951548, -0.8978362, -0.85566158, -0.05257799, 0.24895868, 0.16921378, -1.63488851, 2.69739057, -1.08452608, -0.54310743, 1.17133811, 1.44753404, 0.73664336, 0.06618319, -1.27041004, -1.44055942, -1.34714651, 0.22980032, 1.36565427, -0.89843346, -1.03469148, -0.5260749, -1.04141253, -2.58715189, -0.64862805, -2.4605015, 0.11164159, -1.98578827, -0.27168584, 0.76134712, -1.10234866, -1.26393187, -1.52201238, 1.92762706, 1.10086773, -0.29592203, 2.11028315, -0.73080732, -0.04952872, -0.13164604, 0.10436002, -0.4000255, 0.53312037, 0.33993857, 0.11626446, -0.38118197, 0.58863583, -0.43186347, 0.31776474, -1.49902242, 1.60618544, -0.26328119, 0.26105919, 1.08501939, -0.35544076, 0.231896, 0.69482221, -1.22858108, 1.76838236, 0.73305912, 1.1790418, 0.62004608, 0.83813702, -0.26037864, 0.74914484, -0.63434351, 1.16884393, -0.0964325, -0.21480496, 0.01332289, -1.26518912, 1.27050124, -0.69882411, -0.30036408, -0.56293061, 0.96131736, 0.85847888, -0.49317113, 1.51356688, 0.30091364, 1.13406852, 0.28256426, 0.06035321, 0.1246994, 0.369739, -1.28718044, -0.13159744, -0.52333476, -0.5361268, 0.64545506, 0.00684978, 0.06517127, -0.95655232, 0.54314332, 0.29707475, -0.24562592, 0.87235749, -1.07324121, 0.37826216, -1.14956194, 1.09818573, 0.6534194, -0.50697356, -0.16812413, -0.53556594, -0.35089977, -0.74195996, 0.40828665, 0.50061713, 0.31316687, -0.46757834, 0.74137266, 0.20571767, -1.47991406, 0.7365356, -0.22475025, -0.1339124, -0.24707552, -0.56605377, 1.47341579, 0.96407278, -0.4733757, -1.2013399, -0.05409567, -1.21358051, 0.23097913, -0.19379787, 0.1235754, 0.3835123, -0.37517917, -0.57059294, 0.71343865, -2.03077904, 0.46847596, -2.07172929, -0.1607105, -0.51679746, 0.03041401, -0.89220986, 0.21591287, -0.53424826, -0.20974912, -0.45488571, -0.16682064, 0.99676333, 0.36898972, -1.49944444, 1.26609206, -0.70696238, -1.44257274, -0.21845022, -0.142134, 0.05221587, 0.65404742, -1.19063154, 0.49702661, 0.27069621, -0.85208763, -0.09702888, -0.07301064, -0.23345152, 0.75322569, 1.19079231, -1.0815044, 0.81294245, -1.96665349, 0.31214446, 0.48393353, -0.68575822, 0.0471126, -1.17653192, -0.38780267, 0.21730394, -0.25193044, -0.87854116, 0.11271054, 1.22551277, 0.12495602, -1.08127796, -0.04506021, 1.30313618, -0.3125118, 0.34883724, 0.613603, -0.18576361, 0.68378918, -0.01534037, -1.06491078, -0.21837704, -0.33104125, -0.18588764, 0.0743747, 0.01562586, 0.44475956, -0.0665213, -0.14246049, -0.60873583, -1.73718055, 1.48320477, -0.37992238, 0.34982873, -0.84814653, -1.30667908, 0.64669505, -0.65278273, -0.29838735, -1.05872409, 0.00374465, 2.05352248, -0.71038278, 0.2053318, -1.54485771, -1.29339939, -0.25405769, -1.12565931, -0.1187875, -0.67166574, 0.42216063, 0.59332394, -0.49864246, 0.83970167, -0.71347409, 0.91632027, -0.15507512, 0.68759454, -1.29473366, 0.90841905, 0.14119616, 0.77744963, 0.25503965, -1.28097013, 0.44068451, 0.42463812, -1.22785289, -0.10194648, -1.12285549, 0.07192283, 0.75228205, 1.11411685, 0.27309675, -1.69726223, -0.40578211, -0.4449591, 0.1075989, 0.75152201, 0.42388041, 1.9716984, -0.85843986, 1.24664224, -0.7261308, 1.90043606, 0.6662498, -0.18650988, -0.41438609, -0.43799568, -0.20897853, -0.81612777, -0.84858067, -0.67087688, 2.31564426, -1.62657933, 0.23637944, 0.10345757, -0.07180217, -1.21673319, 0.55898607, 0.93956284, -0.86467198, -0.49894881, 0.89546923, 1.59090759, 0.60650188, 1.68495406, 0.01383839, -0.97293602, 0.35029413, 0.92358284, -0.29211078, -1.78971208, -1.08552769, 1.18669008, -0.28002439, 0.27405075, 0.0694624, -0.68740036, -0.4378249, 0.24358519, -0.83461123, 1.35030876, -0.23716267, -0.2452278, 0.34070813, -0.86693761, 1.48266399, 0.3284211, -0.7516317, 0.31527463, 0.17078875, -0.89807427, -1.14187877, -1.60856579, -0.2829414, 1.1932368, 0.10428649, -1.24914791, -0.31067368, -0.98027293, 0.18272194, -0.16717895, -1.58394599, -0.08220539, 0.3796718, 0.94435941, 0.09364688, -0.26796703, -0.98677443, -0.57043364, -0.13938946, -1.39233404, -0.51054892, -1.34285342, 0.89913058, -0.24026141, -0.26748228, 1.23028654, 0.80222044, -0.62086781, -1.05725053, 0.75431359, -1.3571881, -0.19296285, 0.67547503, -2.16736668, 0.02298493, 0.77733993, 1.07596213, -0.90262257, 0.52154025, 0.23264912, 0.43299946, 1.08888254, 0.70700848, -0.32155372, 0.97833133, 0.19432768, 1.03326106, -0.48738812, -0.51644813, 0.65837451, -0.01592093, 0.88540515, 1.52966435, -0.34930729, -0.93960365, -0.99854216, -0.51736691, -0.02839116, 0.02431064, 1.07381558, 0.01513503, -0.37656687, 0.31340886, -1.31398129, -0.65237506, 0.44979253, 0.09329471, 1.06427764, 0.44931727, 0.35209299, 0.35885106, 0.76910627, -1.06751773, -0.87780018, -0.72838127, 0.01398158, -0.66760187, 0.38354874, 0.90765758, 0.54995534, -1.82158927, -0.84665051, 1.41485362, 0.20534405, -0.78586975, -0.75601187, 1.78271281, -0.13753841, 0.38983535, -0.63615463, -0.6948763, 0.75618016, -1.26441318, 1.13034315, -1.09471196, -0.50284076, -0.6451668, -1.16220905, 1.11388721, -0.30927062, 1.65972238, -0.66007671, 0.23454014, -0.13631757, 0.13627083, -1.07727314, -0.50684795, -1.18287094, -0.40616086, -0.20126522, 0.16991968, 0.50217944, 0.1961915, 0.42198197, -0.92393261, 0.50688396, -0.16413714, -0.09814521, 2.68492743, -1.42601875, 0.52994631, -0.36144077, 0.52451237, -0.36552118, -0.79249003, 0.02199418, 0.56084089, 0.73804126, -0.445993, -1.40333584, 0.29517069, 0.08607819, 0.22432609, -0.22094706, -0.40955473, 0.7872725, 1.01902084, 1.15957053, 0.51434086, 0.84529203, 0.39028861, 0.12781729, -1.41811562, 0.57603583, 1.720511, -0.89654866, -0.32903768, -1.86364959, -0.61600145, 0.68426517, 1.25732209, 0.07710798, 0.85927664, -0.51732527, -0.46382923, 0.33701252]);
  const b1 = new Float64Array([-0.04501977, -0.06786464, 0.38517503, -2.00965485, -1.36006197, -0.90984871, -0.23903812, 1.69543252, 1.76357497, 0.17895431, 0.8791027, 1.19681084, -0.48453938, 0.0806035, -0.71477135, -0.60765939, 0.05872659, -0.17883368, 0.40503165, 1.20432928, 0.91815939, -0.7164548, 0.33941502, -1.29564506]);
  const W2 = new Float64Array([-0.36203105, 1.11444042, 0.28920704, -0.22715359, 0.00270962, 1.45586036, -0.77075687, 0.89857848, -1.46352403, 0.73593244, -0.81715742, 1.61900263, 0.57722728, 0.83162681, -0.73321608, 0.97808978, 1.11773662, 0.32548796, -0.39462803, -0.73667914, -0.59607671, -0.24226012, 0.25649527, -1.34262486, 0.03283518, -1.09171208, -1.88656586, 1.70260708, 0.58504755, -0.53323236, -2.04806689, -0.09521885, -0.30769222, -0.31355321, -1.8862895, 0.02278435, 0.31846112, 0.29290406, -0.75038541, 0.78915758, -0.55909132, 0.38077086, 1.71739705, -0.5260213, 1.96506615, 1.3470564, 0.2125017, 0.72912708, -1.90630018, 0.07590951, 0.71002739, -0.35346408, -1.05541509, -0.4163805, -0.02324588, 0.54953302, 0.20911513, -1.34690209, -0.48023958, 1.08527773, -1.18666397, 0.31494641, 0.86138801, -1.41629148, -0.05353487, -1.14293593, -0.68753118, -0.39283203, 0.2671172, 1.68963676, -1.08845957, -1.98094739, 0.01075708, 1.65126559, -0.08133203, -0.62815516, -0.31103716, -0.09027343, 0.64940858, 0.28259198, -1.18178605, 0.58665342, -0.57575918, -0.22535738, 1.35507036, 0.9915464, -0.52056709, -0.56266391, -0.40176792, -0.22699788, -0.12676844, 0.11992453, 1.41632987, 1.16211105, -0.50610153, 0.61528053, 0.91356906, -0.3925811, -0.73127091, -0.51968519, 1.1003368, 0.10000301, -1.26137213, 0.34369594, -0.56356163, 0.89075511, -0.0135315, -1.30178842, 1.41087358, -0.68499768, 0.01366404, 0.32507579, -0.09625499, -0.20816465, 0.33347069, 0.8862049, 1.26070943, -0.34157614, 0.81729894, 0.20543872, -0.21103876, 0.98311281, -0.63741953, 0.68976419, -0.19568339, 0.40472257, 0.54309838, -0.51200408, 0.52858669, -0.86846921, 0.99464118, 1.12978822, 1.19455755, -1.22806157, -0.05500492, -0.91016055, -1.65694966, 0.35652601, -0.71897884, -0.36048578, 0.10108922, -0.04715849, -0.3677025, 1.07281849, -1.19431563, 0.26561121, 0.13345755, -0.85930778, 0.02842402, 0.19571137, 0.59756238, 2.41538574, 2.32359599, -0.38358409, -0.21717573, 0.28939673, -0.43117385, 0.61475973, -0.61523519, -0.60340667, 0.29507391, 0.80205183, -1.24594185, 1.04027813, -1.61939228, 1.23979721, -0.28813965, -0.3861148, -0.86221249, -0.2220389, 0.06887766, -0.47672538, -0.43456517, 0.26197367, 0.75568015, -1.7019827, 0.25513592, 0.59381781, -0.7520223, 0.20593254, -1.08012467, 0.16865834, -0.60973157, -0.18826232, 0.5217142, -0.00328153, -0.99608961, 0.205683, 0.39597579, -0.34881315, -0.70503439, 0.26652402, 1.04581803, -1.5241366, -0.9393408, -0.69518474, -0.65903632, -0.96433342, -1.38817449, -0.64982999, 0.86033103, -0.99271215, 0.47439341, -0.57632501, 0.11059336, 0.24997572, -0.09321106, 0.90894957, -0.73228278, 0.37412336, -0.98320035, 1.75183524, -0.88956563, 0.12995636, 0.9505478, 0.11578967, -0.48724716, -0.95717149, -0.62536783, 1.27679098, -1.4419048, -0.20956439, -2.17584731, -0.69319636, 0.37043723, -1.12816826, -1.37334602, -0.82044366, -0.19347451, 0.23088948, 0.80113348, 0.14411953, 1.11029387, -0.51955156, -0.17202987, 0.51053749, 0.85386444, 0.39601311, -0.60352591, 0.11745979, -0.39188141, -0.44682297, 0.65676566, -0.50768162, -0.24124639, -1.15518148, 0.17612402, -0.76767696, -0.11091289, -0.77821176, 0.81234848, 0.37009811, -0.7010621, 0.83902131, 0.12094033, -0.7810462, -0.1332277, -0.03389862, -0.39428638, 1.14337448, 0.33159995, 1.03448594, -0.80235438, 1.24789609, -0.92480733, -1.5242533, -0.08531325, 0.48883467, -0.25473957, 0.06262591, -0.97318266, 0.41024863, -0.30896329, 2.15180933, -0.63072505, -0.39100527, 0.83211227, 1.26026154, -0.6556551, 0.61631494, -0.02888172, -0.09189633, 1.53665684, 0.1575344, 0.95175782, 1.35691282, 0.98454785, -0.1392527, 0.19864182, -1.14189014, -1.63201371, 0.13369249, -0.3291153, 0.40165933, -2.18481807, 0.6504763, -0.81479198, 0.75151765, -0.72908316, 0.29175708, -0.23806541, 0.06329758, -1.00491806, 0.4590159, -0.9329038, -0.43917329, 0.69736697, -0.68497323, 0.13183705, 0.10687794, 1.5750525, -0.59614241, 0.63789167, -0.58595206, -0.05270211, -0.84949346, 1.17826848, 1.32127682, -0.00467535, 1.40060059, 0.757025, 0.09849058, 0.02944816, -0.54012028, -1.40016106, -0.97348785, -0.6733093, -0.26210343, -0.97918476, 0.36894944, 0.9417323, 0.47074119, 0.6202772, -0.09401513, -2.10119479, -0.02145509, -1.42549668, 0.46424606, -0.12488351, 0.3038293, 0.66651838, -0.68854441, 1.6067379, 0.62734875, 1.14394337, -0.24149576, 0.65424192, 1.62719579, 0.97703151, -0.61650132, 0.16990306, 0.73970402, 0.17935936, 1.28145179, 0.71661582, 0.23285912, 0.63221769, 0.57523213, 1.41478324, -0.2802291, 0.32042282, 0.67366042, -0.04906987, 0.61704318, 0.79384694, 1.10959013, -0.36257566, -1.32063167, 0.56139142, 0.2317525, -1.59723844, -1.8584276, 2.56907729, 0.32345626, 0.65911366, -0.70140495, -0.07489592, -1.57833011, 1.06858397, 1.51780039, 0.7346972, 0.32760107, 0.03618043, 0.19593001]);
  const b2 = new Float64Array([0.89567392, 0.39791317, -0.57053053, 0.52263103, -0.54315672, 0.43907682, -1.05207441, -0.38643489, 0.17394048, -0.08847069, 0.8231733, -1.1758024, 0.14474272, -0.06573147, -0.65300272, 0.68912112]);
  const W3 = new Float64Array([-0.73318682, 5.36539283, -3.53490891, 5.90103767, -2.63806588, -0.59232742, 3.27827034, -3.55047722, -1.70372062, -1.53539041, 1.01197529, 0.94308066, 0.06252869, -1.97690767, -2.18696985, 3.80776275, 0.12836789, 5.68714188, -0.18236897, 9.60572463, -0.25151508, 1.25617159, 4.1496217, -1.68856561, -2.38913261, -1.01929024, 0.40192007, 0.98074291, 1.86815676, -0.05416323, 1.61387904, 0.53795982, -0.42596855, 0.62088318, -0.62067109, 2.5158814, -0.78244993, -0.06453228, 1.0634106, 1.84857413, 0.45275362, -2.75462688, 0.27071099, 0.53466477, -4.73197392, -0.49632036, -2.0222201, -1.28468241, -0.84320121, 0.53592403, -0.20404542, 6.07982336, 4.2558285, 2.62141053, 1.39801581, 5.13841093, -1.43188939, 4.51980592, 1.67193398, 0.39944905, 0.51520341, -3.62814928, 0.56838028, -6.17492122, -0.55230076, 7.01651921, -4.25641426, 9.97742156, -5.7867469, -0.23477681, -0.3762071, -1.02097498, -4.50295625, -0.876215, 3.27588154, 2.09851357, -0.90801454, 0.2844138, -0.56385995, 0.77840142]);
  const b3 = new Float64Array([1.0568041, -0.10669929, -0.88836877, -0.03010754, -0.46700424]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.12919988, 0.53839085, -0.1060256, 0.18404706, -1.84451855, -0.2654118, -0.96417753, 0.19694201, -0.1316366, -1.09859573, 0.20089892, 0.4053082, 0.41059322, 0.34122344, -0.33941922, -0.60747516, -0.23366435, 0.3661617, 0.90760967, -0.20897337, 0.95617585, -0.52531092, -1.20260868, 0.25895174, 0.36075162, 0.66167732, 0.46454885, -0.409713, 0.96587258, 0.02635149, 0.67326605, -0.87727076, -1.08249929, 0.0675701, 0.68452451, 1.25444908, -0.36469147, -1.72830683, -0.3522396, -0.13956489, 0.46877731, 0.92153177, 1.20344287, -0.02614582, 0.8410064, 0.06633651, -0.26373905, -0.16140108, -0.35537125, -0.60195755, 0.81694713, -0.62569702, 0.49049964, 1.68547244, -0.61301157, -0.7394573, -1.54993101, 0.92090681, -0.09905171, -1.48434426, 0.06712329, -0.96920817, -0.32909871, -0.51625916, 0.51948175, -1.06373098, -0.94466859, -0.16711838, -1.67841318, -0.57880075, -0.44718282, 0.43136932, 1.09984914, 0.76879281, -0.29231537, -0.34075089, 0.13875126, -0.19083625, -0.58389058, 0.2990573, -0.43515077, 0.44894048, 1.5017857, 1.1124457, -0.02559045, 0.94510429, -0.19926982, -0.59673061, 0.4064476, 1.97965291, -0.523701, -1.10911585, -0.23396502, -0.94437975, 0.8450979, 0.429929, 1.16686847, -1.08792432, 0.18349473, 0.71557004, 1.25494788, -0.30248998, 1.43511725, 0.63203774, -0.31191915, -0.42858654, -0.84111098, -2.00535127, 0.08608713, 0.49598659, 2.07053847, 1.60597759, 0.3366828, -0.22281002, -1.35314547, -0.92101901, -1.16667447, 0.74056623, 0.94773047, -0.92817511, -1.86657268, -0.25997904, -0.77814528, -0.15708403, 0.37996977, -0.52248615, -0.96268558, -0.74393704, -1.04759005, 0.71810873, 0.75010374, 0.07684314, 0.61312677, -1.2752957, 0.07869385, -1.29272587, -0.84614424, 1.79130541, 0.41443751, -0.34436736, 0.85821302, -1.28706709, -1.57946258, 0.86588403, 0.34407335, -0.49242266, 1.61308089, -0.80075512, 1.00867526, -1.07276262, -0.19937004, 0.11348028, -1.04952927, -0.26357263, 0.502315, -0.32899089, 0.62314725, -0.82493827, -0.34373542, -0.41511676, -0.30028973, -0.14974018, 0.89107496, -0.2066916, 0.20511613, -2.26749236, -0.08907113, -1.46868928, -0.06046051, -0.20222232, 0.30067437, 0.90743619, 0.40532131, 0.18604324, -0.11580713, -0.48562792, -0.01031199, -0.77580853, 0.66895244, -0.45807735, 0.19890305, 1.04423572, 0.47897106, -0.44629131, 0.16680932, -0.39576426, -0.18037069, -0.43067111, -1.16346728, -0.5143305, 1.08291031, 0.27520681, -0.57399016, -0.69634947, -0.49470007, -0.23408483, 1.30774803, -1.24674451, 0.18855524, -0.61607742, -1.22255446, 1.71805393, -0.083574, 0.6934223, -1.8481099, -0.27376993, -1.17454895, 0.14272256, 0.11276265, 0.3157888, 0.94116905, 1.18179326, 0.80811847, -0.21125064, 0.29018061, 1.28514364, -0.57728162, -0.37644024, -0.85508952, 0.39502617, -0.16487126, -0.55399526, -0.93944557, 0.22304983, -0.40875941, 0.51243544, -0.26842774, -0.08311363, 0.42731917, 0.3331231, -1.49283208, 1.65904085, -0.63747887, -0.08686399, -0.21013847, 1.86649012, -1.10214724, 0.0265192, -0.26370607, -2.08958289, 0.14572481, -2.7562922, -1.63838789, -1.02839787, 0.436912, -0.77784546, -0.38244757, -1.50218174, -0.87980013, 0.6204392, -0.18685724, -0.25550805, 0.06538993, -1.88552871, 0.37356024, -1.07630368, -1.85175301, -0.12844573, -0.84957873, 0.19531525, -0.56409773, 0.11771226, 1.26912131, -0.42566036, -0.64689513, 0.32324206, -0.01811351, -0.4675068, 1.49441298, -2.40135195, -0.7709642, -0.07333278, -0.22380423, -1.23415325, -0.20548278, -0.40844235, 0.28129554, -0.05594934, -1.51964944, -0.86522298, -1.67468189, -1.27298165, 0.56246491, -0.7119768, -0.70566282, -0.15246681, -0.41107516, 0.63565999, -0.2236744, 0.94818793, 0.09433935, -0.40463127, -0.13317247, -0.48678278, 0.90130134, -0.49479485, 0.55181518, -0.72544249, 0.34669671, -0.21822634, 0.72478334, -0.00015779, 0.09494694, -1.33637406, 0.65897185, 0.37715712, -1.94359733, -0.15333243, 0.38681636, 0.99755587, -0.77918575, -0.88368053, 0.56937193, 1.0986412, -0.0063286, -1.19481331, 0.40327863, 1.74304513, -0.29062309, -0.12046315, -0.40488974, 0.06733586, -0.5864114, -0.03977954, -0.53943196, -0.93268546, 0.72747257, -0.50341872, -0.32455451, -0.19119688, 1.26203, 1.32115231, 0.58004996, 1.24379026, -0.09752867, 0.95456556, 1.01712524, 0.32199711, -1.67299999, -0.1203608, 1.43034142, -0.00249132, 0.07435869, 0.62077547, -0.5272084, 2.59266289, -0.14530446, 0.97571757, 0.95104164, -0.49587531, 1.12296808, 0.37678994, -0.32438995, -1.61782993, -0.49110977, 0.48054622, -0.57305494, 0.73637119, 0.59996627, -0.62513343, -0.93888143, 0.13973976, -0.93924959, -0.15394797, 0.86709815, -0.88680711, 0.42357626, 0.80393412, -0.63971255, -1.67282706, 0.33781738, 1.45378643, -1.07606707, 1.25920057, -0.1016934, -0.19269155, 0.98838125, 0.14495898, -0.89328348, 1.0522509, 0.50623302, 0.42726883, -0.68869639, -0.44018062, 1.84150782, -0.59408578, 0.34331978, -0.39553807, -0.9511237, 0.19410909, 1.44209698, -1.04005444, 2.00103385, -0.61206814, 0.3017591, -0.30243556, -0.20696573, -0.90748117, 1.17969408, 1.02747861, -0.50807734, -0.54017285, 3.35569838, -0.29054497, 1.35453779, -0.83753321, -1.07840614, 0.41798364, 0.66156192, 1.42321578, 0.3400416, -1.15941756, -0.47172295, -0.33638498, 0.69234623, -1.00583168, -0.66125072, 0.59734064, -0.109898, 0.64953168, 0.74382221, 0.56988032, -1.7669224, 0.03985264, -0.8884815, -1.8871374, 0.30804287, 1.047233, -0.00242477, -0.48541024, 2.0123724, 1.66439548, 0.10256516, 0.86625983, 0.69709549, 0.28621121, -0.93705224, 0.46101749, 0.42302368, -2.34677794, -1.34523253, -0.85369879, -0.85019653, 1.05960297, -0.35259578, 0.20540335, -0.01254739, 0.74453087, -1.00579491, 0.50553924, 0.20173546, 0.84004475, 0.94619881, 0.81654418, -2.3631754, -0.95024623, -0.12798009, 0.26052984, 0.12221493, 1.98934866, 0.06134287, -1.23755948, -1.55221303, 0.86905162, -0.33574497, -0.785917, 1.79821277, 1.99543148, -0.59893392, -0.72924345, 0.72594461, 0.88571702, -0.80652723, -0.18328393, 0.19164536, 0.39070334, -1.28511416, -1.48279908, 0.2255184, -0.02850824, -0.83065691, -0.92983366, 0.51613866, -0.51841491, 1.21304059, 1.19434286, -0.23825356, -0.78336346, -0.96941738, -1.01372181, 0.25071878, -0.81270147, 0.41247486, 0.04840887, -0.59708023, -1.70989936, -1.31540066, 0.43707815, 0.15903183, -0.65557914, 0.35488817, 0.30326477, 0.01417764, 1.78043017, -0.2347309, -0.00977352, -0.1452394, -0.31506725, 0.29124182, -0.56487455, 1.13568681, 0.60135936, 0.52472101, -0.96473102, -0.03204886, -0.74985515, 2.24862799, -0.47025752, -1.04800781, 1.06676979, -1.3332727, -1.10347546, 0.90924515, -0.9259584, 0.20510289, 1.8890085, -1.00018466, 0.32846825, -0.04377756, 0.1494981, -1.07726775, -2.00005095, -0.45746394, -0.88477777, 0.10832786, -0.96356527, -0.40846596, -1.22084067, -0.53498869, -0.60472866, -1.06906236, 1.43677127, 1.45554181, -0.29889496, -0.36577127, 0.62508352, 0.11447551, 0.7359401, -1.8138315, -1.38096985, -0.15439718, 0.49077554, 0.4435932, 0.11377517, 0.76599221, -0.61566495, 0.64040563, -0.41730931, -1.1750121, 1.12287294, -0.11695974, -0.79565246, 0.2371364, -0.6538574, -0.09239033, -0.35505938, -0.28133177, -0.76474658, -0.45523695, 0.05232185, -1.71427051, 0.70795835, 0.18788025, 0.1402817, -0.04253285, 0.48357989, -0.158762, 1.17951548, -0.8978362, -0.85566158, -0.05257799, 0.24895868, 0.16921378, -1.63488851, 2.69739057, -1.08452608, -0.54310743, 1.17133811, 1.44753404, 0.73664336, 0.06618319, -1.27041004, -1.44055942, -1.34714651, 0.22980032, 1.36565427, -0.89843346, -1.03469148, -0.5260749, -1.04141253, -2.58715189, -0.64862805, -2.4605015, 0.11164159, -1.98578827, -0.27168584, 0.76134712, -1.10234866, -1.26393187, -1.52201238, 1.92762706, 1.10086773, -0.29592203, 2.11028315, -0.73080732, -0.04952872, -0.13164604, 0.10436002, -0.4000255, 0.53312037, 0.33993857, 0.11626446, -0.38118197, 0.58863583, -0.43186347, 0.31776474, -1.49902242, 1.60618544, -0.26328119, 0.26105919, 1.08501939, -0.35544076, 0.231896, 0.69482221, -1.22858108, 1.76838236, 0.73305912, 1.1790418, 0.62004608, 0.83813702, -0.26037864, 0.74914484, -0.63434351, 1.16884393, -0.0964325, -0.21480496, 0.01332289, -1.26518912, 1.27050124, -0.69882411, -0.30036408, -0.56293061, 0.96131736, 0.85847888, -0.49317113, 1.51356688, 0.30091364, 1.13406852, 0.28256426, 0.06035321, 0.1246994, 0.369739, -1.28718044, -0.13159744, -0.52333476, -0.5361268, 0.64545506, 0.00684978, 0.06517127, -0.95655232, 0.54314332, 0.29707475, -0.24562592, 0.87235749, -1.07324121, 0.37826216, -1.14956194, 1.09818573, 0.6534194, -0.50697356, -0.16812413, -0.53556594, -0.35089977, -0.74195996, 0.40828665, 0.50061713, 0.31316687, -0.46757834, 0.74137266, 0.20571767, -1.47991406, 0.7365356, -0.22475025, -0.1339124, -0.24707552, -0.56605377, 1.47341579, 0.96407278, -0.4733757, -1.2013399, -0.05409567, -1.21358051, 0.23097913, -0.19379787, 0.1235754, 0.3835123, -0.37517917, -0.57059294, 0.71343865, -2.03077904, 0.46847596, -2.07172929, -0.1607105, -0.51679746, 0.03041401, -0.89220986, 0.21591287, -0.53424826, -0.20974912, -0.45488571, -0.16682064, 0.99676333, 0.36898972, -1.49944444, 1.26609206, -0.70696238, -1.44257274, -0.21845022, -0.142134, 0.05221587, 0.65404742, -1.19063154, 0.49702661, 0.27069621, -0.85208763, -0.09702888, -0.07301064, -0.23345152, 0.75322569, 1.19079231, -1.0815044, 0.81294245, -1.96665349, 0.31214446, 0.48393353, -0.68575822, 0.0471126, -1.17653192, -0.38780267, 0.21730394, -0.25193044, -0.87854116, 0.11271054, 1.22551277, 0.12495602, -1.08127796, -0.04506021, 1.30313618, -0.3125118, 0.34883724, 0.613603, -0.18576361, 0.68378918, -0.01534037, -1.06491078, -0.21837704, -0.33104125, -0.18588764, 0.0743747, 0.01562586, 0.44475956, -0.0665213, -0.14246049, -0.60873583, -1.73718055, 1.48320477, -0.37992238, 0.34982873, -0.84814653, -1.30667908, 0.64669505, -0.65278273, -0.29838735, -1.05872409, 0.00374465, 2.05352248, -0.71038278, 0.2053318, -1.54485771, -1.29339939, -0.25405769, -1.12565931, -0.1187875, -0.67166574, 0.42216063, 0.59332394, -0.49864246, 0.83970167, -0.71347409, 0.91632027, -0.15507512, 0.68759454, -1.29473366, 0.90841905, 0.14119616, 0.77744963, 0.25503965, -1.28097013, 0.44068451, 0.42463812, -1.22785289, -0.10194648, -1.12285549, 0.07192283, 0.75228205, 1.11411685, 0.27309675, -1.69726223, -0.40578211, -0.4449591, 0.1075989, 0.75152201, 0.42388041, 1.9716984, -0.85843986, 1.24664224, -0.7261308, 1.90043606, 0.6662498, -0.18650988, -0.41438609, -0.43799568, -0.20897853, -0.81612777, -0.84858067, -0.67087688, 2.31564426, -1.62657933, 0.23637944, 0.10345757, -0.07180217, -1.21673319, 0.55898607, 0.93956284, -0.86467198, -0.49894881, 0.89546923, 1.59090759, 0.60650188, 1.68495406, 0.01383839, -0.97293602, 0.35029413, 0.92358284, -0.29211078, -1.78971208, -1.08552769, 1.18669008, -0.28002439, 0.27405075, 0.0694624, -0.68740036, -0.4378249, 0.24358519, -0.83461123, 1.35030876, -0.23716267, -0.2452278, 0.34070813, -0.86693761, 1.48266399, 0.3284211, -0.7516317, 0.31527463, 0.17078875, -0.89807427, -1.14187877, -1.60856579, -0.2829414, 1.1932368, 0.10428649, -1.24914791, -0.31067368, -0.98027293, 0.18272194, -0.16717895, -1.58394599, -0.08220539, 0.3796718, 0.94435941, 0.09364688, -0.26796703, -0.98677443, -0.57043364, -0.13938946, -1.39233404, -0.51054892, -1.34285342, 0.89913058, -0.24026141, -0.26748228, 1.23028654, 0.80222044, -0.62086781, -1.05725053, 0.75431359, -1.3571881, -0.19296285, 0.67547503, -2.16736668, 0.02298493, 0.77733993, 1.07596213, -0.90262257, 0.52154025, 0.23264912, 0.43299946, 1.08888254, 0.70700848, -0.32155372, 0.97833133, 0.19432768, 1.03326106, -0.48738812, -0.51644813, 0.65837451, -0.01592093, 0.88540515, 1.52966435, -0.34930729, -0.93960365, -0.99854216, -0.51736691, -0.02839116, 0.02431064, 1.07381558, 0.01513503, -0.37656687, 0.31340886, -1.31398129, -0.65237506, 0.44979253, 0.09329471, 1.06427764, 0.44931727, 0.35209299, 0.35885106, 0.76910627, -1.06751773, -0.87780018, -0.72838127, 0.01398158, -0.66760187, 0.38354874, 0.90765758, 0.54995534, -1.82158927, -0.84665051, 1.41485362, 0.20534405, -0.78586975, -0.75601187, 1.78271281, -0.13753841, 0.38983535, -0.63615463, -0.6948763, 0.75618016, -1.26441318, 1.13034315, -1.09471196, -0.50284076, -0.6451668, -1.16220905, 1.11388721, -0.30927062, 1.65972238, -0.66007671, 0.23454014, -0.13631757, 0.13627083, -1.07727314, -0.50684795, -1.18287094, -0.40616086, -0.20126522, 0.16991968, 0.50217944, 0.1961915, 0.42198197, -0.92393261, 0.50688396, -0.16413714, -0.09814521, 2.68492743, -1.42601875, 0.52994631, -0.36144077, 0.52451237, -0.36552118, -0.79249003, 0.02199418, 0.56084089, 0.73804126, -0.445993, -1.40333584, 0.29517069, 0.08607819, 0.22432609, -0.22094706, -0.40955473, 0.7872725, 1.01902084, 1.15957053, 0.51434086, 0.84529203, 0.39028861, 0.12781729, -1.41811562, 0.57603583, 1.720511, -0.89654866, -0.32903768, -1.86364959, -0.61600145, 0.68426517, 1.25732209, 0.07710798, 0.85927664, -0.51732527, -0.46382923, 0.33701252]);
  const b1 = new Float64Array([-0.04501977, -0.06786464, 0.38517503, -2.00965485, -1.36006197, -0.90984871, -0.23903812, 1.69543252, 1.76357497, 0.17895431, 0.8791027, 1.19681084, -0.48453938, 0.0806035, -0.71477135, -0.60765939, 0.05872659, -0.17883368, 0.40503165, 1.20432928, 0.91815939, -0.7164548, 0.33941502, -1.29564506]);
  const W2 = new Float64Array([-0.36203105, 1.11444042, 0.28920704, -0.22715359, 0.00270962, 1.45586036, -0.77075687, 0.89857848, -1.46352403, 0.73593244, -0.81715742, 1.61900263, 0.57722728, 0.83162681, -0.73321608, 0.97808978, 1.11773662, 0.32548796, -0.39462803, -0.73667914, -0.59607671, -0.24226012, 0.25649527, -1.34262486, 0.03283518, -1.09171208, -1.88656586, 1.70260708, 0.58504755, -0.53323236, -2.04806689, -0.09521885, -0.30769222, -0.31355321, -1.8862895, 0.02278435, 0.31846112, 0.29290406, -0.75038541, 0.78915758, -0.55909132, 0.38077086, 1.71739705, -0.5260213, 1.96506615, 1.3470564, 0.2125017, 0.72912708, -1.90630018, 0.07590951, 0.71002739, -0.35346408, -1.05541509, -0.4163805, -0.02324588, 0.54953302, 0.20911513, -1.34690209, -0.48023958, 1.08527773, -1.18666397, 0.31494641, 0.86138801, -1.41629148, -0.05353487, -1.14293593, -0.68753118, -0.39283203, 0.2671172, 1.68963676, -1.08845957, -1.98094739, 0.01075708, 1.65126559, -0.08133203, -0.62815516, -0.31103716, -0.09027343, 0.64940858, 0.28259198, -1.18178605, 0.58665342, -0.57575918, -0.22535738, 1.35507036, 0.9915464, -0.52056709, -0.56266391, -0.40176792, -0.22699788, -0.12676844, 0.11992453, 1.41632987, 1.16211105, -0.50610153, 0.61528053, 0.91356906, -0.3925811, -0.73127091, -0.51968519, 1.1003368, 0.10000301, -1.26137213, 0.34369594, -0.56356163, 0.89075511, -0.0135315, -1.30178842, 1.41087358, -0.68499768, 0.01366404, 0.32507579, -0.09625499, -0.20816465, 0.33347069, 0.8862049, 1.26070943, -0.34157614, 0.81729894, 0.20543872, -0.21103876, 0.98311281, -0.63741953, 0.68976419, -0.19568339, 0.40472257, 0.54309838, -0.51200408, 0.52858669, -0.86846921, 0.99464118, 1.12978822, 1.19455755, -1.22806157, -0.05500492, -0.91016055, -1.65694966, 0.35652601, -0.71897884, -0.36048578, 0.10108922, -0.04715849, -0.3677025, 1.07281849, -1.19431563, 0.26561121, 0.13345755, -0.85930778, 0.02842402, 0.19571137, 0.59756238, 2.41538574, 2.32359599, -0.38358409, -0.21717573, 0.28939673, -0.43117385, 0.61475973, -0.61523519, -0.60340667, 0.29507391, 0.80205183, -1.24594185, 1.04027813, -1.61939228, 1.23979721, -0.28813965, -0.3861148, -0.86221249, -0.2220389, 0.06887766, -0.47672538, -0.43456517, 0.26197367, 0.75568015, -1.7019827, 0.25513592, 0.59381781, -0.7520223, 0.20593254, -1.08012467, 0.16865834, -0.60973157, -0.18826232, 0.5217142, -0.00328153, -0.99608961, 0.205683, 0.39597579, -0.34881315, -0.70503439, 0.26652402, 1.04581803, -1.5241366, -0.9393408, -0.69518474, -0.65903632, -0.96433342, -1.38817449, -0.64982999, 0.86033103, -0.99271215, 0.47439341, -0.57632501, 0.11059336, 0.24997572, -0.09321106, 0.90894957, -0.73228278, 0.37412336, -0.98320035, 1.75183524, -0.88956563, 0.12995636, 0.9505478, 0.11578967, -0.48724716, -0.95717149, -0.62536783, 1.27679098, -1.4419048, -0.20956439, -2.17584731, -0.69319636, 0.37043723, -1.12816826, -1.37334602, -0.82044366, -0.19347451, 0.23088948, 0.80113348, 0.14411953, 1.11029387, -0.51955156, -0.17202987, 0.51053749, 0.85386444, 0.39601311, -0.60352591, 0.11745979, -0.39188141, -0.44682297, 0.65676566, -0.50768162, -0.24124639, -1.15518148, 0.17612402, -0.76767696, -0.11091289, -0.77821176, 0.81234848, 0.37009811, -0.7010621, 0.83902131, 0.12094033, -0.7810462, -0.1332277, -0.03389862, -0.39428638, 1.14337448, 0.33159995, 1.03448594, -0.80235438, 1.24789609, -0.92480733, -1.5242533, -0.08531325, 0.48883467, -0.25473957, 0.06262591, -0.97318266, 0.41024863, -0.30896329, 2.15180933, -0.63072505, -0.39100527, 0.83211227, 1.26026154, -0.6556551, 0.61631494, -0.02888172, -0.09189633, 1.53665684, 0.1575344, 0.95175782, 1.35691282, 0.98454785, -0.1392527, 0.19864182, -1.14189014, -1.63201371, 0.13369249, -0.3291153, 0.40165933, -2.18481807, 0.6504763, -0.81479198, 0.75151765, -0.72908316, 0.29175708, -0.23806541, 0.06329758, -1.00491806, 0.4590159, -0.9329038, -0.43917329, 0.69736697, -0.68497323, 0.13183705, 0.10687794, 1.5750525, -0.59614241, 0.63789167, -0.58595206, -0.05270211, -0.84949346, 1.17826848, 1.32127682, -0.00467535, 1.40060059, 0.757025, 0.09849058, 0.02944816, -0.54012028, -1.40016106, -0.97348785, -0.6733093, -0.26210343, -0.97918476, 0.36894944, 0.9417323, 0.47074119, 0.6202772, -0.09401513, -2.10119479, -0.02145509, -1.42549668, 0.46424606, -0.12488351, 0.3038293, 0.66651838, -0.68854441, 1.6067379, 0.62734875, 1.14394337, -0.24149576, 0.65424192, 1.62719579, 0.97703151, -0.61650132, 0.16990306, 0.73970402, 0.17935936, 1.28145179, 0.71661582, 0.23285912, 0.63221769, 0.57523213, 1.41478324, -0.2802291, 0.32042282, 0.67366042, -0.04906987, 0.61704318, 0.79384694, 1.10959013, -0.36257566, -1.32063167, 0.56139142, 0.2317525, -1.59723844, -1.8584276, 2.56907729, 0.32345626, 0.65911366, -0.70140495, -0.07489592, -1.57833011, 1.06858397, 1.51780039, 0.7346972, 0.32760107, 0.03618043, 0.19593001]);
  const b2 = new Float64Array([0.89567392, 0.39791317, -0.57053053, 0.52263103, -0.54315672, 0.43907682, -1.05207441, -0.38643489, 0.17394048, -0.08847069, 0.8231733, -1.1758024, 0.14474272, -0.06573147, -0.65300272, 0.68912112]);
  const W3 = new Float64Array([-0.73318682, 5.36539283, -3.53490891, 5.90103767, -2.63806588, -0.59232742, 3.27827034, -3.55047722, -1.70372062, -1.53539041, 1.01197529, 0.94308066, 0.06252869, -1.97690767, -2.18696985, 3.80776275, 0.12836789, 5.68714188, -0.18236897, 9.60572463, -0.25151508, 1.25617159, 4.1496217, -1.68856561, -2.38913261, -1.01929024, 0.40192007, 0.98074291, 1.86815676, -0.05416323, 1.61387904, 0.53795982, -0.42596855, 0.62088318, -0.62067109, 2.5158814, -0.78244993, -0.06453228, 1.0634106, 1.84857413, 0.45275362, -2.75462688, 0.27071099, 0.53466477, -4.73197392, -0.49632036, -2.0222201, -1.28468241, -0.84320121, 0.53592403, -0.20404542, 6.07982336, 4.2558285, 2.62141053, 1.39801581, 5.13841093, -1.43188939, 4.51980592, 1.67193398, 0.39944905, 0.51520341, -3.62814928, 0.56838028, -6.17492122, -0.55230076, 7.01651921, -4.25641426, 9.97742156, -5.7867469, -0.23477681, -0.3762071, -1.02097498, -4.50295625, -0.876215, 3.27588154, 2.09851357, -0.90801454, 0.2844138, -0.56385995, 0.77840142]);
  const b3 = new Float64Array([1.0568041, -0.10669929, -0.88836877, -0.03010754, -0.46700424]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.12919988, 0.53839085, -0.1060256, 0.18404706, -1.84451855, -0.2654118, -0.96417753, 0.19694201, -0.1316366, -1.09859573, 0.20089892, 0.4053082, 0.41059322, 0.34122344, -0.33941922, -0.60747516, -0.23366435, 0.3661617, 0.90760967, -0.20897337, 0.95617585, -0.52531092, -1.20260868, 0.25895174, 0.36075162, 0.66167732, 0.46454885, -0.409713, 0.96587258, 0.02635149, 0.67326605, -0.87727076, -1.08249929, 0.0675701, 0.68452451, 1.25444908, -0.36469147, -1.72830683, -0.3522396, -0.13956489, 0.46877731, 0.92153177, 1.20344287, -0.02614582, 0.8410064, 0.06633651, -0.26373905, -0.16140108, -0.35537125, -0.60195755, 0.81694713, -0.62569702, 0.49049964, 1.68547244, -0.61301157, -0.7394573, -1.54993101, 0.92090681, -0.09905171, -1.48434426, 0.06712329, -0.96920817, -0.32909871, -0.51625916, 0.51948175, -1.06373098, -0.94466859, -0.16711838, -1.67841318, -0.57880075, -0.44718282, 0.43136932, 1.09984914, 0.76879281, -0.29231537, -0.34075089, 0.13875126, -0.19083625, -0.58389058, 0.2990573, -0.43515077, 0.44894048, 1.5017857, 1.1124457, -0.02559045, 0.94510429, -0.19926982, -0.59673061, 0.4064476, 1.97965291, -0.523701, -1.10911585, -0.23396502, -0.94437975, 0.8450979, 0.429929, 1.16686847, -1.08792432, 0.18349473, 0.71557004, 1.25494788, -0.30248998, 1.43511725, 0.63203774, -0.31191915, -0.42858654, -0.84111098, -2.00535127, 0.08608713, 0.49598659, 2.07053847, 1.60597759, 0.3366828, -0.22281002, -1.35314547, -0.92101901, -1.16667447, 0.74056623, 0.94773047, -0.92817511, -1.86657268, -0.25997904, -0.77814528, -0.15708403, 0.37996977, -0.52248615, -0.96268558, -0.74393704, -1.04759005, 0.71810873, 0.75010374, 0.07684314, 0.61312677, -1.2752957, 0.07869385, -1.29272587, -0.84614424, 1.79130541, 0.41443751, -0.34436736, 0.85821302, -1.28706709, -1.57946258, 0.86588403, 0.34407335, -0.49242266, 1.61308089, -0.80075512, 1.00867526, -1.07276262, -0.19937004, 0.11348028, -1.04952927, -0.26357263, 0.502315, -0.32899089, 0.62314725, -0.82493827, -0.34373542, -0.41511676, -0.30028973, -0.14974018, 0.89107496, -0.2066916, 0.20511613, -2.26749236, -0.08907113, -1.46868928, -0.06046051, -0.20222232, 0.30067437, 0.90743619, 0.40532131, 0.18604324, -0.11580713, -0.48562792, -0.01031199, -0.77580853, 0.66895244, -0.45807735, 0.19890305, 1.04423572, 0.47897106, -0.44629131, 0.16680932, -0.39576426, -0.18037069, -0.43067111, -1.16346728, -0.5143305, 1.08291031, 0.27520681, -0.57399016, -0.69634947, -0.49470007, -0.23408483, 1.30774803, -1.24674451, 0.18855524, -0.61607742, -1.22255446, 1.71805393, -0.083574, 0.6934223, -1.8481099, -0.27376993, -1.17454895, 0.14272256, 0.11276265, 0.3157888, 0.94116905, 1.18179326, 0.80811847, -0.21125064, 0.29018061, 1.28514364, -0.57728162, -0.37644024, -0.85508952, 0.39502617, -0.16487126, -0.55399526, -0.93944557, 0.22304983, -0.40875941, 0.51243544, -0.26842774, -0.08311363, 0.42731917, 0.3331231, -1.49283208, 1.65904085, -0.63747887, -0.08686399, -0.21013847, 1.86649012, -1.10214724, 0.0265192, -0.26370607, -2.08958289, 0.14572481, -2.7562922, -1.63838789, -1.02839787, 0.436912, -0.77784546, -0.38244757, -1.50218174, -0.87980013, 0.6204392, -0.18685724, -0.25550805, 0.06538993, -1.88552871, 0.37356024, -1.07630368, -1.85175301, -0.12844573, -0.84957873, 0.19531525, -0.56409773, 0.11771226, 1.26912131, -0.42566036, -0.64689513, 0.32324206, -0.01811351, -0.4675068, 1.49441298, -2.40135195, -0.7709642, -0.07333278, -0.22380423, -1.23415325, -0.20548278, -0.40844235, 0.28129554, -0.05594934, -1.51964944, -0.86522298, -1.67468189, -1.27298165, 0.56246491, -0.7119768, -0.70566282, -0.15246681, -0.41107516, 0.63565999, -0.2236744, 0.94818793, 0.09433935, -0.40463127, -0.13317247, -0.48678278, 0.90130134, -0.49479485, 0.55181518, -0.72544249, 0.34669671, -0.21822634, 0.72478334, -0.00015779, 0.09494694, -1.33637406, 0.65897185, 0.37715712, -1.94359733, -0.15333243, 0.38681636, 0.99755587, -0.77918575, -0.88368053, 0.56937193, 1.0986412, -0.0063286, -1.19481331, 0.40327863, 1.74304513, -0.29062309, -0.12046315, -0.40488974, 0.06733586, -0.5864114, -0.03977954, -0.53943196, -0.93268546, 0.72747257, -0.50341872, -0.32455451, -0.19119688, 1.26203, 1.32115231, 0.58004996, 1.24379026, -0.09752867, 0.95456556, 1.01712524, 0.32199711, -1.67299999, -0.1203608, 1.43034142, -0.00249132, 0.07435869, 0.62077547, -0.5272084, 2.59266289, -0.14530446, 0.97571757, 0.95104164, -0.49587531, 1.12296808, 0.37678994, -0.32438995, -1.61782993, -0.49110977, 0.48054622, -0.57305494, 0.73637119, 0.59996627, -0.62513343, -0.93888143, 0.13973976, -0.93924959, -0.15394797, 0.86709815, -0.88680711, 0.42357626, 0.80393412, -0.63971255, -1.67282706, 0.33781738, 1.45378643, -1.07606707, 1.25920057, -0.1016934, -0.19269155, 0.98838125, 0.14495898, -0.89328348, 1.0522509, 0.50623302, 0.42726883, -0.68869639, -0.44018062, 1.84150782, -0.59408578, 0.34331978, -0.39553807, -0.9511237, 0.19410909, 1.44209698, -1.04005444, 2.00103385, -0.61206814, 0.3017591, -0.30243556, -0.20696573, -0.90748117, 1.17969408, 1.02747861, -0.50807734, -0.54017285, 3.35569838, -0.29054497, 1.35453779, -0.83753321, -1.07840614, 0.41798364, 0.66156192, 1.42321578, 0.3400416, -1.15941756, -0.47172295, -0.33638498, 0.69234623, -1.00583168, -0.66125072, 0.59734064, -0.109898, 0.64953168, 0.74382221, 0.56988032, -1.7669224, 0.03985264, -0.8884815, -1.8871374, 0.30804287, 1.047233, -0.00242477, -0.48541024, 2.0123724, 1.66439548, 0.10256516, 0.86625983, 0.69709549, 0.28621121, -0.93705224, 0.46101749, 0.42302368, -2.34677794, -1.34523253, -0.85369879, -0.85019653, 1.05960297, -0.35259578, 0.20540335, -0.01254739, 0.74453087, -1.00579491, 0.50553924, 0.20173546, 0.84004475, 0.94619881, 0.81654418, -2.3631754, -0.95024623, -0.12798009, 0.26052984, 0.12221493, 1.98934866, 0.06134287, -1.23755948, -1.55221303, 0.86905162, -0.33574497, -0.785917, 1.79821277, 1.99543148, -0.59893392, -0.72924345, 0.72594461, 0.88571702, -0.80652723, -0.18328393, 0.19164536, 0.39070334, -1.28511416, -1.48279908, 0.2255184, -0.02850824, -0.83065691, -0.92983366, 0.51613866, -0.51841491, 1.21304059, 1.19434286, -0.23825356, -0.78336346, -0.96941738, -1.01372181, 0.25071878, -0.81270147, 0.41247486, 0.04840887, -0.59708023, -1.70989936, -1.31540066, 0.43707815, 0.15903183, -0.65557914, 0.35488817, 0.30326477, 0.01417764, 1.78043017, -0.2347309, -0.00977352, -0.1452394, -0.31506725, 0.29124182, -0.56487455, 1.13568681, 0.60135936, 0.52472101, -0.96473102, -0.03204886, -0.74985515, 2.24862799, -0.47025752, -1.04800781, 1.06676979, -1.3332727, -1.10347546, 0.90924515, -0.9259584, 0.20510289, 1.8890085, -1.00018466, 0.32846825, -0.04377756, 0.1494981, -1.07726775, -2.00005095, -0.45746394, -0.88477777, 0.10832786, -0.96356527, -0.40846596, -1.22084067, -0.53498869, -0.60472866, -1.06906236, 1.43677127, 1.45554181, -0.29889496, -0.36577127, 0.62508352, 0.11447551, 0.7359401, -1.8138315, -1.38096985, -0.15439718, 0.49077554, 0.4435932, 0.11377517, 0.76599221, -0.61566495, 0.64040563, -0.41730931, -1.1750121, 1.12287294, -0.11695974, -0.79565246, 0.2371364, -0.6538574, -0.09239033, -0.35505938, -0.28133177, -0.76474658, -0.45523695, 0.05232185, -1.71427051, 0.70795835, 0.18788025, 0.1402817, -0.04253285, 0.48357989, -0.158762, 1.17951548, -0.8978362, -0.85566158, -0.05257799, 0.24895868, 0.16921378, -1.63488851, 2.69739057, -1.08452608, -0.54310743, 1.17133811, 1.44753404, 0.73664336, 0.06618319, -1.27041004, -1.44055942, -1.34714651, 0.22980032, 1.36565427, -0.89843346, -1.03469148, -0.5260749, -1.04141253, -2.58715189, -0.64862805, -2.4605015, 0.11164159, -1.98578827, -0.27168584, 0.76134712, -1.10234866, -1.26393187, -1.52201238, 1.92762706, 1.10086773, -0.29592203, 2.11028315, -0.73080732, -0.04952872, -0.13164604, 0.10436002, -0.4000255, 0.53312037, 0.33993857, 0.11626446, -0.38118197, 0.58863583, -0.43186347, 0.31776474, -1.49902242, 1.60618544, -0.26328119, 0.26105919, 1.08501939, -0.35544076, 0.231896, 0.69482221, -1.22858108, 1.76838236, 0.73305912, 1.1790418, 0.62004608, 0.83813702, -0.26037864, 0.74914484, -0.63434351, 1.16884393, -0.0964325, -0.21480496, 0.01332289, -1.26518912, 1.27050124, -0.69882411, -0.30036408, -0.56293061, 0.96131736, 0.85847888, -0.49317113, 1.51356688, 0.30091364, 1.13406852, 0.28256426, 0.06035321, 0.1246994, 0.369739, -1.28718044, -0.13159744, -0.52333476, -0.5361268, 0.64545506, 0.00684978, 0.06517127, -0.95655232, 0.54314332, 0.29707475, -0.24562592, 0.87235749, -1.07324121, 0.37826216, -1.14956194, 1.09818573, 0.6534194, -0.50697356, -0.16812413, -0.53556594, -0.35089977, -0.74195996, 0.40828665, 0.50061713, 0.31316687, -0.46757834, 0.74137266, 0.20571767, -1.47991406, 0.7365356, -0.22475025, -0.1339124, -0.24707552, -0.56605377, 1.47341579, 0.96407278, -0.4733757, -1.2013399, -0.05409567, -1.21358051, 0.23097913, -0.19379787, 0.1235754, 0.3835123, -0.37517917, -0.57059294, 0.71343865, -2.03077904, 0.46847596, -2.07172929, -0.1607105, -0.51679746, 0.03041401, -0.89220986, 0.21591287, -0.53424826, -0.20974912, -0.45488571, -0.16682064, 0.99676333, 0.36898972, -1.49944444, 1.26609206, -0.70696238, -1.44257274, -0.21845022, -0.142134, 0.05221587, 0.65404742, -1.19063154, 0.49702661, 0.27069621, -0.85208763, -0.09702888, -0.07301064, -0.23345152, 0.75322569, 1.19079231, -1.0815044, 0.81294245, -1.96665349, 0.31214446, 0.48393353, -0.68575822, 0.0471126, -1.17653192, -0.38780267, 0.21730394, -0.25193044, -0.87854116, 0.11271054, 1.22551277, 0.12495602, -1.08127796, -0.04506021, 1.30313618, -0.3125118, 0.34883724, 0.613603, -0.18576361, 0.68378918, -0.01534037, -1.06491078, -0.21837704, -0.33104125, -0.18588764, 0.0743747, 0.01562586, 0.44475956, -0.0665213, -0.14246049, -0.60873583, -1.73718055, 1.48320477, -0.37992238, 0.34982873, -0.84814653, -1.30667908, 0.64669505, -0.65278273, -0.29838735, -1.05872409, 0.00374465, 2.05352248, -0.71038278, 0.2053318, -1.54485771, -1.29339939, -0.25405769, -1.12565931, -0.1187875, -0.67166574, 0.42216063, 0.59332394, -0.49864246, 0.83970167, -0.71347409, 0.91632027, -0.15507512, 0.68759454, -1.29473366, 0.90841905, 0.14119616, 0.77744963, 0.25503965, -1.28097013, 0.44068451, 0.42463812, -1.22785289, -0.10194648, -1.12285549, 0.07192283, 0.75228205, 1.11411685, 0.27309675, -1.69726223, -0.40578211, -0.4449591, 0.1075989, 0.75152201, 0.42388041, 1.9716984, -0.85843986, 1.24664224, -0.7261308, 1.90043606, 0.6662498, -0.18650988, -0.41438609, -0.43799568, -0.20897853, -0.81612777, -0.84858067, -0.67087688, 2.31564426, -1.62657933, 0.23637944, 0.10345757, -0.07180217, -1.21673319, 0.55898607, 0.93956284, -0.86467198, -0.49894881, 0.89546923, 1.59090759, 0.60650188, 1.68495406, 0.01383839, -0.97293602, 0.35029413, 0.92358284, -0.29211078, -1.78971208, -1.08552769, 1.18669008, -0.28002439, 0.27405075, 0.0694624, -0.68740036, -0.4378249, 0.24358519, -0.83461123, 1.35030876, -0.23716267, -0.2452278, 0.34070813, -0.86693761, 1.48266399, 0.3284211, -0.7516317, 0.31527463, 0.17078875, -0.89807427, -1.14187877, -1.60856579, -0.2829414, 1.1932368, 0.10428649, -1.24914791, -0.31067368, -0.98027293, 0.18272194, -0.16717895, -1.58394599, -0.08220539, 0.3796718, 0.94435941, 0.09364688, -0.26796703, -0.98677443, -0.57043364, -0.13938946, -1.39233404, -0.51054892, -1.34285342, 0.89913058, -0.24026141, -0.26748228, 1.23028654, 0.80222044, -0.62086781, -1.05725053, 0.75431359, -1.3571881, -0.19296285, 0.67547503, -2.16736668, 0.02298493, 0.77733993, 1.07596213, -0.90262257, 0.52154025, 0.23264912, 0.43299946, 1.08888254, 0.70700848, -0.32155372, 0.97833133, 0.19432768, 1.03326106, -0.48738812, -0.51644813, 0.65837451, -0.01592093, 0.88540515, 1.52966435, -0.34930729, -0.93960365, -0.99854216, -0.51736691, -0.02839116, 0.02431064, 1.07381558, 0.01513503, -0.37656687, 0.31340886, -1.31398129, -0.65237506, 0.44979253, 0.09329471, 1.06427764, 0.44931727, 0.35209299, 0.35885106, 0.76910627, -1.06751773, -0.87780018, -0.72838127, 0.01398158, -0.66760187, 0.38354874, 0.90765758, 0.54995534, -1.82158927, -0.84665051, 1.41485362, 0.20534405, -0.78586975, -0.75601187, 1.78271281, -0.13753841, 0.38983535, -0.63615463, -0.6948763, 0.75618016, -1.26441318, 1.13034315, -1.09471196, -0.50284076, -0.6451668, -1.16220905, 1.11388721, -0.30927062, 1.65972238, -0.66007671, 0.23454014, -0.13631757, 0.13627083, -1.07727314, -0.50684795, -1.18287094, -0.40616086, -0.20126522, 0.16991968, 0.50217944, 0.1961915, 0.42198197, -0.92393261, 0.50688396, -0.16413714, -0.09814521, 2.68492743, -1.42601875, 0.52994631, -0.36144077, 0.52451237, -0.36552118, -0.79249003, 0.02199418, 0.56084089, 0.73804126, -0.445993, -1.40333584, 0.29517069, 0.08607819, 0.22432609, -0.22094706, -0.40955473, 0.7872725, 1.01902084, 1.15957053, 0.51434086, 0.84529203, 0.39028861, 0.12781729, -1.41811562, 0.57603583, 1.720511, -0.89654866, -0.32903768, -1.86364959, -0.61600145, 0.68426517, 1.25732209, 0.07710798, 0.85927664, -0.51732527, -0.46382923, 0.33701252]);
  const b1 = new Float64Array([-0.04501977, -0.06786464, 0.38517503, -2.00965485, -1.36006197, -0.90984871, -0.23903812, 1.69543252, 1.76357497, 0.17895431, 0.8791027, 1.19681084, -0.48453938, 0.0806035, -0.71477135, -0.60765939, 0.05872659, -0.17883368, 0.40503165, 1.20432928, 0.91815939, -0.7164548, 0.33941502, -1.29564506]);
  const W2 = new Float64Array([-0.36203105, 1.11444042, 0.28920704, -0.22715359, 0.00270962, 1.45586036, -0.77075687, 0.89857848, -1.46352403, 0.73593244, -0.81715742, 1.61900263, 0.57722728, 0.83162681, -0.73321608, 0.97808978, 1.11773662, 0.32548796, -0.39462803, -0.73667914, -0.59607671, -0.24226012, 0.25649527, -1.34262486, 0.03283518, -1.09171208, -1.88656586, 1.70260708, 0.58504755, -0.53323236, -2.04806689, -0.09521885, -0.30769222, -0.31355321, -1.8862895, 0.02278435, 0.31846112, 0.29290406, -0.75038541, 0.78915758, -0.55909132, 0.38077086, 1.71739705, -0.5260213, 1.96506615, 1.3470564, 0.2125017, 0.72912708, -1.90630018, 0.07590951, 0.71002739, -0.35346408, -1.05541509, -0.4163805, -0.02324588, 0.54953302, 0.20911513, -1.34690209, -0.48023958, 1.08527773, -1.18666397, 0.31494641, 0.86138801, -1.41629148, -0.05353487, -1.14293593, -0.68753118, -0.39283203, 0.2671172, 1.68963676, -1.08845957, -1.98094739, 0.01075708, 1.65126559, -0.08133203, -0.62815516, -0.31103716, -0.09027343, 0.64940858, 0.28259198, -1.18178605, 0.58665342, -0.57575918, -0.22535738, 1.35507036, 0.9915464, -0.52056709, -0.56266391, -0.40176792, -0.22699788, -0.12676844, 0.11992453, 1.41632987, 1.16211105, -0.50610153, 0.61528053, 0.91356906, -0.3925811, -0.73127091, -0.51968519, 1.1003368, 0.10000301, -1.26137213, 0.34369594, -0.56356163, 0.89075511, -0.0135315, -1.30178842, 1.41087358, -0.68499768, 0.01366404, 0.32507579, -0.09625499, -0.20816465, 0.33347069, 0.8862049, 1.26070943, -0.34157614, 0.81729894, 0.20543872, -0.21103876, 0.98311281, -0.63741953, 0.68976419, -0.19568339, 0.40472257, 0.54309838, -0.51200408, 0.52858669, -0.86846921, 0.99464118, 1.12978822, 1.19455755, -1.22806157, -0.05500492, -0.91016055, -1.65694966, 0.35652601, -0.71897884, -0.36048578, 0.10108922, -0.04715849, -0.3677025, 1.07281849, -1.19431563, 0.26561121, 0.13345755, -0.85930778, 0.02842402, 0.19571137, 0.59756238, 2.41538574, 2.32359599, -0.38358409, -0.21717573, 0.28939673, -0.43117385, 0.61475973, -0.61523519, -0.60340667, 0.29507391, 0.80205183, -1.24594185, 1.04027813, -1.61939228, 1.23979721, -0.28813965, -0.3861148, -0.86221249, -0.2220389, 0.06887766, -0.47672538, -0.43456517, 0.26197367, 0.75568015, -1.7019827, 0.25513592, 0.59381781, -0.7520223, 0.20593254, -1.08012467, 0.16865834, -0.60973157, -0.18826232, 0.5217142, -0.00328153, -0.99608961, 0.205683, 0.39597579, -0.34881315, -0.70503439, 0.26652402, 1.04581803, -1.5241366, -0.9393408, -0.69518474, -0.65903632, -0.96433342, -1.38817449, -0.64982999, 0.86033103, -0.99271215, 0.47439341, -0.57632501, 0.11059336, 0.24997572, -0.09321106, 0.90894957, -0.73228278, 0.37412336, -0.98320035, 1.75183524, -0.88956563, 0.12995636, 0.9505478, 0.11578967, -0.48724716, -0.95717149, -0.62536783, 1.27679098, -1.4419048, -0.20956439, -2.17584731, -0.69319636, 0.37043723, -1.12816826, -1.37334602, -0.82044366, -0.19347451, 0.23088948, 0.80113348, 0.14411953, 1.11029387, -0.51955156, -0.17202987, 0.51053749, 0.85386444, 0.39601311, -0.60352591, 0.11745979, -0.39188141, -0.44682297, 0.65676566, -0.50768162, -0.24124639, -1.15518148, 0.17612402, -0.76767696, -0.11091289, -0.77821176, 0.81234848, 0.37009811, -0.7010621, 0.83902131, 0.12094033, -0.7810462, -0.1332277, -0.03389862, -0.39428638, 1.14337448, 0.33159995, 1.03448594, -0.80235438, 1.24789609, -0.92480733, -1.5242533, -0.08531325, 0.48883467, -0.25473957, 0.06262591, -0.97318266, 0.41024863, -0.30896329, 2.15180933, -0.63072505, -0.39100527, 0.83211227, 1.26026154, -0.6556551, 0.61631494, -0.02888172, -0.09189633, 1.53665684, 0.1575344, 0.95175782, 1.35691282, 0.98454785, -0.1392527, 0.19864182, -1.14189014, -1.63201371, 0.13369249, -0.3291153, 0.40165933, -2.18481807, 0.6504763, -0.81479198, 0.75151765, -0.72908316, 0.29175708, -0.23806541, 0.06329758, -1.00491806, 0.4590159, -0.9329038, -0.43917329, 0.69736697, -0.68497323, 0.13183705, 0.10687794, 1.5750525, -0.59614241, 0.63789167, -0.58595206, -0.05270211, -0.84949346, 1.17826848, 1.32127682, -0.00467535, 1.40060059, 0.757025, 0.09849058, 0.02944816, -0.54012028, -1.40016106, -0.97348785, -0.6733093, -0.26210343, -0.97918476, 0.36894944, 0.9417323, 0.47074119, 0.6202772, -0.09401513, -2.10119479, -0.02145509, -1.42549668, 0.46424606, -0.12488351, 0.3038293, 0.66651838, -0.68854441, 1.6067379, 0.62734875, 1.14394337, -0.24149576, 0.65424192, 1.62719579, 0.97703151, -0.61650132, 0.16990306, 0.73970402, 0.17935936, 1.28145179, 0.71661582, 0.23285912, 0.63221769, 0.57523213, 1.41478324, -0.2802291, 0.32042282, 0.67366042, -0.04906987, 0.61704318, 0.79384694, 1.10959013, -0.36257566, -1.32063167, 0.56139142, 0.2317525, -1.59723844, -1.8584276, 2.56907729, 0.32345626, 0.65911366, -0.70140495, -0.07489592, -1.57833011, 1.06858397, 1.51780039, 0.7346972, 0.32760107, 0.03618043, 0.19593001]);
  const b2 = new Float64Array([0.89567392, 0.39791317, -0.57053053, 0.52263103, -0.54315672, 0.43907682, -1.05207441, -0.38643489, 0.17394048, -0.08847069, 0.8231733, -1.1758024, 0.14474272, -0.06573147, -0.65300272, 0.68912112]);
  const W3 = new Float64Array([-0.73318682, 5.36539283, -3.53490891, 5.90103767, -2.63806588, -0.59232742, 3.27827034, -3.55047722, -1.70372062, -1.53539041, 1.01197529, 0.94308066, 0.06252869, -1.97690767, -2.18696985, 3.80776275, 0.12836789, 5.68714188, -0.18236897, 9.60572463, -0.25151508, 1.25617159, 4.1496217, -1.68856561, -2.38913261, -1.01929024, 0.40192007, 0.98074291, 1.86815676, -0.05416323, 1.61387904, 0.53795982, -0.42596855, 0.62088318, -0.62067109, 2.5158814, -0.78244993, -0.06453228, 1.0634106, 1.84857413, 0.45275362, -2.75462688, 0.27071099, 0.53466477, -4.73197392, -0.49632036, -2.0222201, -1.28468241, -0.84320121, 0.53592403, -0.20404542, 6.07982336, 4.2558285, 2.62141053, 1.39801581, 5.13841093, -1.43188939, 4.51980592, 1.67193398, 0.39944905, 0.51520341, -3.62814928, 0.56838028, -6.17492122, -0.55230076, 7.01651921, -4.25641426, 9.97742156, -5.7867469, -0.23477681, -0.3762071, -1.02097498, -4.50295625, -0.876215, 3.27588154, 2.09851357, -0.90801454, 0.2844138, -0.56385995, 0.77840142]);
  const b3 = new Float64Array([1.0568041, -0.10669929, -0.88836877, -0.03010754, -0.46700424]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.12919988, 0.53839085, -0.1060256, 0.18404706, -1.84451855, -0.2654118, -0.96417753, 0.19694201, -0.1316366, -1.09859573, 0.20089892, 0.4053082, 0.41059322, 0.34122344, -0.33941922, -0.60747516, -0.23366435, 0.3661617, 0.90760967, -0.20897337, 0.95617585, -0.52531092, -1.20260868, 0.25895174, 0.36075162, 0.66167732, 0.46454885, -0.409713, 0.96587258, 0.02635149, 0.67326605, -0.87727076, -1.08249929, 0.0675701, 0.68452451, 1.25444908, -0.36469147, -1.72830683, -0.3522396, -0.13956489, 0.46877731, 0.92153177, 1.20344287, -0.02614582, 0.8410064, 0.06633651, -0.26373905, -0.16140108, -0.35537125, -0.60195755, 0.81694713, -0.62569702, 0.49049964, 1.68547244, -0.61301157, -0.7394573, -1.54993101, 0.92090681, -0.09905171, -1.48434426, 0.06712329, -0.96920817, -0.32909871, -0.51625916, 0.51948175, -1.06373098, -0.94466859, -0.16711838, -1.67841318, -0.57880075, -0.44718282, 0.43136932, 1.09984914, 0.76879281, -0.29231537, -0.34075089, 0.13875126, -0.19083625, -0.58389058, 0.2990573, -0.43515077, 0.44894048, 1.5017857, 1.1124457, -0.02559045, 0.94510429, -0.19926982, -0.59673061, 0.4064476, 1.97965291, -0.523701, -1.10911585, -0.23396502, -0.94437975, 0.8450979, 0.429929, 1.16686847, -1.08792432, 0.18349473, 0.71557004, 1.25494788, -0.30248998, 1.43511725, 0.63203774, -0.31191915, -0.42858654, -0.84111098, -2.00535127, 0.08608713, 0.49598659, 2.07053847, 1.60597759, 0.3366828, -0.22281002, -1.35314547, -0.92101901, -1.16667447, 0.74056623, 0.94773047, -0.92817511, -1.86657268, -0.25997904, -0.77814528, -0.15708403, 0.37996977, -0.52248615, -0.96268558, -0.74393704, -1.04759005, 0.71810873, 0.75010374, 0.07684314, 0.61312677, -1.2752957, 0.07869385, -1.29272587, -0.84614424, 1.79130541, 0.41443751, -0.34436736, 0.85821302, -1.28706709, -1.57946258, 0.86588403, 0.34407335, -0.49242266, 1.61308089, -0.80075512, 1.00867526, -1.07276262, -0.19937004, 0.11348028, -1.04952927, -0.26357263, 0.502315, -0.32899089, 0.62314725, -0.82493827, -0.34373542, -0.41511676, -0.30028973, -0.14974018, 0.89107496, -0.2066916, 0.20511613, -2.26749236, -0.08907113, -1.46868928, -0.06046051, -0.20222232, 0.30067437, 0.90743619, 0.40532131, 0.18604324, -0.11580713, -0.48562792, -0.01031199, -0.77580853, 0.66895244, -0.45807735, 0.19890305, 1.04423572, 0.47897106, -0.44629131, 0.16680932, -0.39576426, -0.18037069, -0.43067111, -1.16346728, -0.5143305, 1.08291031, 0.27520681, -0.57399016, -0.69634947, -0.49470007, -0.23408483, 1.30774803, -1.24674451, 0.18855524, -0.61607742, -1.22255446, 1.71805393, -0.083574, 0.6934223, -1.8481099, -0.27376993, -1.17454895, 0.14272256, 0.11276265, 0.3157888, 0.94116905, 1.18179326, 0.80811847, -0.21125064, 0.29018061, 1.28514364, -0.57728162, -0.37644024, -0.85508952, 0.39502617, -0.16487126, -0.55399526, -0.93944557, 0.22304983, -0.40875941, 0.51243544, -0.26842774, -0.08311363, 0.42731917, 0.3331231, -1.49283208, 1.65904085, -0.63747887, -0.08686399, -0.21013847, 1.86649012, -1.10214724, 0.0265192, -0.26370607, -2.08958289, 0.14572481, -2.7562922, -1.63838789, -1.02839787, 0.436912, -0.77784546, -0.38244757, -1.50218174, -0.87980013, 0.6204392, -0.18685724, -0.25550805, 0.06538993, -1.88552871, 0.37356024, -1.07630368, -1.85175301, -0.12844573, -0.84957873, 0.19531525, -0.56409773, 0.11771226, 1.26912131, -0.42566036, -0.64689513, 0.32324206, -0.01811351, -0.4675068, 1.49441298, -2.40135195, -0.7709642, -0.07333278, -0.22380423, -1.23415325, -0.20548278, -0.40844235, 0.28129554, -0.05594934, -1.51964944, -0.86522298, -1.67468189, -1.27298165, 0.56246491, -0.7119768, -0.70566282, -0.15246681, -0.41107516, 0.63565999, -0.2236744, 0.94818793, 0.09433935, -0.40463127, -0.13317247, -0.48678278, 0.90130134, -0.49479485, 0.55181518, -0.72544249, 0.34669671, -0.21822634, 0.72478334, -0.00015779, 0.09494694, -1.33637406, 0.65897185, 0.37715712, -1.94359733, -0.15333243, 0.38681636, 0.99755587, -0.77918575, -0.88368053, 0.56937193, 1.0986412, -0.0063286, -1.19481331, 0.40327863, 1.74304513, -0.29062309, -0.12046315, -0.40488974, 0.06733586, -0.5864114, -0.03977954, -0.53943196, -0.93268546, 0.72747257, -0.50341872, -0.32455451, -0.19119688, 1.26203, 1.32115231, 0.58004996, 1.24379026, -0.09752867, 0.95456556, 1.01712524, 0.32199711, -1.67299999, -0.1203608, 1.43034142, -0.00249132, 0.07435869, 0.62077547, -0.5272084, 2.59266289, -0.14530446, 0.97571757, 0.95104164, -0.49587531, 1.12296808, 0.37678994, -0.32438995, -1.61782993, -0.49110977, 0.48054622, -0.57305494, 0.73637119, 0.59996627, -0.62513343, -0.93888143, 0.13973976, -0.93924959, -0.15394797, 0.86709815, -0.88680711, 0.42357626, 0.80393412, -0.63971255, -1.67282706, 0.33781738, 1.45378643, -1.07606707, 1.25920057, -0.1016934, -0.19269155, 0.98838125, 0.14495898, -0.89328348, 1.0522509, 0.50623302, 0.42726883, -0.68869639, -0.44018062, 1.84150782, -0.59408578, 0.34331978, -0.39553807, -0.9511237, 0.19410909, 1.44209698, -1.04005444, 2.00103385, -0.61206814, 0.3017591, -0.30243556, -0.20696573, -0.90748117, 1.17969408, 1.02747861, -0.50807734, -0.54017285, 3.35569838, -0.29054497, 1.35453779, -0.83753321, -1.07840614, 0.41798364, 0.66156192, 1.42321578, 0.3400416, -1.15941756, -0.47172295, -0.33638498, 0.69234623, -1.00583168, -0.66125072, 0.59734064, -0.109898, 0.64953168, 0.74382221, 0.56988032, -1.7669224, 0.03985264, -0.8884815, -1.8871374, 0.30804287, 1.047233, -0.00242477, -0.48541024, 2.0123724, 1.66439548, 0.10256516, 0.86625983, 0.69709549, 0.28621121, -0.93705224, 0.46101749, 0.42302368, -2.34677794, -1.34523253, -0.85369879, -0.85019653, 1.05960297, -0.35259578, 0.20540335, -0.01254739, 0.74453087, -1.00579491, 0.50553924, 0.20173546, 0.84004475, 0.94619881, 0.81654418, -2.3631754, -0.95024623, -0.12798009, 0.26052984, 0.12221493, 1.98934866, 0.06134287, -1.23755948, -1.55221303, 0.86905162, -0.33574497, -0.785917, 1.79821277, 1.99543148, -0.59893392, -0.72924345, 0.72594461, 0.88571702, -0.80652723, -0.18328393, 0.19164536, 0.39070334, -1.28511416, -1.48279908, 0.2255184, -0.02850824, -0.83065691, -0.92983366, 0.51613866, -0.51841491, 1.21304059, 1.19434286, -0.23825356, -0.78336346, -0.96941738, -1.01372181, 0.25071878, -0.81270147, 0.41247486, 0.04840887, -0.59708023, -1.70989936, -1.31540066, 0.43707815, 0.15903183, -0.65557914, 0.35488817, 0.30326477, 0.01417764, 1.78043017, -0.2347309, -0.00977352, -0.1452394, -0.31506725, 0.29124182, -0.56487455, 1.13568681, 0.60135936, 0.52472101, -0.96473102, -0.03204886, -0.74985515, 2.24862799, -0.47025752, -1.04800781, 1.06676979, -1.3332727, -1.10347546, 0.90924515, -0.9259584, 0.20510289, 1.8890085, -1.00018466, 0.32846825, -0.04377756, 0.1494981, -1.07726775, -2.00005095, -0.45746394, -0.88477777, 0.10832786, -0.96356527, -0.40846596, -1.22084067, -0.53498869, -0.60472866, -1.06906236, 1.43677127, 1.45554181, -0.29889496, -0.36577127, 0.62508352, 0.11447551, 0.7359401, -1.8138315, -1.38096985, -0.15439718, 0.49077554, 0.4435932, 0.11377517, 0.76599221, -0.61566495, 0.64040563, -0.41730931, -1.1750121, 1.12287294, -0.11695974, -0.79565246, 0.2371364, -0.6538574, -0.09239033, -0.35505938, -0.28133177, -0.76474658, -0.45523695, 0.05232185, -1.71427051, 0.70795835, 0.18788025, 0.1402817, -0.04253285, 0.48357989, -0.158762, 1.17951548, -0.8978362, -0.85566158, -0.05257799, 0.24895868, 0.16921378, -1.63488851, 2.69739057, -1.08452608, -0.54310743, 1.17133811, 1.44753404, 0.73664336, 0.06618319, -1.27041004, -1.44055942, -1.34714651, 0.22980032, 1.36565427, -0.89843346, -1.03469148, -0.5260749, -1.04141253, -2.58715189, -0.64862805, -2.4605015, 0.11164159, -1.98578827, -0.27168584, 0.76134712, -1.10234866, -1.26393187, -1.52201238, 1.92762706, 1.10086773, -0.29592203, 2.11028315, -0.73080732, -0.04952872, -0.13164604, 0.10436002, -0.4000255, 0.53312037, 0.33993857, 0.11626446, -0.38118197, 0.58863583, -0.43186347, 0.31776474, -1.49902242, 1.60618544, -0.26328119, 0.26105919, 1.08501939, -0.35544076, 0.231896, 0.69482221, -1.22858108, 1.76838236, 0.73305912, 1.1790418, 0.62004608, 0.83813702, -0.26037864, 0.74914484, -0.63434351, 1.16884393, -0.0964325, -0.21480496, 0.01332289, -1.26518912, 1.27050124, -0.69882411, -0.30036408, -0.56293061, 0.96131736, 0.85847888, -0.49317113, 1.51356688, 0.30091364, 1.13406852, 0.28256426, 0.06035321, 0.1246994, 0.369739, -1.28718044, -0.13159744, -0.52333476, -0.5361268, 0.64545506, 0.00684978, 0.06517127, -0.95655232, 0.54314332, 0.29707475, -0.24562592, 0.87235749, -1.07324121, 0.37826216, -1.14956194, 1.09818573, 0.6534194, -0.50697356, -0.16812413, -0.53556594, -0.35089977, -0.74195996, 0.40828665, 0.50061713, 0.31316687, -0.46757834, 0.74137266, 0.20571767, -1.47991406, 0.7365356, -0.22475025, -0.1339124, -0.24707552, -0.56605377, 1.47341579, 0.96407278, -0.4733757, -1.2013399, -0.05409567, -1.21358051, 0.23097913, -0.19379787, 0.1235754, 0.3835123, -0.37517917, -0.57059294, 0.71343865, -2.03077904, 0.46847596, -2.07172929, -0.1607105, -0.51679746, 0.03041401, -0.89220986, 0.21591287, -0.53424826, -0.20974912, -0.45488571, -0.16682064, 0.99676333, 0.36898972, -1.49944444, 1.26609206, -0.70696238, -1.44257274, -0.21845022, -0.142134, 0.05221587, 0.65404742, -1.19063154, 0.49702661, 0.27069621, -0.85208763, -0.09702888, -0.07301064, -0.23345152, 0.75322569, 1.19079231, -1.0815044, 0.81294245, -1.96665349, 0.31214446, 0.48393353, -0.68575822, 0.0471126, -1.17653192, -0.38780267, 0.21730394, -0.25193044, -0.87854116, 0.11271054, 1.22551277, 0.12495602, -1.08127796, -0.04506021, 1.30313618, -0.3125118, 0.34883724, 0.613603, -0.18576361, 0.68378918, -0.01534037, -1.06491078, -0.21837704, -0.33104125, -0.18588764, 0.0743747, 0.01562586, 0.44475956, -0.0665213, -0.14246049, -0.60873583, -1.73718055, 1.48320477, -0.37992238, 0.34982873, -0.84814653, -1.30667908, 0.64669505, -0.65278273, -0.29838735, -1.05872409, 0.00374465, 2.05352248, -0.71038278, 0.2053318, -1.54485771, -1.29339939, -0.25405769, -1.12565931, -0.1187875, -0.67166574, 0.42216063, 0.59332394, -0.49864246, 0.83970167, -0.71347409, 0.91632027, -0.15507512, 0.68759454, -1.29473366, 0.90841905, 0.14119616, 0.77744963, 0.25503965, -1.28097013, 0.44068451, 0.42463812, -1.22785289, -0.10194648, -1.12285549, 0.07192283, 0.75228205, 1.11411685, 0.27309675, -1.69726223, -0.40578211, -0.4449591, 0.1075989, 0.75152201, 0.42388041, 1.9716984, -0.85843986, 1.24664224, -0.7261308, 1.90043606, 0.6662498, -0.18650988, -0.41438609, -0.43799568, -0.20897853, -0.81612777, -0.84858067, -0.67087688, 2.31564426, -1.62657933, 0.23637944, 0.10345757, -0.07180217, -1.21673319, 0.55898607, 0.93956284, -0.86467198, -0.49894881, 0.89546923, 1.59090759, 0.60650188, 1.68495406, 0.01383839, -0.97293602, 0.35029413, 0.92358284, -0.29211078, -1.78971208, -1.08552769, 1.18669008, -0.28002439, 0.27405075, 0.0694624, -0.68740036, -0.4378249, 0.24358519, -0.83461123, 1.35030876, -0.23716267, -0.2452278, 0.34070813, -0.86693761, 1.48266399, 0.3284211, -0.7516317, 0.31527463, 0.17078875, -0.89807427, -1.14187877, -1.60856579, -0.2829414, 1.1932368, 0.10428649, -1.24914791, -0.31067368, -0.98027293, 0.18272194, -0.16717895, -1.58394599, -0.08220539, 0.3796718, 0.94435941, 0.09364688, -0.26796703, -0.98677443, -0.57043364, -0.13938946, -1.39233404, -0.51054892, -1.34285342, 0.89913058, -0.24026141, -0.26748228, 1.23028654, 0.80222044, -0.62086781, -1.05725053, 0.75431359, -1.3571881, -0.19296285, 0.67547503, -2.16736668, 0.02298493, 0.77733993, 1.07596213, -0.90262257, 0.52154025, 0.23264912, 0.43299946, 1.08888254, 0.70700848, -0.32155372, 0.97833133, 0.19432768, 1.03326106, -0.48738812, -0.51644813, 0.65837451, -0.01592093, 0.88540515, 1.52966435, -0.34930729, -0.93960365, -0.99854216, -0.51736691, -0.02839116, 0.02431064, 1.07381558, 0.01513503, -0.37656687, 0.31340886, -1.31398129, -0.65237506, 0.44979253, 0.09329471, 1.06427764, 0.44931727, 0.35209299, 0.35885106, 0.76910627, -1.06751773, -0.87780018, -0.72838127, 0.01398158, -0.66760187, 0.38354874, 0.90765758, 0.54995534, -1.82158927, -0.84665051, 1.41485362, 0.20534405, -0.78586975, -0.75601187, 1.78271281, -0.13753841, 0.38983535, -0.63615463, -0.6948763, 0.75618016, -1.26441318, 1.13034315, -1.09471196, -0.50284076, -0.6451668, -1.16220905, 1.11388721, -0.30927062, 1.65972238, -0.66007671, 0.23454014, -0.13631757, 0.13627083, -1.07727314, -0.50684795, -1.18287094, -0.40616086, -0.20126522, 0.16991968, 0.50217944, 0.1961915, 0.42198197, -0.92393261, 0.50688396, -0.16413714, -0.09814521, 2.68492743, -1.42601875, 0.52994631, -0.36144077, 0.52451237, -0.36552118, -0.79249003, 0.02199418, 0.56084089, 0.73804126, -0.445993, -1.40333584, 0.29517069, 0.08607819, 0.22432609, -0.22094706, -0.40955473, 0.7872725, 1.01902084, 1.15957053, 0.51434086, 0.84529203, 0.39028861, 0.12781729, -1.41811562, 0.57603583, 1.720511, -0.89654866, -0.32903768, -1.86364959, -0.61600145, 0.68426517, 1.25732209, 0.07710798, 0.85927664, -0.51732527, -0.46382923, 0.33701252]);
  const b1 = new Float64Array([-0.04501977, -0.06786464, 0.38517503, -2.00965485, -1.36006197, -0.90984871, -0.23903812, 1.69543252, 1.76357497, 0.17895431, 0.8791027, 1.19681084, -0.48453938, 0.0806035, -0.71477135, -0.60765939, 0.05872659, -0.17883368, 0.40503165, 1.20432928, 0.91815939, -0.7164548, 0.33941502, -1.29564506]);
  const W2 = new Float64Array([-0.36203105, 1.11444042, 0.28920704, -0.22715359, 0.00270962, 1.45586036, -0.77075687, 0.89857848, -1.46352403, 0.73593244, -0.81715742, 1.61900263, 0.57722728, 0.83162681, -0.73321608, 0.97808978, 1.11773662, 0.32548796, -0.39462803, -0.73667914, -0.59607671, -0.24226012, 0.25649527, -1.34262486, 0.03283518, -1.09171208, -1.88656586, 1.70260708, 0.58504755, -0.53323236, -2.04806689, -0.09521885, -0.30769222, -0.31355321, -1.8862895, 0.02278435, 0.31846112, 0.29290406, -0.75038541, 0.78915758, -0.55909132, 0.38077086, 1.71739705, -0.5260213, 1.96506615, 1.3470564, 0.2125017, 0.72912708, -1.90630018, 0.07590951, 0.71002739, -0.35346408, -1.05541509, -0.4163805, -0.02324588, 0.54953302, 0.20911513, -1.34690209, -0.48023958, 1.08527773, -1.18666397, 0.31494641, 0.86138801, -1.41629148, -0.05353487, -1.14293593, -0.68753118, -0.39283203, 0.2671172, 1.68963676, -1.08845957, -1.98094739, 0.01075708, 1.65126559, -0.08133203, -0.62815516, -0.31103716, -0.09027343, 0.64940858, 0.28259198, -1.18178605, 0.58665342, -0.57575918, -0.22535738, 1.35507036, 0.9915464, -0.52056709, -0.56266391, -0.40176792, -0.22699788, -0.12676844, 0.11992453, 1.41632987, 1.16211105, -0.50610153, 0.61528053, 0.91356906, -0.3925811, -0.73127091, -0.51968519, 1.1003368, 0.10000301, -1.26137213, 0.34369594, -0.56356163, 0.89075511, -0.0135315, -1.30178842, 1.41087358, -0.68499768, 0.01366404, 0.32507579, -0.09625499, -0.20816465, 0.33347069, 0.8862049, 1.26070943, -0.34157614, 0.81729894, 0.20543872, -0.21103876, 0.98311281, -0.63741953, 0.68976419, -0.19568339, 0.40472257, 0.54309838, -0.51200408, 0.52858669, -0.86846921, 0.99464118, 1.12978822, 1.19455755, -1.22806157, -0.05500492, -0.91016055, -1.65694966, 0.35652601, -0.71897884, -0.36048578, 0.10108922, -0.04715849, -0.3677025, 1.07281849, -1.19431563, 0.26561121, 0.13345755, -0.85930778, 0.02842402, 0.19571137, 0.59756238, 2.41538574, 2.32359599, -0.38358409, -0.21717573, 0.28939673, -0.43117385, 0.61475973, -0.61523519, -0.60340667, 0.29507391, 0.80205183, -1.24594185, 1.04027813, -1.61939228, 1.23979721, -0.28813965, -0.3861148, -0.86221249, -0.2220389, 0.06887766, -0.47672538, -0.43456517, 0.26197367, 0.75568015, -1.7019827, 0.25513592, 0.59381781, -0.7520223, 0.20593254, -1.08012467, 0.16865834, -0.60973157, -0.18826232, 0.5217142, -0.00328153, -0.99608961, 0.205683, 0.39597579, -0.34881315, -0.70503439, 0.26652402, 1.04581803, -1.5241366, -0.9393408, -0.69518474, -0.65903632, -0.96433342, -1.38817449, -0.64982999, 0.86033103, -0.99271215, 0.47439341, -0.57632501, 0.11059336, 0.24997572, -0.09321106, 0.90894957, -0.73228278, 0.37412336, -0.98320035, 1.75183524, -0.88956563, 0.12995636, 0.9505478, 0.11578967, -0.48724716, -0.95717149, -0.62536783, 1.27679098, -1.4419048, -0.20956439, -2.17584731, -0.69319636, 0.37043723, -1.12816826, -1.37334602, -0.82044366, -0.19347451, 0.23088948, 0.80113348, 0.14411953, 1.11029387, -0.51955156, -0.17202987, 0.51053749, 0.85386444, 0.39601311, -0.60352591, 0.11745979, -0.39188141, -0.44682297, 0.65676566, -0.50768162, -0.24124639, -1.15518148, 0.17612402, -0.76767696, -0.11091289, -0.77821176, 0.81234848, 0.37009811, -0.7010621, 0.83902131, 0.12094033, -0.7810462, -0.1332277, -0.03389862, -0.39428638, 1.14337448, 0.33159995, 1.03448594, -0.80235438, 1.24789609, -0.92480733, -1.5242533, -0.08531325, 0.48883467, -0.25473957, 0.06262591, -0.97318266, 0.41024863, -0.30896329, 2.15180933, -0.63072505, -0.39100527, 0.83211227, 1.26026154, -0.6556551, 0.61631494, -0.02888172, -0.09189633, 1.53665684, 0.1575344, 0.95175782, 1.35691282, 0.98454785, -0.1392527, 0.19864182, -1.14189014, -1.63201371, 0.13369249, -0.3291153, 0.40165933, -2.18481807, 0.6504763, -0.81479198, 0.75151765, -0.72908316, 0.29175708, -0.23806541, 0.06329758, -1.00491806, 0.4590159, -0.9329038, -0.43917329, 0.69736697, -0.68497323, 0.13183705, 0.10687794, 1.5750525, -0.59614241, 0.63789167, -0.58595206, -0.05270211, -0.84949346, 1.17826848, 1.32127682, -0.00467535, 1.40060059, 0.757025, 0.09849058, 0.02944816, -0.54012028, -1.40016106, -0.97348785, -0.6733093, -0.26210343, -0.97918476, 0.36894944, 0.9417323, 0.47074119, 0.6202772, -0.09401513, -2.10119479, -0.02145509, -1.42549668, 0.46424606, -0.12488351, 0.3038293, 0.66651838, -0.68854441, 1.6067379, 0.62734875, 1.14394337, -0.24149576, 0.65424192, 1.62719579, 0.97703151, -0.61650132, 0.16990306, 0.73970402, 0.17935936, 1.28145179, 0.71661582, 0.23285912, 0.63221769, 0.57523213, 1.41478324, -0.2802291, 0.32042282, 0.67366042, -0.04906987, 0.61704318, 0.79384694, 1.10959013, -0.36257566, -1.32063167, 0.56139142, 0.2317525, -1.59723844, -1.8584276, 2.56907729, 0.32345626, 0.65911366, -0.70140495, -0.07489592, -1.57833011, 1.06858397, 1.51780039, 0.7346972, 0.32760107, 0.03618043, 0.19593001]);
  const b2 = new Float64Array([0.89567392, 0.39791317, -0.57053053, 0.52263103, -0.54315672, 0.43907682, -1.05207441, -0.38643489, 0.17394048, -0.08847069, 0.8231733, -1.1758024, 0.14474272, -0.06573147, -0.65300272, 0.68912112]);
  const W3 = new Float64Array([-0.73318682, 5.36539283, -3.53490891, 5.90103767, -2.63806588, -0.59232742, 3.27827034, -3.55047722, -1.70372062, -1.53539041, 1.01197529, 0.94308066, 0.06252869, -1.97690767, -2.18696985, 3.80776275, 0.12836789, 5.68714188, -0.18236897, 9.60572463, -0.25151508, 1.25617159, 4.1496217, -1.68856561, -2.38913261, -1.01929024, 0.40192007, 0.98074291, 1.86815676, -0.05416323, 1.61387904, 0.53795982, -0.42596855, 0.62088318, -0.62067109, 2.5158814, -0.78244993, -0.06453228, 1.0634106, 1.84857413, 0.45275362, -2.75462688, 0.27071099, 0.53466477, -4.73197392, -0.49632036, -2.0222201, -1.28468241, -0.84320121, 0.53592403, -0.20404542, 6.07982336, 4.2558285, 2.62141053, 1.39801581, 5.13841093, -1.43188939, 4.51980592, 1.67193398, 0.39944905, 0.51520341, -3.62814928, 0.56838028, -6.17492122, -0.55230076, 7.01651921, -4.25641426, 9.97742156, -5.7867469, -0.23477681, -0.3762071, -1.02097498, -4.50295625, -0.876215, 3.27588154, 2.09851357, -0.90801454, 0.2844138, -0.56385995, 0.77840142]);
  const b3 = new Float64Array([1.0568041, -0.10669929, -0.88836877, -0.03010754, -0.46700424]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
