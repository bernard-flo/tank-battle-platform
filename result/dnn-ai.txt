function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = [].concat(xSelf, xEn, xAl, xBl);

  // 네트워크 파라미터
  const W1 = [0.11656912, 0.01260383, -0.32057178, -0.18905277, -0.09714652, -0.24313108, 0.17302394, -0.14495162, -0.21558669, -0.33901278, -0.12184461, 0.18955023, -0.21425091, 0.08283297, -0.29751645, -0.4144216, 0.17116984, -0.2208081, -0.23572377, -0.07284823, 0.24693006, 0.34950426, 0.03112469, -0.17990605, 0.26801496, 0.72616566, 0.17461417, 0.01764007, 0.78600584, -0.31605109, -0.03393034, -0.30264372, -0.27311637, 0.62776753, 0.18216503, 0.10052461, 0.07666186, -0.30140457, 0.16467462, 0.00314817, -0.02803327, -0.2193544, -0.25914014, 0.10464072, 0.10929909, 0.17981487, -0.11175828, 0.13891904, 0.34446455, -0.03214401, 0.15143138, -0.08288712, 2.1773745, 0.66184581, 0.05174873, 0.0539937, -0.16999456, -0.24063937, 0.12051248, -0.03339576, 0.07139236, -0.02115658, 0.02482972, -0.86448745, -0.57878824, 0.05921001, 0.20836453, 0.04476935, 0.04230419, -0.12696441, 0.04823266, -0.41672078, 0.80723679, 0.37144886, -0.30848678, 0.50578728, -0.39003326, 0.67581631, -0.02034531, -0.13267806, 0.28439678, -0.17117114, 0.32947826, 0.04035268, -0.36672863, 0.08249913, -0.38825069, -0.42049487, -0.01858038, 0.03009207, -0.56230488, -0.11604681, -0.41158262, 0.0441916, 0.87962326, 1.29116443, -0.48867992, -0.14634261, 0.47691828, -0.05259212, 0.03380839, -0.2758087, -0.01967602, 0.01628491, 0.0657156, 0.31262597, 0.20848497, -0.03807146, -0.10761772, -0.28951491, 0.01420879, 0.3844144, -0.18832312, -0.80462206, 0.90815417, 1.27638158, 0.0481103, -0.05091778, 0.35397996, 0.38280478, 1.02580844, -0.09255345, 0.11115765, 0.40604435, 0.7068669, 0.27570792, -0.34855366, -0.05832268, 0.24226477, -0.34137395, -0.29165637, -0.22525584, -0.23300008, -0.10595134, -0.41131194, -0.32275155, -0.24470947, 0.19489653, -1.46915264, 0.20634114, -0.23820239, 0.49519778, 0.57324564, 0.34989206, -0.18650418, 0.36774967, 0.39902684, -0.33766271, -0.13379049, 0.59984486, -0.34552083, 0.11181477, -0.18329685, -1.13658071, -0.62711976, -0.03399629, -0.3571374, 0.37062312, -1.55208303, -0.38085666, 0.00004274, 0.44555405, 0.9913173, -0.97300671, -0.30368865, 0.21488683, 0.06910782, 0.52697813, -0.78491217, -0.16009726, 0.40470786, -0.22781528, 0.34163687, 0.74601177, 0.04822372, 0.31122334, 0.14193186, 0.4045294, -0.04853074, 0.19617735, -0.5600238, -0.93201602, -0.15894012, 0.44960899, -0.16380811, 0.17650275, -0.14008267, 0.17549408, 0.02879807, -0.03526237, -0.11739401, 0.06856943, -0.54230245, -0.6807158, 0.13836145, 0.4085312, 0.11703181, 0.205917, -0.30871627, 0.01029271, 0.94078832, 0.61903494, 0.53553442, -0.17233047, 0.82925244, 0.34912739, 0.96067147, 0.35785498, 0.20609688, 0.60507092, 0.36461142, -0.57561876, 0.55582428, 0.25373296, 0.45807012, 0.19974605, 0.08494931, -0.07611746, 0.297461, 0.21326621, 0.23349938, -0.08789935, -0.04259956, 0.731871, 0.12933701, 0.00748416, 0.29236831, -0.41141938, -0.41411425, -0.05120632, 0.00810806, -0.31937749, -0.39605149, 0.04545084, -0.06541803, 0.70701307, 0.1112314, 0.03537126, 0.18324138, 0.192416, -0.00230517, -0.24664495, -0.07174495, 0.44668221, 0.10233309, -0.03984052, -0.16303642, -0.00561082, 0.32475806, 0.03821171, -0.36204912, -0.38159029, 0.10513158, 0.47383453, 0.27739658, -0.27327185, -0.17936086, 0.33378664, -0.34328281, -0.06477387, -0.12203795, -0.14788203, 0.05020787, -0.37444298, -0.40981099, -0.2783886, 0.98311214, 0.92759979, -0.00520371, 0.08646998, 0.03724115, -0.10862182, -0.10127607, -0.06306517, 0.67518015, 0.11620735, 0.12323183, -0.000749, -0.12554883, 0.02737117, -0.39689931, 0.04925057, 0.29352836, 0.00340176, -0.12321169, -0.37005742, 0.98428522, 1.62612609, 0.15219643, -0.17493699, 0.10782456, 0.18642404, 0.93140537, -0.17727962, 0.10813149, 0.30798851, 0.20138006, 0.39808345, -0.02940169, 0.08942249, 0.0118382, 0.51947075, 0.42439121, -0.00551761, -0.15554035, -0.26754478, 0.00800815, 0.13767964, -0.14606478, -0.71030246, 0.10222601, 0.13578726, -0.01805413, 0.26163815, -0.58847958, 0.43555031, 0.17300121, -0.57468595, -0.01206604, -0.15645349, 0.30313485, -0.75020608, -1.45259757, 0.33232984, 0.36157188, -1.60718019, -1.01943067, -0.1007777, -0.14725204, 0.3544181, 0.46328559, 0.67196597, -0.02653055, -0.35228967, -0.54903328, 0.72128216, 0.73889507, 0.10211226, -1.09572413, -1.14730286, 0.22766139, 0.55213876, -0.10574788, -0.79557923, -0.12688618, -0.27602739, -0.16694259, -0.43416473, -0.08358647, -0.45198533, -0.43173008, -0.09835351, -0.61523846, -0.08767582, 0.08256399, -0.23340027, -0.35089407, 0.68999766, 0.01044201, -0.07452876, -0.29084764, 0.99822029, -0.23558141, 0.05397922, 0.54824991, 0.18093329, -0.18459797, 0.04977722, -0.67608188, 0.58470558, -0.2395082, -0.12696988, 1.23434434, 0.38970846, -0.16523428, -0.4295355, -0.22262463, 0.95914491, -0.8647607, 0.34839563, -0.269823, -0.4789148, 0.1488286, -0.02096427, 0.2196612, -0.28172805, -0.41030713, 0.20895993, 0.33418851, 0.10718393, 0.00751245, 0.12244945, -0.31462119, -0.14042555, 0.11726189, -0.40989137, -0.28186675, -0.10752951, 0.09579376, -0.29615914, -0.19800281, 0.39204366, 0.57933214, 0.13217556, -0.52804167, 0.07117505, 0.14039992, 0.46430646, 0.04018397, -0.25007696, 0.38746384, 0.6142287, -0.05156373, -0.06169037, 0.37997443, 0.42520735, 0.97580372, 0.47520471, -0.21281804, 0.8468674, -0.2038644, 0.47810672, -0.05051733, -0.13141479, 0.77605276, 0.03384848, 0.10650798, 0.32934754, 0.23504761, 0.48556511, 0.4091963, 0.34334739, 0.48250941, 0.32118264, 0.30846639, -0.09986353, -0.10481873, 0.0126358, -0.65511367, -1.81915588, 0.02345465, -0.15668247, -0.09862377, 0.24296676, -0.18007248, 0.07404256, -0.10516072, -0.33238472, 0.08246728, -0.13962502, -1.195236, -0.75366657, -0.05481154, 0.49604476, -0.42407431, 0.28331828, -0.29566093, 0.10096441, 0.78812321, 0.00923245, 0.2653448, -0.29925643, 0.18658936, 0.59484309, 0.19341232, 0.70210834, -0.11120997, 0.55927965, 0.04864629, -0.33075092, 0.31644374, 0.06517006, 0.44038402, -0.28132379, -0.40156235, 0.16674877, -0.28895275, -0.14899585, 0.10938034, 0.05763293, -0.23145349, 0.80737535, 1.79517153, -0.04376242, -0.14166773, -0.19367596, -0.16822073, -0.15257529, -0.033102, 0.0313577, -0.08254242, 0.04965696, 0.1824166, 0.24012152, -0.0116119, -0.10221473, -0.35060292, 0.46862918, 0.14079463, 0.04741571, -0.46612945, -0.5525376, 0.50985789, -0.36679008, 0.12358293, 0.04324134, -0.64506095, 0.58874012, -0.29184706, -0.06507416, 0.11746848, 0.33241326, 0.29369025, -0.53808339, 0.12450444, -0.34416662, -0.54235272, 0.00405574, 0.3351423, -0.24477075, -0.33703204, -0.11569786, 0.08219512, -0.19850019, 0.50064489, -4.16539275, -0.06992304, -0.22031102, -0.12578118, 1.08869709, -0.30188319, -0.46677303, 0.44624126, 0.62824836, 0.00611861, -0.26836834, 0.49544385, 0.58904577, 0.00374667, -0.26553369, -0.0095229, 0.18647884, 0.19596849, -0.12474201, 0.43134062, -0.23344849, -0.14084008, -0.17598133, -0.33350814, 1.00194754, 0.01010018, -0.14755359, 0.2441612, -0.07208423, 0.53818159, 0.4911631, -0.38558399, 0.06544949, -0.31819574, -0.09387737, -0.62945106, -0.36233495, 0.16007471, 0.02631519, -0.01772445, 0.03654983, -0.10491017, 0.11976413, 0.79754624, -0.00124571, -0.57749542, 0.19930433, 0.61239643, -0.26906465, 0.1180577, -0.06076355, 0.88898494, -0.44166098, 0.00722621, 0.06930887, -0.79258125, 0.07918831, -0.09588985, 0.45788676, 0.84958227, -0.19483142, 0.40406669, -1.72495546, 1.7609001, -0.27954135, -0.14432514, -0.56453398, -1.70607594, 0.70521403, 0.00524729, -0.55819512, -0.19133266, -1.32251295, 0.53653363, -0.02823735, -0.30823185, -0.13834728, 0.20942778, -0.06088772, -0.44084244, -0.24381548, -0.29819345, -0.15338387, -0.02457246, -0.00068268, -0.25008147, -0.34822054, -0.1276898, -0.22084982, 0.04297474, -0.08270366, -0.17597566, -0.23325412, 0.07065949, -0.15231691, -0.21031819, -0.05199123, 0.40705074, 0.27849829, -0.28144875, -0.19642361, 0.08677109, 0.04645579, -0.19174716, -0.24619884, 0.52121951, 0.35613798, 0.44570219, -0.1407154, -0.48746821, 0.36939071, -0.45023886, 0.17293403, 0.29330927, -0.68403919, 0.08154632, 0.50107062, 0.10689493, 0.15829561, 0.07131082, -0.35481732, -0.35849691, 0.13439235, -0.0933293, 0.31196508, 0.17218823, 0.19710659, -0.03173697, -0.28046528, 0.22552106, -0.19980917, -0.31690659, -0.37488911, -0.13832425, -0.2592101, 0.1836837, 0.05680613, 0.05323633, -0.51228244, 0.00994088, -0.15135323, 0.37802053, -0.46499023, 0.16475649, 0.29182655, 1.1473361, 0.11269061, 0.16561833, -1.67132837, 0.27801224, 0.08780549, -0.00625492, -0.35493779, -1.0410123, 0.29809505, -0.0081657, -0.17916354, -0.45546139, -0.73221607, 0.35578474, 0.04960554, -0.54198689, -0.28875043, 0.51567381, 0.08426944, 0.18842716, 0.00651904, 0.11050491, 0.1114375, 0.33249839, -0.12783033, 0.35755453, -0.21572296, 0.1818811, 0.01445475, 0.35848873, 0.09113617, 0.22500077, 0.16229392, -0.0419484, -0.10547295, -0.0364918, 0.10482991, 0.22003532, 0.70022856, 0.30269652, 0.16281787, -0.0110107, 0.1377463, 0.1443325, 0.35285322, 0.88144367, 0.83968568, -0.37692111, -0.35345407, -0.10210126, 0.43879143, 0.50732917, -0.24606077, 0.34739484, -0.08593058, 0.42095051, 0.83033535, -0.21615333, 0.00974722, -0.43392147, 0.52731772, 0.11814306, -0.25088612, 0.34407072, 0.10548074, -0.26270129, -0.40593595, 0.35326615, -0.04197826, 0.71234169, -0.26968222, -0.01382421, -0.24488838, 0.55670683, 0.09716758, 0.55940501, -0.42772095, 0.51558781, -0.01208142, -0.00736871, 0.24431332, -0.52527877, -0.09511965, 0.46150864, -0.22166153, -0.79877433, -0.30436118, 0.36297511, 0.03933843, -0.27234601, -0.02335656, -0.28792455, 0.00729501, 0.26460437, -0.61052716, 0.36658722, -0.31188668, 0.34206989, 0.03063796, -0.75257416, 0.10752729, -0.162318, 0.05936824, 0.21701145, 0.15934821, 0.4882908, 0.10100446, 0.0638792, 0.78924017, 0.03327403, 0.24836199, -0.15249644, 0.19428417, 0.26601694, 0.24670011, 0.20228171, 0.0747417, -0.07070433, 0.21361797, 0.0294063, -0.58146931, 0.21824335, 0.04226849, -0.72473443, 0.76012655, -0.46872568, -0.08785797, 0.59917894, -1.2980071, 0.33761511, 0.24036051, -1.36910009, 0.32855425, -0.26183911, 0.2372365, 0.25670148, -0.75584026, 0.32254071, -0.35796282, 0.22020162, 0.55869074, -0.25658921, 0.26156101, -0.17411264, 0.18532143, 0.29185561, 0.20918061, -0.11713574, 0.34779995, 0.18928815, -0.10005055, 0.15094578, -0.1146037, -0.20669081, 0.64503519, -1.04639328, 0.01507657, 0.29870911, 0.21257701, 0.60983952, 0.15646156, -0.05509115, 0.66238896, 0.07440839, 0.23630829, 0.02412448, 0.83461663, 0.72155838, 0.38660228, -0.08585396, 0.33074346, 0.4260826, 0.13318146, 0.27466797, 1.02153936, 0.36384706, -0.39395086, -0.19403108, -0.27995345, 0.55445445, 0.13145753, -0.13378839, 0.11315117, -0.1720372, 0.20048784, 0.06961685, -0.13838247, 0.08546044, 0.08626895, -0.09246028, 0.25848254, 0.02413693, -0.04585539, -0.30594765, -0.05834811, 0.07516183, -0.10106324, 0.33599916, -1.84741915, -0.05719073, 0.30993055, 0.57593458, 0.16477796, 0.18783923, 0.24985636, 0.54761805, -0.26709863, -0.11640327, -0.11844496, -0.44843839, 0.27925438, -0.03878884, 0.1862963, 0.11304902, -0.54879594, -0.15894322, 0.00332476, 1.08532384, -0.79896199, -0.14958974, 0.72145615, -0.16995578, 1.69374766, -0.33555916, 0.22641759, 0.49161883, -0.04161805, 0.95291673, -0.44521579, 0.25807384, 0.58434668, -0.17658288, -0.136333, -0.34848973, -0.07044363, 0.06361424, -0.08767029, -0.17954034, -0.0383828, -0.19257063, 0.59635827, 1.69497215, -0.03449625, -0.04183927, -0.09809114, 0.07265937, -0.0166826, -0.37364595, -0.04373142, 0.56161769, 0.31809769, 0.0920483, 1.20868137, -0.10364103, -0.20305273, -0.21029578, 0.49939112, 0.02383471, 0.25690314, 0.12581766, -0.53883081, 1.02737879, -0.16172813, 0.21644487, -0.22745302, -0.36615935, 0.27739194, -0.22130153, 0.35620296, -0.26859959, -0.29250019, 0.14857086, -0.04918168, -0.06581278, -0.15599119, -0.05416978, 0.14301398, 0.14336164, -0.12940798, 0.01574845, -0.194997, 0.23539887, -0.27963388, 0.80375497, 2.64663007, 0.10556622, 0.26373973, 0.15357508, -0.15883028, -0.29138146, 0.2312997, -0.38603113, -0.31396237, 0.00053986, -0.13197285, 0.27658705, -0.15864011, -0.25352992, -0.09760601, -0.18809161, 0.40986757, -0.30057021, -0.49365223, 0.53620452, 0.06652924, -0.07702021, -0.31837201, 0.18390592, 0.76505927, 0.77708273, -0.58009242, -0.42422276, -0.1669471, 0.01448478, 0.08364221, 0.0537065, -0.63663741, -0.01489829, -0.23169603, -0.06111227, -0.14739884, 0.14914107, -0.1485188, 0.09486223, -0.13377943, -0.13352092, -0.03975135, -0.68753726, -0.231787, 0.06716726, 0.12952125, 0.45532547, 0.07147436, -0.11407593, 0.35358837, 0.59869726, -0.10145802, -0.30169013, 0.12311321, 0.66082689, -0.09242533, -0.13512284, -0.27116293, -0.14377833, -0.22179902, 0.25757522, -0.91809521, -0.8848736, -0.38352263, 0.06044481, -0.61012371, -0.1019073, -0.68873463, -0.24377828, -0.1693349, -0.30199548, 0.05214627, -0.15315334, -0.0578892, -0.21520469, -0.54114474];
  const b1 = [-0.10670646, 0.11572152, -0.22418798, -0.16820795, 0.18565796, 0.12847083, -0.17673837, -0.20969799, -0.16197849, 0.18618439, 0.14572692, -0.16879431, -0.26879764, -0.06515952, -0.15607907, -0.06668094, 0.12983212, 0.27845053, 0.18861751, 0.09587898, 0.03680396, -0.10832145, -0.09668422, -0.09061121];
  const W2 = [0.44350177, -0.12000715, 0.14762373, 0.31447595, -0.00772669, -0.19729412, 0.070103, 0.07499362, 0.18610277, -0.45691684, 0.10452577, 0.20747582, 0.03722777, 0.03042965, -0.00388945, -0.08749616, -0.16914972, -0.00311234, -0.45282962, -0.44984872, 0.08400178, 0.01455487, -0.23453056, 0.52027326, -0.50536745, -0.4634344, -0.13107271, 0.14426717, -0.21875619, -0.5384428, 0.18657387, 0.40861312, 0.16914776, -0.26617532, 0.24732855, -0.84968363, 0.04646352, -0.19636303, 0.0832973, -0.03207353, -0.0134106, -0.11496949, -0.38911338, 0.35632124, 0.39258028, -0.07898395, -0.26200498, 0.38445209, -0.0122499, 0.70315747, 0.48187695, -0.35936992, -0.51257318, 0.03747751, 0.2561838, 0.1103753, 0.09152353, -0.07523923, -0.73906026, 0.46359963, -1.61201307, -0.07953765, -0.12883107, -0.12417271, 0.20756374, 0.18518047, 0.12778842, -0.27943081, -0.72779361, 0.45505154, 0.84657981, -0.22344093, -0.47844284, 0.34003416, 0.52292175, -0.05161418, 0.45357208, 0.22818961, -0.00243962, -0.81742872, -0.71187429, 0.08565115, 0.18499648, 0.41762895, -0.10864102, 0.29156273, -0.32245861, -0.16101362, -0.21667127, 0.06620157, 0.27019688, -0.26300703, 0.13265231, 0.08409508, 0.16636356, -0.49411654, 0.16843664, -0.37739973, -0.39019902, -0.08577088, 0.90506688, 0.05458636, -0.29445318, 0.04640206, -0.2618108, 0.28121695, 1.23258937, -1.2334208, 0.90523829, -0.07330142, -0.27830777, 0.34658614, -0.13024179, -0.09817313, 0.19600003, -0.33783973, 0.15848792, -0.8182816, -0.97440901, 0.04192408, -0.01761016, 0.68116449, -0.21036348, -0.18927593, 0.20913952, 0.12951181, -0.32849995, -0.12801096, -0.23406828, 0.20592771, -0.00656944, -0.15578249, -0.35969023, -0.63625753, -0.22799418, -0.48773259, -0.04218528, 0.3565715, 0.22762908, -0.52458931, 0.12312307, 0.0794097, -0.09435558, -0.20765071, -0.08331699, -0.11910371, -0.60912589, 0.48908295, -0.68336517, -0.22452028, -0.43569307, -0.4242236, -0.417292, -0.29363784, -0.12201705, -0.11885014, -0.25669585, 0.26074779, -0.28313031, 0.19986429, -0.42069552, 0.12231286, 0.40434032, -0.15163645, -0.20703264, -0.02280057, -0.87861712, 0.15574295, -0.51092031, 0.12452921, -0.31159766, -0.17228332, 0.16849375, 0.69706819, 0.25580321, -0.16513983, -0.27138282, 0.22231656, 0.16157296, 0.33990677, -0.21831987, -0.05362667, 0.03191586, -0.05512075, 0.25699847, 0.0603624, 0.40932769, 0.22377369, 0.00484899, -0.2488386, 0.20852063, -0.13213618, 0.00824925, -0.23224688, 0.19035679, 0.08852136, -0.22532033, -0.20743222, -0.05455082, 0.72615561, -0.0602697, -0.37313847, -0.30927832, -0.19973239, -0.048321, 0.49748817, 0.56893179, -0.05677302, -0.04099906, -0.4608484, -0.51867258, 0.0317118, 0.860764, 0.44172428, -0.16184868, 0.60372466, -0.01875745, 0.00659691, -0.47108961, -0.45041016, 0.41508756, 0.23965699, -0.32950929, -0.21874178, -0.02987422, 0.07927656, 0.07329058, -0.6469969, 0.2687739, 0.69116592, -0.13080578, 0.38876649, -0.03500875, 0.22953302, -0.16072227, -0.19802397, -0.32512057, -0.16105087, -0.41474356, 0.16130862, 0.27704406, -0.05220067, -0.00750753, 0.27848617, -0.71233708, 0.23955546, 0.40128131, -0.68924307, -0.00333474, 0.01282985, -0.18038067, 0.13806988, 0.78407584, 0.95647198, -0.13559976, 0.4814807, 0.65152088, 0.60896947, 0.13610062, 0.47628614, -0.21160271, 0.19628027, -0.33598763, 0.25900403, -0.41775, 0.25699068, -0.32824027, -0.13695813, -0.13945952, 0.159675, -0.35426809, 0.28385044, -0.2938311, -0.31840739, 0.29671559, -0.37394448, 0.02214902, -0.45062186, -0.76067182, -0.02359098, 0.07567459, 0.22404626, 0.12962318, 0.00369471, -0.13481045, -0.51751584, 0.12005434, 0.06795926, 0.20701996, -0.92321812, -0.55174721, 0.55327042, 0.10065671, -0.08785817, -0.19914849, -0.57231586, 0.07359595, -0.26415331, 0.0471002, -0.52327122, 1.90546868, -0.42699064, 0.03844813, -0.03991395, -0.1615002, -0.61603472, -0.18297134, 0.17371348, 0.99094236, -0.10705552, -0.89146195, 0.54275078, -0.27637047, 0.08780732, 0.67716783, -0.39809078, -1.02863079, 0.24573183, 0.37193204, 0.11603561, 0.30970725, 0.05877079, -0.78560139, 0.12007972, -0.81904175, 0.62327862, 0.02866845, 0.19126501, 0.20406004, 0.36399028, -0.07659751, 0.057711, -0.49846303, 0.67065908, 0.46549073, -0.08625406, -0.08440807, 0.43984865, 0.07118102, -0.0660345, 0.02380957, 0.37533976, 0.13200925, -0.03232223, -0.36040764, 0.61241457, -0.47488246, 0.36913586, 0.13488608, 0.04741713, -0.35960047, -0.02982263, 0.03838425, 0.27160043, 0.59196516, 0.04188202, -0.25481488, -0.3400094, 0.11715715, 0.06008305, 0.42132389, -0.64857747, 0.12642101, 0.33232981, -0.15200593, -0.03410358, 0.42581749, 0.46277611, 0.281696, -0.57744176, -0.14460467, -0.38784477, -0.03486834, 0.02343516, 0.13413376, 0.15244409, -0.2144859, -0.44474257, -0.02270177, -0.312952, 0.09914382, 0.08631034, 0.29059477, 0.26923704];
  const b2 = [-0.16367468, -0.18920664, -0.1019189, 0.13882645, 0.13420502, 0.16422186, 0.16368406, 0.1574417, -0.16556346, 0.14113202, 0.09265691, 0.13568047, -0.20761098, 0.12645792, 0.16946764, -0.17552724];
  const W3 = [-0.18583336, -0.09726861, -0.07253347, 0.79819709, -0.07711202, 0.22358101, 1.42014533, 0.21028136, -0.19560468, 0.53876378, 0.5866373, 0.82820107, 0.58310445, 0.48474708, 0.26882082, -0.28165418, -0.02649559, 0.03088833, 0.01204488, 0.05356736, 0.00216045, 0.26252865, -0.00606709, -0.1178731, -0.20712052, 0.01086991, 0.01159401, -0.14898379, -0.00014444, -0.00801027, 0.01879299, 0.34942694, -0.29190106, -0.04726403, -0.01093185, 0.05003652, 0.01306064, -0.18029102, 0.0062519, -0.05402431, 0.47897765, 0.0079396, -0.01582809, -0.13732133, -0.00651921, -0.01274217, -0.09864776, -0.43562778, 0.47295873, 0.06453979, 0.01461427, -0.01813537, -0.02108663, 0.05343741, -0.01680023, -0.04100695, -0.23546979, -0.00649101, -0.00302633, 0.14255149, 0.00561092, 0.01131782, 0.14972219, 0.04084563, -0.2801681, -0.33417382, -0.80734528, 0.13402743, 0.90497258, 0.41655619, -0.26049196, 0.42204999, -0.4727114, 0.63744202, 0.70085702, 0.40725087, 0.7733632, -0.6462957, 0.41991489, -0.13147466];
  const b3 = [0.12858837, 0.06220128, 0.10879635, 0.05489659, 0.19883583];

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = [].concat(xSelf, xEn, xAl, xBl);

  // 네트워크 파라미터
  const W1 = [0.11656912, 0.01260383, -0.32057178, -0.18905277, -0.09714652, -0.24313108, 0.17302394, -0.14495162, -0.21558669, -0.33901278, -0.12184461, 0.18955023, -0.21425091, 0.08283297, -0.29751645, -0.4144216, 0.17116984, -0.2208081, -0.23572377, -0.07284823, 0.24693006, 0.34950426, 0.03112469, -0.17990605, 0.26801496, 0.72616566, 0.17461417, 0.01764007, 0.78600584, -0.31605109, -0.03393034, -0.30264372, -0.27311637, 0.62776753, 0.18216503, 0.10052461, 0.07666186, -0.30140457, 0.16467462, 0.00314817, -0.02803327, -0.2193544, -0.25914014, 0.10464072, 0.10929909, 0.17981487, -0.11175828, 0.13891904, 0.34446455, -0.03214401, 0.15143138, -0.08288712, 2.1773745, 0.66184581, 0.05174873, 0.0539937, -0.16999456, -0.24063937, 0.12051248, -0.03339576, 0.07139236, -0.02115658, 0.02482972, -0.86448745, -0.57878824, 0.05921001, 0.20836453, 0.04476935, 0.04230419, -0.12696441, 0.04823266, -0.41672078, 0.80723679, 0.37144886, -0.30848678, 0.50578728, -0.39003326, 0.67581631, -0.02034531, -0.13267806, 0.28439678, -0.17117114, 0.32947826, 0.04035268, -0.36672863, 0.08249913, -0.38825069, -0.42049487, -0.01858038, 0.03009207, -0.56230488, -0.11604681, -0.41158262, 0.0441916, 0.87962326, 1.29116443, -0.48867992, -0.14634261, 0.47691828, -0.05259212, 0.03380839, -0.2758087, -0.01967602, 0.01628491, 0.0657156, 0.31262597, 0.20848497, -0.03807146, -0.10761772, -0.28951491, 0.01420879, 0.3844144, -0.18832312, -0.80462206, 0.90815417, 1.27638158, 0.0481103, -0.05091778, 0.35397996, 0.38280478, 1.02580844, -0.09255345, 0.11115765, 0.40604435, 0.7068669, 0.27570792, -0.34855366, -0.05832268, 0.24226477, -0.34137395, -0.29165637, -0.22525584, -0.23300008, -0.10595134, -0.41131194, -0.32275155, -0.24470947, 0.19489653, -1.46915264, 0.20634114, -0.23820239, 0.49519778, 0.57324564, 0.34989206, -0.18650418, 0.36774967, 0.39902684, -0.33766271, -0.13379049, 0.59984486, -0.34552083, 0.11181477, -0.18329685, -1.13658071, -0.62711976, -0.03399629, -0.3571374, 0.37062312, -1.55208303, -0.38085666, 0.00004274, 0.44555405, 0.9913173, -0.97300671, -0.30368865, 0.21488683, 0.06910782, 0.52697813, -0.78491217, -0.16009726, 0.40470786, -0.22781528, 0.34163687, 0.74601177, 0.04822372, 0.31122334, 0.14193186, 0.4045294, -0.04853074, 0.19617735, -0.5600238, -0.93201602, -0.15894012, 0.44960899, -0.16380811, 0.17650275, -0.14008267, 0.17549408, 0.02879807, -0.03526237, -0.11739401, 0.06856943, -0.54230245, -0.6807158, 0.13836145, 0.4085312, 0.11703181, 0.205917, -0.30871627, 0.01029271, 0.94078832, 0.61903494, 0.53553442, -0.17233047, 0.82925244, 0.34912739, 0.96067147, 0.35785498, 0.20609688, 0.60507092, 0.36461142, -0.57561876, 0.55582428, 0.25373296, 0.45807012, 0.19974605, 0.08494931, -0.07611746, 0.297461, 0.21326621, 0.23349938, -0.08789935, -0.04259956, 0.731871, 0.12933701, 0.00748416, 0.29236831, -0.41141938, -0.41411425, -0.05120632, 0.00810806, -0.31937749, -0.39605149, 0.04545084, -0.06541803, 0.70701307, 0.1112314, 0.03537126, 0.18324138, 0.192416, -0.00230517, -0.24664495, -0.07174495, 0.44668221, 0.10233309, -0.03984052, -0.16303642, -0.00561082, 0.32475806, 0.03821171, -0.36204912, -0.38159029, 0.10513158, 0.47383453, 0.27739658, -0.27327185, -0.17936086, 0.33378664, -0.34328281, -0.06477387, -0.12203795, -0.14788203, 0.05020787, -0.37444298, -0.40981099, -0.2783886, 0.98311214, 0.92759979, -0.00520371, 0.08646998, 0.03724115, -0.10862182, -0.10127607, -0.06306517, 0.67518015, 0.11620735, 0.12323183, -0.000749, -0.12554883, 0.02737117, -0.39689931, 0.04925057, 0.29352836, 0.00340176, -0.12321169, -0.37005742, 0.98428522, 1.62612609, 0.15219643, -0.17493699, 0.10782456, 0.18642404, 0.93140537, -0.17727962, 0.10813149, 0.30798851, 0.20138006, 0.39808345, -0.02940169, 0.08942249, 0.0118382, 0.51947075, 0.42439121, -0.00551761, -0.15554035, -0.26754478, 0.00800815, 0.13767964, -0.14606478, -0.71030246, 0.10222601, 0.13578726, -0.01805413, 0.26163815, -0.58847958, 0.43555031, 0.17300121, -0.57468595, -0.01206604, -0.15645349, 0.30313485, -0.75020608, -1.45259757, 0.33232984, 0.36157188, -1.60718019, -1.01943067, -0.1007777, -0.14725204, 0.3544181, 0.46328559, 0.67196597, -0.02653055, -0.35228967, -0.54903328, 0.72128216, 0.73889507, 0.10211226, -1.09572413, -1.14730286, 0.22766139, 0.55213876, -0.10574788, -0.79557923, -0.12688618, -0.27602739, -0.16694259, -0.43416473, -0.08358647, -0.45198533, -0.43173008, -0.09835351, -0.61523846, -0.08767582, 0.08256399, -0.23340027, -0.35089407, 0.68999766, 0.01044201, -0.07452876, -0.29084764, 0.99822029, -0.23558141, 0.05397922, 0.54824991, 0.18093329, -0.18459797, 0.04977722, -0.67608188, 0.58470558, -0.2395082, -0.12696988, 1.23434434, 0.38970846, -0.16523428, -0.4295355, -0.22262463, 0.95914491, -0.8647607, 0.34839563, -0.269823, -0.4789148, 0.1488286, -0.02096427, 0.2196612, -0.28172805, -0.41030713, 0.20895993, 0.33418851, 0.10718393, 0.00751245, 0.12244945, -0.31462119, -0.14042555, 0.11726189, -0.40989137, -0.28186675, -0.10752951, 0.09579376, -0.29615914, -0.19800281, 0.39204366, 0.57933214, 0.13217556, -0.52804167, 0.07117505, 0.14039992, 0.46430646, 0.04018397, -0.25007696, 0.38746384, 0.6142287, -0.05156373, -0.06169037, 0.37997443, 0.42520735, 0.97580372, 0.47520471, -0.21281804, 0.8468674, -0.2038644, 0.47810672, -0.05051733, -0.13141479, 0.77605276, 0.03384848, 0.10650798, 0.32934754, 0.23504761, 0.48556511, 0.4091963, 0.34334739, 0.48250941, 0.32118264, 0.30846639, -0.09986353, -0.10481873, 0.0126358, -0.65511367, -1.81915588, 0.02345465, -0.15668247, -0.09862377, 0.24296676, -0.18007248, 0.07404256, -0.10516072, -0.33238472, 0.08246728, -0.13962502, -1.195236, -0.75366657, -0.05481154, 0.49604476, -0.42407431, 0.28331828, -0.29566093, 0.10096441, 0.78812321, 0.00923245, 0.2653448, -0.29925643, 0.18658936, 0.59484309, 0.19341232, 0.70210834, -0.11120997, 0.55927965, 0.04864629, -0.33075092, 0.31644374, 0.06517006, 0.44038402, -0.28132379, -0.40156235, 0.16674877, -0.28895275, -0.14899585, 0.10938034, 0.05763293, -0.23145349, 0.80737535, 1.79517153, -0.04376242, -0.14166773, -0.19367596, -0.16822073, -0.15257529, -0.033102, 0.0313577, -0.08254242, 0.04965696, 0.1824166, 0.24012152, -0.0116119, -0.10221473, -0.35060292, 0.46862918, 0.14079463, 0.04741571, -0.46612945, -0.5525376, 0.50985789, -0.36679008, 0.12358293, 0.04324134, -0.64506095, 0.58874012, -0.29184706, -0.06507416, 0.11746848, 0.33241326, 0.29369025, -0.53808339, 0.12450444, -0.34416662, -0.54235272, 0.00405574, 0.3351423, -0.24477075, -0.33703204, -0.11569786, 0.08219512, -0.19850019, 0.50064489, -4.16539275, -0.06992304, -0.22031102, -0.12578118, 1.08869709, -0.30188319, -0.46677303, 0.44624126, 0.62824836, 0.00611861, -0.26836834, 0.49544385, 0.58904577, 0.00374667, -0.26553369, -0.0095229, 0.18647884, 0.19596849, -0.12474201, 0.43134062, -0.23344849, -0.14084008, -0.17598133, -0.33350814, 1.00194754, 0.01010018, -0.14755359, 0.2441612, -0.07208423, 0.53818159, 0.4911631, -0.38558399, 0.06544949, -0.31819574, -0.09387737, -0.62945106, -0.36233495, 0.16007471, 0.02631519, -0.01772445, 0.03654983, -0.10491017, 0.11976413, 0.79754624, -0.00124571, -0.57749542, 0.19930433, 0.61239643, -0.26906465, 0.1180577, -0.06076355, 0.88898494, -0.44166098, 0.00722621, 0.06930887, -0.79258125, 0.07918831, -0.09588985, 0.45788676, 0.84958227, -0.19483142, 0.40406669, -1.72495546, 1.7609001, -0.27954135, -0.14432514, -0.56453398, -1.70607594, 0.70521403, 0.00524729, -0.55819512, -0.19133266, -1.32251295, 0.53653363, -0.02823735, -0.30823185, -0.13834728, 0.20942778, -0.06088772, -0.44084244, -0.24381548, -0.29819345, -0.15338387, -0.02457246, -0.00068268, -0.25008147, -0.34822054, -0.1276898, -0.22084982, 0.04297474, -0.08270366, -0.17597566, -0.23325412, 0.07065949, -0.15231691, -0.21031819, -0.05199123, 0.40705074, 0.27849829, -0.28144875, -0.19642361, 0.08677109, 0.04645579, -0.19174716, -0.24619884, 0.52121951, 0.35613798, 0.44570219, -0.1407154, -0.48746821, 0.36939071, -0.45023886, 0.17293403, 0.29330927, -0.68403919, 0.08154632, 0.50107062, 0.10689493, 0.15829561, 0.07131082, -0.35481732, -0.35849691, 0.13439235, -0.0933293, 0.31196508, 0.17218823, 0.19710659, -0.03173697, -0.28046528, 0.22552106, -0.19980917, -0.31690659, -0.37488911, -0.13832425, -0.2592101, 0.1836837, 0.05680613, 0.05323633, -0.51228244, 0.00994088, -0.15135323, 0.37802053, -0.46499023, 0.16475649, 0.29182655, 1.1473361, 0.11269061, 0.16561833, -1.67132837, 0.27801224, 0.08780549, -0.00625492, -0.35493779, -1.0410123, 0.29809505, -0.0081657, -0.17916354, -0.45546139, -0.73221607, 0.35578474, 0.04960554, -0.54198689, -0.28875043, 0.51567381, 0.08426944, 0.18842716, 0.00651904, 0.11050491, 0.1114375, 0.33249839, -0.12783033, 0.35755453, -0.21572296, 0.1818811, 0.01445475, 0.35848873, 0.09113617, 0.22500077, 0.16229392, -0.0419484, -0.10547295, -0.0364918, 0.10482991, 0.22003532, 0.70022856, 0.30269652, 0.16281787, -0.0110107, 0.1377463, 0.1443325, 0.35285322, 0.88144367, 0.83968568, -0.37692111, -0.35345407, -0.10210126, 0.43879143, 0.50732917, -0.24606077, 0.34739484, -0.08593058, 0.42095051, 0.83033535, -0.21615333, 0.00974722, -0.43392147, 0.52731772, 0.11814306, -0.25088612, 0.34407072, 0.10548074, -0.26270129, -0.40593595, 0.35326615, -0.04197826, 0.71234169, -0.26968222, -0.01382421, -0.24488838, 0.55670683, 0.09716758, 0.55940501, -0.42772095, 0.51558781, -0.01208142, -0.00736871, 0.24431332, -0.52527877, -0.09511965, 0.46150864, -0.22166153, -0.79877433, -0.30436118, 0.36297511, 0.03933843, -0.27234601, -0.02335656, -0.28792455, 0.00729501, 0.26460437, -0.61052716, 0.36658722, -0.31188668, 0.34206989, 0.03063796, -0.75257416, 0.10752729, -0.162318, 0.05936824, 0.21701145, 0.15934821, 0.4882908, 0.10100446, 0.0638792, 0.78924017, 0.03327403, 0.24836199, -0.15249644, 0.19428417, 0.26601694, 0.24670011, 0.20228171, 0.0747417, -0.07070433, 0.21361797, 0.0294063, -0.58146931, 0.21824335, 0.04226849, -0.72473443, 0.76012655, -0.46872568, -0.08785797, 0.59917894, -1.2980071, 0.33761511, 0.24036051, -1.36910009, 0.32855425, -0.26183911, 0.2372365, 0.25670148, -0.75584026, 0.32254071, -0.35796282, 0.22020162, 0.55869074, -0.25658921, 0.26156101, -0.17411264, 0.18532143, 0.29185561, 0.20918061, -0.11713574, 0.34779995, 0.18928815, -0.10005055, 0.15094578, -0.1146037, -0.20669081, 0.64503519, -1.04639328, 0.01507657, 0.29870911, 0.21257701, 0.60983952, 0.15646156, -0.05509115, 0.66238896, 0.07440839, 0.23630829, 0.02412448, 0.83461663, 0.72155838, 0.38660228, -0.08585396, 0.33074346, 0.4260826, 0.13318146, 0.27466797, 1.02153936, 0.36384706, -0.39395086, -0.19403108, -0.27995345, 0.55445445, 0.13145753, -0.13378839, 0.11315117, -0.1720372, 0.20048784, 0.06961685, -0.13838247, 0.08546044, 0.08626895, -0.09246028, 0.25848254, 0.02413693, -0.04585539, -0.30594765, -0.05834811, 0.07516183, -0.10106324, 0.33599916, -1.84741915, -0.05719073, 0.30993055, 0.57593458, 0.16477796, 0.18783923, 0.24985636, 0.54761805, -0.26709863, -0.11640327, -0.11844496, -0.44843839, 0.27925438, -0.03878884, 0.1862963, 0.11304902, -0.54879594, -0.15894322, 0.00332476, 1.08532384, -0.79896199, -0.14958974, 0.72145615, -0.16995578, 1.69374766, -0.33555916, 0.22641759, 0.49161883, -0.04161805, 0.95291673, -0.44521579, 0.25807384, 0.58434668, -0.17658288, -0.136333, -0.34848973, -0.07044363, 0.06361424, -0.08767029, -0.17954034, -0.0383828, -0.19257063, 0.59635827, 1.69497215, -0.03449625, -0.04183927, -0.09809114, 0.07265937, -0.0166826, -0.37364595, -0.04373142, 0.56161769, 0.31809769, 0.0920483, 1.20868137, -0.10364103, -0.20305273, -0.21029578, 0.49939112, 0.02383471, 0.25690314, 0.12581766, -0.53883081, 1.02737879, -0.16172813, 0.21644487, -0.22745302, -0.36615935, 0.27739194, -0.22130153, 0.35620296, -0.26859959, -0.29250019, 0.14857086, -0.04918168, -0.06581278, -0.15599119, -0.05416978, 0.14301398, 0.14336164, -0.12940798, 0.01574845, -0.194997, 0.23539887, -0.27963388, 0.80375497, 2.64663007, 0.10556622, 0.26373973, 0.15357508, -0.15883028, -0.29138146, 0.2312997, -0.38603113, -0.31396237, 0.00053986, -0.13197285, 0.27658705, -0.15864011, -0.25352992, -0.09760601, -0.18809161, 0.40986757, -0.30057021, -0.49365223, 0.53620452, 0.06652924, -0.07702021, -0.31837201, 0.18390592, 0.76505927, 0.77708273, -0.58009242, -0.42422276, -0.1669471, 0.01448478, 0.08364221, 0.0537065, -0.63663741, -0.01489829, -0.23169603, -0.06111227, -0.14739884, 0.14914107, -0.1485188, 0.09486223, -0.13377943, -0.13352092, -0.03975135, -0.68753726, -0.231787, 0.06716726, 0.12952125, 0.45532547, 0.07147436, -0.11407593, 0.35358837, 0.59869726, -0.10145802, -0.30169013, 0.12311321, 0.66082689, -0.09242533, -0.13512284, -0.27116293, -0.14377833, -0.22179902, 0.25757522, -0.91809521, -0.8848736, -0.38352263, 0.06044481, -0.61012371, -0.1019073, -0.68873463, -0.24377828, -0.1693349, -0.30199548, 0.05214627, -0.15315334, -0.0578892, -0.21520469, -0.54114474];
  const b1 = [-0.10670646, 0.11572152, -0.22418798, -0.16820795, 0.18565796, 0.12847083, -0.17673837, -0.20969799, -0.16197849, 0.18618439, 0.14572692, -0.16879431, -0.26879764, -0.06515952, -0.15607907, -0.06668094, 0.12983212, 0.27845053, 0.18861751, 0.09587898, 0.03680396, -0.10832145, -0.09668422, -0.09061121];
  const W2 = [0.44350177, -0.12000715, 0.14762373, 0.31447595, -0.00772669, -0.19729412, 0.070103, 0.07499362, 0.18610277, -0.45691684, 0.10452577, 0.20747582, 0.03722777, 0.03042965, -0.00388945, -0.08749616, -0.16914972, -0.00311234, -0.45282962, -0.44984872, 0.08400178, 0.01455487, -0.23453056, 0.52027326, -0.50536745, -0.4634344, -0.13107271, 0.14426717, -0.21875619, -0.5384428, 0.18657387, 0.40861312, 0.16914776, -0.26617532, 0.24732855, -0.84968363, 0.04646352, -0.19636303, 0.0832973, -0.03207353, -0.0134106, -0.11496949, -0.38911338, 0.35632124, 0.39258028, -0.07898395, -0.26200498, 0.38445209, -0.0122499, 0.70315747, 0.48187695, -0.35936992, -0.51257318, 0.03747751, 0.2561838, 0.1103753, 0.09152353, -0.07523923, -0.73906026, 0.46359963, -1.61201307, -0.07953765, -0.12883107, -0.12417271, 0.20756374, 0.18518047, 0.12778842, -0.27943081, -0.72779361, 0.45505154, 0.84657981, -0.22344093, -0.47844284, 0.34003416, 0.52292175, -0.05161418, 0.45357208, 0.22818961, -0.00243962, -0.81742872, -0.71187429, 0.08565115, 0.18499648, 0.41762895, -0.10864102, 0.29156273, -0.32245861, -0.16101362, -0.21667127, 0.06620157, 0.27019688, -0.26300703, 0.13265231, 0.08409508, 0.16636356, -0.49411654, 0.16843664, -0.37739973, -0.39019902, -0.08577088, 0.90506688, 0.05458636, -0.29445318, 0.04640206, -0.2618108, 0.28121695, 1.23258937, -1.2334208, 0.90523829, -0.07330142, -0.27830777, 0.34658614, -0.13024179, -0.09817313, 0.19600003, -0.33783973, 0.15848792, -0.8182816, -0.97440901, 0.04192408, -0.01761016, 0.68116449, -0.21036348, -0.18927593, 0.20913952, 0.12951181, -0.32849995, -0.12801096, -0.23406828, 0.20592771, -0.00656944, -0.15578249, -0.35969023, -0.63625753, -0.22799418, -0.48773259, -0.04218528, 0.3565715, 0.22762908, -0.52458931, 0.12312307, 0.0794097, -0.09435558, -0.20765071, -0.08331699, -0.11910371, -0.60912589, 0.48908295, -0.68336517, -0.22452028, -0.43569307, -0.4242236, -0.417292, -0.29363784, -0.12201705, -0.11885014, -0.25669585, 0.26074779, -0.28313031, 0.19986429, -0.42069552, 0.12231286, 0.40434032, -0.15163645, -0.20703264, -0.02280057, -0.87861712, 0.15574295, -0.51092031, 0.12452921, -0.31159766, -0.17228332, 0.16849375, 0.69706819, 0.25580321, -0.16513983, -0.27138282, 0.22231656, 0.16157296, 0.33990677, -0.21831987, -0.05362667, 0.03191586, -0.05512075, 0.25699847, 0.0603624, 0.40932769, 0.22377369, 0.00484899, -0.2488386, 0.20852063, -0.13213618, 0.00824925, -0.23224688, 0.19035679, 0.08852136, -0.22532033, -0.20743222, -0.05455082, 0.72615561, -0.0602697, -0.37313847, -0.30927832, -0.19973239, -0.048321, 0.49748817, 0.56893179, -0.05677302, -0.04099906, -0.4608484, -0.51867258, 0.0317118, 0.860764, 0.44172428, -0.16184868, 0.60372466, -0.01875745, 0.00659691, -0.47108961, -0.45041016, 0.41508756, 0.23965699, -0.32950929, -0.21874178, -0.02987422, 0.07927656, 0.07329058, -0.6469969, 0.2687739, 0.69116592, -0.13080578, 0.38876649, -0.03500875, 0.22953302, -0.16072227, -0.19802397, -0.32512057, -0.16105087, -0.41474356, 0.16130862, 0.27704406, -0.05220067, -0.00750753, 0.27848617, -0.71233708, 0.23955546, 0.40128131, -0.68924307, -0.00333474, 0.01282985, -0.18038067, 0.13806988, 0.78407584, 0.95647198, -0.13559976, 0.4814807, 0.65152088, 0.60896947, 0.13610062, 0.47628614, -0.21160271, 0.19628027, -0.33598763, 0.25900403, -0.41775, 0.25699068, -0.32824027, -0.13695813, -0.13945952, 0.159675, -0.35426809, 0.28385044, -0.2938311, -0.31840739, 0.29671559, -0.37394448, 0.02214902, -0.45062186, -0.76067182, -0.02359098, 0.07567459, 0.22404626, 0.12962318, 0.00369471, -0.13481045, -0.51751584, 0.12005434, 0.06795926, 0.20701996, -0.92321812, -0.55174721, 0.55327042, 0.10065671, -0.08785817, -0.19914849, -0.57231586, 0.07359595, -0.26415331, 0.0471002, -0.52327122, 1.90546868, -0.42699064, 0.03844813, -0.03991395, -0.1615002, -0.61603472, -0.18297134, 0.17371348, 0.99094236, -0.10705552, -0.89146195, 0.54275078, -0.27637047, 0.08780732, 0.67716783, -0.39809078, -1.02863079, 0.24573183, 0.37193204, 0.11603561, 0.30970725, 0.05877079, -0.78560139, 0.12007972, -0.81904175, 0.62327862, 0.02866845, 0.19126501, 0.20406004, 0.36399028, -0.07659751, 0.057711, -0.49846303, 0.67065908, 0.46549073, -0.08625406, -0.08440807, 0.43984865, 0.07118102, -0.0660345, 0.02380957, 0.37533976, 0.13200925, -0.03232223, -0.36040764, 0.61241457, -0.47488246, 0.36913586, 0.13488608, 0.04741713, -0.35960047, -0.02982263, 0.03838425, 0.27160043, 0.59196516, 0.04188202, -0.25481488, -0.3400094, 0.11715715, 0.06008305, 0.42132389, -0.64857747, 0.12642101, 0.33232981, -0.15200593, -0.03410358, 0.42581749, 0.46277611, 0.281696, -0.57744176, -0.14460467, -0.38784477, -0.03486834, 0.02343516, 0.13413376, 0.15244409, -0.2144859, -0.44474257, -0.02270177, -0.312952, 0.09914382, 0.08631034, 0.29059477, 0.26923704];
  const b2 = [-0.16367468, -0.18920664, -0.1019189, 0.13882645, 0.13420502, 0.16422186, 0.16368406, 0.1574417, -0.16556346, 0.14113202, 0.09265691, 0.13568047, -0.20761098, 0.12645792, 0.16946764, -0.17552724];
  const W3 = [-0.18583336, -0.09726861, -0.07253347, 0.79819709, -0.07711202, 0.22358101, 1.42014533, 0.21028136, -0.19560468, 0.53876378, 0.5866373, 0.82820107, 0.58310445, 0.48474708, 0.26882082, -0.28165418, -0.02649559, 0.03088833, 0.01204488, 0.05356736, 0.00216045, 0.26252865, -0.00606709, -0.1178731, -0.20712052, 0.01086991, 0.01159401, -0.14898379, -0.00014444, -0.00801027, 0.01879299, 0.34942694, -0.29190106, -0.04726403, -0.01093185, 0.05003652, 0.01306064, -0.18029102, 0.0062519, -0.05402431, 0.47897765, 0.0079396, -0.01582809, -0.13732133, -0.00651921, -0.01274217, -0.09864776, -0.43562778, 0.47295873, 0.06453979, 0.01461427, -0.01813537, -0.02108663, 0.05343741, -0.01680023, -0.04100695, -0.23546979, -0.00649101, -0.00302633, 0.14255149, 0.00561092, 0.01131782, 0.14972219, 0.04084563, -0.2801681, -0.33417382, -0.80734528, 0.13402743, 0.90497258, 0.41655619, -0.26049196, 0.42204999, -0.4727114, 0.63744202, 0.70085702, 0.40725087, 0.7733632, -0.6462957, 0.41991489, -0.13147466];
  const b3 = [0.12858837, 0.06220128, 0.10879635, 0.05489659, 0.19883583];

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = [].concat(xSelf, xEn, xAl, xBl);

  // 네트워크 파라미터
  const W1 = [0.11656912, 0.01260383, -0.32057178, -0.18905277, -0.09714652, -0.24313108, 0.17302394, -0.14495162, -0.21558669, -0.33901278, -0.12184461, 0.18955023, -0.21425091, 0.08283297, -0.29751645, -0.4144216, 0.17116984, -0.2208081, -0.23572377, -0.07284823, 0.24693006, 0.34950426, 0.03112469, -0.17990605, 0.26801496, 0.72616566, 0.17461417, 0.01764007, 0.78600584, -0.31605109, -0.03393034, -0.30264372, -0.27311637, 0.62776753, 0.18216503, 0.10052461, 0.07666186, -0.30140457, 0.16467462, 0.00314817, -0.02803327, -0.2193544, -0.25914014, 0.10464072, 0.10929909, 0.17981487, -0.11175828, 0.13891904, 0.34446455, -0.03214401, 0.15143138, -0.08288712, 2.1773745, 0.66184581, 0.05174873, 0.0539937, -0.16999456, -0.24063937, 0.12051248, -0.03339576, 0.07139236, -0.02115658, 0.02482972, -0.86448745, -0.57878824, 0.05921001, 0.20836453, 0.04476935, 0.04230419, -0.12696441, 0.04823266, -0.41672078, 0.80723679, 0.37144886, -0.30848678, 0.50578728, -0.39003326, 0.67581631, -0.02034531, -0.13267806, 0.28439678, -0.17117114, 0.32947826, 0.04035268, -0.36672863, 0.08249913, -0.38825069, -0.42049487, -0.01858038, 0.03009207, -0.56230488, -0.11604681, -0.41158262, 0.0441916, 0.87962326, 1.29116443, -0.48867992, -0.14634261, 0.47691828, -0.05259212, 0.03380839, -0.2758087, -0.01967602, 0.01628491, 0.0657156, 0.31262597, 0.20848497, -0.03807146, -0.10761772, -0.28951491, 0.01420879, 0.3844144, -0.18832312, -0.80462206, 0.90815417, 1.27638158, 0.0481103, -0.05091778, 0.35397996, 0.38280478, 1.02580844, -0.09255345, 0.11115765, 0.40604435, 0.7068669, 0.27570792, -0.34855366, -0.05832268, 0.24226477, -0.34137395, -0.29165637, -0.22525584, -0.23300008, -0.10595134, -0.41131194, -0.32275155, -0.24470947, 0.19489653, -1.46915264, 0.20634114, -0.23820239, 0.49519778, 0.57324564, 0.34989206, -0.18650418, 0.36774967, 0.39902684, -0.33766271, -0.13379049, 0.59984486, -0.34552083, 0.11181477, -0.18329685, -1.13658071, -0.62711976, -0.03399629, -0.3571374, 0.37062312, -1.55208303, -0.38085666, 0.00004274, 0.44555405, 0.9913173, -0.97300671, -0.30368865, 0.21488683, 0.06910782, 0.52697813, -0.78491217, -0.16009726, 0.40470786, -0.22781528, 0.34163687, 0.74601177, 0.04822372, 0.31122334, 0.14193186, 0.4045294, -0.04853074, 0.19617735, -0.5600238, -0.93201602, -0.15894012, 0.44960899, -0.16380811, 0.17650275, -0.14008267, 0.17549408, 0.02879807, -0.03526237, -0.11739401, 0.06856943, -0.54230245, -0.6807158, 0.13836145, 0.4085312, 0.11703181, 0.205917, -0.30871627, 0.01029271, 0.94078832, 0.61903494, 0.53553442, -0.17233047, 0.82925244, 0.34912739, 0.96067147, 0.35785498, 0.20609688, 0.60507092, 0.36461142, -0.57561876, 0.55582428, 0.25373296, 0.45807012, 0.19974605, 0.08494931, -0.07611746, 0.297461, 0.21326621, 0.23349938, -0.08789935, -0.04259956, 0.731871, 0.12933701, 0.00748416, 0.29236831, -0.41141938, -0.41411425, -0.05120632, 0.00810806, -0.31937749, -0.39605149, 0.04545084, -0.06541803, 0.70701307, 0.1112314, 0.03537126, 0.18324138, 0.192416, -0.00230517, -0.24664495, -0.07174495, 0.44668221, 0.10233309, -0.03984052, -0.16303642, -0.00561082, 0.32475806, 0.03821171, -0.36204912, -0.38159029, 0.10513158, 0.47383453, 0.27739658, -0.27327185, -0.17936086, 0.33378664, -0.34328281, -0.06477387, -0.12203795, -0.14788203, 0.05020787, -0.37444298, -0.40981099, -0.2783886, 0.98311214, 0.92759979, -0.00520371, 0.08646998, 0.03724115, -0.10862182, -0.10127607, -0.06306517, 0.67518015, 0.11620735, 0.12323183, -0.000749, -0.12554883, 0.02737117, -0.39689931, 0.04925057, 0.29352836, 0.00340176, -0.12321169, -0.37005742, 0.98428522, 1.62612609, 0.15219643, -0.17493699, 0.10782456, 0.18642404, 0.93140537, -0.17727962, 0.10813149, 0.30798851, 0.20138006, 0.39808345, -0.02940169, 0.08942249, 0.0118382, 0.51947075, 0.42439121, -0.00551761, -0.15554035, -0.26754478, 0.00800815, 0.13767964, -0.14606478, -0.71030246, 0.10222601, 0.13578726, -0.01805413, 0.26163815, -0.58847958, 0.43555031, 0.17300121, -0.57468595, -0.01206604, -0.15645349, 0.30313485, -0.75020608, -1.45259757, 0.33232984, 0.36157188, -1.60718019, -1.01943067, -0.1007777, -0.14725204, 0.3544181, 0.46328559, 0.67196597, -0.02653055, -0.35228967, -0.54903328, 0.72128216, 0.73889507, 0.10211226, -1.09572413, -1.14730286, 0.22766139, 0.55213876, -0.10574788, -0.79557923, -0.12688618, -0.27602739, -0.16694259, -0.43416473, -0.08358647, -0.45198533, -0.43173008, -0.09835351, -0.61523846, -0.08767582, 0.08256399, -0.23340027, -0.35089407, 0.68999766, 0.01044201, -0.07452876, -0.29084764, 0.99822029, -0.23558141, 0.05397922, 0.54824991, 0.18093329, -0.18459797, 0.04977722, -0.67608188, 0.58470558, -0.2395082, -0.12696988, 1.23434434, 0.38970846, -0.16523428, -0.4295355, -0.22262463, 0.95914491, -0.8647607, 0.34839563, -0.269823, -0.4789148, 0.1488286, -0.02096427, 0.2196612, -0.28172805, -0.41030713, 0.20895993, 0.33418851, 0.10718393, 0.00751245, 0.12244945, -0.31462119, -0.14042555, 0.11726189, -0.40989137, -0.28186675, -0.10752951, 0.09579376, -0.29615914, -0.19800281, 0.39204366, 0.57933214, 0.13217556, -0.52804167, 0.07117505, 0.14039992, 0.46430646, 0.04018397, -0.25007696, 0.38746384, 0.6142287, -0.05156373, -0.06169037, 0.37997443, 0.42520735, 0.97580372, 0.47520471, -0.21281804, 0.8468674, -0.2038644, 0.47810672, -0.05051733, -0.13141479, 0.77605276, 0.03384848, 0.10650798, 0.32934754, 0.23504761, 0.48556511, 0.4091963, 0.34334739, 0.48250941, 0.32118264, 0.30846639, -0.09986353, -0.10481873, 0.0126358, -0.65511367, -1.81915588, 0.02345465, -0.15668247, -0.09862377, 0.24296676, -0.18007248, 0.07404256, -0.10516072, -0.33238472, 0.08246728, -0.13962502, -1.195236, -0.75366657, -0.05481154, 0.49604476, -0.42407431, 0.28331828, -0.29566093, 0.10096441, 0.78812321, 0.00923245, 0.2653448, -0.29925643, 0.18658936, 0.59484309, 0.19341232, 0.70210834, -0.11120997, 0.55927965, 0.04864629, -0.33075092, 0.31644374, 0.06517006, 0.44038402, -0.28132379, -0.40156235, 0.16674877, -0.28895275, -0.14899585, 0.10938034, 0.05763293, -0.23145349, 0.80737535, 1.79517153, -0.04376242, -0.14166773, -0.19367596, -0.16822073, -0.15257529, -0.033102, 0.0313577, -0.08254242, 0.04965696, 0.1824166, 0.24012152, -0.0116119, -0.10221473, -0.35060292, 0.46862918, 0.14079463, 0.04741571, -0.46612945, -0.5525376, 0.50985789, -0.36679008, 0.12358293, 0.04324134, -0.64506095, 0.58874012, -0.29184706, -0.06507416, 0.11746848, 0.33241326, 0.29369025, -0.53808339, 0.12450444, -0.34416662, -0.54235272, 0.00405574, 0.3351423, -0.24477075, -0.33703204, -0.11569786, 0.08219512, -0.19850019, 0.50064489, -4.16539275, -0.06992304, -0.22031102, -0.12578118, 1.08869709, -0.30188319, -0.46677303, 0.44624126, 0.62824836, 0.00611861, -0.26836834, 0.49544385, 0.58904577, 0.00374667, -0.26553369, -0.0095229, 0.18647884, 0.19596849, -0.12474201, 0.43134062, -0.23344849, -0.14084008, -0.17598133, -0.33350814, 1.00194754, 0.01010018, -0.14755359, 0.2441612, -0.07208423, 0.53818159, 0.4911631, -0.38558399, 0.06544949, -0.31819574, -0.09387737, -0.62945106, -0.36233495, 0.16007471, 0.02631519, -0.01772445, 0.03654983, -0.10491017, 0.11976413, 0.79754624, -0.00124571, -0.57749542, 0.19930433, 0.61239643, -0.26906465, 0.1180577, -0.06076355, 0.88898494, -0.44166098, 0.00722621, 0.06930887, -0.79258125, 0.07918831, -0.09588985, 0.45788676, 0.84958227, -0.19483142, 0.40406669, -1.72495546, 1.7609001, -0.27954135, -0.14432514, -0.56453398, -1.70607594, 0.70521403, 0.00524729, -0.55819512, -0.19133266, -1.32251295, 0.53653363, -0.02823735, -0.30823185, -0.13834728, 0.20942778, -0.06088772, -0.44084244, -0.24381548, -0.29819345, -0.15338387, -0.02457246, -0.00068268, -0.25008147, -0.34822054, -0.1276898, -0.22084982, 0.04297474, -0.08270366, -0.17597566, -0.23325412, 0.07065949, -0.15231691, -0.21031819, -0.05199123, 0.40705074, 0.27849829, -0.28144875, -0.19642361, 0.08677109, 0.04645579, -0.19174716, -0.24619884, 0.52121951, 0.35613798, 0.44570219, -0.1407154, -0.48746821, 0.36939071, -0.45023886, 0.17293403, 0.29330927, -0.68403919, 0.08154632, 0.50107062, 0.10689493, 0.15829561, 0.07131082, -0.35481732, -0.35849691, 0.13439235, -0.0933293, 0.31196508, 0.17218823, 0.19710659, -0.03173697, -0.28046528, 0.22552106, -0.19980917, -0.31690659, -0.37488911, -0.13832425, -0.2592101, 0.1836837, 0.05680613, 0.05323633, -0.51228244, 0.00994088, -0.15135323, 0.37802053, -0.46499023, 0.16475649, 0.29182655, 1.1473361, 0.11269061, 0.16561833, -1.67132837, 0.27801224, 0.08780549, -0.00625492, -0.35493779, -1.0410123, 0.29809505, -0.0081657, -0.17916354, -0.45546139, -0.73221607, 0.35578474, 0.04960554, -0.54198689, -0.28875043, 0.51567381, 0.08426944, 0.18842716, 0.00651904, 0.11050491, 0.1114375, 0.33249839, -0.12783033, 0.35755453, -0.21572296, 0.1818811, 0.01445475, 0.35848873, 0.09113617, 0.22500077, 0.16229392, -0.0419484, -0.10547295, -0.0364918, 0.10482991, 0.22003532, 0.70022856, 0.30269652, 0.16281787, -0.0110107, 0.1377463, 0.1443325, 0.35285322, 0.88144367, 0.83968568, -0.37692111, -0.35345407, -0.10210126, 0.43879143, 0.50732917, -0.24606077, 0.34739484, -0.08593058, 0.42095051, 0.83033535, -0.21615333, 0.00974722, -0.43392147, 0.52731772, 0.11814306, -0.25088612, 0.34407072, 0.10548074, -0.26270129, -0.40593595, 0.35326615, -0.04197826, 0.71234169, -0.26968222, -0.01382421, -0.24488838, 0.55670683, 0.09716758, 0.55940501, -0.42772095, 0.51558781, -0.01208142, -0.00736871, 0.24431332, -0.52527877, -0.09511965, 0.46150864, -0.22166153, -0.79877433, -0.30436118, 0.36297511, 0.03933843, -0.27234601, -0.02335656, -0.28792455, 0.00729501, 0.26460437, -0.61052716, 0.36658722, -0.31188668, 0.34206989, 0.03063796, -0.75257416, 0.10752729, -0.162318, 0.05936824, 0.21701145, 0.15934821, 0.4882908, 0.10100446, 0.0638792, 0.78924017, 0.03327403, 0.24836199, -0.15249644, 0.19428417, 0.26601694, 0.24670011, 0.20228171, 0.0747417, -0.07070433, 0.21361797, 0.0294063, -0.58146931, 0.21824335, 0.04226849, -0.72473443, 0.76012655, -0.46872568, -0.08785797, 0.59917894, -1.2980071, 0.33761511, 0.24036051, -1.36910009, 0.32855425, -0.26183911, 0.2372365, 0.25670148, -0.75584026, 0.32254071, -0.35796282, 0.22020162, 0.55869074, -0.25658921, 0.26156101, -0.17411264, 0.18532143, 0.29185561, 0.20918061, -0.11713574, 0.34779995, 0.18928815, -0.10005055, 0.15094578, -0.1146037, -0.20669081, 0.64503519, -1.04639328, 0.01507657, 0.29870911, 0.21257701, 0.60983952, 0.15646156, -0.05509115, 0.66238896, 0.07440839, 0.23630829, 0.02412448, 0.83461663, 0.72155838, 0.38660228, -0.08585396, 0.33074346, 0.4260826, 0.13318146, 0.27466797, 1.02153936, 0.36384706, -0.39395086, -0.19403108, -0.27995345, 0.55445445, 0.13145753, -0.13378839, 0.11315117, -0.1720372, 0.20048784, 0.06961685, -0.13838247, 0.08546044, 0.08626895, -0.09246028, 0.25848254, 0.02413693, -0.04585539, -0.30594765, -0.05834811, 0.07516183, -0.10106324, 0.33599916, -1.84741915, -0.05719073, 0.30993055, 0.57593458, 0.16477796, 0.18783923, 0.24985636, 0.54761805, -0.26709863, -0.11640327, -0.11844496, -0.44843839, 0.27925438, -0.03878884, 0.1862963, 0.11304902, -0.54879594, -0.15894322, 0.00332476, 1.08532384, -0.79896199, -0.14958974, 0.72145615, -0.16995578, 1.69374766, -0.33555916, 0.22641759, 0.49161883, -0.04161805, 0.95291673, -0.44521579, 0.25807384, 0.58434668, -0.17658288, -0.136333, -0.34848973, -0.07044363, 0.06361424, -0.08767029, -0.17954034, -0.0383828, -0.19257063, 0.59635827, 1.69497215, -0.03449625, -0.04183927, -0.09809114, 0.07265937, -0.0166826, -0.37364595, -0.04373142, 0.56161769, 0.31809769, 0.0920483, 1.20868137, -0.10364103, -0.20305273, -0.21029578, 0.49939112, 0.02383471, 0.25690314, 0.12581766, -0.53883081, 1.02737879, -0.16172813, 0.21644487, -0.22745302, -0.36615935, 0.27739194, -0.22130153, 0.35620296, -0.26859959, -0.29250019, 0.14857086, -0.04918168, -0.06581278, -0.15599119, -0.05416978, 0.14301398, 0.14336164, -0.12940798, 0.01574845, -0.194997, 0.23539887, -0.27963388, 0.80375497, 2.64663007, 0.10556622, 0.26373973, 0.15357508, -0.15883028, -0.29138146, 0.2312997, -0.38603113, -0.31396237, 0.00053986, -0.13197285, 0.27658705, -0.15864011, -0.25352992, -0.09760601, -0.18809161, 0.40986757, -0.30057021, -0.49365223, 0.53620452, 0.06652924, -0.07702021, -0.31837201, 0.18390592, 0.76505927, 0.77708273, -0.58009242, -0.42422276, -0.1669471, 0.01448478, 0.08364221, 0.0537065, -0.63663741, -0.01489829, -0.23169603, -0.06111227, -0.14739884, 0.14914107, -0.1485188, 0.09486223, -0.13377943, -0.13352092, -0.03975135, -0.68753726, -0.231787, 0.06716726, 0.12952125, 0.45532547, 0.07147436, -0.11407593, 0.35358837, 0.59869726, -0.10145802, -0.30169013, 0.12311321, 0.66082689, -0.09242533, -0.13512284, -0.27116293, -0.14377833, -0.22179902, 0.25757522, -0.91809521, -0.8848736, -0.38352263, 0.06044481, -0.61012371, -0.1019073, -0.68873463, -0.24377828, -0.1693349, -0.30199548, 0.05214627, -0.15315334, -0.0578892, -0.21520469, -0.54114474];
  const b1 = [-0.10670646, 0.11572152, -0.22418798, -0.16820795, 0.18565796, 0.12847083, -0.17673837, -0.20969799, -0.16197849, 0.18618439, 0.14572692, -0.16879431, -0.26879764, -0.06515952, -0.15607907, -0.06668094, 0.12983212, 0.27845053, 0.18861751, 0.09587898, 0.03680396, -0.10832145, -0.09668422, -0.09061121];
  const W2 = [0.44350177, -0.12000715, 0.14762373, 0.31447595, -0.00772669, -0.19729412, 0.070103, 0.07499362, 0.18610277, -0.45691684, 0.10452577, 0.20747582, 0.03722777, 0.03042965, -0.00388945, -0.08749616, -0.16914972, -0.00311234, -0.45282962, -0.44984872, 0.08400178, 0.01455487, -0.23453056, 0.52027326, -0.50536745, -0.4634344, -0.13107271, 0.14426717, -0.21875619, -0.5384428, 0.18657387, 0.40861312, 0.16914776, -0.26617532, 0.24732855, -0.84968363, 0.04646352, -0.19636303, 0.0832973, -0.03207353, -0.0134106, -0.11496949, -0.38911338, 0.35632124, 0.39258028, -0.07898395, -0.26200498, 0.38445209, -0.0122499, 0.70315747, 0.48187695, -0.35936992, -0.51257318, 0.03747751, 0.2561838, 0.1103753, 0.09152353, -0.07523923, -0.73906026, 0.46359963, -1.61201307, -0.07953765, -0.12883107, -0.12417271, 0.20756374, 0.18518047, 0.12778842, -0.27943081, -0.72779361, 0.45505154, 0.84657981, -0.22344093, -0.47844284, 0.34003416, 0.52292175, -0.05161418, 0.45357208, 0.22818961, -0.00243962, -0.81742872, -0.71187429, 0.08565115, 0.18499648, 0.41762895, -0.10864102, 0.29156273, -0.32245861, -0.16101362, -0.21667127, 0.06620157, 0.27019688, -0.26300703, 0.13265231, 0.08409508, 0.16636356, -0.49411654, 0.16843664, -0.37739973, -0.39019902, -0.08577088, 0.90506688, 0.05458636, -0.29445318, 0.04640206, -0.2618108, 0.28121695, 1.23258937, -1.2334208, 0.90523829, -0.07330142, -0.27830777, 0.34658614, -0.13024179, -0.09817313, 0.19600003, -0.33783973, 0.15848792, -0.8182816, -0.97440901, 0.04192408, -0.01761016, 0.68116449, -0.21036348, -0.18927593, 0.20913952, 0.12951181, -0.32849995, -0.12801096, -0.23406828, 0.20592771, -0.00656944, -0.15578249, -0.35969023, -0.63625753, -0.22799418, -0.48773259, -0.04218528, 0.3565715, 0.22762908, -0.52458931, 0.12312307, 0.0794097, -0.09435558, -0.20765071, -0.08331699, -0.11910371, -0.60912589, 0.48908295, -0.68336517, -0.22452028, -0.43569307, -0.4242236, -0.417292, -0.29363784, -0.12201705, -0.11885014, -0.25669585, 0.26074779, -0.28313031, 0.19986429, -0.42069552, 0.12231286, 0.40434032, -0.15163645, -0.20703264, -0.02280057, -0.87861712, 0.15574295, -0.51092031, 0.12452921, -0.31159766, -0.17228332, 0.16849375, 0.69706819, 0.25580321, -0.16513983, -0.27138282, 0.22231656, 0.16157296, 0.33990677, -0.21831987, -0.05362667, 0.03191586, -0.05512075, 0.25699847, 0.0603624, 0.40932769, 0.22377369, 0.00484899, -0.2488386, 0.20852063, -0.13213618, 0.00824925, -0.23224688, 0.19035679, 0.08852136, -0.22532033, -0.20743222, -0.05455082, 0.72615561, -0.0602697, -0.37313847, -0.30927832, -0.19973239, -0.048321, 0.49748817, 0.56893179, -0.05677302, -0.04099906, -0.4608484, -0.51867258, 0.0317118, 0.860764, 0.44172428, -0.16184868, 0.60372466, -0.01875745, 0.00659691, -0.47108961, -0.45041016, 0.41508756, 0.23965699, -0.32950929, -0.21874178, -0.02987422, 0.07927656, 0.07329058, -0.6469969, 0.2687739, 0.69116592, -0.13080578, 0.38876649, -0.03500875, 0.22953302, -0.16072227, -0.19802397, -0.32512057, -0.16105087, -0.41474356, 0.16130862, 0.27704406, -0.05220067, -0.00750753, 0.27848617, -0.71233708, 0.23955546, 0.40128131, -0.68924307, -0.00333474, 0.01282985, -0.18038067, 0.13806988, 0.78407584, 0.95647198, -0.13559976, 0.4814807, 0.65152088, 0.60896947, 0.13610062, 0.47628614, -0.21160271, 0.19628027, -0.33598763, 0.25900403, -0.41775, 0.25699068, -0.32824027, -0.13695813, -0.13945952, 0.159675, -0.35426809, 0.28385044, -0.2938311, -0.31840739, 0.29671559, -0.37394448, 0.02214902, -0.45062186, -0.76067182, -0.02359098, 0.07567459, 0.22404626, 0.12962318, 0.00369471, -0.13481045, -0.51751584, 0.12005434, 0.06795926, 0.20701996, -0.92321812, -0.55174721, 0.55327042, 0.10065671, -0.08785817, -0.19914849, -0.57231586, 0.07359595, -0.26415331, 0.0471002, -0.52327122, 1.90546868, -0.42699064, 0.03844813, -0.03991395, -0.1615002, -0.61603472, -0.18297134, 0.17371348, 0.99094236, -0.10705552, -0.89146195, 0.54275078, -0.27637047, 0.08780732, 0.67716783, -0.39809078, -1.02863079, 0.24573183, 0.37193204, 0.11603561, 0.30970725, 0.05877079, -0.78560139, 0.12007972, -0.81904175, 0.62327862, 0.02866845, 0.19126501, 0.20406004, 0.36399028, -0.07659751, 0.057711, -0.49846303, 0.67065908, 0.46549073, -0.08625406, -0.08440807, 0.43984865, 0.07118102, -0.0660345, 0.02380957, 0.37533976, 0.13200925, -0.03232223, -0.36040764, 0.61241457, -0.47488246, 0.36913586, 0.13488608, 0.04741713, -0.35960047, -0.02982263, 0.03838425, 0.27160043, 0.59196516, 0.04188202, -0.25481488, -0.3400094, 0.11715715, 0.06008305, 0.42132389, -0.64857747, 0.12642101, 0.33232981, -0.15200593, -0.03410358, 0.42581749, 0.46277611, 0.281696, -0.57744176, -0.14460467, -0.38784477, -0.03486834, 0.02343516, 0.13413376, 0.15244409, -0.2144859, -0.44474257, -0.02270177, -0.312952, 0.09914382, 0.08631034, 0.29059477, 0.26923704];
  const b2 = [-0.16367468, -0.18920664, -0.1019189, 0.13882645, 0.13420502, 0.16422186, 0.16368406, 0.1574417, -0.16556346, 0.14113202, 0.09265691, 0.13568047, -0.20761098, 0.12645792, 0.16946764, -0.17552724];
  const W3 = [-0.18583336, -0.09726861, -0.07253347, 0.79819709, -0.07711202, 0.22358101, 1.42014533, 0.21028136, -0.19560468, 0.53876378, 0.5866373, 0.82820107, 0.58310445, 0.48474708, 0.26882082, -0.28165418, -0.02649559, 0.03088833, 0.01204488, 0.05356736, 0.00216045, 0.26252865, -0.00606709, -0.1178731, -0.20712052, 0.01086991, 0.01159401, -0.14898379, -0.00014444, -0.00801027, 0.01879299, 0.34942694, -0.29190106, -0.04726403, -0.01093185, 0.05003652, 0.01306064, -0.18029102, 0.0062519, -0.05402431, 0.47897765, 0.0079396, -0.01582809, -0.13732133, -0.00651921, -0.01274217, -0.09864776, -0.43562778, 0.47295873, 0.06453979, 0.01461427, -0.01813537, -0.02108663, 0.05343741, -0.01680023, -0.04100695, -0.23546979, -0.00649101, -0.00302633, 0.14255149, 0.00561092, 0.01131782, 0.14972219, 0.04084563, -0.2801681, -0.33417382, -0.80734528, 0.13402743, 0.90497258, 0.41655619, -0.26049196, 0.42204999, -0.4727114, 0.63744202, 0.70085702, 0.40725087, 0.7733632, -0.6462957, 0.41991489, -0.13147466];
  const b3 = [0.12858837, 0.06220128, 0.10879635, 0.05489659, 0.19883583];

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = [].concat(xSelf, xEn, xAl, xBl);

  // 네트워크 파라미터
  const W1 = [0.11656912, 0.01260383, -0.32057178, -0.18905277, -0.09714652, -0.24313108, 0.17302394, -0.14495162, -0.21558669, -0.33901278, -0.12184461, 0.18955023, -0.21425091, 0.08283297, -0.29751645, -0.4144216, 0.17116984, -0.2208081, -0.23572377, -0.07284823, 0.24693006, 0.34950426, 0.03112469, -0.17990605, 0.26801496, 0.72616566, 0.17461417, 0.01764007, 0.78600584, -0.31605109, -0.03393034, -0.30264372, -0.27311637, 0.62776753, 0.18216503, 0.10052461, 0.07666186, -0.30140457, 0.16467462, 0.00314817, -0.02803327, -0.2193544, -0.25914014, 0.10464072, 0.10929909, 0.17981487, -0.11175828, 0.13891904, 0.34446455, -0.03214401, 0.15143138, -0.08288712, 2.1773745, 0.66184581, 0.05174873, 0.0539937, -0.16999456, -0.24063937, 0.12051248, -0.03339576, 0.07139236, -0.02115658, 0.02482972, -0.86448745, -0.57878824, 0.05921001, 0.20836453, 0.04476935, 0.04230419, -0.12696441, 0.04823266, -0.41672078, 0.80723679, 0.37144886, -0.30848678, 0.50578728, -0.39003326, 0.67581631, -0.02034531, -0.13267806, 0.28439678, -0.17117114, 0.32947826, 0.04035268, -0.36672863, 0.08249913, -0.38825069, -0.42049487, -0.01858038, 0.03009207, -0.56230488, -0.11604681, -0.41158262, 0.0441916, 0.87962326, 1.29116443, -0.48867992, -0.14634261, 0.47691828, -0.05259212, 0.03380839, -0.2758087, -0.01967602, 0.01628491, 0.0657156, 0.31262597, 0.20848497, -0.03807146, -0.10761772, -0.28951491, 0.01420879, 0.3844144, -0.18832312, -0.80462206, 0.90815417, 1.27638158, 0.0481103, -0.05091778, 0.35397996, 0.38280478, 1.02580844, -0.09255345, 0.11115765, 0.40604435, 0.7068669, 0.27570792, -0.34855366, -0.05832268, 0.24226477, -0.34137395, -0.29165637, -0.22525584, -0.23300008, -0.10595134, -0.41131194, -0.32275155, -0.24470947, 0.19489653, -1.46915264, 0.20634114, -0.23820239, 0.49519778, 0.57324564, 0.34989206, -0.18650418, 0.36774967, 0.39902684, -0.33766271, -0.13379049, 0.59984486, -0.34552083, 0.11181477, -0.18329685, -1.13658071, -0.62711976, -0.03399629, -0.3571374, 0.37062312, -1.55208303, -0.38085666, 0.00004274, 0.44555405, 0.9913173, -0.97300671, -0.30368865, 0.21488683, 0.06910782, 0.52697813, -0.78491217, -0.16009726, 0.40470786, -0.22781528, 0.34163687, 0.74601177, 0.04822372, 0.31122334, 0.14193186, 0.4045294, -0.04853074, 0.19617735, -0.5600238, -0.93201602, -0.15894012, 0.44960899, -0.16380811, 0.17650275, -0.14008267, 0.17549408, 0.02879807, -0.03526237, -0.11739401, 0.06856943, -0.54230245, -0.6807158, 0.13836145, 0.4085312, 0.11703181, 0.205917, -0.30871627, 0.01029271, 0.94078832, 0.61903494, 0.53553442, -0.17233047, 0.82925244, 0.34912739, 0.96067147, 0.35785498, 0.20609688, 0.60507092, 0.36461142, -0.57561876, 0.55582428, 0.25373296, 0.45807012, 0.19974605, 0.08494931, -0.07611746, 0.297461, 0.21326621, 0.23349938, -0.08789935, -0.04259956, 0.731871, 0.12933701, 0.00748416, 0.29236831, -0.41141938, -0.41411425, -0.05120632, 0.00810806, -0.31937749, -0.39605149, 0.04545084, -0.06541803, 0.70701307, 0.1112314, 0.03537126, 0.18324138, 0.192416, -0.00230517, -0.24664495, -0.07174495, 0.44668221, 0.10233309, -0.03984052, -0.16303642, -0.00561082, 0.32475806, 0.03821171, -0.36204912, -0.38159029, 0.10513158, 0.47383453, 0.27739658, -0.27327185, -0.17936086, 0.33378664, -0.34328281, -0.06477387, -0.12203795, -0.14788203, 0.05020787, -0.37444298, -0.40981099, -0.2783886, 0.98311214, 0.92759979, -0.00520371, 0.08646998, 0.03724115, -0.10862182, -0.10127607, -0.06306517, 0.67518015, 0.11620735, 0.12323183, -0.000749, -0.12554883, 0.02737117, -0.39689931, 0.04925057, 0.29352836, 0.00340176, -0.12321169, -0.37005742, 0.98428522, 1.62612609, 0.15219643, -0.17493699, 0.10782456, 0.18642404, 0.93140537, -0.17727962, 0.10813149, 0.30798851, 0.20138006, 0.39808345, -0.02940169, 0.08942249, 0.0118382, 0.51947075, 0.42439121, -0.00551761, -0.15554035, -0.26754478, 0.00800815, 0.13767964, -0.14606478, -0.71030246, 0.10222601, 0.13578726, -0.01805413, 0.26163815, -0.58847958, 0.43555031, 0.17300121, -0.57468595, -0.01206604, -0.15645349, 0.30313485, -0.75020608, -1.45259757, 0.33232984, 0.36157188, -1.60718019, -1.01943067, -0.1007777, -0.14725204, 0.3544181, 0.46328559, 0.67196597, -0.02653055, -0.35228967, -0.54903328, 0.72128216, 0.73889507, 0.10211226, -1.09572413, -1.14730286, 0.22766139, 0.55213876, -0.10574788, -0.79557923, -0.12688618, -0.27602739, -0.16694259, -0.43416473, -0.08358647, -0.45198533, -0.43173008, -0.09835351, -0.61523846, -0.08767582, 0.08256399, -0.23340027, -0.35089407, 0.68999766, 0.01044201, -0.07452876, -0.29084764, 0.99822029, -0.23558141, 0.05397922, 0.54824991, 0.18093329, -0.18459797, 0.04977722, -0.67608188, 0.58470558, -0.2395082, -0.12696988, 1.23434434, 0.38970846, -0.16523428, -0.4295355, -0.22262463, 0.95914491, -0.8647607, 0.34839563, -0.269823, -0.4789148, 0.1488286, -0.02096427, 0.2196612, -0.28172805, -0.41030713, 0.20895993, 0.33418851, 0.10718393, 0.00751245, 0.12244945, -0.31462119, -0.14042555, 0.11726189, -0.40989137, -0.28186675, -0.10752951, 0.09579376, -0.29615914, -0.19800281, 0.39204366, 0.57933214, 0.13217556, -0.52804167, 0.07117505, 0.14039992, 0.46430646, 0.04018397, -0.25007696, 0.38746384, 0.6142287, -0.05156373, -0.06169037, 0.37997443, 0.42520735, 0.97580372, 0.47520471, -0.21281804, 0.8468674, -0.2038644, 0.47810672, -0.05051733, -0.13141479, 0.77605276, 0.03384848, 0.10650798, 0.32934754, 0.23504761, 0.48556511, 0.4091963, 0.34334739, 0.48250941, 0.32118264, 0.30846639, -0.09986353, -0.10481873, 0.0126358, -0.65511367, -1.81915588, 0.02345465, -0.15668247, -0.09862377, 0.24296676, -0.18007248, 0.07404256, -0.10516072, -0.33238472, 0.08246728, -0.13962502, -1.195236, -0.75366657, -0.05481154, 0.49604476, -0.42407431, 0.28331828, -0.29566093, 0.10096441, 0.78812321, 0.00923245, 0.2653448, -0.29925643, 0.18658936, 0.59484309, 0.19341232, 0.70210834, -0.11120997, 0.55927965, 0.04864629, -0.33075092, 0.31644374, 0.06517006, 0.44038402, -0.28132379, -0.40156235, 0.16674877, -0.28895275, -0.14899585, 0.10938034, 0.05763293, -0.23145349, 0.80737535, 1.79517153, -0.04376242, -0.14166773, -0.19367596, -0.16822073, -0.15257529, -0.033102, 0.0313577, -0.08254242, 0.04965696, 0.1824166, 0.24012152, -0.0116119, -0.10221473, -0.35060292, 0.46862918, 0.14079463, 0.04741571, -0.46612945, -0.5525376, 0.50985789, -0.36679008, 0.12358293, 0.04324134, -0.64506095, 0.58874012, -0.29184706, -0.06507416, 0.11746848, 0.33241326, 0.29369025, -0.53808339, 0.12450444, -0.34416662, -0.54235272, 0.00405574, 0.3351423, -0.24477075, -0.33703204, -0.11569786, 0.08219512, -0.19850019, 0.50064489, -4.16539275, -0.06992304, -0.22031102, -0.12578118, 1.08869709, -0.30188319, -0.46677303, 0.44624126, 0.62824836, 0.00611861, -0.26836834, 0.49544385, 0.58904577, 0.00374667, -0.26553369, -0.0095229, 0.18647884, 0.19596849, -0.12474201, 0.43134062, -0.23344849, -0.14084008, -0.17598133, -0.33350814, 1.00194754, 0.01010018, -0.14755359, 0.2441612, -0.07208423, 0.53818159, 0.4911631, -0.38558399, 0.06544949, -0.31819574, -0.09387737, -0.62945106, -0.36233495, 0.16007471, 0.02631519, -0.01772445, 0.03654983, -0.10491017, 0.11976413, 0.79754624, -0.00124571, -0.57749542, 0.19930433, 0.61239643, -0.26906465, 0.1180577, -0.06076355, 0.88898494, -0.44166098, 0.00722621, 0.06930887, -0.79258125, 0.07918831, -0.09588985, 0.45788676, 0.84958227, -0.19483142, 0.40406669, -1.72495546, 1.7609001, -0.27954135, -0.14432514, -0.56453398, -1.70607594, 0.70521403, 0.00524729, -0.55819512, -0.19133266, -1.32251295, 0.53653363, -0.02823735, -0.30823185, -0.13834728, 0.20942778, -0.06088772, -0.44084244, -0.24381548, -0.29819345, -0.15338387, -0.02457246, -0.00068268, -0.25008147, -0.34822054, -0.1276898, -0.22084982, 0.04297474, -0.08270366, -0.17597566, -0.23325412, 0.07065949, -0.15231691, -0.21031819, -0.05199123, 0.40705074, 0.27849829, -0.28144875, -0.19642361, 0.08677109, 0.04645579, -0.19174716, -0.24619884, 0.52121951, 0.35613798, 0.44570219, -0.1407154, -0.48746821, 0.36939071, -0.45023886, 0.17293403, 0.29330927, -0.68403919, 0.08154632, 0.50107062, 0.10689493, 0.15829561, 0.07131082, -0.35481732, -0.35849691, 0.13439235, -0.0933293, 0.31196508, 0.17218823, 0.19710659, -0.03173697, -0.28046528, 0.22552106, -0.19980917, -0.31690659, -0.37488911, -0.13832425, -0.2592101, 0.1836837, 0.05680613, 0.05323633, -0.51228244, 0.00994088, -0.15135323, 0.37802053, -0.46499023, 0.16475649, 0.29182655, 1.1473361, 0.11269061, 0.16561833, -1.67132837, 0.27801224, 0.08780549, -0.00625492, -0.35493779, -1.0410123, 0.29809505, -0.0081657, -0.17916354, -0.45546139, -0.73221607, 0.35578474, 0.04960554, -0.54198689, -0.28875043, 0.51567381, 0.08426944, 0.18842716, 0.00651904, 0.11050491, 0.1114375, 0.33249839, -0.12783033, 0.35755453, -0.21572296, 0.1818811, 0.01445475, 0.35848873, 0.09113617, 0.22500077, 0.16229392, -0.0419484, -0.10547295, -0.0364918, 0.10482991, 0.22003532, 0.70022856, 0.30269652, 0.16281787, -0.0110107, 0.1377463, 0.1443325, 0.35285322, 0.88144367, 0.83968568, -0.37692111, -0.35345407, -0.10210126, 0.43879143, 0.50732917, -0.24606077, 0.34739484, -0.08593058, 0.42095051, 0.83033535, -0.21615333, 0.00974722, -0.43392147, 0.52731772, 0.11814306, -0.25088612, 0.34407072, 0.10548074, -0.26270129, -0.40593595, 0.35326615, -0.04197826, 0.71234169, -0.26968222, -0.01382421, -0.24488838, 0.55670683, 0.09716758, 0.55940501, -0.42772095, 0.51558781, -0.01208142, -0.00736871, 0.24431332, -0.52527877, -0.09511965, 0.46150864, -0.22166153, -0.79877433, -0.30436118, 0.36297511, 0.03933843, -0.27234601, -0.02335656, -0.28792455, 0.00729501, 0.26460437, -0.61052716, 0.36658722, -0.31188668, 0.34206989, 0.03063796, -0.75257416, 0.10752729, -0.162318, 0.05936824, 0.21701145, 0.15934821, 0.4882908, 0.10100446, 0.0638792, 0.78924017, 0.03327403, 0.24836199, -0.15249644, 0.19428417, 0.26601694, 0.24670011, 0.20228171, 0.0747417, -0.07070433, 0.21361797, 0.0294063, -0.58146931, 0.21824335, 0.04226849, -0.72473443, 0.76012655, -0.46872568, -0.08785797, 0.59917894, -1.2980071, 0.33761511, 0.24036051, -1.36910009, 0.32855425, -0.26183911, 0.2372365, 0.25670148, -0.75584026, 0.32254071, -0.35796282, 0.22020162, 0.55869074, -0.25658921, 0.26156101, -0.17411264, 0.18532143, 0.29185561, 0.20918061, -0.11713574, 0.34779995, 0.18928815, -0.10005055, 0.15094578, -0.1146037, -0.20669081, 0.64503519, -1.04639328, 0.01507657, 0.29870911, 0.21257701, 0.60983952, 0.15646156, -0.05509115, 0.66238896, 0.07440839, 0.23630829, 0.02412448, 0.83461663, 0.72155838, 0.38660228, -0.08585396, 0.33074346, 0.4260826, 0.13318146, 0.27466797, 1.02153936, 0.36384706, -0.39395086, -0.19403108, -0.27995345, 0.55445445, 0.13145753, -0.13378839, 0.11315117, -0.1720372, 0.20048784, 0.06961685, -0.13838247, 0.08546044, 0.08626895, -0.09246028, 0.25848254, 0.02413693, -0.04585539, -0.30594765, -0.05834811, 0.07516183, -0.10106324, 0.33599916, -1.84741915, -0.05719073, 0.30993055, 0.57593458, 0.16477796, 0.18783923, 0.24985636, 0.54761805, -0.26709863, -0.11640327, -0.11844496, -0.44843839, 0.27925438, -0.03878884, 0.1862963, 0.11304902, -0.54879594, -0.15894322, 0.00332476, 1.08532384, -0.79896199, -0.14958974, 0.72145615, -0.16995578, 1.69374766, -0.33555916, 0.22641759, 0.49161883, -0.04161805, 0.95291673, -0.44521579, 0.25807384, 0.58434668, -0.17658288, -0.136333, -0.34848973, -0.07044363, 0.06361424, -0.08767029, -0.17954034, -0.0383828, -0.19257063, 0.59635827, 1.69497215, -0.03449625, -0.04183927, -0.09809114, 0.07265937, -0.0166826, -0.37364595, -0.04373142, 0.56161769, 0.31809769, 0.0920483, 1.20868137, -0.10364103, -0.20305273, -0.21029578, 0.49939112, 0.02383471, 0.25690314, 0.12581766, -0.53883081, 1.02737879, -0.16172813, 0.21644487, -0.22745302, -0.36615935, 0.27739194, -0.22130153, 0.35620296, -0.26859959, -0.29250019, 0.14857086, -0.04918168, -0.06581278, -0.15599119, -0.05416978, 0.14301398, 0.14336164, -0.12940798, 0.01574845, -0.194997, 0.23539887, -0.27963388, 0.80375497, 2.64663007, 0.10556622, 0.26373973, 0.15357508, -0.15883028, -0.29138146, 0.2312997, -0.38603113, -0.31396237, 0.00053986, -0.13197285, 0.27658705, -0.15864011, -0.25352992, -0.09760601, -0.18809161, 0.40986757, -0.30057021, -0.49365223, 0.53620452, 0.06652924, -0.07702021, -0.31837201, 0.18390592, 0.76505927, 0.77708273, -0.58009242, -0.42422276, -0.1669471, 0.01448478, 0.08364221, 0.0537065, -0.63663741, -0.01489829, -0.23169603, -0.06111227, -0.14739884, 0.14914107, -0.1485188, 0.09486223, -0.13377943, -0.13352092, -0.03975135, -0.68753726, -0.231787, 0.06716726, 0.12952125, 0.45532547, 0.07147436, -0.11407593, 0.35358837, 0.59869726, -0.10145802, -0.30169013, 0.12311321, 0.66082689, -0.09242533, -0.13512284, -0.27116293, -0.14377833, -0.22179902, 0.25757522, -0.91809521, -0.8848736, -0.38352263, 0.06044481, -0.61012371, -0.1019073, -0.68873463, -0.24377828, -0.1693349, -0.30199548, 0.05214627, -0.15315334, -0.0578892, -0.21520469, -0.54114474];
  const b1 = [-0.10670646, 0.11572152, -0.22418798, -0.16820795, 0.18565796, 0.12847083, -0.17673837, -0.20969799, -0.16197849, 0.18618439, 0.14572692, -0.16879431, -0.26879764, -0.06515952, -0.15607907, -0.06668094, 0.12983212, 0.27845053, 0.18861751, 0.09587898, 0.03680396, -0.10832145, -0.09668422, -0.09061121];
  const W2 = [0.44350177, -0.12000715, 0.14762373, 0.31447595, -0.00772669, -0.19729412, 0.070103, 0.07499362, 0.18610277, -0.45691684, 0.10452577, 0.20747582, 0.03722777, 0.03042965, -0.00388945, -0.08749616, -0.16914972, -0.00311234, -0.45282962, -0.44984872, 0.08400178, 0.01455487, -0.23453056, 0.52027326, -0.50536745, -0.4634344, -0.13107271, 0.14426717, -0.21875619, -0.5384428, 0.18657387, 0.40861312, 0.16914776, -0.26617532, 0.24732855, -0.84968363, 0.04646352, -0.19636303, 0.0832973, -0.03207353, -0.0134106, -0.11496949, -0.38911338, 0.35632124, 0.39258028, -0.07898395, -0.26200498, 0.38445209, -0.0122499, 0.70315747, 0.48187695, -0.35936992, -0.51257318, 0.03747751, 0.2561838, 0.1103753, 0.09152353, -0.07523923, -0.73906026, 0.46359963, -1.61201307, -0.07953765, -0.12883107, -0.12417271, 0.20756374, 0.18518047, 0.12778842, -0.27943081, -0.72779361, 0.45505154, 0.84657981, -0.22344093, -0.47844284, 0.34003416, 0.52292175, -0.05161418, 0.45357208, 0.22818961, -0.00243962, -0.81742872, -0.71187429, 0.08565115, 0.18499648, 0.41762895, -0.10864102, 0.29156273, -0.32245861, -0.16101362, -0.21667127, 0.06620157, 0.27019688, -0.26300703, 0.13265231, 0.08409508, 0.16636356, -0.49411654, 0.16843664, -0.37739973, -0.39019902, -0.08577088, 0.90506688, 0.05458636, -0.29445318, 0.04640206, -0.2618108, 0.28121695, 1.23258937, -1.2334208, 0.90523829, -0.07330142, -0.27830777, 0.34658614, -0.13024179, -0.09817313, 0.19600003, -0.33783973, 0.15848792, -0.8182816, -0.97440901, 0.04192408, -0.01761016, 0.68116449, -0.21036348, -0.18927593, 0.20913952, 0.12951181, -0.32849995, -0.12801096, -0.23406828, 0.20592771, -0.00656944, -0.15578249, -0.35969023, -0.63625753, -0.22799418, -0.48773259, -0.04218528, 0.3565715, 0.22762908, -0.52458931, 0.12312307, 0.0794097, -0.09435558, -0.20765071, -0.08331699, -0.11910371, -0.60912589, 0.48908295, -0.68336517, -0.22452028, -0.43569307, -0.4242236, -0.417292, -0.29363784, -0.12201705, -0.11885014, -0.25669585, 0.26074779, -0.28313031, 0.19986429, -0.42069552, 0.12231286, 0.40434032, -0.15163645, -0.20703264, -0.02280057, -0.87861712, 0.15574295, -0.51092031, 0.12452921, -0.31159766, -0.17228332, 0.16849375, 0.69706819, 0.25580321, -0.16513983, -0.27138282, 0.22231656, 0.16157296, 0.33990677, -0.21831987, -0.05362667, 0.03191586, -0.05512075, 0.25699847, 0.0603624, 0.40932769, 0.22377369, 0.00484899, -0.2488386, 0.20852063, -0.13213618, 0.00824925, -0.23224688, 0.19035679, 0.08852136, -0.22532033, -0.20743222, -0.05455082, 0.72615561, -0.0602697, -0.37313847, -0.30927832, -0.19973239, -0.048321, 0.49748817, 0.56893179, -0.05677302, -0.04099906, -0.4608484, -0.51867258, 0.0317118, 0.860764, 0.44172428, -0.16184868, 0.60372466, -0.01875745, 0.00659691, -0.47108961, -0.45041016, 0.41508756, 0.23965699, -0.32950929, -0.21874178, -0.02987422, 0.07927656, 0.07329058, -0.6469969, 0.2687739, 0.69116592, -0.13080578, 0.38876649, -0.03500875, 0.22953302, -0.16072227, -0.19802397, -0.32512057, -0.16105087, -0.41474356, 0.16130862, 0.27704406, -0.05220067, -0.00750753, 0.27848617, -0.71233708, 0.23955546, 0.40128131, -0.68924307, -0.00333474, 0.01282985, -0.18038067, 0.13806988, 0.78407584, 0.95647198, -0.13559976, 0.4814807, 0.65152088, 0.60896947, 0.13610062, 0.47628614, -0.21160271, 0.19628027, -0.33598763, 0.25900403, -0.41775, 0.25699068, -0.32824027, -0.13695813, -0.13945952, 0.159675, -0.35426809, 0.28385044, -0.2938311, -0.31840739, 0.29671559, -0.37394448, 0.02214902, -0.45062186, -0.76067182, -0.02359098, 0.07567459, 0.22404626, 0.12962318, 0.00369471, -0.13481045, -0.51751584, 0.12005434, 0.06795926, 0.20701996, -0.92321812, -0.55174721, 0.55327042, 0.10065671, -0.08785817, -0.19914849, -0.57231586, 0.07359595, -0.26415331, 0.0471002, -0.52327122, 1.90546868, -0.42699064, 0.03844813, -0.03991395, -0.1615002, -0.61603472, -0.18297134, 0.17371348, 0.99094236, -0.10705552, -0.89146195, 0.54275078, -0.27637047, 0.08780732, 0.67716783, -0.39809078, -1.02863079, 0.24573183, 0.37193204, 0.11603561, 0.30970725, 0.05877079, -0.78560139, 0.12007972, -0.81904175, 0.62327862, 0.02866845, 0.19126501, 0.20406004, 0.36399028, -0.07659751, 0.057711, -0.49846303, 0.67065908, 0.46549073, -0.08625406, -0.08440807, 0.43984865, 0.07118102, -0.0660345, 0.02380957, 0.37533976, 0.13200925, -0.03232223, -0.36040764, 0.61241457, -0.47488246, 0.36913586, 0.13488608, 0.04741713, -0.35960047, -0.02982263, 0.03838425, 0.27160043, 0.59196516, 0.04188202, -0.25481488, -0.3400094, 0.11715715, 0.06008305, 0.42132389, -0.64857747, 0.12642101, 0.33232981, -0.15200593, -0.03410358, 0.42581749, 0.46277611, 0.281696, -0.57744176, -0.14460467, -0.38784477, -0.03486834, 0.02343516, 0.13413376, 0.15244409, -0.2144859, -0.44474257, -0.02270177, -0.312952, 0.09914382, 0.08631034, 0.29059477, 0.26923704];
  const b2 = [-0.16367468, -0.18920664, -0.1019189, 0.13882645, 0.13420502, 0.16422186, 0.16368406, 0.1574417, -0.16556346, 0.14113202, 0.09265691, 0.13568047, -0.20761098, 0.12645792, 0.16946764, -0.17552724];
  const W3 = [-0.18583336, -0.09726861, -0.07253347, 0.79819709, -0.07711202, 0.22358101, 1.42014533, 0.21028136, -0.19560468, 0.53876378, 0.5866373, 0.82820107, 0.58310445, 0.48474708, 0.26882082, -0.28165418, -0.02649559, 0.03088833, 0.01204488, 0.05356736, 0.00216045, 0.26252865, -0.00606709, -0.1178731, -0.20712052, 0.01086991, 0.01159401, -0.14898379, -0.00014444, -0.00801027, 0.01879299, 0.34942694, -0.29190106, -0.04726403, -0.01093185, 0.05003652, 0.01306064, -0.18029102, 0.0062519, -0.05402431, 0.47897765, 0.0079396, -0.01582809, -0.13732133, -0.00651921, -0.01274217, -0.09864776, -0.43562778, 0.47295873, 0.06453979, 0.01461427, -0.01813537, -0.02108663, 0.05343741, -0.01680023, -0.04100695, -0.23546979, -0.00649101, -0.00302633, 0.14255149, 0.00561092, 0.01131782, 0.14972219, 0.04084563, -0.2801681, -0.33417382, -0.80734528, 0.13402743, 0.90497258, 0.41655619, -0.26049196, 0.42204999, -0.4727114, 0.63744202, 0.70085702, 0.40725087, 0.7733632, -0.6462957, 0.41991489, -0.13147466];
  const b3 = [0.12858837, 0.06220128, 0.10879635, 0.05489659, 0.19883583];

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = [].concat(xSelf, xEn, xAl, xBl);

  // 네트워크 파라미터
  const W1 = [0.11656912, 0.01260383, -0.32057178, -0.18905277, -0.09714652, -0.24313108, 0.17302394, -0.14495162, -0.21558669, -0.33901278, -0.12184461, 0.18955023, -0.21425091, 0.08283297, -0.29751645, -0.4144216, 0.17116984, -0.2208081, -0.23572377, -0.07284823, 0.24693006, 0.34950426, 0.03112469, -0.17990605, 0.26801496, 0.72616566, 0.17461417, 0.01764007, 0.78600584, -0.31605109, -0.03393034, -0.30264372, -0.27311637, 0.62776753, 0.18216503, 0.10052461, 0.07666186, -0.30140457, 0.16467462, 0.00314817, -0.02803327, -0.2193544, -0.25914014, 0.10464072, 0.10929909, 0.17981487, -0.11175828, 0.13891904, 0.34446455, -0.03214401, 0.15143138, -0.08288712, 2.1773745, 0.66184581, 0.05174873, 0.0539937, -0.16999456, -0.24063937, 0.12051248, -0.03339576, 0.07139236, -0.02115658, 0.02482972, -0.86448745, -0.57878824, 0.05921001, 0.20836453, 0.04476935, 0.04230419, -0.12696441, 0.04823266, -0.41672078, 0.80723679, 0.37144886, -0.30848678, 0.50578728, -0.39003326, 0.67581631, -0.02034531, -0.13267806, 0.28439678, -0.17117114, 0.32947826, 0.04035268, -0.36672863, 0.08249913, -0.38825069, -0.42049487, -0.01858038, 0.03009207, -0.56230488, -0.11604681, -0.41158262, 0.0441916, 0.87962326, 1.29116443, -0.48867992, -0.14634261, 0.47691828, -0.05259212, 0.03380839, -0.2758087, -0.01967602, 0.01628491, 0.0657156, 0.31262597, 0.20848497, -0.03807146, -0.10761772, -0.28951491, 0.01420879, 0.3844144, -0.18832312, -0.80462206, 0.90815417, 1.27638158, 0.0481103, -0.05091778, 0.35397996, 0.38280478, 1.02580844, -0.09255345, 0.11115765, 0.40604435, 0.7068669, 0.27570792, -0.34855366, -0.05832268, 0.24226477, -0.34137395, -0.29165637, -0.22525584, -0.23300008, -0.10595134, -0.41131194, -0.32275155, -0.24470947, 0.19489653, -1.46915264, 0.20634114, -0.23820239, 0.49519778, 0.57324564, 0.34989206, -0.18650418, 0.36774967, 0.39902684, -0.33766271, -0.13379049, 0.59984486, -0.34552083, 0.11181477, -0.18329685, -1.13658071, -0.62711976, -0.03399629, -0.3571374, 0.37062312, -1.55208303, -0.38085666, 0.00004274, 0.44555405, 0.9913173, -0.97300671, -0.30368865, 0.21488683, 0.06910782, 0.52697813, -0.78491217, -0.16009726, 0.40470786, -0.22781528, 0.34163687, 0.74601177, 0.04822372, 0.31122334, 0.14193186, 0.4045294, -0.04853074, 0.19617735, -0.5600238, -0.93201602, -0.15894012, 0.44960899, -0.16380811, 0.17650275, -0.14008267, 0.17549408, 0.02879807, -0.03526237, -0.11739401, 0.06856943, -0.54230245, -0.6807158, 0.13836145, 0.4085312, 0.11703181, 0.205917, -0.30871627, 0.01029271, 0.94078832, 0.61903494, 0.53553442, -0.17233047, 0.82925244, 0.34912739, 0.96067147, 0.35785498, 0.20609688, 0.60507092, 0.36461142, -0.57561876, 0.55582428, 0.25373296, 0.45807012, 0.19974605, 0.08494931, -0.07611746, 0.297461, 0.21326621, 0.23349938, -0.08789935, -0.04259956, 0.731871, 0.12933701, 0.00748416, 0.29236831, -0.41141938, -0.41411425, -0.05120632, 0.00810806, -0.31937749, -0.39605149, 0.04545084, -0.06541803, 0.70701307, 0.1112314, 0.03537126, 0.18324138, 0.192416, -0.00230517, -0.24664495, -0.07174495, 0.44668221, 0.10233309, -0.03984052, -0.16303642, -0.00561082, 0.32475806, 0.03821171, -0.36204912, -0.38159029, 0.10513158, 0.47383453, 0.27739658, -0.27327185, -0.17936086, 0.33378664, -0.34328281, -0.06477387, -0.12203795, -0.14788203, 0.05020787, -0.37444298, -0.40981099, -0.2783886, 0.98311214, 0.92759979, -0.00520371, 0.08646998, 0.03724115, -0.10862182, -0.10127607, -0.06306517, 0.67518015, 0.11620735, 0.12323183, -0.000749, -0.12554883, 0.02737117, -0.39689931, 0.04925057, 0.29352836, 0.00340176, -0.12321169, -0.37005742, 0.98428522, 1.62612609, 0.15219643, -0.17493699, 0.10782456, 0.18642404, 0.93140537, -0.17727962, 0.10813149, 0.30798851, 0.20138006, 0.39808345, -0.02940169, 0.08942249, 0.0118382, 0.51947075, 0.42439121, -0.00551761, -0.15554035, -0.26754478, 0.00800815, 0.13767964, -0.14606478, -0.71030246, 0.10222601, 0.13578726, -0.01805413, 0.26163815, -0.58847958, 0.43555031, 0.17300121, -0.57468595, -0.01206604, -0.15645349, 0.30313485, -0.75020608, -1.45259757, 0.33232984, 0.36157188, -1.60718019, -1.01943067, -0.1007777, -0.14725204, 0.3544181, 0.46328559, 0.67196597, -0.02653055, -0.35228967, -0.54903328, 0.72128216, 0.73889507, 0.10211226, -1.09572413, -1.14730286, 0.22766139, 0.55213876, -0.10574788, -0.79557923, -0.12688618, -0.27602739, -0.16694259, -0.43416473, -0.08358647, -0.45198533, -0.43173008, -0.09835351, -0.61523846, -0.08767582, 0.08256399, -0.23340027, -0.35089407, 0.68999766, 0.01044201, -0.07452876, -0.29084764, 0.99822029, -0.23558141, 0.05397922, 0.54824991, 0.18093329, -0.18459797, 0.04977722, -0.67608188, 0.58470558, -0.2395082, -0.12696988, 1.23434434, 0.38970846, -0.16523428, -0.4295355, -0.22262463, 0.95914491, -0.8647607, 0.34839563, -0.269823, -0.4789148, 0.1488286, -0.02096427, 0.2196612, -0.28172805, -0.41030713, 0.20895993, 0.33418851, 0.10718393, 0.00751245, 0.12244945, -0.31462119, -0.14042555, 0.11726189, -0.40989137, -0.28186675, -0.10752951, 0.09579376, -0.29615914, -0.19800281, 0.39204366, 0.57933214, 0.13217556, -0.52804167, 0.07117505, 0.14039992, 0.46430646, 0.04018397, -0.25007696, 0.38746384, 0.6142287, -0.05156373, -0.06169037, 0.37997443, 0.42520735, 0.97580372, 0.47520471, -0.21281804, 0.8468674, -0.2038644, 0.47810672, -0.05051733, -0.13141479, 0.77605276, 0.03384848, 0.10650798, 0.32934754, 0.23504761, 0.48556511, 0.4091963, 0.34334739, 0.48250941, 0.32118264, 0.30846639, -0.09986353, -0.10481873, 0.0126358, -0.65511367, -1.81915588, 0.02345465, -0.15668247, -0.09862377, 0.24296676, -0.18007248, 0.07404256, -0.10516072, -0.33238472, 0.08246728, -0.13962502, -1.195236, -0.75366657, -0.05481154, 0.49604476, -0.42407431, 0.28331828, -0.29566093, 0.10096441, 0.78812321, 0.00923245, 0.2653448, -0.29925643, 0.18658936, 0.59484309, 0.19341232, 0.70210834, -0.11120997, 0.55927965, 0.04864629, -0.33075092, 0.31644374, 0.06517006, 0.44038402, -0.28132379, -0.40156235, 0.16674877, -0.28895275, -0.14899585, 0.10938034, 0.05763293, -0.23145349, 0.80737535, 1.79517153, -0.04376242, -0.14166773, -0.19367596, -0.16822073, -0.15257529, -0.033102, 0.0313577, -0.08254242, 0.04965696, 0.1824166, 0.24012152, -0.0116119, -0.10221473, -0.35060292, 0.46862918, 0.14079463, 0.04741571, -0.46612945, -0.5525376, 0.50985789, -0.36679008, 0.12358293, 0.04324134, -0.64506095, 0.58874012, -0.29184706, -0.06507416, 0.11746848, 0.33241326, 0.29369025, -0.53808339, 0.12450444, -0.34416662, -0.54235272, 0.00405574, 0.3351423, -0.24477075, -0.33703204, -0.11569786, 0.08219512, -0.19850019, 0.50064489, -4.16539275, -0.06992304, -0.22031102, -0.12578118, 1.08869709, -0.30188319, -0.46677303, 0.44624126, 0.62824836, 0.00611861, -0.26836834, 0.49544385, 0.58904577, 0.00374667, -0.26553369, -0.0095229, 0.18647884, 0.19596849, -0.12474201, 0.43134062, -0.23344849, -0.14084008, -0.17598133, -0.33350814, 1.00194754, 0.01010018, -0.14755359, 0.2441612, -0.07208423, 0.53818159, 0.4911631, -0.38558399, 0.06544949, -0.31819574, -0.09387737, -0.62945106, -0.36233495, 0.16007471, 0.02631519, -0.01772445, 0.03654983, -0.10491017, 0.11976413, 0.79754624, -0.00124571, -0.57749542, 0.19930433, 0.61239643, -0.26906465, 0.1180577, -0.06076355, 0.88898494, -0.44166098, 0.00722621, 0.06930887, -0.79258125, 0.07918831, -0.09588985, 0.45788676, 0.84958227, -0.19483142, 0.40406669, -1.72495546, 1.7609001, -0.27954135, -0.14432514, -0.56453398, -1.70607594, 0.70521403, 0.00524729, -0.55819512, -0.19133266, -1.32251295, 0.53653363, -0.02823735, -0.30823185, -0.13834728, 0.20942778, -0.06088772, -0.44084244, -0.24381548, -0.29819345, -0.15338387, -0.02457246, -0.00068268, -0.25008147, -0.34822054, -0.1276898, -0.22084982, 0.04297474, -0.08270366, -0.17597566, -0.23325412, 0.07065949, -0.15231691, -0.21031819, -0.05199123, 0.40705074, 0.27849829, -0.28144875, -0.19642361, 0.08677109, 0.04645579, -0.19174716, -0.24619884, 0.52121951, 0.35613798, 0.44570219, -0.1407154, -0.48746821, 0.36939071, -0.45023886, 0.17293403, 0.29330927, -0.68403919, 0.08154632, 0.50107062, 0.10689493, 0.15829561, 0.07131082, -0.35481732, -0.35849691, 0.13439235, -0.0933293, 0.31196508, 0.17218823, 0.19710659, -0.03173697, -0.28046528, 0.22552106, -0.19980917, -0.31690659, -0.37488911, -0.13832425, -0.2592101, 0.1836837, 0.05680613, 0.05323633, -0.51228244, 0.00994088, -0.15135323, 0.37802053, -0.46499023, 0.16475649, 0.29182655, 1.1473361, 0.11269061, 0.16561833, -1.67132837, 0.27801224, 0.08780549, -0.00625492, -0.35493779, -1.0410123, 0.29809505, -0.0081657, -0.17916354, -0.45546139, -0.73221607, 0.35578474, 0.04960554, -0.54198689, -0.28875043, 0.51567381, 0.08426944, 0.18842716, 0.00651904, 0.11050491, 0.1114375, 0.33249839, -0.12783033, 0.35755453, -0.21572296, 0.1818811, 0.01445475, 0.35848873, 0.09113617, 0.22500077, 0.16229392, -0.0419484, -0.10547295, -0.0364918, 0.10482991, 0.22003532, 0.70022856, 0.30269652, 0.16281787, -0.0110107, 0.1377463, 0.1443325, 0.35285322, 0.88144367, 0.83968568, -0.37692111, -0.35345407, -0.10210126, 0.43879143, 0.50732917, -0.24606077, 0.34739484, -0.08593058, 0.42095051, 0.83033535, -0.21615333, 0.00974722, -0.43392147, 0.52731772, 0.11814306, -0.25088612, 0.34407072, 0.10548074, -0.26270129, -0.40593595, 0.35326615, -0.04197826, 0.71234169, -0.26968222, -0.01382421, -0.24488838, 0.55670683, 0.09716758, 0.55940501, -0.42772095, 0.51558781, -0.01208142, -0.00736871, 0.24431332, -0.52527877, -0.09511965, 0.46150864, -0.22166153, -0.79877433, -0.30436118, 0.36297511, 0.03933843, -0.27234601, -0.02335656, -0.28792455, 0.00729501, 0.26460437, -0.61052716, 0.36658722, -0.31188668, 0.34206989, 0.03063796, -0.75257416, 0.10752729, -0.162318, 0.05936824, 0.21701145, 0.15934821, 0.4882908, 0.10100446, 0.0638792, 0.78924017, 0.03327403, 0.24836199, -0.15249644, 0.19428417, 0.26601694, 0.24670011, 0.20228171, 0.0747417, -0.07070433, 0.21361797, 0.0294063, -0.58146931, 0.21824335, 0.04226849, -0.72473443, 0.76012655, -0.46872568, -0.08785797, 0.59917894, -1.2980071, 0.33761511, 0.24036051, -1.36910009, 0.32855425, -0.26183911, 0.2372365, 0.25670148, -0.75584026, 0.32254071, -0.35796282, 0.22020162, 0.55869074, -0.25658921, 0.26156101, -0.17411264, 0.18532143, 0.29185561, 0.20918061, -0.11713574, 0.34779995, 0.18928815, -0.10005055, 0.15094578, -0.1146037, -0.20669081, 0.64503519, -1.04639328, 0.01507657, 0.29870911, 0.21257701, 0.60983952, 0.15646156, -0.05509115, 0.66238896, 0.07440839, 0.23630829, 0.02412448, 0.83461663, 0.72155838, 0.38660228, -0.08585396, 0.33074346, 0.4260826, 0.13318146, 0.27466797, 1.02153936, 0.36384706, -0.39395086, -0.19403108, -0.27995345, 0.55445445, 0.13145753, -0.13378839, 0.11315117, -0.1720372, 0.20048784, 0.06961685, -0.13838247, 0.08546044, 0.08626895, -0.09246028, 0.25848254, 0.02413693, -0.04585539, -0.30594765, -0.05834811, 0.07516183, -0.10106324, 0.33599916, -1.84741915, -0.05719073, 0.30993055, 0.57593458, 0.16477796, 0.18783923, 0.24985636, 0.54761805, -0.26709863, -0.11640327, -0.11844496, -0.44843839, 0.27925438, -0.03878884, 0.1862963, 0.11304902, -0.54879594, -0.15894322, 0.00332476, 1.08532384, -0.79896199, -0.14958974, 0.72145615, -0.16995578, 1.69374766, -0.33555916, 0.22641759, 0.49161883, -0.04161805, 0.95291673, -0.44521579, 0.25807384, 0.58434668, -0.17658288, -0.136333, -0.34848973, -0.07044363, 0.06361424, -0.08767029, -0.17954034, -0.0383828, -0.19257063, 0.59635827, 1.69497215, -0.03449625, -0.04183927, -0.09809114, 0.07265937, -0.0166826, -0.37364595, -0.04373142, 0.56161769, 0.31809769, 0.0920483, 1.20868137, -0.10364103, -0.20305273, -0.21029578, 0.49939112, 0.02383471, 0.25690314, 0.12581766, -0.53883081, 1.02737879, -0.16172813, 0.21644487, -0.22745302, -0.36615935, 0.27739194, -0.22130153, 0.35620296, -0.26859959, -0.29250019, 0.14857086, -0.04918168, -0.06581278, -0.15599119, -0.05416978, 0.14301398, 0.14336164, -0.12940798, 0.01574845, -0.194997, 0.23539887, -0.27963388, 0.80375497, 2.64663007, 0.10556622, 0.26373973, 0.15357508, -0.15883028, -0.29138146, 0.2312997, -0.38603113, -0.31396237, 0.00053986, -0.13197285, 0.27658705, -0.15864011, -0.25352992, -0.09760601, -0.18809161, 0.40986757, -0.30057021, -0.49365223, 0.53620452, 0.06652924, -0.07702021, -0.31837201, 0.18390592, 0.76505927, 0.77708273, -0.58009242, -0.42422276, -0.1669471, 0.01448478, 0.08364221, 0.0537065, -0.63663741, -0.01489829, -0.23169603, -0.06111227, -0.14739884, 0.14914107, -0.1485188, 0.09486223, -0.13377943, -0.13352092, -0.03975135, -0.68753726, -0.231787, 0.06716726, 0.12952125, 0.45532547, 0.07147436, -0.11407593, 0.35358837, 0.59869726, -0.10145802, -0.30169013, 0.12311321, 0.66082689, -0.09242533, -0.13512284, -0.27116293, -0.14377833, -0.22179902, 0.25757522, -0.91809521, -0.8848736, -0.38352263, 0.06044481, -0.61012371, -0.1019073, -0.68873463, -0.24377828, -0.1693349, -0.30199548, 0.05214627, -0.15315334, -0.0578892, -0.21520469, -0.54114474];
  const b1 = [-0.10670646, 0.11572152, -0.22418798, -0.16820795, 0.18565796, 0.12847083, -0.17673837, -0.20969799, -0.16197849, 0.18618439, 0.14572692, -0.16879431, -0.26879764, -0.06515952, -0.15607907, -0.06668094, 0.12983212, 0.27845053, 0.18861751, 0.09587898, 0.03680396, -0.10832145, -0.09668422, -0.09061121];
  const W2 = [0.44350177, -0.12000715, 0.14762373, 0.31447595, -0.00772669, -0.19729412, 0.070103, 0.07499362, 0.18610277, -0.45691684, 0.10452577, 0.20747582, 0.03722777, 0.03042965, -0.00388945, -0.08749616, -0.16914972, -0.00311234, -0.45282962, -0.44984872, 0.08400178, 0.01455487, -0.23453056, 0.52027326, -0.50536745, -0.4634344, -0.13107271, 0.14426717, -0.21875619, -0.5384428, 0.18657387, 0.40861312, 0.16914776, -0.26617532, 0.24732855, -0.84968363, 0.04646352, -0.19636303, 0.0832973, -0.03207353, -0.0134106, -0.11496949, -0.38911338, 0.35632124, 0.39258028, -0.07898395, -0.26200498, 0.38445209, -0.0122499, 0.70315747, 0.48187695, -0.35936992, -0.51257318, 0.03747751, 0.2561838, 0.1103753, 0.09152353, -0.07523923, -0.73906026, 0.46359963, -1.61201307, -0.07953765, -0.12883107, -0.12417271, 0.20756374, 0.18518047, 0.12778842, -0.27943081, -0.72779361, 0.45505154, 0.84657981, -0.22344093, -0.47844284, 0.34003416, 0.52292175, -0.05161418, 0.45357208, 0.22818961, -0.00243962, -0.81742872, -0.71187429, 0.08565115, 0.18499648, 0.41762895, -0.10864102, 0.29156273, -0.32245861, -0.16101362, -0.21667127, 0.06620157, 0.27019688, -0.26300703, 0.13265231, 0.08409508, 0.16636356, -0.49411654, 0.16843664, -0.37739973, -0.39019902, -0.08577088, 0.90506688, 0.05458636, -0.29445318, 0.04640206, -0.2618108, 0.28121695, 1.23258937, -1.2334208, 0.90523829, -0.07330142, -0.27830777, 0.34658614, -0.13024179, -0.09817313, 0.19600003, -0.33783973, 0.15848792, -0.8182816, -0.97440901, 0.04192408, -0.01761016, 0.68116449, -0.21036348, -0.18927593, 0.20913952, 0.12951181, -0.32849995, -0.12801096, -0.23406828, 0.20592771, -0.00656944, -0.15578249, -0.35969023, -0.63625753, -0.22799418, -0.48773259, -0.04218528, 0.3565715, 0.22762908, -0.52458931, 0.12312307, 0.0794097, -0.09435558, -0.20765071, -0.08331699, -0.11910371, -0.60912589, 0.48908295, -0.68336517, -0.22452028, -0.43569307, -0.4242236, -0.417292, -0.29363784, -0.12201705, -0.11885014, -0.25669585, 0.26074779, -0.28313031, 0.19986429, -0.42069552, 0.12231286, 0.40434032, -0.15163645, -0.20703264, -0.02280057, -0.87861712, 0.15574295, -0.51092031, 0.12452921, -0.31159766, -0.17228332, 0.16849375, 0.69706819, 0.25580321, -0.16513983, -0.27138282, 0.22231656, 0.16157296, 0.33990677, -0.21831987, -0.05362667, 0.03191586, -0.05512075, 0.25699847, 0.0603624, 0.40932769, 0.22377369, 0.00484899, -0.2488386, 0.20852063, -0.13213618, 0.00824925, -0.23224688, 0.19035679, 0.08852136, -0.22532033, -0.20743222, -0.05455082, 0.72615561, -0.0602697, -0.37313847, -0.30927832, -0.19973239, -0.048321, 0.49748817, 0.56893179, -0.05677302, -0.04099906, -0.4608484, -0.51867258, 0.0317118, 0.860764, 0.44172428, -0.16184868, 0.60372466, -0.01875745, 0.00659691, -0.47108961, -0.45041016, 0.41508756, 0.23965699, -0.32950929, -0.21874178, -0.02987422, 0.07927656, 0.07329058, -0.6469969, 0.2687739, 0.69116592, -0.13080578, 0.38876649, -0.03500875, 0.22953302, -0.16072227, -0.19802397, -0.32512057, -0.16105087, -0.41474356, 0.16130862, 0.27704406, -0.05220067, -0.00750753, 0.27848617, -0.71233708, 0.23955546, 0.40128131, -0.68924307, -0.00333474, 0.01282985, -0.18038067, 0.13806988, 0.78407584, 0.95647198, -0.13559976, 0.4814807, 0.65152088, 0.60896947, 0.13610062, 0.47628614, -0.21160271, 0.19628027, -0.33598763, 0.25900403, -0.41775, 0.25699068, -0.32824027, -0.13695813, -0.13945952, 0.159675, -0.35426809, 0.28385044, -0.2938311, -0.31840739, 0.29671559, -0.37394448, 0.02214902, -0.45062186, -0.76067182, -0.02359098, 0.07567459, 0.22404626, 0.12962318, 0.00369471, -0.13481045, -0.51751584, 0.12005434, 0.06795926, 0.20701996, -0.92321812, -0.55174721, 0.55327042, 0.10065671, -0.08785817, -0.19914849, -0.57231586, 0.07359595, -0.26415331, 0.0471002, -0.52327122, 1.90546868, -0.42699064, 0.03844813, -0.03991395, -0.1615002, -0.61603472, -0.18297134, 0.17371348, 0.99094236, -0.10705552, -0.89146195, 0.54275078, -0.27637047, 0.08780732, 0.67716783, -0.39809078, -1.02863079, 0.24573183, 0.37193204, 0.11603561, 0.30970725, 0.05877079, -0.78560139, 0.12007972, -0.81904175, 0.62327862, 0.02866845, 0.19126501, 0.20406004, 0.36399028, -0.07659751, 0.057711, -0.49846303, 0.67065908, 0.46549073, -0.08625406, -0.08440807, 0.43984865, 0.07118102, -0.0660345, 0.02380957, 0.37533976, 0.13200925, -0.03232223, -0.36040764, 0.61241457, -0.47488246, 0.36913586, 0.13488608, 0.04741713, -0.35960047, -0.02982263, 0.03838425, 0.27160043, 0.59196516, 0.04188202, -0.25481488, -0.3400094, 0.11715715, 0.06008305, 0.42132389, -0.64857747, 0.12642101, 0.33232981, -0.15200593, -0.03410358, 0.42581749, 0.46277611, 0.281696, -0.57744176, -0.14460467, -0.38784477, -0.03486834, 0.02343516, 0.13413376, 0.15244409, -0.2144859, -0.44474257, -0.02270177, -0.312952, 0.09914382, 0.08631034, 0.29059477, 0.26923704];
  const b2 = [-0.16367468, -0.18920664, -0.1019189, 0.13882645, 0.13420502, 0.16422186, 0.16368406, 0.1574417, -0.16556346, 0.14113202, 0.09265691, 0.13568047, -0.20761098, 0.12645792, 0.16946764, -0.17552724];
  const W3 = [-0.18583336, -0.09726861, -0.07253347, 0.79819709, -0.07711202, 0.22358101, 1.42014533, 0.21028136, -0.19560468, 0.53876378, 0.5866373, 0.82820107, 0.58310445, 0.48474708, 0.26882082, -0.28165418, -0.02649559, 0.03088833, 0.01204488, 0.05356736, 0.00216045, 0.26252865, -0.00606709, -0.1178731, -0.20712052, 0.01086991, 0.01159401, -0.14898379, -0.00014444, -0.00801027, 0.01879299, 0.34942694, -0.29190106, -0.04726403, -0.01093185, 0.05003652, 0.01306064, -0.18029102, 0.0062519, -0.05402431, 0.47897765, 0.0079396, -0.01582809, -0.13732133, -0.00651921, -0.01274217, -0.09864776, -0.43562778, 0.47295873, 0.06453979, 0.01461427, -0.01813537, -0.02108663, 0.05343741, -0.01680023, -0.04100695, -0.23546979, -0.00649101, -0.00302633, 0.14255149, 0.00561092, 0.01131782, 0.14972219, 0.04084563, -0.2801681, -0.33417382, -0.80734528, 0.13402743, 0.90497258, 0.41655619, -0.26049196, 0.42204999, -0.4727114, 0.63744202, 0.70085702, 0.40725087, 0.7733632, -0.6462957, 0.41991489, -0.13147466];
  const b3 = [0.12858837, 0.06220128, 0.10879635, 0.05489659, 0.19883583];

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = [].concat(xSelf, xEn, xAl, xBl);

  // 네트워크 파라미터
  const W1 = [0.11656912, 0.01260383, -0.32057178, -0.18905277, -0.09714652, -0.24313108, 0.17302394, -0.14495162, -0.21558669, -0.33901278, -0.12184461, 0.18955023, -0.21425091, 0.08283297, -0.29751645, -0.4144216, 0.17116984, -0.2208081, -0.23572377, -0.07284823, 0.24693006, 0.34950426, 0.03112469, -0.17990605, 0.26801496, 0.72616566, 0.17461417, 0.01764007, 0.78600584, -0.31605109, -0.03393034, -0.30264372, -0.27311637, 0.62776753, 0.18216503, 0.10052461, 0.07666186, -0.30140457, 0.16467462, 0.00314817, -0.02803327, -0.2193544, -0.25914014, 0.10464072, 0.10929909, 0.17981487, -0.11175828, 0.13891904, 0.34446455, -0.03214401, 0.15143138, -0.08288712, 2.1773745, 0.66184581, 0.05174873, 0.0539937, -0.16999456, -0.24063937, 0.12051248, -0.03339576, 0.07139236, -0.02115658, 0.02482972, -0.86448745, -0.57878824, 0.05921001, 0.20836453, 0.04476935, 0.04230419, -0.12696441, 0.04823266, -0.41672078, 0.80723679, 0.37144886, -0.30848678, 0.50578728, -0.39003326, 0.67581631, -0.02034531, -0.13267806, 0.28439678, -0.17117114, 0.32947826, 0.04035268, -0.36672863, 0.08249913, -0.38825069, -0.42049487, -0.01858038, 0.03009207, -0.56230488, -0.11604681, -0.41158262, 0.0441916, 0.87962326, 1.29116443, -0.48867992, -0.14634261, 0.47691828, -0.05259212, 0.03380839, -0.2758087, -0.01967602, 0.01628491, 0.0657156, 0.31262597, 0.20848497, -0.03807146, -0.10761772, -0.28951491, 0.01420879, 0.3844144, -0.18832312, -0.80462206, 0.90815417, 1.27638158, 0.0481103, -0.05091778, 0.35397996, 0.38280478, 1.02580844, -0.09255345, 0.11115765, 0.40604435, 0.7068669, 0.27570792, -0.34855366, -0.05832268, 0.24226477, -0.34137395, -0.29165637, -0.22525584, -0.23300008, -0.10595134, -0.41131194, -0.32275155, -0.24470947, 0.19489653, -1.46915264, 0.20634114, -0.23820239, 0.49519778, 0.57324564, 0.34989206, -0.18650418, 0.36774967, 0.39902684, -0.33766271, -0.13379049, 0.59984486, -0.34552083, 0.11181477, -0.18329685, -1.13658071, -0.62711976, -0.03399629, -0.3571374, 0.37062312, -1.55208303, -0.38085666, 0.00004274, 0.44555405, 0.9913173, -0.97300671, -0.30368865, 0.21488683, 0.06910782, 0.52697813, -0.78491217, -0.16009726, 0.40470786, -0.22781528, 0.34163687, 0.74601177, 0.04822372, 0.31122334, 0.14193186, 0.4045294, -0.04853074, 0.19617735, -0.5600238, -0.93201602, -0.15894012, 0.44960899, -0.16380811, 0.17650275, -0.14008267, 0.17549408, 0.02879807, -0.03526237, -0.11739401, 0.06856943, -0.54230245, -0.6807158, 0.13836145, 0.4085312, 0.11703181, 0.205917, -0.30871627, 0.01029271, 0.94078832, 0.61903494, 0.53553442, -0.17233047, 0.82925244, 0.34912739, 0.96067147, 0.35785498, 0.20609688, 0.60507092, 0.36461142, -0.57561876, 0.55582428, 0.25373296, 0.45807012, 0.19974605, 0.08494931, -0.07611746, 0.297461, 0.21326621, 0.23349938, -0.08789935, -0.04259956, 0.731871, 0.12933701, 0.00748416, 0.29236831, -0.41141938, -0.41411425, -0.05120632, 0.00810806, -0.31937749, -0.39605149, 0.04545084, -0.06541803, 0.70701307, 0.1112314, 0.03537126, 0.18324138, 0.192416, -0.00230517, -0.24664495, -0.07174495, 0.44668221, 0.10233309, -0.03984052, -0.16303642, -0.00561082, 0.32475806, 0.03821171, -0.36204912, -0.38159029, 0.10513158, 0.47383453, 0.27739658, -0.27327185, -0.17936086, 0.33378664, -0.34328281, -0.06477387, -0.12203795, -0.14788203, 0.05020787, -0.37444298, -0.40981099, -0.2783886, 0.98311214, 0.92759979, -0.00520371, 0.08646998, 0.03724115, -0.10862182, -0.10127607, -0.06306517, 0.67518015, 0.11620735, 0.12323183, -0.000749, -0.12554883, 0.02737117, -0.39689931, 0.04925057, 0.29352836, 0.00340176, -0.12321169, -0.37005742, 0.98428522, 1.62612609, 0.15219643, -0.17493699, 0.10782456, 0.18642404, 0.93140537, -0.17727962, 0.10813149, 0.30798851, 0.20138006, 0.39808345, -0.02940169, 0.08942249, 0.0118382, 0.51947075, 0.42439121, -0.00551761, -0.15554035, -0.26754478, 0.00800815, 0.13767964, -0.14606478, -0.71030246, 0.10222601, 0.13578726, -0.01805413, 0.26163815, -0.58847958, 0.43555031, 0.17300121, -0.57468595, -0.01206604, -0.15645349, 0.30313485, -0.75020608, -1.45259757, 0.33232984, 0.36157188, -1.60718019, -1.01943067, -0.1007777, -0.14725204, 0.3544181, 0.46328559, 0.67196597, -0.02653055, -0.35228967, -0.54903328, 0.72128216, 0.73889507, 0.10211226, -1.09572413, -1.14730286, 0.22766139, 0.55213876, -0.10574788, -0.79557923, -0.12688618, -0.27602739, -0.16694259, -0.43416473, -0.08358647, -0.45198533, -0.43173008, -0.09835351, -0.61523846, -0.08767582, 0.08256399, -0.23340027, -0.35089407, 0.68999766, 0.01044201, -0.07452876, -0.29084764, 0.99822029, -0.23558141, 0.05397922, 0.54824991, 0.18093329, -0.18459797, 0.04977722, -0.67608188, 0.58470558, -0.2395082, -0.12696988, 1.23434434, 0.38970846, -0.16523428, -0.4295355, -0.22262463, 0.95914491, -0.8647607, 0.34839563, -0.269823, -0.4789148, 0.1488286, -0.02096427, 0.2196612, -0.28172805, -0.41030713, 0.20895993, 0.33418851, 0.10718393, 0.00751245, 0.12244945, -0.31462119, -0.14042555, 0.11726189, -0.40989137, -0.28186675, -0.10752951, 0.09579376, -0.29615914, -0.19800281, 0.39204366, 0.57933214, 0.13217556, -0.52804167, 0.07117505, 0.14039992, 0.46430646, 0.04018397, -0.25007696, 0.38746384, 0.6142287, -0.05156373, -0.06169037, 0.37997443, 0.42520735, 0.97580372, 0.47520471, -0.21281804, 0.8468674, -0.2038644, 0.47810672, -0.05051733, -0.13141479, 0.77605276, 0.03384848, 0.10650798, 0.32934754, 0.23504761, 0.48556511, 0.4091963, 0.34334739, 0.48250941, 0.32118264, 0.30846639, -0.09986353, -0.10481873, 0.0126358, -0.65511367, -1.81915588, 0.02345465, -0.15668247, -0.09862377, 0.24296676, -0.18007248, 0.07404256, -0.10516072, -0.33238472, 0.08246728, -0.13962502, -1.195236, -0.75366657, -0.05481154, 0.49604476, -0.42407431, 0.28331828, -0.29566093, 0.10096441, 0.78812321, 0.00923245, 0.2653448, -0.29925643, 0.18658936, 0.59484309, 0.19341232, 0.70210834, -0.11120997, 0.55927965, 0.04864629, -0.33075092, 0.31644374, 0.06517006, 0.44038402, -0.28132379, -0.40156235, 0.16674877, -0.28895275, -0.14899585, 0.10938034, 0.05763293, -0.23145349, 0.80737535, 1.79517153, -0.04376242, -0.14166773, -0.19367596, -0.16822073, -0.15257529, -0.033102, 0.0313577, -0.08254242, 0.04965696, 0.1824166, 0.24012152, -0.0116119, -0.10221473, -0.35060292, 0.46862918, 0.14079463, 0.04741571, -0.46612945, -0.5525376, 0.50985789, -0.36679008, 0.12358293, 0.04324134, -0.64506095, 0.58874012, -0.29184706, -0.06507416, 0.11746848, 0.33241326, 0.29369025, -0.53808339, 0.12450444, -0.34416662, -0.54235272, 0.00405574, 0.3351423, -0.24477075, -0.33703204, -0.11569786, 0.08219512, -0.19850019, 0.50064489, -4.16539275, -0.06992304, -0.22031102, -0.12578118, 1.08869709, -0.30188319, -0.46677303, 0.44624126, 0.62824836, 0.00611861, -0.26836834, 0.49544385, 0.58904577, 0.00374667, -0.26553369, -0.0095229, 0.18647884, 0.19596849, -0.12474201, 0.43134062, -0.23344849, -0.14084008, -0.17598133, -0.33350814, 1.00194754, 0.01010018, -0.14755359, 0.2441612, -0.07208423, 0.53818159, 0.4911631, -0.38558399, 0.06544949, -0.31819574, -0.09387737, -0.62945106, -0.36233495, 0.16007471, 0.02631519, -0.01772445, 0.03654983, -0.10491017, 0.11976413, 0.79754624, -0.00124571, -0.57749542, 0.19930433, 0.61239643, -0.26906465, 0.1180577, -0.06076355, 0.88898494, -0.44166098, 0.00722621, 0.06930887, -0.79258125, 0.07918831, -0.09588985, 0.45788676, 0.84958227, -0.19483142, 0.40406669, -1.72495546, 1.7609001, -0.27954135, -0.14432514, -0.56453398, -1.70607594, 0.70521403, 0.00524729, -0.55819512, -0.19133266, -1.32251295, 0.53653363, -0.02823735, -0.30823185, -0.13834728, 0.20942778, -0.06088772, -0.44084244, -0.24381548, -0.29819345, -0.15338387, -0.02457246, -0.00068268, -0.25008147, -0.34822054, -0.1276898, -0.22084982, 0.04297474, -0.08270366, -0.17597566, -0.23325412, 0.07065949, -0.15231691, -0.21031819, -0.05199123, 0.40705074, 0.27849829, -0.28144875, -0.19642361, 0.08677109, 0.04645579, -0.19174716, -0.24619884, 0.52121951, 0.35613798, 0.44570219, -0.1407154, -0.48746821, 0.36939071, -0.45023886, 0.17293403, 0.29330927, -0.68403919, 0.08154632, 0.50107062, 0.10689493, 0.15829561, 0.07131082, -0.35481732, -0.35849691, 0.13439235, -0.0933293, 0.31196508, 0.17218823, 0.19710659, -0.03173697, -0.28046528, 0.22552106, -0.19980917, -0.31690659, -0.37488911, -0.13832425, -0.2592101, 0.1836837, 0.05680613, 0.05323633, -0.51228244, 0.00994088, -0.15135323, 0.37802053, -0.46499023, 0.16475649, 0.29182655, 1.1473361, 0.11269061, 0.16561833, -1.67132837, 0.27801224, 0.08780549, -0.00625492, -0.35493779, -1.0410123, 0.29809505, -0.0081657, -0.17916354, -0.45546139, -0.73221607, 0.35578474, 0.04960554, -0.54198689, -0.28875043, 0.51567381, 0.08426944, 0.18842716, 0.00651904, 0.11050491, 0.1114375, 0.33249839, -0.12783033, 0.35755453, -0.21572296, 0.1818811, 0.01445475, 0.35848873, 0.09113617, 0.22500077, 0.16229392, -0.0419484, -0.10547295, -0.0364918, 0.10482991, 0.22003532, 0.70022856, 0.30269652, 0.16281787, -0.0110107, 0.1377463, 0.1443325, 0.35285322, 0.88144367, 0.83968568, -0.37692111, -0.35345407, -0.10210126, 0.43879143, 0.50732917, -0.24606077, 0.34739484, -0.08593058, 0.42095051, 0.83033535, -0.21615333, 0.00974722, -0.43392147, 0.52731772, 0.11814306, -0.25088612, 0.34407072, 0.10548074, -0.26270129, -0.40593595, 0.35326615, -0.04197826, 0.71234169, -0.26968222, -0.01382421, -0.24488838, 0.55670683, 0.09716758, 0.55940501, -0.42772095, 0.51558781, -0.01208142, -0.00736871, 0.24431332, -0.52527877, -0.09511965, 0.46150864, -0.22166153, -0.79877433, -0.30436118, 0.36297511, 0.03933843, -0.27234601, -0.02335656, -0.28792455, 0.00729501, 0.26460437, -0.61052716, 0.36658722, -0.31188668, 0.34206989, 0.03063796, -0.75257416, 0.10752729, -0.162318, 0.05936824, 0.21701145, 0.15934821, 0.4882908, 0.10100446, 0.0638792, 0.78924017, 0.03327403, 0.24836199, -0.15249644, 0.19428417, 0.26601694, 0.24670011, 0.20228171, 0.0747417, -0.07070433, 0.21361797, 0.0294063, -0.58146931, 0.21824335, 0.04226849, -0.72473443, 0.76012655, -0.46872568, -0.08785797, 0.59917894, -1.2980071, 0.33761511, 0.24036051, -1.36910009, 0.32855425, -0.26183911, 0.2372365, 0.25670148, -0.75584026, 0.32254071, -0.35796282, 0.22020162, 0.55869074, -0.25658921, 0.26156101, -0.17411264, 0.18532143, 0.29185561, 0.20918061, -0.11713574, 0.34779995, 0.18928815, -0.10005055, 0.15094578, -0.1146037, -0.20669081, 0.64503519, -1.04639328, 0.01507657, 0.29870911, 0.21257701, 0.60983952, 0.15646156, -0.05509115, 0.66238896, 0.07440839, 0.23630829, 0.02412448, 0.83461663, 0.72155838, 0.38660228, -0.08585396, 0.33074346, 0.4260826, 0.13318146, 0.27466797, 1.02153936, 0.36384706, -0.39395086, -0.19403108, -0.27995345, 0.55445445, 0.13145753, -0.13378839, 0.11315117, -0.1720372, 0.20048784, 0.06961685, -0.13838247, 0.08546044, 0.08626895, -0.09246028, 0.25848254, 0.02413693, -0.04585539, -0.30594765, -0.05834811, 0.07516183, -0.10106324, 0.33599916, -1.84741915, -0.05719073, 0.30993055, 0.57593458, 0.16477796, 0.18783923, 0.24985636, 0.54761805, -0.26709863, -0.11640327, -0.11844496, -0.44843839, 0.27925438, -0.03878884, 0.1862963, 0.11304902, -0.54879594, -0.15894322, 0.00332476, 1.08532384, -0.79896199, -0.14958974, 0.72145615, -0.16995578, 1.69374766, -0.33555916, 0.22641759, 0.49161883, -0.04161805, 0.95291673, -0.44521579, 0.25807384, 0.58434668, -0.17658288, -0.136333, -0.34848973, -0.07044363, 0.06361424, -0.08767029, -0.17954034, -0.0383828, -0.19257063, 0.59635827, 1.69497215, -0.03449625, -0.04183927, -0.09809114, 0.07265937, -0.0166826, -0.37364595, -0.04373142, 0.56161769, 0.31809769, 0.0920483, 1.20868137, -0.10364103, -0.20305273, -0.21029578, 0.49939112, 0.02383471, 0.25690314, 0.12581766, -0.53883081, 1.02737879, -0.16172813, 0.21644487, -0.22745302, -0.36615935, 0.27739194, -0.22130153, 0.35620296, -0.26859959, -0.29250019, 0.14857086, -0.04918168, -0.06581278, -0.15599119, -0.05416978, 0.14301398, 0.14336164, -0.12940798, 0.01574845, -0.194997, 0.23539887, -0.27963388, 0.80375497, 2.64663007, 0.10556622, 0.26373973, 0.15357508, -0.15883028, -0.29138146, 0.2312997, -0.38603113, -0.31396237, 0.00053986, -0.13197285, 0.27658705, -0.15864011, -0.25352992, -0.09760601, -0.18809161, 0.40986757, -0.30057021, -0.49365223, 0.53620452, 0.06652924, -0.07702021, -0.31837201, 0.18390592, 0.76505927, 0.77708273, -0.58009242, -0.42422276, -0.1669471, 0.01448478, 0.08364221, 0.0537065, -0.63663741, -0.01489829, -0.23169603, -0.06111227, -0.14739884, 0.14914107, -0.1485188, 0.09486223, -0.13377943, -0.13352092, -0.03975135, -0.68753726, -0.231787, 0.06716726, 0.12952125, 0.45532547, 0.07147436, -0.11407593, 0.35358837, 0.59869726, -0.10145802, -0.30169013, 0.12311321, 0.66082689, -0.09242533, -0.13512284, -0.27116293, -0.14377833, -0.22179902, 0.25757522, -0.91809521, -0.8848736, -0.38352263, 0.06044481, -0.61012371, -0.1019073, -0.68873463, -0.24377828, -0.1693349, -0.30199548, 0.05214627, -0.15315334, -0.0578892, -0.21520469, -0.54114474];
  const b1 = [-0.10670646, 0.11572152, -0.22418798, -0.16820795, 0.18565796, 0.12847083, -0.17673837, -0.20969799, -0.16197849, 0.18618439, 0.14572692, -0.16879431, -0.26879764, -0.06515952, -0.15607907, -0.06668094, 0.12983212, 0.27845053, 0.18861751, 0.09587898, 0.03680396, -0.10832145, -0.09668422, -0.09061121];
  const W2 = [0.44350177, -0.12000715, 0.14762373, 0.31447595, -0.00772669, -0.19729412, 0.070103, 0.07499362, 0.18610277, -0.45691684, 0.10452577, 0.20747582, 0.03722777, 0.03042965, -0.00388945, -0.08749616, -0.16914972, -0.00311234, -0.45282962, -0.44984872, 0.08400178, 0.01455487, -0.23453056, 0.52027326, -0.50536745, -0.4634344, -0.13107271, 0.14426717, -0.21875619, -0.5384428, 0.18657387, 0.40861312, 0.16914776, -0.26617532, 0.24732855, -0.84968363, 0.04646352, -0.19636303, 0.0832973, -0.03207353, -0.0134106, -0.11496949, -0.38911338, 0.35632124, 0.39258028, -0.07898395, -0.26200498, 0.38445209, -0.0122499, 0.70315747, 0.48187695, -0.35936992, -0.51257318, 0.03747751, 0.2561838, 0.1103753, 0.09152353, -0.07523923, -0.73906026, 0.46359963, -1.61201307, -0.07953765, -0.12883107, -0.12417271, 0.20756374, 0.18518047, 0.12778842, -0.27943081, -0.72779361, 0.45505154, 0.84657981, -0.22344093, -0.47844284, 0.34003416, 0.52292175, -0.05161418, 0.45357208, 0.22818961, -0.00243962, -0.81742872, -0.71187429, 0.08565115, 0.18499648, 0.41762895, -0.10864102, 0.29156273, -0.32245861, -0.16101362, -0.21667127, 0.06620157, 0.27019688, -0.26300703, 0.13265231, 0.08409508, 0.16636356, -0.49411654, 0.16843664, -0.37739973, -0.39019902, -0.08577088, 0.90506688, 0.05458636, -0.29445318, 0.04640206, -0.2618108, 0.28121695, 1.23258937, -1.2334208, 0.90523829, -0.07330142, -0.27830777, 0.34658614, -0.13024179, -0.09817313, 0.19600003, -0.33783973, 0.15848792, -0.8182816, -0.97440901, 0.04192408, -0.01761016, 0.68116449, -0.21036348, -0.18927593, 0.20913952, 0.12951181, -0.32849995, -0.12801096, -0.23406828, 0.20592771, -0.00656944, -0.15578249, -0.35969023, -0.63625753, -0.22799418, -0.48773259, -0.04218528, 0.3565715, 0.22762908, -0.52458931, 0.12312307, 0.0794097, -0.09435558, -0.20765071, -0.08331699, -0.11910371, -0.60912589, 0.48908295, -0.68336517, -0.22452028, -0.43569307, -0.4242236, -0.417292, -0.29363784, -0.12201705, -0.11885014, -0.25669585, 0.26074779, -0.28313031, 0.19986429, -0.42069552, 0.12231286, 0.40434032, -0.15163645, -0.20703264, -0.02280057, -0.87861712, 0.15574295, -0.51092031, 0.12452921, -0.31159766, -0.17228332, 0.16849375, 0.69706819, 0.25580321, -0.16513983, -0.27138282, 0.22231656, 0.16157296, 0.33990677, -0.21831987, -0.05362667, 0.03191586, -0.05512075, 0.25699847, 0.0603624, 0.40932769, 0.22377369, 0.00484899, -0.2488386, 0.20852063, -0.13213618, 0.00824925, -0.23224688, 0.19035679, 0.08852136, -0.22532033, -0.20743222, -0.05455082, 0.72615561, -0.0602697, -0.37313847, -0.30927832, -0.19973239, -0.048321, 0.49748817, 0.56893179, -0.05677302, -0.04099906, -0.4608484, -0.51867258, 0.0317118, 0.860764, 0.44172428, -0.16184868, 0.60372466, -0.01875745, 0.00659691, -0.47108961, -0.45041016, 0.41508756, 0.23965699, -0.32950929, -0.21874178, -0.02987422, 0.07927656, 0.07329058, -0.6469969, 0.2687739, 0.69116592, -0.13080578, 0.38876649, -0.03500875, 0.22953302, -0.16072227, -0.19802397, -0.32512057, -0.16105087, -0.41474356, 0.16130862, 0.27704406, -0.05220067, -0.00750753, 0.27848617, -0.71233708, 0.23955546, 0.40128131, -0.68924307, -0.00333474, 0.01282985, -0.18038067, 0.13806988, 0.78407584, 0.95647198, -0.13559976, 0.4814807, 0.65152088, 0.60896947, 0.13610062, 0.47628614, -0.21160271, 0.19628027, -0.33598763, 0.25900403, -0.41775, 0.25699068, -0.32824027, -0.13695813, -0.13945952, 0.159675, -0.35426809, 0.28385044, -0.2938311, -0.31840739, 0.29671559, -0.37394448, 0.02214902, -0.45062186, -0.76067182, -0.02359098, 0.07567459, 0.22404626, 0.12962318, 0.00369471, -0.13481045, -0.51751584, 0.12005434, 0.06795926, 0.20701996, -0.92321812, -0.55174721, 0.55327042, 0.10065671, -0.08785817, -0.19914849, -0.57231586, 0.07359595, -0.26415331, 0.0471002, -0.52327122, 1.90546868, -0.42699064, 0.03844813, -0.03991395, -0.1615002, -0.61603472, -0.18297134, 0.17371348, 0.99094236, -0.10705552, -0.89146195, 0.54275078, -0.27637047, 0.08780732, 0.67716783, -0.39809078, -1.02863079, 0.24573183, 0.37193204, 0.11603561, 0.30970725, 0.05877079, -0.78560139, 0.12007972, -0.81904175, 0.62327862, 0.02866845, 0.19126501, 0.20406004, 0.36399028, -0.07659751, 0.057711, -0.49846303, 0.67065908, 0.46549073, -0.08625406, -0.08440807, 0.43984865, 0.07118102, -0.0660345, 0.02380957, 0.37533976, 0.13200925, -0.03232223, -0.36040764, 0.61241457, -0.47488246, 0.36913586, 0.13488608, 0.04741713, -0.35960047, -0.02982263, 0.03838425, 0.27160043, 0.59196516, 0.04188202, -0.25481488, -0.3400094, 0.11715715, 0.06008305, 0.42132389, -0.64857747, 0.12642101, 0.33232981, -0.15200593, -0.03410358, 0.42581749, 0.46277611, 0.281696, -0.57744176, -0.14460467, -0.38784477, -0.03486834, 0.02343516, 0.13413376, 0.15244409, -0.2144859, -0.44474257, -0.02270177, -0.312952, 0.09914382, 0.08631034, 0.29059477, 0.26923704];
  const b2 = [-0.16367468, -0.18920664, -0.1019189, 0.13882645, 0.13420502, 0.16422186, 0.16368406, 0.1574417, -0.16556346, 0.14113202, 0.09265691, 0.13568047, -0.20761098, 0.12645792, 0.16946764, -0.17552724];
  const W3 = [-0.18583336, -0.09726861, -0.07253347, 0.79819709, -0.07711202, 0.22358101, 1.42014533, 0.21028136, -0.19560468, 0.53876378, 0.5866373, 0.82820107, 0.58310445, 0.48474708, 0.26882082, -0.28165418, -0.02649559, 0.03088833, 0.01204488, 0.05356736, 0.00216045, 0.26252865, -0.00606709, -0.1178731, -0.20712052, 0.01086991, 0.01159401, -0.14898379, -0.00014444, -0.00801027, 0.01879299, 0.34942694, -0.29190106, -0.04726403, -0.01093185, 0.05003652, 0.01306064, -0.18029102, 0.0062519, -0.05402431, 0.47897765, 0.0079396, -0.01582809, -0.13732133, -0.00651921, -0.01274217, -0.09864776, -0.43562778, 0.47295873, 0.06453979, 0.01461427, -0.01813537, -0.02108663, 0.05343741, -0.01680023, -0.04100695, -0.23546979, -0.00649101, -0.00302633, 0.14255149, 0.00561092, 0.01131782, 0.14972219, 0.04084563, -0.2801681, -0.33417382, -0.80734528, 0.13402743, 0.90497258, 0.41655619, -0.26049196, 0.42204999, -0.4727114, 0.63744202, 0.70085702, 0.40725087, 0.7733632, -0.6462957, 0.41991489, -0.13147466];
  const b3 = [0.12858837, 0.06220128, 0.10879635, 0.05489659, 0.19883583];

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
