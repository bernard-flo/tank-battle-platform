function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.37367955, -0.35655271, -0.20250552, -0.34481252, -0.09999207, -0.00379505, -0.0184631, -0.46863095, 0.75725387, -5.56230644, -0.10896188, 0.15297558, -0.07864012, 0.38746442, -0.11763881, -0.00024774, 0.18476201, 0.01598787, -0.14243465, -0.19989418, 0.39618945, 0.71850921, 0.01053419, 0.12605924, -0.46636395, 0.39170941, 0.12634164, 0.06641563, 0.47845474, -0.01313837, -0.08148162, 0.54502727, -0.1764148, 0.61669693, 0.20005133, -0.17687406, 0.69256141, -0.01875002, 0.56533594, -0.07870909, 0.00186146, 0.60913202, -0.19844768, 0.19290289, 0.08998624, -0.14195802, 0.07428855, 0.30363257, 0.39243164, 0.18022127, -0.00272998, 0.91734827, -1.10212008, -1.37015113, -0.08101384, 0.10213716, 0.86257978, -0.67292438, 0.63858139, 0.25765421, -0.43942791, -0.32244815, 0.98060971, 1.96213201, 0.02376881, 0.31505169, 0.96824986, -1.68711116, 0.61034008, -0.20836064, -0.3895434, 6.72936062, 0.38123824, 0.41431277, 0.53324557, 0.97596945, 4.53033208, 0.65570391, 0.39096668, 0.681621, 0.269472, 1.40211212, 0.79839522, 0.13178913, 0.60215126, -0.70030552, -0.04554696, 0.46055073, 0.04508601, 0.20535651, -0.12727416, 0.19360687, 0.20414665, 0.4604987, -1.29870183, -1.85396709, 0.01555748, 0.75731396, 0.40710334, 0.46626982, -0.68093211, 0.21134125, 0.0396087, -0.28116609, -0.42211123, 0.13349404, -1.19753039, -1.2921438, 0.39829841, 0.12484378, 1.01845594, 1.31458948, -0.44088747, 0.59211759, 0.61404855, 0.66642877, 0.44078828, -0.97065452, -0.34028084, 0.06517759, 1.09645698, 0.12170389, -0.47970173, 0.15599535, -0.1598288, 0.34552495, 0.20994686, -0.24241985, 0.26566471, 0.09404231, -0.00185984, -0.81831437, -0.19537278, -0.26085131, -1.08576424, -0.25281467, 0.04222919, -0.02200046, 1.19190821, 0.19308774, -0.98198101, -0.67181255, 0.04610372, -0.39923057, -0.71626144, -0.5321834, 0.59444319, -0.55059216, -0.16036236, 1.5852253, 0.32265167, -0.82676289, 0.32637174, 1.19828749, -0.09963534, -0.24286612, 0.18423258, 1.65997562, 0.43896263, 0.25142909, 0.05714172, -0.99009309, -0.36277681, 0.17678746, 0.17065356, 0.2999573, -0.51305639, -0.31900132, -0.38967836, -0.14481157, 0.53511676, -0.25737027, -0.08766127, 0.19116151, 0.31669896, -0.14177168, -0.02731271, 0.28196278, 0.45748175, -0.40196382, -0.00271061, -4.2760882, 0.50166892, 0.47782012, -0.2335934, -0.2096391, -0.08637055, 0.35546883, -0.27549609, -0.47947386, 0.02405826, 0.10702495, -0.97608948, 0.63812046, 0.09055079, 0.09075505, 0.67105247, -0.46830954, -0.00370852, 0.67238786, -0.07310662, -0.47338603, 0.48125339, 0.22048789, 0.06709343, 0.54923078, 0.27169977, -0.02955572, 0.66595845, -0.39870067, 0.33382914, -0.71592502, 0.1115227, 0.56116495, 0.36052893, -0.44526205, -0.05939491, -0.04559796, -0.12845957, -0.27877536, -0.09645798, -0.2513095, 0.1988506, 0.88071396, -2.8585234, -0.1656975, -0.22059098, 0.80286704, 0.92415699, -0.08535674, -0.00570063, 0.43308276, 0.24646164, -0.30896173, -0.17709841, -0.16859489, -0.15774939, -0.05108047, -0.76321227, -0.46590614, 0.84741596, -0.3566829, 0.00479685, 0.79825508, -2.21178896, -0.58848294, -0.16492905, -0.23970558, 1.07348152, -0.22593733, -0.47028359, -0.36294249, -0.72077299, 0.41848149, 0.50949535, -0.26921403, -0.45160998, 0.07504819, 0.08655836, 0.30108809, 0.40760542, -0.09314225, -0.18551259, 0.36098076, 0.08008493, -0.17594103, 0.3667882, -0.44959867, 0.94495331, 0.87365067, -0.73656855, -0.31275431, 0.51375214, -0.31321416, -0.61473491, -0.0932328, 0.04089805, -0.11793739, -0.52247519, -0.01954783, 0.04350873, 0.12541805, 0.3495806, -1.01111869, -0.0974116, -0.1912975, 2.49225844, 0.22999173, 0.23385168, -0.82609385, 1.22146573, 1.4350237, 0.31956772, 0.14606169, -0.42307349, 1.24482024, 0.68868796, -0.33224636, -0.03911759, -0.17637863, 0.79316499, -0.2576309, -0.08840788, 0.11548682, 0.05044824, -0.06249549, -0.35326178, -0.14798324, -0.58278107, 1.20958241, 2.59958687, -0.02749967, -0.30519525, -0.45608573, -0.86478838, 0.03342703, -0.09224473, 0.46655865, -0.06266845, 0.5347212, -0.20895469, 1.66416341, -1.4152917, -0.60786259, 0.55932773, 0.38941846, -0.68389871, 0.03803172, 0.17996907, -0.34566564, 0.2400251, -0.10166361, 0.08876131, 0.53118647, 0.40190514, -0.25326954, -0.08875649, 0.08922969, 0.74948099, 0.13952352, -0.41164292, -0.11052886, 0.12421492, -0.08321668, -0.39260526, 0.36233751, 0.4535305, -0.47458518, -0.02055333, -0.44815799, 0.17378572, 0.01454993, -0.3984546, -6.08163587, 0.08393767, -0.0802907, -0.28299343, 0.1077149, 0.6893537, -0.29118718, 0.09575081, 0.69732582, 0.08771233, 0.18128787, 0.67841872, 1.03419939, 0.11464642, -0.64055245, -0.58039127, -1.5393959, 0.66563946, -0.00675712, 0.27619461, -0.01867601, 0.17199815, 0.73896864, -0.49929605, -0.24071797, -0.7735635, 0.36787024, 0.57473598, -0.51470644, 0.10868302, 0.18825567, 0.1433809, 0.44983215, 0.3110922, -0.25781091, -0.01701182, -0.39485142, -0.39225882, -0.4238235, -0.60147618, -0.35322348, -0.15462529, -0.86085885, 0.25426956, -0.48359618, -0.35139001, -0.51315284, 0.05513217, -0.14865726, -0.04124857, -0.4791491, -0.37826954, -0.09199109, 0.0408116, -0.71096745, 0.47174394, -0.11793403, -0.4191609, 0.4345681, -0.70465425, -0.40856462, 0.0919282, 0.89103857, 0.59984947, 0.57940104, -0.00256685, -0.76798229, 0.20545285, -0.19435572, 0.21449673, 0.37891476, -0.73462311, 0.18232847, -0.2191685, -0.17950424, 0.34939034, -0.21671032, -0.14725652, 0.12579731, 0.22736849, -0.4166054, -0.05767994, -0.46284717, -0.24598771, -0.13211549, 0.43400898, 2.46541811, -0.13484735, -0.46557604, 0.1443944, -0.75097079, 0.08695359, -0.27418249, 0.27396717, 0.49244486, 0.15266717, -0.04167017, 0.19010627, -0.41786312, -0.50348014, -0.38997942, 0.00378595, 0.11517839, 0.44369593, -0.54882049, 0.45807867, -0.27621376, -0.10687869, 0.27263099, -0.33355399, 0.03720111, 0.41795753, -0.30067931, 0.12384626, -0.45012036, -0.06015577, 0.46563994, -0.14275769, 0.43840605, -0.56701322, 1.00767277, 0.0803451, 0.0447841, -0.07561186, 0.28511836, 1.11742957, -0.51139321, 0.33867884, -1.17233547, 0.87519597, -0.07655837, -0.03732289, 1.72099088, -0.34952614, 0.60401773, 0.07677419, 0.33020227, -0.60501811, -0.15547007, 0.03979151, -1.40981826, 0.07536672, 0.84747206, -0.80652364, -0.88702868, -0.88839648, 0.91457139, -0.32258107, -1.39670974, -0.86226824, 0.27821097, 0.09137227, -0.71161177, -0.63268748, -0.76203644, 0.03391525, 0.33700284, -0.56546525, -0.27671503, -0.20754898, 0.43492654, -0.26994894, 0.07466348, -0.27469881, -0.30835253, 0.57311595, -0.19135086, -0.00758429, 0.12949078, -0.16737298, -0.06388467, 1.41276559, -1.67826086, 0.11256297, -0.32221906, 0.43195997, -0.73009905, -0.39425429, -0.47782929, 0.11098235, -0.43118211, 0.37777208, -0.24384072, -2.00377526, -0.51397144, 1.02314473, -1.30342489, -0.40097514, 0.21788535, 0.27843285, 0.25252678, 0.70999984, -0.39310426, 0.40489407, -0.03706699, -2.5781379, 0.99043761, 0.28416039, 0.13143118, 0.10564484, -2.33127565, -0.17048388, 0.17486396, -0.0031519, 0.01805415, -1.19640746, -0.30936341, 0.15886225, -0.484087, -0.08683084, -0.052608, -0.52811952, -0.65461897, 0.22361188, -0.38490041, 1.99846423, -0.88974626, -1.36016117, -0.49243242, -0.66310326, -0.65699192, -0.79859392, -0.7749947, -0.05590271, -0.60458855, -0.58833825, 1.03412362, -0.22991797, -0.87396657, -0.6471435, 0.02844965, 0.27442076, -0.36558448, -0.44646803, 1.12875554, 0.02185584, -0.15329332, -0.07330369, -0.57722641, 0.29980512, 0.3628283, -0.22857184, 0.37883553, -0.43993042, 0.23424024, -0.0569633, -0.01990152, 0.60615148, -0.46456648, 0.36658781, 0.78312321, 0.3605576, 0.23405065, -0.36872698, 0.16792231, -0.12076227, 0.47399395, -0.10557934, -1.43560677, -0.34419375, 0.01495153, 0.03885159, -0.24674312, 0.23616006, 0.31404975, 0.21750481, -0.23447034, -0.03676641, 0.61439293, -0.18655758, -0.8651777, 0.11925246, 0.32495045, -0.20426155, -1.05076869, -0.21879875, 0.01617589, 2.70643336, 1.85281517, 0.48081075, -0.32559781, 1.68891186, 0.77603167, 0.51296821, 0.42898649, 0.02403734, 1.43319528, 0.57855442, -0.39464524, 0.74732705, -0.09617027, 0.78749603, -0.41332401, -0.28330427, -0.32226869, -0.14388052, -0.14778918, -0.44224577, -0.03196901, -0.26794169, 0.68220969, 3.34307011, 0.24847419, -0.42382943, 0.13333863, 0.43854206, -0.02462593, 0.00078187, 0.1077558, 0.23829599, 0.31174832, -0.0336766, 0.27630817, 1.44303172, -0.00855537, -0.35891216, 0.82465093, -0.03742278, 0.06036493, -0.52377809, -0.40656264, 0.82444246, -0.61697638, 0.67558564, 0.35191594, -0.5282224, 0.08434215, -0.2426511, 0.09583508, 0.48456962, 0.06679809, -0.40040208, -0.14114741, -0.0809227, -0.63092641, -0.25910505, -0.08592117, -0.06482869, -0.1376199, -0.09884876, 0.14393889, 0.08368564, -0.3665201, 2.16754599, 0.09285028, 0.00570206, -0.11009174, 0.23646948, -0.06039455, -0.23766702, 0.02402643, -1.0695568, -0.71394596, -0.89580276, 0.10851547, -1.86642874, -2.81318044, 0.71277625, -0.46263081, 1.2825585, -1.55471817, -0.26411604, 0.10458911, -1.48794279, 4.07206127, 1.31527352, -0.04915247, -0.52165964, -1.31206989, 0.64806435, 0.21286685, 0.17138245, 0.0345549, -0.72553987, -0.23402846, 0.64149571, 0.05777905, -0.25660845, -0.3842559, 0.03229333, -0.16330155, 0.32827579, 0.13020282, 0.14202244, 0.01069589, 0.19832888, -0.93914962, -1.88289994, -0.33112048, 0.34987486, 0.11804352, -0.01903019, -0.17841263, -0.18961072, -0.26241155, -0.8174164, -0.30740354, -0.50447569, -0.41903202, -0.43410489, 0.16935845, -0.02955339, -0.17022146, -0.77974612, 0.23589389, 0.47154188, 0.25611629, 0.89312216, -0.0613999, -0.15859704, -0.15004505, -0.41511767, 0.46238897, -0.09387331, -0.40414429, 0.19147374, 0.1022777, 0.49361063, 0.14043876, -0.43516633, 0.7815562, 1.21948261, 0.79322107, 0.0776158, -0.27952406, 0.01147481, 0.77572859, -0.11681408, -0.06998583, -1.11363813, 0.54957064, -0.54022562, -0.46586264, 0.60722995, -1.64414979, 0.45673288, 0.46779158, -0.06719015, -0.55520683, 0.32890803, 0.78577772, -2.6444638, -2.90255869, 0.36102429, -0.0334389, -1.58583811, 0.27455064, -0.30671148, -0.97595235, 1.72980814, 1.02317419, 1.80727898, 0.18082774, 0.94389273, 0.11869972, -0.43875856, 1.16373003, 0.07606694, 0.61445033, -0.51274564, -1.01994078, 1.04995413, -0.21807333, 0.80522455, -0.34545427, -0.27150112, -0.71709678, -0.2013548, -0.57043752, -0.51418037, -0.6807708, 0.02921568, -0.39214251, 0.23959787, -0.74707022, 0.42279153, -0.45915771, 0.7834428, 0.14834117, -0.50917047, 0.30374902, 0.84473329, -0.26804779, -0.5402964, -0.77252725, 2.51228808, -0.45100941, 0.55281235, 0.88084719, 0.62645937, 0.76525407, -0.20325039, 1.02253575, 6.13240714, 0.65163466, -0.42165712, 1.21040695, -1.04166048, 2.15892272, -0.1828163, 0.29330258, 2.68353962, 1.17765899, 0.84806436, -0.11848513, 0.21901076, 0.55115811, 0.38551364, -0.06697084, 0.16517862, 0.1283943, 0.64718835, -0.47028789, 0.3972625, 0.52069881, -0.93649364, -2.08205695, 0.09803816, 0.36423555, -0.11349227, 0.92488823, 0.08206258, 0.50652821, -0.42065908, 0.10856862, -0.0654208, -0.1372549, 0.49674405, 0.38003519, 0.60424828, 0.32020323, -1.57378214, 0.51755184, 0.39012964, 0.50056123, -1.49999621, -1.3814717, -0.06494532, 0.08884502, -0.50213344, -0.4514629, -2.0837348, 0.25719078, -0.13371639, -0.51934369, -1.20131608, -0.01717315, 0.13690821, -0.7813616, 0.11606223, -0.54944106, 0.00886557, 0.15375807, -0.32474046, 0.05596555, -0.14689821, 0.02835635, -0.28388456, 0.21699988, -3.48653378, -0.39647272, 0.40088006, 0.01416231, 0.18881201, -0.05630252, -0.12417696, 0.7780627, -0.35005511, -0.0427732, -0.01765561, -0.81225087, 0.37245777, -0.14276719, 0.03233728, 1.186064, 0.17462922, -0.51487399, 0.60124582, 0.33224874, -0.05486804, -0.11303612, 0.13779535, 0.13642379, 0.39657825, 0.23303783, -0.1261119, 0.04866497, 0.15551102, 0.96474035, -0.53098741, -0.03982736, 0.72189164, 0.53049708, 0.75787783, 0.09097524, 0.01830308, 0.39389232, 0.27012072, 0.54644018, 1.12601875, 0.01968803, -0.45336743, 3.13538151, 0.28449194, -0.14325775, 0.23172357, -0.1098143, -0.43297551, 0.55169826, -0.29991348, 0.1422041, -0.20385603, 0.58512631, -0.93381751, -0.38023049, 0.18913321, 0.76018968, 0.43824838, 0.33898552, -0.40985546, 0.2983509, -0.52846436, 1.24588521, 0.33262407, 0.14892457, -0.00878468, -0.6532851, 1.70561891, 0.22941184, 0.37914114, -0.22506072, -0.3429072, 0.83438116, 0.31039006, -0.12009891, -0.76953382, 0.16039463, 0.22640251, 0.66662906, -0.01887328, 0.00694876, 1.14695765, 0.11555568, 0.30689163, -0.58892017, -0.63082043, -0.58159424, -0.42239301, 0.12747927, -0.9863424, -0.27425589, 0.12827138, -0.37054683, -0.17097179, -0.3826806, 0.10933824, 0.00680591, -1.96163135, -0.05833431, -0.44803859, 0.95302928, -0.65686424, -0.4095714, 0.05578588, -2.64474972, -2.04286411, -0.46660226, 0.7275184, -0.50159665, -1.07010678, -1.1152038, -0.10196977, 0.17893571, -0.49192931, -0.86016558, -0.36944581, 0.30919506, 0.5008314, 0.72367374]);
  const b1 = new Float64Array([-0.22109897, 0.21784641, 0.2099804, -0.01431288, 0.01443251, -0.13592099, 0.01625457, -0.22994792, -0.08768779, -0.20622678, -0.08855239, 0.29967456, -0.1238973, -0.1281671, 0.1176462, -0.18593962, -0.14445972, 0.04660619, 0.14119252, -0.27189766, 0.32998061, -0.1620127, 0.29943027, 0.21876492]);
  const W2 = new Float64Array([0.62871994, -0.23432196, 0.1638401, -0.02876664, -0.53018742, -0.33625674, -0.57872319, -0.22037016, 0.73451219, -0.40192462, -0.0759618, 0.26670821, -0.21580192, -0.05525081, -0.14918828, -1.01518117, -0.16226877, 0.48775536, 0.15665141, -0.34170622, 1.15426584, -0.43399239, -0.75897101, 0.26519989, 1.20422542, 0.08170176, 1.18619573, -0.38288927, 0.61522501, 0.3637301, 0.39878735, -0.42862798, -0.0693727, 0.18749291, -0.28314584, 0.04718683, 0.37374164, -0.02201248, 0.89578048, -0.70696951, -0.02876644, -0.05623654, 0.69700148, -0.7503903, 0.06983855, 0.60596989, -0.09549831, 0.75364485, 0.56362842, -0.43302427, -0.08916726, -0.51480718, -0.45242222, 0.01954209, -0.18437553, -0.65542767, 0.2194854, -0.34732287, -0.18522718, 0.88165975, -0.44657291, -0.10778114, -0.26238677, -0.02297598, 0.39602011, 0.45395579, -0.6899758, 0.38131482, 0.57091053, 0.066329, -0.36989006, 0.82658197, -1.63366195, 0.36497267, 0.34733624, -0.12843518, -1.03590799, -0.56667242, -0.12209489, 0.78249159, -2.08303374, -0.04533514, -0.10945963, 0.14038298, -0.47347597, 0.29987462, -0.90393001, 0.81027367, -0.33941072, 0.19884969, 0.87522396, 0.31868622, -0.76946276, -0.41073882, 0.85722686, -0.08545006, -0.76992487, -0.28677609, -1.00313245, 0.12783386, 0.1728436, 0.71473843, -0.13000031, -0.3506244, 0.70088959, 0.39668922, -0.32374849, -0.18658476, -0.08292243, 0.61407854, 0.28687968, 0.2218216, 0.59732168, -0.54776628, 0.16244402, 0.28739754, 0.02546341, -0.57378135, 0.51422093, -0.04858902, 1.48390453, -0.29267222, -0.64645552, 0.03048756, 1.05157142, 1.02253859, -0.09612965, 0.54486893, 1.28959578, -0.13649375, -0.05160025, -0.65083979, 0.40404193, -0.33511861, -0.09092869, -0.3677296, 0.39543597, -0.21703855, -0.90983508, 0.04372587, -0.12645913, 0.07219552, -0.33401422, -0.36758765, 0.20412845, -0.03120644, -0.19770311, 0.21733562, 0.13249198, -1.32034804, 0.75509697, 0.86478052, 0.19214225, 0.65416862, -0.08484749, -0.48412836, 0.21602274, 0.40148529, 0.07746418, 1.20552888, 0.12446551, -0.18972528, -0.05912647, 0.9071618, -0.62578433, -0.25459306, 0.40782904, -0.57428862, -0.0146803, 0.07395741, -0.28007471, 0.47914321, 0.27209217, 0.45318785, -0.8891784, 0.40002671, 0.26753086, 0.44076367, 0.52338638, 0.25003771, 0.39197833, 0.67447595, -0.17805398, 0.17617213, 0.51446866, 0.05797459, 0.09213482, -0.04050456, -0.54425384, 0.14625782, -0.13016084, -0.06444231, -0.51173997, 0.36801052, -0.11309571, 0.96104328, -0.19204557, 0.33726989, -0.53374999, 0.04529358, 0.15277142, 0.509849, 0.79062068, 0.46222685, 0.11433892, 0.79516821, 0.48694495, -0.27891788, -0.5640859, -0.37453234, 0.95299259, -0.87792412, -0.17750971, 0.07672105, 0.45044506, -0.4650693, 0.11755519, -0.58801966, 0.02937998, -0.07457529, -0.86983507, -0.81564126, -0.28426075, 0.36887063, -1.01572975, 0.1387897, 0.3240348, 0.67284089, -0.12052952, 0.00017316, -0.27948332, 0.22913473, 1.1587979, -0.27556149, -0.72228271, 1.23196424, -0.13795553, -0.27720337, -0.30195832, 0.11117176, 0.50040679, 0.37146036, -0.01272207, 0.19529276, -0.0893127, -0.01296985, -1.17371716, -0.20753321, 0.63750495, 0.06666584, 0.38655746, 0.12943873, 1.85012517, -0.09761697, -0.36663912, -0.13691638, 0.77991756, 0.02309491, -0.06852533, -0.14767018, 0.23811651, -0.30330243, 0.15740664, 0.20393993, 0.10006965, 0.02428588, -0.17089029, -0.2135282, -1.08893392, -0.18072822, 0.32709689, -0.24801017, -0.58125944, -0.16589336, 0.32505254, -0.40353177, 0.10040854, 0.00732609, -0.11548299, 0.05065486, -0.66076333, -0.22312989, -0.82135787, 0.38276637, 0.08453765, -0.33883814, -0.38727332, -0.31059584, 0.44577625, -1.44292495, -0.04086017, -0.39701687, -0.09360024, 0.41855149, -0.28613669, 0.429119, 1.17012127, -0.14792799, -0.01587281, -0.12621984, -0.43948346, 0.1776941, -0.68006552, -0.08795923, -0.7379923, -0.31054717, -0.85467817, -1.20917699, 0.50664544, 0.27581075, -0.75773291, 0.98767151, -0.3112697, -0.14864131, 0.35068664, -0.33054521, 0.34524341, -0.40444375, -0.06219724, -0.1614772, -0.07498081, -0.4727252, -0.39419348, 0.83772287, -0.14882572, -0.34527889, 0.50879943, -0.01004583, 0.00207072, -0.17747884, -0.09487019, -0.56562003, 0.50512382, -0.55184357, 0.41833585, -0.15333326, -0.41862171, -0.03667213, -0.06483376, -0.03447758, 0.08807429, -0.54246274, 0.24342099, -0.12868965, -0.09222031, -0.62142009, -0.53745467, 0.26243811, -0.15849904, -0.39114068, 0.2249857, -0.43757701, -0.73408857, 0.04845447, 0.20181919, -0.51523017, 0.04776046, -0.27121923, 0.19336688, 0.02102174, 1.85839199, -0.25379031, 1.18061153, -0.61909411, 1.25435584, 0.8259441, 0.28736397, -0.64972916, 0.97577725, -0.05195807, -0.8278123, -0.04442319, 0.02589251, -1.17398796, 0.54047419, -1.66681676, 0.23686338, 0.25139518, -0.16800947, 0.10911162, 0.32916197, 1.20066286, -1.38081226, 0.0834085]);
  const b2 = new Float64Array([0.22839199, -0.06869452, 0.28456833, 0.07599486, -0.15410599, -0.27936628, -0.26019183, -0.26696157, -0.17444879, -0.00980512, -0.1870744, 0.05553892, 0.12065706, 0.16295789, 0.15797137, -0.00691717]);
  const W3 = new Float64Array([0.40534857, -0.90793936, 0.3325431, -0.34009484, 0.05819459, 0.50365571, -0.8798512, -0.53267366, -0.52592731, 0.98219583, -0.36927924, -0.19925158, 0.77553604, 0.69315608, 0.61338876, 0.12301313, -0.00091092, -0.00122856, 0.00108022, -0.0002136, 0.00028832, -0.00148943, -0.00076635, 0.1210248, 0.00146162, 0.00260385, 0.00121324, -0.00085099, -0.00041146, -0.06056726, 0.10921337, 0.00139551, 0.00521299, 0.00228777, -0.00650049, 0.00045195, -0.00026342, 0.00058552, 0.00326363, -0.13249789, -0.00517233, -0.00491634, -0.00150322, 0.00016704, 0.00208288, 0.1582026, -0.31062787, -0.00434516, 0.00315715, 0.00046297, -0.00316454, -0.00037269, 0.00111673, -0.0018535, -0.00026883, -0.01272536, -0.00164658, 0.00032673, 0.00079463, -0.0015404, 0.00039479, 0.03332332, -0.09674194, 0.00017231, 0.45638725, 0.53459894, -0.14289287, -0.44480918, -0.54465852, 0.85056455, 0.2291249, -0.6785143, -0.28156744, 0.34240435, -0.04632177, 1.02117878, -0.07190558, 0.6873022, 0.95163175, 1.52251458]);
  const b3 = new Float64Array([0.29324723, 0.0739221, 0.01674306, 0.05172712, 0.30922134]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.37367955, -0.35655271, -0.20250552, -0.34481252, -0.09999207, -0.00379505, -0.0184631, -0.46863095, 0.75725387, -5.56230644, -0.10896188, 0.15297558, -0.07864012, 0.38746442, -0.11763881, -0.00024774, 0.18476201, 0.01598787, -0.14243465, -0.19989418, 0.39618945, 0.71850921, 0.01053419, 0.12605924, -0.46636395, 0.39170941, 0.12634164, 0.06641563, 0.47845474, -0.01313837, -0.08148162, 0.54502727, -0.1764148, 0.61669693, 0.20005133, -0.17687406, 0.69256141, -0.01875002, 0.56533594, -0.07870909, 0.00186146, 0.60913202, -0.19844768, 0.19290289, 0.08998624, -0.14195802, 0.07428855, 0.30363257, 0.39243164, 0.18022127, -0.00272998, 0.91734827, -1.10212008, -1.37015113, -0.08101384, 0.10213716, 0.86257978, -0.67292438, 0.63858139, 0.25765421, -0.43942791, -0.32244815, 0.98060971, 1.96213201, 0.02376881, 0.31505169, 0.96824986, -1.68711116, 0.61034008, -0.20836064, -0.3895434, 6.72936062, 0.38123824, 0.41431277, 0.53324557, 0.97596945, 4.53033208, 0.65570391, 0.39096668, 0.681621, 0.269472, 1.40211212, 0.79839522, 0.13178913, 0.60215126, -0.70030552, -0.04554696, 0.46055073, 0.04508601, 0.20535651, -0.12727416, 0.19360687, 0.20414665, 0.4604987, -1.29870183, -1.85396709, 0.01555748, 0.75731396, 0.40710334, 0.46626982, -0.68093211, 0.21134125, 0.0396087, -0.28116609, -0.42211123, 0.13349404, -1.19753039, -1.2921438, 0.39829841, 0.12484378, 1.01845594, 1.31458948, -0.44088747, 0.59211759, 0.61404855, 0.66642877, 0.44078828, -0.97065452, -0.34028084, 0.06517759, 1.09645698, 0.12170389, -0.47970173, 0.15599535, -0.1598288, 0.34552495, 0.20994686, -0.24241985, 0.26566471, 0.09404231, -0.00185984, -0.81831437, -0.19537278, -0.26085131, -1.08576424, -0.25281467, 0.04222919, -0.02200046, 1.19190821, 0.19308774, -0.98198101, -0.67181255, 0.04610372, -0.39923057, -0.71626144, -0.5321834, 0.59444319, -0.55059216, -0.16036236, 1.5852253, 0.32265167, -0.82676289, 0.32637174, 1.19828749, -0.09963534, -0.24286612, 0.18423258, 1.65997562, 0.43896263, 0.25142909, 0.05714172, -0.99009309, -0.36277681, 0.17678746, 0.17065356, 0.2999573, -0.51305639, -0.31900132, -0.38967836, -0.14481157, 0.53511676, -0.25737027, -0.08766127, 0.19116151, 0.31669896, -0.14177168, -0.02731271, 0.28196278, 0.45748175, -0.40196382, -0.00271061, -4.2760882, 0.50166892, 0.47782012, -0.2335934, -0.2096391, -0.08637055, 0.35546883, -0.27549609, -0.47947386, 0.02405826, 0.10702495, -0.97608948, 0.63812046, 0.09055079, 0.09075505, 0.67105247, -0.46830954, -0.00370852, 0.67238786, -0.07310662, -0.47338603, 0.48125339, 0.22048789, 0.06709343, 0.54923078, 0.27169977, -0.02955572, 0.66595845, -0.39870067, 0.33382914, -0.71592502, 0.1115227, 0.56116495, 0.36052893, -0.44526205, -0.05939491, -0.04559796, -0.12845957, -0.27877536, -0.09645798, -0.2513095, 0.1988506, 0.88071396, -2.8585234, -0.1656975, -0.22059098, 0.80286704, 0.92415699, -0.08535674, -0.00570063, 0.43308276, 0.24646164, -0.30896173, -0.17709841, -0.16859489, -0.15774939, -0.05108047, -0.76321227, -0.46590614, 0.84741596, -0.3566829, 0.00479685, 0.79825508, -2.21178896, -0.58848294, -0.16492905, -0.23970558, 1.07348152, -0.22593733, -0.47028359, -0.36294249, -0.72077299, 0.41848149, 0.50949535, -0.26921403, -0.45160998, 0.07504819, 0.08655836, 0.30108809, 0.40760542, -0.09314225, -0.18551259, 0.36098076, 0.08008493, -0.17594103, 0.3667882, -0.44959867, 0.94495331, 0.87365067, -0.73656855, -0.31275431, 0.51375214, -0.31321416, -0.61473491, -0.0932328, 0.04089805, -0.11793739, -0.52247519, -0.01954783, 0.04350873, 0.12541805, 0.3495806, -1.01111869, -0.0974116, -0.1912975, 2.49225844, 0.22999173, 0.23385168, -0.82609385, 1.22146573, 1.4350237, 0.31956772, 0.14606169, -0.42307349, 1.24482024, 0.68868796, -0.33224636, -0.03911759, -0.17637863, 0.79316499, -0.2576309, -0.08840788, 0.11548682, 0.05044824, -0.06249549, -0.35326178, -0.14798324, -0.58278107, 1.20958241, 2.59958687, -0.02749967, -0.30519525, -0.45608573, -0.86478838, 0.03342703, -0.09224473, 0.46655865, -0.06266845, 0.5347212, -0.20895469, 1.66416341, -1.4152917, -0.60786259, 0.55932773, 0.38941846, -0.68389871, 0.03803172, 0.17996907, -0.34566564, 0.2400251, -0.10166361, 0.08876131, 0.53118647, 0.40190514, -0.25326954, -0.08875649, 0.08922969, 0.74948099, 0.13952352, -0.41164292, -0.11052886, 0.12421492, -0.08321668, -0.39260526, 0.36233751, 0.4535305, -0.47458518, -0.02055333, -0.44815799, 0.17378572, 0.01454993, -0.3984546, -6.08163587, 0.08393767, -0.0802907, -0.28299343, 0.1077149, 0.6893537, -0.29118718, 0.09575081, 0.69732582, 0.08771233, 0.18128787, 0.67841872, 1.03419939, 0.11464642, -0.64055245, -0.58039127, -1.5393959, 0.66563946, -0.00675712, 0.27619461, -0.01867601, 0.17199815, 0.73896864, -0.49929605, -0.24071797, -0.7735635, 0.36787024, 0.57473598, -0.51470644, 0.10868302, 0.18825567, 0.1433809, 0.44983215, 0.3110922, -0.25781091, -0.01701182, -0.39485142, -0.39225882, -0.4238235, -0.60147618, -0.35322348, -0.15462529, -0.86085885, 0.25426956, -0.48359618, -0.35139001, -0.51315284, 0.05513217, -0.14865726, -0.04124857, -0.4791491, -0.37826954, -0.09199109, 0.0408116, -0.71096745, 0.47174394, -0.11793403, -0.4191609, 0.4345681, -0.70465425, -0.40856462, 0.0919282, 0.89103857, 0.59984947, 0.57940104, -0.00256685, -0.76798229, 0.20545285, -0.19435572, 0.21449673, 0.37891476, -0.73462311, 0.18232847, -0.2191685, -0.17950424, 0.34939034, -0.21671032, -0.14725652, 0.12579731, 0.22736849, -0.4166054, -0.05767994, -0.46284717, -0.24598771, -0.13211549, 0.43400898, 2.46541811, -0.13484735, -0.46557604, 0.1443944, -0.75097079, 0.08695359, -0.27418249, 0.27396717, 0.49244486, 0.15266717, -0.04167017, 0.19010627, -0.41786312, -0.50348014, -0.38997942, 0.00378595, 0.11517839, 0.44369593, -0.54882049, 0.45807867, -0.27621376, -0.10687869, 0.27263099, -0.33355399, 0.03720111, 0.41795753, -0.30067931, 0.12384626, -0.45012036, -0.06015577, 0.46563994, -0.14275769, 0.43840605, -0.56701322, 1.00767277, 0.0803451, 0.0447841, -0.07561186, 0.28511836, 1.11742957, -0.51139321, 0.33867884, -1.17233547, 0.87519597, -0.07655837, -0.03732289, 1.72099088, -0.34952614, 0.60401773, 0.07677419, 0.33020227, -0.60501811, -0.15547007, 0.03979151, -1.40981826, 0.07536672, 0.84747206, -0.80652364, -0.88702868, -0.88839648, 0.91457139, -0.32258107, -1.39670974, -0.86226824, 0.27821097, 0.09137227, -0.71161177, -0.63268748, -0.76203644, 0.03391525, 0.33700284, -0.56546525, -0.27671503, -0.20754898, 0.43492654, -0.26994894, 0.07466348, -0.27469881, -0.30835253, 0.57311595, -0.19135086, -0.00758429, 0.12949078, -0.16737298, -0.06388467, 1.41276559, -1.67826086, 0.11256297, -0.32221906, 0.43195997, -0.73009905, -0.39425429, -0.47782929, 0.11098235, -0.43118211, 0.37777208, -0.24384072, -2.00377526, -0.51397144, 1.02314473, -1.30342489, -0.40097514, 0.21788535, 0.27843285, 0.25252678, 0.70999984, -0.39310426, 0.40489407, -0.03706699, -2.5781379, 0.99043761, 0.28416039, 0.13143118, 0.10564484, -2.33127565, -0.17048388, 0.17486396, -0.0031519, 0.01805415, -1.19640746, -0.30936341, 0.15886225, -0.484087, -0.08683084, -0.052608, -0.52811952, -0.65461897, 0.22361188, -0.38490041, 1.99846423, -0.88974626, -1.36016117, -0.49243242, -0.66310326, -0.65699192, -0.79859392, -0.7749947, -0.05590271, -0.60458855, -0.58833825, 1.03412362, -0.22991797, -0.87396657, -0.6471435, 0.02844965, 0.27442076, -0.36558448, -0.44646803, 1.12875554, 0.02185584, -0.15329332, -0.07330369, -0.57722641, 0.29980512, 0.3628283, -0.22857184, 0.37883553, -0.43993042, 0.23424024, -0.0569633, -0.01990152, 0.60615148, -0.46456648, 0.36658781, 0.78312321, 0.3605576, 0.23405065, -0.36872698, 0.16792231, -0.12076227, 0.47399395, -0.10557934, -1.43560677, -0.34419375, 0.01495153, 0.03885159, -0.24674312, 0.23616006, 0.31404975, 0.21750481, -0.23447034, -0.03676641, 0.61439293, -0.18655758, -0.8651777, 0.11925246, 0.32495045, -0.20426155, -1.05076869, -0.21879875, 0.01617589, 2.70643336, 1.85281517, 0.48081075, -0.32559781, 1.68891186, 0.77603167, 0.51296821, 0.42898649, 0.02403734, 1.43319528, 0.57855442, -0.39464524, 0.74732705, -0.09617027, 0.78749603, -0.41332401, -0.28330427, -0.32226869, -0.14388052, -0.14778918, -0.44224577, -0.03196901, -0.26794169, 0.68220969, 3.34307011, 0.24847419, -0.42382943, 0.13333863, 0.43854206, -0.02462593, 0.00078187, 0.1077558, 0.23829599, 0.31174832, -0.0336766, 0.27630817, 1.44303172, -0.00855537, -0.35891216, 0.82465093, -0.03742278, 0.06036493, -0.52377809, -0.40656264, 0.82444246, -0.61697638, 0.67558564, 0.35191594, -0.5282224, 0.08434215, -0.2426511, 0.09583508, 0.48456962, 0.06679809, -0.40040208, -0.14114741, -0.0809227, -0.63092641, -0.25910505, -0.08592117, -0.06482869, -0.1376199, -0.09884876, 0.14393889, 0.08368564, -0.3665201, 2.16754599, 0.09285028, 0.00570206, -0.11009174, 0.23646948, -0.06039455, -0.23766702, 0.02402643, -1.0695568, -0.71394596, -0.89580276, 0.10851547, -1.86642874, -2.81318044, 0.71277625, -0.46263081, 1.2825585, -1.55471817, -0.26411604, 0.10458911, -1.48794279, 4.07206127, 1.31527352, -0.04915247, -0.52165964, -1.31206989, 0.64806435, 0.21286685, 0.17138245, 0.0345549, -0.72553987, -0.23402846, 0.64149571, 0.05777905, -0.25660845, -0.3842559, 0.03229333, -0.16330155, 0.32827579, 0.13020282, 0.14202244, 0.01069589, 0.19832888, -0.93914962, -1.88289994, -0.33112048, 0.34987486, 0.11804352, -0.01903019, -0.17841263, -0.18961072, -0.26241155, -0.8174164, -0.30740354, -0.50447569, -0.41903202, -0.43410489, 0.16935845, -0.02955339, -0.17022146, -0.77974612, 0.23589389, 0.47154188, 0.25611629, 0.89312216, -0.0613999, -0.15859704, -0.15004505, -0.41511767, 0.46238897, -0.09387331, -0.40414429, 0.19147374, 0.1022777, 0.49361063, 0.14043876, -0.43516633, 0.7815562, 1.21948261, 0.79322107, 0.0776158, -0.27952406, 0.01147481, 0.77572859, -0.11681408, -0.06998583, -1.11363813, 0.54957064, -0.54022562, -0.46586264, 0.60722995, -1.64414979, 0.45673288, 0.46779158, -0.06719015, -0.55520683, 0.32890803, 0.78577772, -2.6444638, -2.90255869, 0.36102429, -0.0334389, -1.58583811, 0.27455064, -0.30671148, -0.97595235, 1.72980814, 1.02317419, 1.80727898, 0.18082774, 0.94389273, 0.11869972, -0.43875856, 1.16373003, 0.07606694, 0.61445033, -0.51274564, -1.01994078, 1.04995413, -0.21807333, 0.80522455, -0.34545427, -0.27150112, -0.71709678, -0.2013548, -0.57043752, -0.51418037, -0.6807708, 0.02921568, -0.39214251, 0.23959787, -0.74707022, 0.42279153, -0.45915771, 0.7834428, 0.14834117, -0.50917047, 0.30374902, 0.84473329, -0.26804779, -0.5402964, -0.77252725, 2.51228808, -0.45100941, 0.55281235, 0.88084719, 0.62645937, 0.76525407, -0.20325039, 1.02253575, 6.13240714, 0.65163466, -0.42165712, 1.21040695, -1.04166048, 2.15892272, -0.1828163, 0.29330258, 2.68353962, 1.17765899, 0.84806436, -0.11848513, 0.21901076, 0.55115811, 0.38551364, -0.06697084, 0.16517862, 0.1283943, 0.64718835, -0.47028789, 0.3972625, 0.52069881, -0.93649364, -2.08205695, 0.09803816, 0.36423555, -0.11349227, 0.92488823, 0.08206258, 0.50652821, -0.42065908, 0.10856862, -0.0654208, -0.1372549, 0.49674405, 0.38003519, 0.60424828, 0.32020323, -1.57378214, 0.51755184, 0.39012964, 0.50056123, -1.49999621, -1.3814717, -0.06494532, 0.08884502, -0.50213344, -0.4514629, -2.0837348, 0.25719078, -0.13371639, -0.51934369, -1.20131608, -0.01717315, 0.13690821, -0.7813616, 0.11606223, -0.54944106, 0.00886557, 0.15375807, -0.32474046, 0.05596555, -0.14689821, 0.02835635, -0.28388456, 0.21699988, -3.48653378, -0.39647272, 0.40088006, 0.01416231, 0.18881201, -0.05630252, -0.12417696, 0.7780627, -0.35005511, -0.0427732, -0.01765561, -0.81225087, 0.37245777, -0.14276719, 0.03233728, 1.186064, 0.17462922, -0.51487399, 0.60124582, 0.33224874, -0.05486804, -0.11303612, 0.13779535, 0.13642379, 0.39657825, 0.23303783, -0.1261119, 0.04866497, 0.15551102, 0.96474035, -0.53098741, -0.03982736, 0.72189164, 0.53049708, 0.75787783, 0.09097524, 0.01830308, 0.39389232, 0.27012072, 0.54644018, 1.12601875, 0.01968803, -0.45336743, 3.13538151, 0.28449194, -0.14325775, 0.23172357, -0.1098143, -0.43297551, 0.55169826, -0.29991348, 0.1422041, -0.20385603, 0.58512631, -0.93381751, -0.38023049, 0.18913321, 0.76018968, 0.43824838, 0.33898552, -0.40985546, 0.2983509, -0.52846436, 1.24588521, 0.33262407, 0.14892457, -0.00878468, -0.6532851, 1.70561891, 0.22941184, 0.37914114, -0.22506072, -0.3429072, 0.83438116, 0.31039006, -0.12009891, -0.76953382, 0.16039463, 0.22640251, 0.66662906, -0.01887328, 0.00694876, 1.14695765, 0.11555568, 0.30689163, -0.58892017, -0.63082043, -0.58159424, -0.42239301, 0.12747927, -0.9863424, -0.27425589, 0.12827138, -0.37054683, -0.17097179, -0.3826806, 0.10933824, 0.00680591, -1.96163135, -0.05833431, -0.44803859, 0.95302928, -0.65686424, -0.4095714, 0.05578588, -2.64474972, -2.04286411, -0.46660226, 0.7275184, -0.50159665, -1.07010678, -1.1152038, -0.10196977, 0.17893571, -0.49192931, -0.86016558, -0.36944581, 0.30919506, 0.5008314, 0.72367374]);
  const b1 = new Float64Array([-0.22109897, 0.21784641, 0.2099804, -0.01431288, 0.01443251, -0.13592099, 0.01625457, -0.22994792, -0.08768779, -0.20622678, -0.08855239, 0.29967456, -0.1238973, -0.1281671, 0.1176462, -0.18593962, -0.14445972, 0.04660619, 0.14119252, -0.27189766, 0.32998061, -0.1620127, 0.29943027, 0.21876492]);
  const W2 = new Float64Array([0.62871994, -0.23432196, 0.1638401, -0.02876664, -0.53018742, -0.33625674, -0.57872319, -0.22037016, 0.73451219, -0.40192462, -0.0759618, 0.26670821, -0.21580192, -0.05525081, -0.14918828, -1.01518117, -0.16226877, 0.48775536, 0.15665141, -0.34170622, 1.15426584, -0.43399239, -0.75897101, 0.26519989, 1.20422542, 0.08170176, 1.18619573, -0.38288927, 0.61522501, 0.3637301, 0.39878735, -0.42862798, -0.0693727, 0.18749291, -0.28314584, 0.04718683, 0.37374164, -0.02201248, 0.89578048, -0.70696951, -0.02876644, -0.05623654, 0.69700148, -0.7503903, 0.06983855, 0.60596989, -0.09549831, 0.75364485, 0.56362842, -0.43302427, -0.08916726, -0.51480718, -0.45242222, 0.01954209, -0.18437553, -0.65542767, 0.2194854, -0.34732287, -0.18522718, 0.88165975, -0.44657291, -0.10778114, -0.26238677, -0.02297598, 0.39602011, 0.45395579, -0.6899758, 0.38131482, 0.57091053, 0.066329, -0.36989006, 0.82658197, -1.63366195, 0.36497267, 0.34733624, -0.12843518, -1.03590799, -0.56667242, -0.12209489, 0.78249159, -2.08303374, -0.04533514, -0.10945963, 0.14038298, -0.47347597, 0.29987462, -0.90393001, 0.81027367, -0.33941072, 0.19884969, 0.87522396, 0.31868622, -0.76946276, -0.41073882, 0.85722686, -0.08545006, -0.76992487, -0.28677609, -1.00313245, 0.12783386, 0.1728436, 0.71473843, -0.13000031, -0.3506244, 0.70088959, 0.39668922, -0.32374849, -0.18658476, -0.08292243, 0.61407854, 0.28687968, 0.2218216, 0.59732168, -0.54776628, 0.16244402, 0.28739754, 0.02546341, -0.57378135, 0.51422093, -0.04858902, 1.48390453, -0.29267222, -0.64645552, 0.03048756, 1.05157142, 1.02253859, -0.09612965, 0.54486893, 1.28959578, -0.13649375, -0.05160025, -0.65083979, 0.40404193, -0.33511861, -0.09092869, -0.3677296, 0.39543597, -0.21703855, -0.90983508, 0.04372587, -0.12645913, 0.07219552, -0.33401422, -0.36758765, 0.20412845, -0.03120644, -0.19770311, 0.21733562, 0.13249198, -1.32034804, 0.75509697, 0.86478052, 0.19214225, 0.65416862, -0.08484749, -0.48412836, 0.21602274, 0.40148529, 0.07746418, 1.20552888, 0.12446551, -0.18972528, -0.05912647, 0.9071618, -0.62578433, -0.25459306, 0.40782904, -0.57428862, -0.0146803, 0.07395741, -0.28007471, 0.47914321, 0.27209217, 0.45318785, -0.8891784, 0.40002671, 0.26753086, 0.44076367, 0.52338638, 0.25003771, 0.39197833, 0.67447595, -0.17805398, 0.17617213, 0.51446866, 0.05797459, 0.09213482, -0.04050456, -0.54425384, 0.14625782, -0.13016084, -0.06444231, -0.51173997, 0.36801052, -0.11309571, 0.96104328, -0.19204557, 0.33726989, -0.53374999, 0.04529358, 0.15277142, 0.509849, 0.79062068, 0.46222685, 0.11433892, 0.79516821, 0.48694495, -0.27891788, -0.5640859, -0.37453234, 0.95299259, -0.87792412, -0.17750971, 0.07672105, 0.45044506, -0.4650693, 0.11755519, -0.58801966, 0.02937998, -0.07457529, -0.86983507, -0.81564126, -0.28426075, 0.36887063, -1.01572975, 0.1387897, 0.3240348, 0.67284089, -0.12052952, 0.00017316, -0.27948332, 0.22913473, 1.1587979, -0.27556149, -0.72228271, 1.23196424, -0.13795553, -0.27720337, -0.30195832, 0.11117176, 0.50040679, 0.37146036, -0.01272207, 0.19529276, -0.0893127, -0.01296985, -1.17371716, -0.20753321, 0.63750495, 0.06666584, 0.38655746, 0.12943873, 1.85012517, -0.09761697, -0.36663912, -0.13691638, 0.77991756, 0.02309491, -0.06852533, -0.14767018, 0.23811651, -0.30330243, 0.15740664, 0.20393993, 0.10006965, 0.02428588, -0.17089029, -0.2135282, -1.08893392, -0.18072822, 0.32709689, -0.24801017, -0.58125944, -0.16589336, 0.32505254, -0.40353177, 0.10040854, 0.00732609, -0.11548299, 0.05065486, -0.66076333, -0.22312989, -0.82135787, 0.38276637, 0.08453765, -0.33883814, -0.38727332, -0.31059584, 0.44577625, -1.44292495, -0.04086017, -0.39701687, -0.09360024, 0.41855149, -0.28613669, 0.429119, 1.17012127, -0.14792799, -0.01587281, -0.12621984, -0.43948346, 0.1776941, -0.68006552, -0.08795923, -0.7379923, -0.31054717, -0.85467817, -1.20917699, 0.50664544, 0.27581075, -0.75773291, 0.98767151, -0.3112697, -0.14864131, 0.35068664, -0.33054521, 0.34524341, -0.40444375, -0.06219724, -0.1614772, -0.07498081, -0.4727252, -0.39419348, 0.83772287, -0.14882572, -0.34527889, 0.50879943, -0.01004583, 0.00207072, -0.17747884, -0.09487019, -0.56562003, 0.50512382, -0.55184357, 0.41833585, -0.15333326, -0.41862171, -0.03667213, -0.06483376, -0.03447758, 0.08807429, -0.54246274, 0.24342099, -0.12868965, -0.09222031, -0.62142009, -0.53745467, 0.26243811, -0.15849904, -0.39114068, 0.2249857, -0.43757701, -0.73408857, 0.04845447, 0.20181919, -0.51523017, 0.04776046, -0.27121923, 0.19336688, 0.02102174, 1.85839199, -0.25379031, 1.18061153, -0.61909411, 1.25435584, 0.8259441, 0.28736397, -0.64972916, 0.97577725, -0.05195807, -0.8278123, -0.04442319, 0.02589251, -1.17398796, 0.54047419, -1.66681676, 0.23686338, 0.25139518, -0.16800947, 0.10911162, 0.32916197, 1.20066286, -1.38081226, 0.0834085]);
  const b2 = new Float64Array([0.22839199, -0.06869452, 0.28456833, 0.07599486, -0.15410599, -0.27936628, -0.26019183, -0.26696157, -0.17444879, -0.00980512, -0.1870744, 0.05553892, 0.12065706, 0.16295789, 0.15797137, -0.00691717]);
  const W3 = new Float64Array([0.40534857, -0.90793936, 0.3325431, -0.34009484, 0.05819459, 0.50365571, -0.8798512, -0.53267366, -0.52592731, 0.98219583, -0.36927924, -0.19925158, 0.77553604, 0.69315608, 0.61338876, 0.12301313, -0.00091092, -0.00122856, 0.00108022, -0.0002136, 0.00028832, -0.00148943, -0.00076635, 0.1210248, 0.00146162, 0.00260385, 0.00121324, -0.00085099, -0.00041146, -0.06056726, 0.10921337, 0.00139551, 0.00521299, 0.00228777, -0.00650049, 0.00045195, -0.00026342, 0.00058552, 0.00326363, -0.13249789, -0.00517233, -0.00491634, -0.00150322, 0.00016704, 0.00208288, 0.1582026, -0.31062787, -0.00434516, 0.00315715, 0.00046297, -0.00316454, -0.00037269, 0.00111673, -0.0018535, -0.00026883, -0.01272536, -0.00164658, 0.00032673, 0.00079463, -0.0015404, 0.00039479, 0.03332332, -0.09674194, 0.00017231, 0.45638725, 0.53459894, -0.14289287, -0.44480918, -0.54465852, 0.85056455, 0.2291249, -0.6785143, -0.28156744, 0.34240435, -0.04632177, 1.02117878, -0.07190558, 0.6873022, 0.95163175, 1.52251458]);
  const b3 = new Float64Array([0.29324723, 0.0739221, 0.01674306, 0.05172712, 0.30922134]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.37367955, -0.35655271, -0.20250552, -0.34481252, -0.09999207, -0.00379505, -0.0184631, -0.46863095, 0.75725387, -5.56230644, -0.10896188, 0.15297558, -0.07864012, 0.38746442, -0.11763881, -0.00024774, 0.18476201, 0.01598787, -0.14243465, -0.19989418, 0.39618945, 0.71850921, 0.01053419, 0.12605924, -0.46636395, 0.39170941, 0.12634164, 0.06641563, 0.47845474, -0.01313837, -0.08148162, 0.54502727, -0.1764148, 0.61669693, 0.20005133, -0.17687406, 0.69256141, -0.01875002, 0.56533594, -0.07870909, 0.00186146, 0.60913202, -0.19844768, 0.19290289, 0.08998624, -0.14195802, 0.07428855, 0.30363257, 0.39243164, 0.18022127, -0.00272998, 0.91734827, -1.10212008, -1.37015113, -0.08101384, 0.10213716, 0.86257978, -0.67292438, 0.63858139, 0.25765421, -0.43942791, -0.32244815, 0.98060971, 1.96213201, 0.02376881, 0.31505169, 0.96824986, -1.68711116, 0.61034008, -0.20836064, -0.3895434, 6.72936062, 0.38123824, 0.41431277, 0.53324557, 0.97596945, 4.53033208, 0.65570391, 0.39096668, 0.681621, 0.269472, 1.40211212, 0.79839522, 0.13178913, 0.60215126, -0.70030552, -0.04554696, 0.46055073, 0.04508601, 0.20535651, -0.12727416, 0.19360687, 0.20414665, 0.4604987, -1.29870183, -1.85396709, 0.01555748, 0.75731396, 0.40710334, 0.46626982, -0.68093211, 0.21134125, 0.0396087, -0.28116609, -0.42211123, 0.13349404, -1.19753039, -1.2921438, 0.39829841, 0.12484378, 1.01845594, 1.31458948, -0.44088747, 0.59211759, 0.61404855, 0.66642877, 0.44078828, -0.97065452, -0.34028084, 0.06517759, 1.09645698, 0.12170389, -0.47970173, 0.15599535, -0.1598288, 0.34552495, 0.20994686, -0.24241985, 0.26566471, 0.09404231, -0.00185984, -0.81831437, -0.19537278, -0.26085131, -1.08576424, -0.25281467, 0.04222919, -0.02200046, 1.19190821, 0.19308774, -0.98198101, -0.67181255, 0.04610372, -0.39923057, -0.71626144, -0.5321834, 0.59444319, -0.55059216, -0.16036236, 1.5852253, 0.32265167, -0.82676289, 0.32637174, 1.19828749, -0.09963534, -0.24286612, 0.18423258, 1.65997562, 0.43896263, 0.25142909, 0.05714172, -0.99009309, -0.36277681, 0.17678746, 0.17065356, 0.2999573, -0.51305639, -0.31900132, -0.38967836, -0.14481157, 0.53511676, -0.25737027, -0.08766127, 0.19116151, 0.31669896, -0.14177168, -0.02731271, 0.28196278, 0.45748175, -0.40196382, -0.00271061, -4.2760882, 0.50166892, 0.47782012, -0.2335934, -0.2096391, -0.08637055, 0.35546883, -0.27549609, -0.47947386, 0.02405826, 0.10702495, -0.97608948, 0.63812046, 0.09055079, 0.09075505, 0.67105247, -0.46830954, -0.00370852, 0.67238786, -0.07310662, -0.47338603, 0.48125339, 0.22048789, 0.06709343, 0.54923078, 0.27169977, -0.02955572, 0.66595845, -0.39870067, 0.33382914, -0.71592502, 0.1115227, 0.56116495, 0.36052893, -0.44526205, -0.05939491, -0.04559796, -0.12845957, -0.27877536, -0.09645798, -0.2513095, 0.1988506, 0.88071396, -2.8585234, -0.1656975, -0.22059098, 0.80286704, 0.92415699, -0.08535674, -0.00570063, 0.43308276, 0.24646164, -0.30896173, -0.17709841, -0.16859489, -0.15774939, -0.05108047, -0.76321227, -0.46590614, 0.84741596, -0.3566829, 0.00479685, 0.79825508, -2.21178896, -0.58848294, -0.16492905, -0.23970558, 1.07348152, -0.22593733, -0.47028359, -0.36294249, -0.72077299, 0.41848149, 0.50949535, -0.26921403, -0.45160998, 0.07504819, 0.08655836, 0.30108809, 0.40760542, -0.09314225, -0.18551259, 0.36098076, 0.08008493, -0.17594103, 0.3667882, -0.44959867, 0.94495331, 0.87365067, -0.73656855, -0.31275431, 0.51375214, -0.31321416, -0.61473491, -0.0932328, 0.04089805, -0.11793739, -0.52247519, -0.01954783, 0.04350873, 0.12541805, 0.3495806, -1.01111869, -0.0974116, -0.1912975, 2.49225844, 0.22999173, 0.23385168, -0.82609385, 1.22146573, 1.4350237, 0.31956772, 0.14606169, -0.42307349, 1.24482024, 0.68868796, -0.33224636, -0.03911759, -0.17637863, 0.79316499, -0.2576309, -0.08840788, 0.11548682, 0.05044824, -0.06249549, -0.35326178, -0.14798324, -0.58278107, 1.20958241, 2.59958687, -0.02749967, -0.30519525, -0.45608573, -0.86478838, 0.03342703, -0.09224473, 0.46655865, -0.06266845, 0.5347212, -0.20895469, 1.66416341, -1.4152917, -0.60786259, 0.55932773, 0.38941846, -0.68389871, 0.03803172, 0.17996907, -0.34566564, 0.2400251, -0.10166361, 0.08876131, 0.53118647, 0.40190514, -0.25326954, -0.08875649, 0.08922969, 0.74948099, 0.13952352, -0.41164292, -0.11052886, 0.12421492, -0.08321668, -0.39260526, 0.36233751, 0.4535305, -0.47458518, -0.02055333, -0.44815799, 0.17378572, 0.01454993, -0.3984546, -6.08163587, 0.08393767, -0.0802907, -0.28299343, 0.1077149, 0.6893537, -0.29118718, 0.09575081, 0.69732582, 0.08771233, 0.18128787, 0.67841872, 1.03419939, 0.11464642, -0.64055245, -0.58039127, -1.5393959, 0.66563946, -0.00675712, 0.27619461, -0.01867601, 0.17199815, 0.73896864, -0.49929605, -0.24071797, -0.7735635, 0.36787024, 0.57473598, -0.51470644, 0.10868302, 0.18825567, 0.1433809, 0.44983215, 0.3110922, -0.25781091, -0.01701182, -0.39485142, -0.39225882, -0.4238235, -0.60147618, -0.35322348, -0.15462529, -0.86085885, 0.25426956, -0.48359618, -0.35139001, -0.51315284, 0.05513217, -0.14865726, -0.04124857, -0.4791491, -0.37826954, -0.09199109, 0.0408116, -0.71096745, 0.47174394, -0.11793403, -0.4191609, 0.4345681, -0.70465425, -0.40856462, 0.0919282, 0.89103857, 0.59984947, 0.57940104, -0.00256685, -0.76798229, 0.20545285, -0.19435572, 0.21449673, 0.37891476, -0.73462311, 0.18232847, -0.2191685, -0.17950424, 0.34939034, -0.21671032, -0.14725652, 0.12579731, 0.22736849, -0.4166054, -0.05767994, -0.46284717, -0.24598771, -0.13211549, 0.43400898, 2.46541811, -0.13484735, -0.46557604, 0.1443944, -0.75097079, 0.08695359, -0.27418249, 0.27396717, 0.49244486, 0.15266717, -0.04167017, 0.19010627, -0.41786312, -0.50348014, -0.38997942, 0.00378595, 0.11517839, 0.44369593, -0.54882049, 0.45807867, -0.27621376, -0.10687869, 0.27263099, -0.33355399, 0.03720111, 0.41795753, -0.30067931, 0.12384626, -0.45012036, -0.06015577, 0.46563994, -0.14275769, 0.43840605, -0.56701322, 1.00767277, 0.0803451, 0.0447841, -0.07561186, 0.28511836, 1.11742957, -0.51139321, 0.33867884, -1.17233547, 0.87519597, -0.07655837, -0.03732289, 1.72099088, -0.34952614, 0.60401773, 0.07677419, 0.33020227, -0.60501811, -0.15547007, 0.03979151, -1.40981826, 0.07536672, 0.84747206, -0.80652364, -0.88702868, -0.88839648, 0.91457139, -0.32258107, -1.39670974, -0.86226824, 0.27821097, 0.09137227, -0.71161177, -0.63268748, -0.76203644, 0.03391525, 0.33700284, -0.56546525, -0.27671503, -0.20754898, 0.43492654, -0.26994894, 0.07466348, -0.27469881, -0.30835253, 0.57311595, -0.19135086, -0.00758429, 0.12949078, -0.16737298, -0.06388467, 1.41276559, -1.67826086, 0.11256297, -0.32221906, 0.43195997, -0.73009905, -0.39425429, -0.47782929, 0.11098235, -0.43118211, 0.37777208, -0.24384072, -2.00377526, -0.51397144, 1.02314473, -1.30342489, -0.40097514, 0.21788535, 0.27843285, 0.25252678, 0.70999984, -0.39310426, 0.40489407, -0.03706699, -2.5781379, 0.99043761, 0.28416039, 0.13143118, 0.10564484, -2.33127565, -0.17048388, 0.17486396, -0.0031519, 0.01805415, -1.19640746, -0.30936341, 0.15886225, -0.484087, -0.08683084, -0.052608, -0.52811952, -0.65461897, 0.22361188, -0.38490041, 1.99846423, -0.88974626, -1.36016117, -0.49243242, -0.66310326, -0.65699192, -0.79859392, -0.7749947, -0.05590271, -0.60458855, -0.58833825, 1.03412362, -0.22991797, -0.87396657, -0.6471435, 0.02844965, 0.27442076, -0.36558448, -0.44646803, 1.12875554, 0.02185584, -0.15329332, -0.07330369, -0.57722641, 0.29980512, 0.3628283, -0.22857184, 0.37883553, -0.43993042, 0.23424024, -0.0569633, -0.01990152, 0.60615148, -0.46456648, 0.36658781, 0.78312321, 0.3605576, 0.23405065, -0.36872698, 0.16792231, -0.12076227, 0.47399395, -0.10557934, -1.43560677, -0.34419375, 0.01495153, 0.03885159, -0.24674312, 0.23616006, 0.31404975, 0.21750481, -0.23447034, -0.03676641, 0.61439293, -0.18655758, -0.8651777, 0.11925246, 0.32495045, -0.20426155, -1.05076869, -0.21879875, 0.01617589, 2.70643336, 1.85281517, 0.48081075, -0.32559781, 1.68891186, 0.77603167, 0.51296821, 0.42898649, 0.02403734, 1.43319528, 0.57855442, -0.39464524, 0.74732705, -0.09617027, 0.78749603, -0.41332401, -0.28330427, -0.32226869, -0.14388052, -0.14778918, -0.44224577, -0.03196901, -0.26794169, 0.68220969, 3.34307011, 0.24847419, -0.42382943, 0.13333863, 0.43854206, -0.02462593, 0.00078187, 0.1077558, 0.23829599, 0.31174832, -0.0336766, 0.27630817, 1.44303172, -0.00855537, -0.35891216, 0.82465093, -0.03742278, 0.06036493, -0.52377809, -0.40656264, 0.82444246, -0.61697638, 0.67558564, 0.35191594, -0.5282224, 0.08434215, -0.2426511, 0.09583508, 0.48456962, 0.06679809, -0.40040208, -0.14114741, -0.0809227, -0.63092641, -0.25910505, -0.08592117, -0.06482869, -0.1376199, -0.09884876, 0.14393889, 0.08368564, -0.3665201, 2.16754599, 0.09285028, 0.00570206, -0.11009174, 0.23646948, -0.06039455, -0.23766702, 0.02402643, -1.0695568, -0.71394596, -0.89580276, 0.10851547, -1.86642874, -2.81318044, 0.71277625, -0.46263081, 1.2825585, -1.55471817, -0.26411604, 0.10458911, -1.48794279, 4.07206127, 1.31527352, -0.04915247, -0.52165964, -1.31206989, 0.64806435, 0.21286685, 0.17138245, 0.0345549, -0.72553987, -0.23402846, 0.64149571, 0.05777905, -0.25660845, -0.3842559, 0.03229333, -0.16330155, 0.32827579, 0.13020282, 0.14202244, 0.01069589, 0.19832888, -0.93914962, -1.88289994, -0.33112048, 0.34987486, 0.11804352, -0.01903019, -0.17841263, -0.18961072, -0.26241155, -0.8174164, -0.30740354, -0.50447569, -0.41903202, -0.43410489, 0.16935845, -0.02955339, -0.17022146, -0.77974612, 0.23589389, 0.47154188, 0.25611629, 0.89312216, -0.0613999, -0.15859704, -0.15004505, -0.41511767, 0.46238897, -0.09387331, -0.40414429, 0.19147374, 0.1022777, 0.49361063, 0.14043876, -0.43516633, 0.7815562, 1.21948261, 0.79322107, 0.0776158, -0.27952406, 0.01147481, 0.77572859, -0.11681408, -0.06998583, -1.11363813, 0.54957064, -0.54022562, -0.46586264, 0.60722995, -1.64414979, 0.45673288, 0.46779158, -0.06719015, -0.55520683, 0.32890803, 0.78577772, -2.6444638, -2.90255869, 0.36102429, -0.0334389, -1.58583811, 0.27455064, -0.30671148, -0.97595235, 1.72980814, 1.02317419, 1.80727898, 0.18082774, 0.94389273, 0.11869972, -0.43875856, 1.16373003, 0.07606694, 0.61445033, -0.51274564, -1.01994078, 1.04995413, -0.21807333, 0.80522455, -0.34545427, -0.27150112, -0.71709678, -0.2013548, -0.57043752, -0.51418037, -0.6807708, 0.02921568, -0.39214251, 0.23959787, -0.74707022, 0.42279153, -0.45915771, 0.7834428, 0.14834117, -0.50917047, 0.30374902, 0.84473329, -0.26804779, -0.5402964, -0.77252725, 2.51228808, -0.45100941, 0.55281235, 0.88084719, 0.62645937, 0.76525407, -0.20325039, 1.02253575, 6.13240714, 0.65163466, -0.42165712, 1.21040695, -1.04166048, 2.15892272, -0.1828163, 0.29330258, 2.68353962, 1.17765899, 0.84806436, -0.11848513, 0.21901076, 0.55115811, 0.38551364, -0.06697084, 0.16517862, 0.1283943, 0.64718835, -0.47028789, 0.3972625, 0.52069881, -0.93649364, -2.08205695, 0.09803816, 0.36423555, -0.11349227, 0.92488823, 0.08206258, 0.50652821, -0.42065908, 0.10856862, -0.0654208, -0.1372549, 0.49674405, 0.38003519, 0.60424828, 0.32020323, -1.57378214, 0.51755184, 0.39012964, 0.50056123, -1.49999621, -1.3814717, -0.06494532, 0.08884502, -0.50213344, -0.4514629, -2.0837348, 0.25719078, -0.13371639, -0.51934369, -1.20131608, -0.01717315, 0.13690821, -0.7813616, 0.11606223, -0.54944106, 0.00886557, 0.15375807, -0.32474046, 0.05596555, -0.14689821, 0.02835635, -0.28388456, 0.21699988, -3.48653378, -0.39647272, 0.40088006, 0.01416231, 0.18881201, -0.05630252, -0.12417696, 0.7780627, -0.35005511, -0.0427732, -0.01765561, -0.81225087, 0.37245777, -0.14276719, 0.03233728, 1.186064, 0.17462922, -0.51487399, 0.60124582, 0.33224874, -0.05486804, -0.11303612, 0.13779535, 0.13642379, 0.39657825, 0.23303783, -0.1261119, 0.04866497, 0.15551102, 0.96474035, -0.53098741, -0.03982736, 0.72189164, 0.53049708, 0.75787783, 0.09097524, 0.01830308, 0.39389232, 0.27012072, 0.54644018, 1.12601875, 0.01968803, -0.45336743, 3.13538151, 0.28449194, -0.14325775, 0.23172357, -0.1098143, -0.43297551, 0.55169826, -0.29991348, 0.1422041, -0.20385603, 0.58512631, -0.93381751, -0.38023049, 0.18913321, 0.76018968, 0.43824838, 0.33898552, -0.40985546, 0.2983509, -0.52846436, 1.24588521, 0.33262407, 0.14892457, -0.00878468, -0.6532851, 1.70561891, 0.22941184, 0.37914114, -0.22506072, -0.3429072, 0.83438116, 0.31039006, -0.12009891, -0.76953382, 0.16039463, 0.22640251, 0.66662906, -0.01887328, 0.00694876, 1.14695765, 0.11555568, 0.30689163, -0.58892017, -0.63082043, -0.58159424, -0.42239301, 0.12747927, -0.9863424, -0.27425589, 0.12827138, -0.37054683, -0.17097179, -0.3826806, 0.10933824, 0.00680591, -1.96163135, -0.05833431, -0.44803859, 0.95302928, -0.65686424, -0.4095714, 0.05578588, -2.64474972, -2.04286411, -0.46660226, 0.7275184, -0.50159665, -1.07010678, -1.1152038, -0.10196977, 0.17893571, -0.49192931, -0.86016558, -0.36944581, 0.30919506, 0.5008314, 0.72367374]);
  const b1 = new Float64Array([-0.22109897, 0.21784641, 0.2099804, -0.01431288, 0.01443251, -0.13592099, 0.01625457, -0.22994792, -0.08768779, -0.20622678, -0.08855239, 0.29967456, -0.1238973, -0.1281671, 0.1176462, -0.18593962, -0.14445972, 0.04660619, 0.14119252, -0.27189766, 0.32998061, -0.1620127, 0.29943027, 0.21876492]);
  const W2 = new Float64Array([0.62871994, -0.23432196, 0.1638401, -0.02876664, -0.53018742, -0.33625674, -0.57872319, -0.22037016, 0.73451219, -0.40192462, -0.0759618, 0.26670821, -0.21580192, -0.05525081, -0.14918828, -1.01518117, -0.16226877, 0.48775536, 0.15665141, -0.34170622, 1.15426584, -0.43399239, -0.75897101, 0.26519989, 1.20422542, 0.08170176, 1.18619573, -0.38288927, 0.61522501, 0.3637301, 0.39878735, -0.42862798, -0.0693727, 0.18749291, -0.28314584, 0.04718683, 0.37374164, -0.02201248, 0.89578048, -0.70696951, -0.02876644, -0.05623654, 0.69700148, -0.7503903, 0.06983855, 0.60596989, -0.09549831, 0.75364485, 0.56362842, -0.43302427, -0.08916726, -0.51480718, -0.45242222, 0.01954209, -0.18437553, -0.65542767, 0.2194854, -0.34732287, -0.18522718, 0.88165975, -0.44657291, -0.10778114, -0.26238677, -0.02297598, 0.39602011, 0.45395579, -0.6899758, 0.38131482, 0.57091053, 0.066329, -0.36989006, 0.82658197, -1.63366195, 0.36497267, 0.34733624, -0.12843518, -1.03590799, -0.56667242, -0.12209489, 0.78249159, -2.08303374, -0.04533514, -0.10945963, 0.14038298, -0.47347597, 0.29987462, -0.90393001, 0.81027367, -0.33941072, 0.19884969, 0.87522396, 0.31868622, -0.76946276, -0.41073882, 0.85722686, -0.08545006, -0.76992487, -0.28677609, -1.00313245, 0.12783386, 0.1728436, 0.71473843, -0.13000031, -0.3506244, 0.70088959, 0.39668922, -0.32374849, -0.18658476, -0.08292243, 0.61407854, 0.28687968, 0.2218216, 0.59732168, -0.54776628, 0.16244402, 0.28739754, 0.02546341, -0.57378135, 0.51422093, -0.04858902, 1.48390453, -0.29267222, -0.64645552, 0.03048756, 1.05157142, 1.02253859, -0.09612965, 0.54486893, 1.28959578, -0.13649375, -0.05160025, -0.65083979, 0.40404193, -0.33511861, -0.09092869, -0.3677296, 0.39543597, -0.21703855, -0.90983508, 0.04372587, -0.12645913, 0.07219552, -0.33401422, -0.36758765, 0.20412845, -0.03120644, -0.19770311, 0.21733562, 0.13249198, -1.32034804, 0.75509697, 0.86478052, 0.19214225, 0.65416862, -0.08484749, -0.48412836, 0.21602274, 0.40148529, 0.07746418, 1.20552888, 0.12446551, -0.18972528, -0.05912647, 0.9071618, -0.62578433, -0.25459306, 0.40782904, -0.57428862, -0.0146803, 0.07395741, -0.28007471, 0.47914321, 0.27209217, 0.45318785, -0.8891784, 0.40002671, 0.26753086, 0.44076367, 0.52338638, 0.25003771, 0.39197833, 0.67447595, -0.17805398, 0.17617213, 0.51446866, 0.05797459, 0.09213482, -0.04050456, -0.54425384, 0.14625782, -0.13016084, -0.06444231, -0.51173997, 0.36801052, -0.11309571, 0.96104328, -0.19204557, 0.33726989, -0.53374999, 0.04529358, 0.15277142, 0.509849, 0.79062068, 0.46222685, 0.11433892, 0.79516821, 0.48694495, -0.27891788, -0.5640859, -0.37453234, 0.95299259, -0.87792412, -0.17750971, 0.07672105, 0.45044506, -0.4650693, 0.11755519, -0.58801966, 0.02937998, -0.07457529, -0.86983507, -0.81564126, -0.28426075, 0.36887063, -1.01572975, 0.1387897, 0.3240348, 0.67284089, -0.12052952, 0.00017316, -0.27948332, 0.22913473, 1.1587979, -0.27556149, -0.72228271, 1.23196424, -0.13795553, -0.27720337, -0.30195832, 0.11117176, 0.50040679, 0.37146036, -0.01272207, 0.19529276, -0.0893127, -0.01296985, -1.17371716, -0.20753321, 0.63750495, 0.06666584, 0.38655746, 0.12943873, 1.85012517, -0.09761697, -0.36663912, -0.13691638, 0.77991756, 0.02309491, -0.06852533, -0.14767018, 0.23811651, -0.30330243, 0.15740664, 0.20393993, 0.10006965, 0.02428588, -0.17089029, -0.2135282, -1.08893392, -0.18072822, 0.32709689, -0.24801017, -0.58125944, -0.16589336, 0.32505254, -0.40353177, 0.10040854, 0.00732609, -0.11548299, 0.05065486, -0.66076333, -0.22312989, -0.82135787, 0.38276637, 0.08453765, -0.33883814, -0.38727332, -0.31059584, 0.44577625, -1.44292495, -0.04086017, -0.39701687, -0.09360024, 0.41855149, -0.28613669, 0.429119, 1.17012127, -0.14792799, -0.01587281, -0.12621984, -0.43948346, 0.1776941, -0.68006552, -0.08795923, -0.7379923, -0.31054717, -0.85467817, -1.20917699, 0.50664544, 0.27581075, -0.75773291, 0.98767151, -0.3112697, -0.14864131, 0.35068664, -0.33054521, 0.34524341, -0.40444375, -0.06219724, -0.1614772, -0.07498081, -0.4727252, -0.39419348, 0.83772287, -0.14882572, -0.34527889, 0.50879943, -0.01004583, 0.00207072, -0.17747884, -0.09487019, -0.56562003, 0.50512382, -0.55184357, 0.41833585, -0.15333326, -0.41862171, -0.03667213, -0.06483376, -0.03447758, 0.08807429, -0.54246274, 0.24342099, -0.12868965, -0.09222031, -0.62142009, -0.53745467, 0.26243811, -0.15849904, -0.39114068, 0.2249857, -0.43757701, -0.73408857, 0.04845447, 0.20181919, -0.51523017, 0.04776046, -0.27121923, 0.19336688, 0.02102174, 1.85839199, -0.25379031, 1.18061153, -0.61909411, 1.25435584, 0.8259441, 0.28736397, -0.64972916, 0.97577725, -0.05195807, -0.8278123, -0.04442319, 0.02589251, -1.17398796, 0.54047419, -1.66681676, 0.23686338, 0.25139518, -0.16800947, 0.10911162, 0.32916197, 1.20066286, -1.38081226, 0.0834085]);
  const b2 = new Float64Array([0.22839199, -0.06869452, 0.28456833, 0.07599486, -0.15410599, -0.27936628, -0.26019183, -0.26696157, -0.17444879, -0.00980512, -0.1870744, 0.05553892, 0.12065706, 0.16295789, 0.15797137, -0.00691717]);
  const W3 = new Float64Array([0.40534857, -0.90793936, 0.3325431, -0.34009484, 0.05819459, 0.50365571, -0.8798512, -0.53267366, -0.52592731, 0.98219583, -0.36927924, -0.19925158, 0.77553604, 0.69315608, 0.61338876, 0.12301313, -0.00091092, -0.00122856, 0.00108022, -0.0002136, 0.00028832, -0.00148943, -0.00076635, 0.1210248, 0.00146162, 0.00260385, 0.00121324, -0.00085099, -0.00041146, -0.06056726, 0.10921337, 0.00139551, 0.00521299, 0.00228777, -0.00650049, 0.00045195, -0.00026342, 0.00058552, 0.00326363, -0.13249789, -0.00517233, -0.00491634, -0.00150322, 0.00016704, 0.00208288, 0.1582026, -0.31062787, -0.00434516, 0.00315715, 0.00046297, -0.00316454, -0.00037269, 0.00111673, -0.0018535, -0.00026883, -0.01272536, -0.00164658, 0.00032673, 0.00079463, -0.0015404, 0.00039479, 0.03332332, -0.09674194, 0.00017231, 0.45638725, 0.53459894, -0.14289287, -0.44480918, -0.54465852, 0.85056455, 0.2291249, -0.6785143, -0.28156744, 0.34240435, -0.04632177, 1.02117878, -0.07190558, 0.6873022, 0.95163175, 1.52251458]);
  const b3 = new Float64Array([0.29324723, 0.0739221, 0.01674306, 0.05172712, 0.30922134]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.37367955, -0.35655271, -0.20250552, -0.34481252, -0.09999207, -0.00379505, -0.0184631, -0.46863095, 0.75725387, -5.56230644, -0.10896188, 0.15297558, -0.07864012, 0.38746442, -0.11763881, -0.00024774, 0.18476201, 0.01598787, -0.14243465, -0.19989418, 0.39618945, 0.71850921, 0.01053419, 0.12605924, -0.46636395, 0.39170941, 0.12634164, 0.06641563, 0.47845474, -0.01313837, -0.08148162, 0.54502727, -0.1764148, 0.61669693, 0.20005133, -0.17687406, 0.69256141, -0.01875002, 0.56533594, -0.07870909, 0.00186146, 0.60913202, -0.19844768, 0.19290289, 0.08998624, -0.14195802, 0.07428855, 0.30363257, 0.39243164, 0.18022127, -0.00272998, 0.91734827, -1.10212008, -1.37015113, -0.08101384, 0.10213716, 0.86257978, -0.67292438, 0.63858139, 0.25765421, -0.43942791, -0.32244815, 0.98060971, 1.96213201, 0.02376881, 0.31505169, 0.96824986, -1.68711116, 0.61034008, -0.20836064, -0.3895434, 6.72936062, 0.38123824, 0.41431277, 0.53324557, 0.97596945, 4.53033208, 0.65570391, 0.39096668, 0.681621, 0.269472, 1.40211212, 0.79839522, 0.13178913, 0.60215126, -0.70030552, -0.04554696, 0.46055073, 0.04508601, 0.20535651, -0.12727416, 0.19360687, 0.20414665, 0.4604987, -1.29870183, -1.85396709, 0.01555748, 0.75731396, 0.40710334, 0.46626982, -0.68093211, 0.21134125, 0.0396087, -0.28116609, -0.42211123, 0.13349404, -1.19753039, -1.2921438, 0.39829841, 0.12484378, 1.01845594, 1.31458948, -0.44088747, 0.59211759, 0.61404855, 0.66642877, 0.44078828, -0.97065452, -0.34028084, 0.06517759, 1.09645698, 0.12170389, -0.47970173, 0.15599535, -0.1598288, 0.34552495, 0.20994686, -0.24241985, 0.26566471, 0.09404231, -0.00185984, -0.81831437, -0.19537278, -0.26085131, -1.08576424, -0.25281467, 0.04222919, -0.02200046, 1.19190821, 0.19308774, -0.98198101, -0.67181255, 0.04610372, -0.39923057, -0.71626144, -0.5321834, 0.59444319, -0.55059216, -0.16036236, 1.5852253, 0.32265167, -0.82676289, 0.32637174, 1.19828749, -0.09963534, -0.24286612, 0.18423258, 1.65997562, 0.43896263, 0.25142909, 0.05714172, -0.99009309, -0.36277681, 0.17678746, 0.17065356, 0.2999573, -0.51305639, -0.31900132, -0.38967836, -0.14481157, 0.53511676, -0.25737027, -0.08766127, 0.19116151, 0.31669896, -0.14177168, -0.02731271, 0.28196278, 0.45748175, -0.40196382, -0.00271061, -4.2760882, 0.50166892, 0.47782012, -0.2335934, -0.2096391, -0.08637055, 0.35546883, -0.27549609, -0.47947386, 0.02405826, 0.10702495, -0.97608948, 0.63812046, 0.09055079, 0.09075505, 0.67105247, -0.46830954, -0.00370852, 0.67238786, -0.07310662, -0.47338603, 0.48125339, 0.22048789, 0.06709343, 0.54923078, 0.27169977, -0.02955572, 0.66595845, -0.39870067, 0.33382914, -0.71592502, 0.1115227, 0.56116495, 0.36052893, -0.44526205, -0.05939491, -0.04559796, -0.12845957, -0.27877536, -0.09645798, -0.2513095, 0.1988506, 0.88071396, -2.8585234, -0.1656975, -0.22059098, 0.80286704, 0.92415699, -0.08535674, -0.00570063, 0.43308276, 0.24646164, -0.30896173, -0.17709841, -0.16859489, -0.15774939, -0.05108047, -0.76321227, -0.46590614, 0.84741596, -0.3566829, 0.00479685, 0.79825508, -2.21178896, -0.58848294, -0.16492905, -0.23970558, 1.07348152, -0.22593733, -0.47028359, -0.36294249, -0.72077299, 0.41848149, 0.50949535, -0.26921403, -0.45160998, 0.07504819, 0.08655836, 0.30108809, 0.40760542, -0.09314225, -0.18551259, 0.36098076, 0.08008493, -0.17594103, 0.3667882, -0.44959867, 0.94495331, 0.87365067, -0.73656855, -0.31275431, 0.51375214, -0.31321416, -0.61473491, -0.0932328, 0.04089805, -0.11793739, -0.52247519, -0.01954783, 0.04350873, 0.12541805, 0.3495806, -1.01111869, -0.0974116, -0.1912975, 2.49225844, 0.22999173, 0.23385168, -0.82609385, 1.22146573, 1.4350237, 0.31956772, 0.14606169, -0.42307349, 1.24482024, 0.68868796, -0.33224636, -0.03911759, -0.17637863, 0.79316499, -0.2576309, -0.08840788, 0.11548682, 0.05044824, -0.06249549, -0.35326178, -0.14798324, -0.58278107, 1.20958241, 2.59958687, -0.02749967, -0.30519525, -0.45608573, -0.86478838, 0.03342703, -0.09224473, 0.46655865, -0.06266845, 0.5347212, -0.20895469, 1.66416341, -1.4152917, -0.60786259, 0.55932773, 0.38941846, -0.68389871, 0.03803172, 0.17996907, -0.34566564, 0.2400251, -0.10166361, 0.08876131, 0.53118647, 0.40190514, -0.25326954, -0.08875649, 0.08922969, 0.74948099, 0.13952352, -0.41164292, -0.11052886, 0.12421492, -0.08321668, -0.39260526, 0.36233751, 0.4535305, -0.47458518, -0.02055333, -0.44815799, 0.17378572, 0.01454993, -0.3984546, -6.08163587, 0.08393767, -0.0802907, -0.28299343, 0.1077149, 0.6893537, -0.29118718, 0.09575081, 0.69732582, 0.08771233, 0.18128787, 0.67841872, 1.03419939, 0.11464642, -0.64055245, -0.58039127, -1.5393959, 0.66563946, -0.00675712, 0.27619461, -0.01867601, 0.17199815, 0.73896864, -0.49929605, -0.24071797, -0.7735635, 0.36787024, 0.57473598, -0.51470644, 0.10868302, 0.18825567, 0.1433809, 0.44983215, 0.3110922, -0.25781091, -0.01701182, -0.39485142, -0.39225882, -0.4238235, -0.60147618, -0.35322348, -0.15462529, -0.86085885, 0.25426956, -0.48359618, -0.35139001, -0.51315284, 0.05513217, -0.14865726, -0.04124857, -0.4791491, -0.37826954, -0.09199109, 0.0408116, -0.71096745, 0.47174394, -0.11793403, -0.4191609, 0.4345681, -0.70465425, -0.40856462, 0.0919282, 0.89103857, 0.59984947, 0.57940104, -0.00256685, -0.76798229, 0.20545285, -0.19435572, 0.21449673, 0.37891476, -0.73462311, 0.18232847, -0.2191685, -0.17950424, 0.34939034, -0.21671032, -0.14725652, 0.12579731, 0.22736849, -0.4166054, -0.05767994, -0.46284717, -0.24598771, -0.13211549, 0.43400898, 2.46541811, -0.13484735, -0.46557604, 0.1443944, -0.75097079, 0.08695359, -0.27418249, 0.27396717, 0.49244486, 0.15266717, -0.04167017, 0.19010627, -0.41786312, -0.50348014, -0.38997942, 0.00378595, 0.11517839, 0.44369593, -0.54882049, 0.45807867, -0.27621376, -0.10687869, 0.27263099, -0.33355399, 0.03720111, 0.41795753, -0.30067931, 0.12384626, -0.45012036, -0.06015577, 0.46563994, -0.14275769, 0.43840605, -0.56701322, 1.00767277, 0.0803451, 0.0447841, -0.07561186, 0.28511836, 1.11742957, -0.51139321, 0.33867884, -1.17233547, 0.87519597, -0.07655837, -0.03732289, 1.72099088, -0.34952614, 0.60401773, 0.07677419, 0.33020227, -0.60501811, -0.15547007, 0.03979151, -1.40981826, 0.07536672, 0.84747206, -0.80652364, -0.88702868, -0.88839648, 0.91457139, -0.32258107, -1.39670974, -0.86226824, 0.27821097, 0.09137227, -0.71161177, -0.63268748, -0.76203644, 0.03391525, 0.33700284, -0.56546525, -0.27671503, -0.20754898, 0.43492654, -0.26994894, 0.07466348, -0.27469881, -0.30835253, 0.57311595, -0.19135086, -0.00758429, 0.12949078, -0.16737298, -0.06388467, 1.41276559, -1.67826086, 0.11256297, -0.32221906, 0.43195997, -0.73009905, -0.39425429, -0.47782929, 0.11098235, -0.43118211, 0.37777208, -0.24384072, -2.00377526, -0.51397144, 1.02314473, -1.30342489, -0.40097514, 0.21788535, 0.27843285, 0.25252678, 0.70999984, -0.39310426, 0.40489407, -0.03706699, -2.5781379, 0.99043761, 0.28416039, 0.13143118, 0.10564484, -2.33127565, -0.17048388, 0.17486396, -0.0031519, 0.01805415, -1.19640746, -0.30936341, 0.15886225, -0.484087, -0.08683084, -0.052608, -0.52811952, -0.65461897, 0.22361188, -0.38490041, 1.99846423, -0.88974626, -1.36016117, -0.49243242, -0.66310326, -0.65699192, -0.79859392, -0.7749947, -0.05590271, -0.60458855, -0.58833825, 1.03412362, -0.22991797, -0.87396657, -0.6471435, 0.02844965, 0.27442076, -0.36558448, -0.44646803, 1.12875554, 0.02185584, -0.15329332, -0.07330369, -0.57722641, 0.29980512, 0.3628283, -0.22857184, 0.37883553, -0.43993042, 0.23424024, -0.0569633, -0.01990152, 0.60615148, -0.46456648, 0.36658781, 0.78312321, 0.3605576, 0.23405065, -0.36872698, 0.16792231, -0.12076227, 0.47399395, -0.10557934, -1.43560677, -0.34419375, 0.01495153, 0.03885159, -0.24674312, 0.23616006, 0.31404975, 0.21750481, -0.23447034, -0.03676641, 0.61439293, -0.18655758, -0.8651777, 0.11925246, 0.32495045, -0.20426155, -1.05076869, -0.21879875, 0.01617589, 2.70643336, 1.85281517, 0.48081075, -0.32559781, 1.68891186, 0.77603167, 0.51296821, 0.42898649, 0.02403734, 1.43319528, 0.57855442, -0.39464524, 0.74732705, -0.09617027, 0.78749603, -0.41332401, -0.28330427, -0.32226869, -0.14388052, -0.14778918, -0.44224577, -0.03196901, -0.26794169, 0.68220969, 3.34307011, 0.24847419, -0.42382943, 0.13333863, 0.43854206, -0.02462593, 0.00078187, 0.1077558, 0.23829599, 0.31174832, -0.0336766, 0.27630817, 1.44303172, -0.00855537, -0.35891216, 0.82465093, -0.03742278, 0.06036493, -0.52377809, -0.40656264, 0.82444246, -0.61697638, 0.67558564, 0.35191594, -0.5282224, 0.08434215, -0.2426511, 0.09583508, 0.48456962, 0.06679809, -0.40040208, -0.14114741, -0.0809227, -0.63092641, -0.25910505, -0.08592117, -0.06482869, -0.1376199, -0.09884876, 0.14393889, 0.08368564, -0.3665201, 2.16754599, 0.09285028, 0.00570206, -0.11009174, 0.23646948, -0.06039455, -0.23766702, 0.02402643, -1.0695568, -0.71394596, -0.89580276, 0.10851547, -1.86642874, -2.81318044, 0.71277625, -0.46263081, 1.2825585, -1.55471817, -0.26411604, 0.10458911, -1.48794279, 4.07206127, 1.31527352, -0.04915247, -0.52165964, -1.31206989, 0.64806435, 0.21286685, 0.17138245, 0.0345549, -0.72553987, -0.23402846, 0.64149571, 0.05777905, -0.25660845, -0.3842559, 0.03229333, -0.16330155, 0.32827579, 0.13020282, 0.14202244, 0.01069589, 0.19832888, -0.93914962, -1.88289994, -0.33112048, 0.34987486, 0.11804352, -0.01903019, -0.17841263, -0.18961072, -0.26241155, -0.8174164, -0.30740354, -0.50447569, -0.41903202, -0.43410489, 0.16935845, -0.02955339, -0.17022146, -0.77974612, 0.23589389, 0.47154188, 0.25611629, 0.89312216, -0.0613999, -0.15859704, -0.15004505, -0.41511767, 0.46238897, -0.09387331, -0.40414429, 0.19147374, 0.1022777, 0.49361063, 0.14043876, -0.43516633, 0.7815562, 1.21948261, 0.79322107, 0.0776158, -0.27952406, 0.01147481, 0.77572859, -0.11681408, -0.06998583, -1.11363813, 0.54957064, -0.54022562, -0.46586264, 0.60722995, -1.64414979, 0.45673288, 0.46779158, -0.06719015, -0.55520683, 0.32890803, 0.78577772, -2.6444638, -2.90255869, 0.36102429, -0.0334389, -1.58583811, 0.27455064, -0.30671148, -0.97595235, 1.72980814, 1.02317419, 1.80727898, 0.18082774, 0.94389273, 0.11869972, -0.43875856, 1.16373003, 0.07606694, 0.61445033, -0.51274564, -1.01994078, 1.04995413, -0.21807333, 0.80522455, -0.34545427, -0.27150112, -0.71709678, -0.2013548, -0.57043752, -0.51418037, -0.6807708, 0.02921568, -0.39214251, 0.23959787, -0.74707022, 0.42279153, -0.45915771, 0.7834428, 0.14834117, -0.50917047, 0.30374902, 0.84473329, -0.26804779, -0.5402964, -0.77252725, 2.51228808, -0.45100941, 0.55281235, 0.88084719, 0.62645937, 0.76525407, -0.20325039, 1.02253575, 6.13240714, 0.65163466, -0.42165712, 1.21040695, -1.04166048, 2.15892272, -0.1828163, 0.29330258, 2.68353962, 1.17765899, 0.84806436, -0.11848513, 0.21901076, 0.55115811, 0.38551364, -0.06697084, 0.16517862, 0.1283943, 0.64718835, -0.47028789, 0.3972625, 0.52069881, -0.93649364, -2.08205695, 0.09803816, 0.36423555, -0.11349227, 0.92488823, 0.08206258, 0.50652821, -0.42065908, 0.10856862, -0.0654208, -0.1372549, 0.49674405, 0.38003519, 0.60424828, 0.32020323, -1.57378214, 0.51755184, 0.39012964, 0.50056123, -1.49999621, -1.3814717, -0.06494532, 0.08884502, -0.50213344, -0.4514629, -2.0837348, 0.25719078, -0.13371639, -0.51934369, -1.20131608, -0.01717315, 0.13690821, -0.7813616, 0.11606223, -0.54944106, 0.00886557, 0.15375807, -0.32474046, 0.05596555, -0.14689821, 0.02835635, -0.28388456, 0.21699988, -3.48653378, -0.39647272, 0.40088006, 0.01416231, 0.18881201, -0.05630252, -0.12417696, 0.7780627, -0.35005511, -0.0427732, -0.01765561, -0.81225087, 0.37245777, -0.14276719, 0.03233728, 1.186064, 0.17462922, -0.51487399, 0.60124582, 0.33224874, -0.05486804, -0.11303612, 0.13779535, 0.13642379, 0.39657825, 0.23303783, -0.1261119, 0.04866497, 0.15551102, 0.96474035, -0.53098741, -0.03982736, 0.72189164, 0.53049708, 0.75787783, 0.09097524, 0.01830308, 0.39389232, 0.27012072, 0.54644018, 1.12601875, 0.01968803, -0.45336743, 3.13538151, 0.28449194, -0.14325775, 0.23172357, -0.1098143, -0.43297551, 0.55169826, -0.29991348, 0.1422041, -0.20385603, 0.58512631, -0.93381751, -0.38023049, 0.18913321, 0.76018968, 0.43824838, 0.33898552, -0.40985546, 0.2983509, -0.52846436, 1.24588521, 0.33262407, 0.14892457, -0.00878468, -0.6532851, 1.70561891, 0.22941184, 0.37914114, -0.22506072, -0.3429072, 0.83438116, 0.31039006, -0.12009891, -0.76953382, 0.16039463, 0.22640251, 0.66662906, -0.01887328, 0.00694876, 1.14695765, 0.11555568, 0.30689163, -0.58892017, -0.63082043, -0.58159424, -0.42239301, 0.12747927, -0.9863424, -0.27425589, 0.12827138, -0.37054683, -0.17097179, -0.3826806, 0.10933824, 0.00680591, -1.96163135, -0.05833431, -0.44803859, 0.95302928, -0.65686424, -0.4095714, 0.05578588, -2.64474972, -2.04286411, -0.46660226, 0.7275184, -0.50159665, -1.07010678, -1.1152038, -0.10196977, 0.17893571, -0.49192931, -0.86016558, -0.36944581, 0.30919506, 0.5008314, 0.72367374]);
  const b1 = new Float64Array([-0.22109897, 0.21784641, 0.2099804, -0.01431288, 0.01443251, -0.13592099, 0.01625457, -0.22994792, -0.08768779, -0.20622678, -0.08855239, 0.29967456, -0.1238973, -0.1281671, 0.1176462, -0.18593962, -0.14445972, 0.04660619, 0.14119252, -0.27189766, 0.32998061, -0.1620127, 0.29943027, 0.21876492]);
  const W2 = new Float64Array([0.62871994, -0.23432196, 0.1638401, -0.02876664, -0.53018742, -0.33625674, -0.57872319, -0.22037016, 0.73451219, -0.40192462, -0.0759618, 0.26670821, -0.21580192, -0.05525081, -0.14918828, -1.01518117, -0.16226877, 0.48775536, 0.15665141, -0.34170622, 1.15426584, -0.43399239, -0.75897101, 0.26519989, 1.20422542, 0.08170176, 1.18619573, -0.38288927, 0.61522501, 0.3637301, 0.39878735, -0.42862798, -0.0693727, 0.18749291, -0.28314584, 0.04718683, 0.37374164, -0.02201248, 0.89578048, -0.70696951, -0.02876644, -0.05623654, 0.69700148, -0.7503903, 0.06983855, 0.60596989, -0.09549831, 0.75364485, 0.56362842, -0.43302427, -0.08916726, -0.51480718, -0.45242222, 0.01954209, -0.18437553, -0.65542767, 0.2194854, -0.34732287, -0.18522718, 0.88165975, -0.44657291, -0.10778114, -0.26238677, -0.02297598, 0.39602011, 0.45395579, -0.6899758, 0.38131482, 0.57091053, 0.066329, -0.36989006, 0.82658197, -1.63366195, 0.36497267, 0.34733624, -0.12843518, -1.03590799, -0.56667242, -0.12209489, 0.78249159, -2.08303374, -0.04533514, -0.10945963, 0.14038298, -0.47347597, 0.29987462, -0.90393001, 0.81027367, -0.33941072, 0.19884969, 0.87522396, 0.31868622, -0.76946276, -0.41073882, 0.85722686, -0.08545006, -0.76992487, -0.28677609, -1.00313245, 0.12783386, 0.1728436, 0.71473843, -0.13000031, -0.3506244, 0.70088959, 0.39668922, -0.32374849, -0.18658476, -0.08292243, 0.61407854, 0.28687968, 0.2218216, 0.59732168, -0.54776628, 0.16244402, 0.28739754, 0.02546341, -0.57378135, 0.51422093, -0.04858902, 1.48390453, -0.29267222, -0.64645552, 0.03048756, 1.05157142, 1.02253859, -0.09612965, 0.54486893, 1.28959578, -0.13649375, -0.05160025, -0.65083979, 0.40404193, -0.33511861, -0.09092869, -0.3677296, 0.39543597, -0.21703855, -0.90983508, 0.04372587, -0.12645913, 0.07219552, -0.33401422, -0.36758765, 0.20412845, -0.03120644, -0.19770311, 0.21733562, 0.13249198, -1.32034804, 0.75509697, 0.86478052, 0.19214225, 0.65416862, -0.08484749, -0.48412836, 0.21602274, 0.40148529, 0.07746418, 1.20552888, 0.12446551, -0.18972528, -0.05912647, 0.9071618, -0.62578433, -0.25459306, 0.40782904, -0.57428862, -0.0146803, 0.07395741, -0.28007471, 0.47914321, 0.27209217, 0.45318785, -0.8891784, 0.40002671, 0.26753086, 0.44076367, 0.52338638, 0.25003771, 0.39197833, 0.67447595, -0.17805398, 0.17617213, 0.51446866, 0.05797459, 0.09213482, -0.04050456, -0.54425384, 0.14625782, -0.13016084, -0.06444231, -0.51173997, 0.36801052, -0.11309571, 0.96104328, -0.19204557, 0.33726989, -0.53374999, 0.04529358, 0.15277142, 0.509849, 0.79062068, 0.46222685, 0.11433892, 0.79516821, 0.48694495, -0.27891788, -0.5640859, -0.37453234, 0.95299259, -0.87792412, -0.17750971, 0.07672105, 0.45044506, -0.4650693, 0.11755519, -0.58801966, 0.02937998, -0.07457529, -0.86983507, -0.81564126, -0.28426075, 0.36887063, -1.01572975, 0.1387897, 0.3240348, 0.67284089, -0.12052952, 0.00017316, -0.27948332, 0.22913473, 1.1587979, -0.27556149, -0.72228271, 1.23196424, -0.13795553, -0.27720337, -0.30195832, 0.11117176, 0.50040679, 0.37146036, -0.01272207, 0.19529276, -0.0893127, -0.01296985, -1.17371716, -0.20753321, 0.63750495, 0.06666584, 0.38655746, 0.12943873, 1.85012517, -0.09761697, -0.36663912, -0.13691638, 0.77991756, 0.02309491, -0.06852533, -0.14767018, 0.23811651, -0.30330243, 0.15740664, 0.20393993, 0.10006965, 0.02428588, -0.17089029, -0.2135282, -1.08893392, -0.18072822, 0.32709689, -0.24801017, -0.58125944, -0.16589336, 0.32505254, -0.40353177, 0.10040854, 0.00732609, -0.11548299, 0.05065486, -0.66076333, -0.22312989, -0.82135787, 0.38276637, 0.08453765, -0.33883814, -0.38727332, -0.31059584, 0.44577625, -1.44292495, -0.04086017, -0.39701687, -0.09360024, 0.41855149, -0.28613669, 0.429119, 1.17012127, -0.14792799, -0.01587281, -0.12621984, -0.43948346, 0.1776941, -0.68006552, -0.08795923, -0.7379923, -0.31054717, -0.85467817, -1.20917699, 0.50664544, 0.27581075, -0.75773291, 0.98767151, -0.3112697, -0.14864131, 0.35068664, -0.33054521, 0.34524341, -0.40444375, -0.06219724, -0.1614772, -0.07498081, -0.4727252, -0.39419348, 0.83772287, -0.14882572, -0.34527889, 0.50879943, -0.01004583, 0.00207072, -0.17747884, -0.09487019, -0.56562003, 0.50512382, -0.55184357, 0.41833585, -0.15333326, -0.41862171, -0.03667213, -0.06483376, -0.03447758, 0.08807429, -0.54246274, 0.24342099, -0.12868965, -0.09222031, -0.62142009, -0.53745467, 0.26243811, -0.15849904, -0.39114068, 0.2249857, -0.43757701, -0.73408857, 0.04845447, 0.20181919, -0.51523017, 0.04776046, -0.27121923, 0.19336688, 0.02102174, 1.85839199, -0.25379031, 1.18061153, -0.61909411, 1.25435584, 0.8259441, 0.28736397, -0.64972916, 0.97577725, -0.05195807, -0.8278123, -0.04442319, 0.02589251, -1.17398796, 0.54047419, -1.66681676, 0.23686338, 0.25139518, -0.16800947, 0.10911162, 0.32916197, 1.20066286, -1.38081226, 0.0834085]);
  const b2 = new Float64Array([0.22839199, -0.06869452, 0.28456833, 0.07599486, -0.15410599, -0.27936628, -0.26019183, -0.26696157, -0.17444879, -0.00980512, -0.1870744, 0.05553892, 0.12065706, 0.16295789, 0.15797137, -0.00691717]);
  const W3 = new Float64Array([0.40534857, -0.90793936, 0.3325431, -0.34009484, 0.05819459, 0.50365571, -0.8798512, -0.53267366, -0.52592731, 0.98219583, -0.36927924, -0.19925158, 0.77553604, 0.69315608, 0.61338876, 0.12301313, -0.00091092, -0.00122856, 0.00108022, -0.0002136, 0.00028832, -0.00148943, -0.00076635, 0.1210248, 0.00146162, 0.00260385, 0.00121324, -0.00085099, -0.00041146, -0.06056726, 0.10921337, 0.00139551, 0.00521299, 0.00228777, -0.00650049, 0.00045195, -0.00026342, 0.00058552, 0.00326363, -0.13249789, -0.00517233, -0.00491634, -0.00150322, 0.00016704, 0.00208288, 0.1582026, -0.31062787, -0.00434516, 0.00315715, 0.00046297, -0.00316454, -0.00037269, 0.00111673, -0.0018535, -0.00026883, -0.01272536, -0.00164658, 0.00032673, 0.00079463, -0.0015404, 0.00039479, 0.03332332, -0.09674194, 0.00017231, 0.45638725, 0.53459894, -0.14289287, -0.44480918, -0.54465852, 0.85056455, 0.2291249, -0.6785143, -0.28156744, 0.34240435, -0.04632177, 1.02117878, -0.07190558, 0.6873022, 0.95163175, 1.52251458]);
  const b3 = new Float64Array([0.29324723, 0.0739221, 0.01674306, 0.05172712, 0.30922134]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.37367955, -0.35655271, -0.20250552, -0.34481252, -0.09999207, -0.00379505, -0.0184631, -0.46863095, 0.75725387, -5.56230644, -0.10896188, 0.15297558, -0.07864012, 0.38746442, -0.11763881, -0.00024774, 0.18476201, 0.01598787, -0.14243465, -0.19989418, 0.39618945, 0.71850921, 0.01053419, 0.12605924, -0.46636395, 0.39170941, 0.12634164, 0.06641563, 0.47845474, -0.01313837, -0.08148162, 0.54502727, -0.1764148, 0.61669693, 0.20005133, -0.17687406, 0.69256141, -0.01875002, 0.56533594, -0.07870909, 0.00186146, 0.60913202, -0.19844768, 0.19290289, 0.08998624, -0.14195802, 0.07428855, 0.30363257, 0.39243164, 0.18022127, -0.00272998, 0.91734827, -1.10212008, -1.37015113, -0.08101384, 0.10213716, 0.86257978, -0.67292438, 0.63858139, 0.25765421, -0.43942791, -0.32244815, 0.98060971, 1.96213201, 0.02376881, 0.31505169, 0.96824986, -1.68711116, 0.61034008, -0.20836064, -0.3895434, 6.72936062, 0.38123824, 0.41431277, 0.53324557, 0.97596945, 4.53033208, 0.65570391, 0.39096668, 0.681621, 0.269472, 1.40211212, 0.79839522, 0.13178913, 0.60215126, -0.70030552, -0.04554696, 0.46055073, 0.04508601, 0.20535651, -0.12727416, 0.19360687, 0.20414665, 0.4604987, -1.29870183, -1.85396709, 0.01555748, 0.75731396, 0.40710334, 0.46626982, -0.68093211, 0.21134125, 0.0396087, -0.28116609, -0.42211123, 0.13349404, -1.19753039, -1.2921438, 0.39829841, 0.12484378, 1.01845594, 1.31458948, -0.44088747, 0.59211759, 0.61404855, 0.66642877, 0.44078828, -0.97065452, -0.34028084, 0.06517759, 1.09645698, 0.12170389, -0.47970173, 0.15599535, -0.1598288, 0.34552495, 0.20994686, -0.24241985, 0.26566471, 0.09404231, -0.00185984, -0.81831437, -0.19537278, -0.26085131, -1.08576424, -0.25281467, 0.04222919, -0.02200046, 1.19190821, 0.19308774, -0.98198101, -0.67181255, 0.04610372, -0.39923057, -0.71626144, -0.5321834, 0.59444319, -0.55059216, -0.16036236, 1.5852253, 0.32265167, -0.82676289, 0.32637174, 1.19828749, -0.09963534, -0.24286612, 0.18423258, 1.65997562, 0.43896263, 0.25142909, 0.05714172, -0.99009309, -0.36277681, 0.17678746, 0.17065356, 0.2999573, -0.51305639, -0.31900132, -0.38967836, -0.14481157, 0.53511676, -0.25737027, -0.08766127, 0.19116151, 0.31669896, -0.14177168, -0.02731271, 0.28196278, 0.45748175, -0.40196382, -0.00271061, -4.2760882, 0.50166892, 0.47782012, -0.2335934, -0.2096391, -0.08637055, 0.35546883, -0.27549609, -0.47947386, 0.02405826, 0.10702495, -0.97608948, 0.63812046, 0.09055079, 0.09075505, 0.67105247, -0.46830954, -0.00370852, 0.67238786, -0.07310662, -0.47338603, 0.48125339, 0.22048789, 0.06709343, 0.54923078, 0.27169977, -0.02955572, 0.66595845, -0.39870067, 0.33382914, -0.71592502, 0.1115227, 0.56116495, 0.36052893, -0.44526205, -0.05939491, -0.04559796, -0.12845957, -0.27877536, -0.09645798, -0.2513095, 0.1988506, 0.88071396, -2.8585234, -0.1656975, -0.22059098, 0.80286704, 0.92415699, -0.08535674, -0.00570063, 0.43308276, 0.24646164, -0.30896173, -0.17709841, -0.16859489, -0.15774939, -0.05108047, -0.76321227, -0.46590614, 0.84741596, -0.3566829, 0.00479685, 0.79825508, -2.21178896, -0.58848294, -0.16492905, -0.23970558, 1.07348152, -0.22593733, -0.47028359, -0.36294249, -0.72077299, 0.41848149, 0.50949535, -0.26921403, -0.45160998, 0.07504819, 0.08655836, 0.30108809, 0.40760542, -0.09314225, -0.18551259, 0.36098076, 0.08008493, -0.17594103, 0.3667882, -0.44959867, 0.94495331, 0.87365067, -0.73656855, -0.31275431, 0.51375214, -0.31321416, -0.61473491, -0.0932328, 0.04089805, -0.11793739, -0.52247519, -0.01954783, 0.04350873, 0.12541805, 0.3495806, -1.01111869, -0.0974116, -0.1912975, 2.49225844, 0.22999173, 0.23385168, -0.82609385, 1.22146573, 1.4350237, 0.31956772, 0.14606169, -0.42307349, 1.24482024, 0.68868796, -0.33224636, -0.03911759, -0.17637863, 0.79316499, -0.2576309, -0.08840788, 0.11548682, 0.05044824, -0.06249549, -0.35326178, -0.14798324, -0.58278107, 1.20958241, 2.59958687, -0.02749967, -0.30519525, -0.45608573, -0.86478838, 0.03342703, -0.09224473, 0.46655865, -0.06266845, 0.5347212, -0.20895469, 1.66416341, -1.4152917, -0.60786259, 0.55932773, 0.38941846, -0.68389871, 0.03803172, 0.17996907, -0.34566564, 0.2400251, -0.10166361, 0.08876131, 0.53118647, 0.40190514, -0.25326954, -0.08875649, 0.08922969, 0.74948099, 0.13952352, -0.41164292, -0.11052886, 0.12421492, -0.08321668, -0.39260526, 0.36233751, 0.4535305, -0.47458518, -0.02055333, -0.44815799, 0.17378572, 0.01454993, -0.3984546, -6.08163587, 0.08393767, -0.0802907, -0.28299343, 0.1077149, 0.6893537, -0.29118718, 0.09575081, 0.69732582, 0.08771233, 0.18128787, 0.67841872, 1.03419939, 0.11464642, -0.64055245, -0.58039127, -1.5393959, 0.66563946, -0.00675712, 0.27619461, -0.01867601, 0.17199815, 0.73896864, -0.49929605, -0.24071797, -0.7735635, 0.36787024, 0.57473598, -0.51470644, 0.10868302, 0.18825567, 0.1433809, 0.44983215, 0.3110922, -0.25781091, -0.01701182, -0.39485142, -0.39225882, -0.4238235, -0.60147618, -0.35322348, -0.15462529, -0.86085885, 0.25426956, -0.48359618, -0.35139001, -0.51315284, 0.05513217, -0.14865726, -0.04124857, -0.4791491, -0.37826954, -0.09199109, 0.0408116, -0.71096745, 0.47174394, -0.11793403, -0.4191609, 0.4345681, -0.70465425, -0.40856462, 0.0919282, 0.89103857, 0.59984947, 0.57940104, -0.00256685, -0.76798229, 0.20545285, -0.19435572, 0.21449673, 0.37891476, -0.73462311, 0.18232847, -0.2191685, -0.17950424, 0.34939034, -0.21671032, -0.14725652, 0.12579731, 0.22736849, -0.4166054, -0.05767994, -0.46284717, -0.24598771, -0.13211549, 0.43400898, 2.46541811, -0.13484735, -0.46557604, 0.1443944, -0.75097079, 0.08695359, -0.27418249, 0.27396717, 0.49244486, 0.15266717, -0.04167017, 0.19010627, -0.41786312, -0.50348014, -0.38997942, 0.00378595, 0.11517839, 0.44369593, -0.54882049, 0.45807867, -0.27621376, -0.10687869, 0.27263099, -0.33355399, 0.03720111, 0.41795753, -0.30067931, 0.12384626, -0.45012036, -0.06015577, 0.46563994, -0.14275769, 0.43840605, -0.56701322, 1.00767277, 0.0803451, 0.0447841, -0.07561186, 0.28511836, 1.11742957, -0.51139321, 0.33867884, -1.17233547, 0.87519597, -0.07655837, -0.03732289, 1.72099088, -0.34952614, 0.60401773, 0.07677419, 0.33020227, -0.60501811, -0.15547007, 0.03979151, -1.40981826, 0.07536672, 0.84747206, -0.80652364, -0.88702868, -0.88839648, 0.91457139, -0.32258107, -1.39670974, -0.86226824, 0.27821097, 0.09137227, -0.71161177, -0.63268748, -0.76203644, 0.03391525, 0.33700284, -0.56546525, -0.27671503, -0.20754898, 0.43492654, -0.26994894, 0.07466348, -0.27469881, -0.30835253, 0.57311595, -0.19135086, -0.00758429, 0.12949078, -0.16737298, -0.06388467, 1.41276559, -1.67826086, 0.11256297, -0.32221906, 0.43195997, -0.73009905, -0.39425429, -0.47782929, 0.11098235, -0.43118211, 0.37777208, -0.24384072, -2.00377526, -0.51397144, 1.02314473, -1.30342489, -0.40097514, 0.21788535, 0.27843285, 0.25252678, 0.70999984, -0.39310426, 0.40489407, -0.03706699, -2.5781379, 0.99043761, 0.28416039, 0.13143118, 0.10564484, -2.33127565, -0.17048388, 0.17486396, -0.0031519, 0.01805415, -1.19640746, -0.30936341, 0.15886225, -0.484087, -0.08683084, -0.052608, -0.52811952, -0.65461897, 0.22361188, -0.38490041, 1.99846423, -0.88974626, -1.36016117, -0.49243242, -0.66310326, -0.65699192, -0.79859392, -0.7749947, -0.05590271, -0.60458855, -0.58833825, 1.03412362, -0.22991797, -0.87396657, -0.6471435, 0.02844965, 0.27442076, -0.36558448, -0.44646803, 1.12875554, 0.02185584, -0.15329332, -0.07330369, -0.57722641, 0.29980512, 0.3628283, -0.22857184, 0.37883553, -0.43993042, 0.23424024, -0.0569633, -0.01990152, 0.60615148, -0.46456648, 0.36658781, 0.78312321, 0.3605576, 0.23405065, -0.36872698, 0.16792231, -0.12076227, 0.47399395, -0.10557934, -1.43560677, -0.34419375, 0.01495153, 0.03885159, -0.24674312, 0.23616006, 0.31404975, 0.21750481, -0.23447034, -0.03676641, 0.61439293, -0.18655758, -0.8651777, 0.11925246, 0.32495045, -0.20426155, -1.05076869, -0.21879875, 0.01617589, 2.70643336, 1.85281517, 0.48081075, -0.32559781, 1.68891186, 0.77603167, 0.51296821, 0.42898649, 0.02403734, 1.43319528, 0.57855442, -0.39464524, 0.74732705, -0.09617027, 0.78749603, -0.41332401, -0.28330427, -0.32226869, -0.14388052, -0.14778918, -0.44224577, -0.03196901, -0.26794169, 0.68220969, 3.34307011, 0.24847419, -0.42382943, 0.13333863, 0.43854206, -0.02462593, 0.00078187, 0.1077558, 0.23829599, 0.31174832, -0.0336766, 0.27630817, 1.44303172, -0.00855537, -0.35891216, 0.82465093, -0.03742278, 0.06036493, -0.52377809, -0.40656264, 0.82444246, -0.61697638, 0.67558564, 0.35191594, -0.5282224, 0.08434215, -0.2426511, 0.09583508, 0.48456962, 0.06679809, -0.40040208, -0.14114741, -0.0809227, -0.63092641, -0.25910505, -0.08592117, -0.06482869, -0.1376199, -0.09884876, 0.14393889, 0.08368564, -0.3665201, 2.16754599, 0.09285028, 0.00570206, -0.11009174, 0.23646948, -0.06039455, -0.23766702, 0.02402643, -1.0695568, -0.71394596, -0.89580276, 0.10851547, -1.86642874, -2.81318044, 0.71277625, -0.46263081, 1.2825585, -1.55471817, -0.26411604, 0.10458911, -1.48794279, 4.07206127, 1.31527352, -0.04915247, -0.52165964, -1.31206989, 0.64806435, 0.21286685, 0.17138245, 0.0345549, -0.72553987, -0.23402846, 0.64149571, 0.05777905, -0.25660845, -0.3842559, 0.03229333, -0.16330155, 0.32827579, 0.13020282, 0.14202244, 0.01069589, 0.19832888, -0.93914962, -1.88289994, -0.33112048, 0.34987486, 0.11804352, -0.01903019, -0.17841263, -0.18961072, -0.26241155, -0.8174164, -0.30740354, -0.50447569, -0.41903202, -0.43410489, 0.16935845, -0.02955339, -0.17022146, -0.77974612, 0.23589389, 0.47154188, 0.25611629, 0.89312216, -0.0613999, -0.15859704, -0.15004505, -0.41511767, 0.46238897, -0.09387331, -0.40414429, 0.19147374, 0.1022777, 0.49361063, 0.14043876, -0.43516633, 0.7815562, 1.21948261, 0.79322107, 0.0776158, -0.27952406, 0.01147481, 0.77572859, -0.11681408, -0.06998583, -1.11363813, 0.54957064, -0.54022562, -0.46586264, 0.60722995, -1.64414979, 0.45673288, 0.46779158, -0.06719015, -0.55520683, 0.32890803, 0.78577772, -2.6444638, -2.90255869, 0.36102429, -0.0334389, -1.58583811, 0.27455064, -0.30671148, -0.97595235, 1.72980814, 1.02317419, 1.80727898, 0.18082774, 0.94389273, 0.11869972, -0.43875856, 1.16373003, 0.07606694, 0.61445033, -0.51274564, -1.01994078, 1.04995413, -0.21807333, 0.80522455, -0.34545427, -0.27150112, -0.71709678, -0.2013548, -0.57043752, -0.51418037, -0.6807708, 0.02921568, -0.39214251, 0.23959787, -0.74707022, 0.42279153, -0.45915771, 0.7834428, 0.14834117, -0.50917047, 0.30374902, 0.84473329, -0.26804779, -0.5402964, -0.77252725, 2.51228808, -0.45100941, 0.55281235, 0.88084719, 0.62645937, 0.76525407, -0.20325039, 1.02253575, 6.13240714, 0.65163466, -0.42165712, 1.21040695, -1.04166048, 2.15892272, -0.1828163, 0.29330258, 2.68353962, 1.17765899, 0.84806436, -0.11848513, 0.21901076, 0.55115811, 0.38551364, -0.06697084, 0.16517862, 0.1283943, 0.64718835, -0.47028789, 0.3972625, 0.52069881, -0.93649364, -2.08205695, 0.09803816, 0.36423555, -0.11349227, 0.92488823, 0.08206258, 0.50652821, -0.42065908, 0.10856862, -0.0654208, -0.1372549, 0.49674405, 0.38003519, 0.60424828, 0.32020323, -1.57378214, 0.51755184, 0.39012964, 0.50056123, -1.49999621, -1.3814717, -0.06494532, 0.08884502, -0.50213344, -0.4514629, -2.0837348, 0.25719078, -0.13371639, -0.51934369, -1.20131608, -0.01717315, 0.13690821, -0.7813616, 0.11606223, -0.54944106, 0.00886557, 0.15375807, -0.32474046, 0.05596555, -0.14689821, 0.02835635, -0.28388456, 0.21699988, -3.48653378, -0.39647272, 0.40088006, 0.01416231, 0.18881201, -0.05630252, -0.12417696, 0.7780627, -0.35005511, -0.0427732, -0.01765561, -0.81225087, 0.37245777, -0.14276719, 0.03233728, 1.186064, 0.17462922, -0.51487399, 0.60124582, 0.33224874, -0.05486804, -0.11303612, 0.13779535, 0.13642379, 0.39657825, 0.23303783, -0.1261119, 0.04866497, 0.15551102, 0.96474035, -0.53098741, -0.03982736, 0.72189164, 0.53049708, 0.75787783, 0.09097524, 0.01830308, 0.39389232, 0.27012072, 0.54644018, 1.12601875, 0.01968803, -0.45336743, 3.13538151, 0.28449194, -0.14325775, 0.23172357, -0.1098143, -0.43297551, 0.55169826, -0.29991348, 0.1422041, -0.20385603, 0.58512631, -0.93381751, -0.38023049, 0.18913321, 0.76018968, 0.43824838, 0.33898552, -0.40985546, 0.2983509, -0.52846436, 1.24588521, 0.33262407, 0.14892457, -0.00878468, -0.6532851, 1.70561891, 0.22941184, 0.37914114, -0.22506072, -0.3429072, 0.83438116, 0.31039006, -0.12009891, -0.76953382, 0.16039463, 0.22640251, 0.66662906, -0.01887328, 0.00694876, 1.14695765, 0.11555568, 0.30689163, -0.58892017, -0.63082043, -0.58159424, -0.42239301, 0.12747927, -0.9863424, -0.27425589, 0.12827138, -0.37054683, -0.17097179, -0.3826806, 0.10933824, 0.00680591, -1.96163135, -0.05833431, -0.44803859, 0.95302928, -0.65686424, -0.4095714, 0.05578588, -2.64474972, -2.04286411, -0.46660226, 0.7275184, -0.50159665, -1.07010678, -1.1152038, -0.10196977, 0.17893571, -0.49192931, -0.86016558, -0.36944581, 0.30919506, 0.5008314, 0.72367374]);
  const b1 = new Float64Array([-0.22109897, 0.21784641, 0.2099804, -0.01431288, 0.01443251, -0.13592099, 0.01625457, -0.22994792, -0.08768779, -0.20622678, -0.08855239, 0.29967456, -0.1238973, -0.1281671, 0.1176462, -0.18593962, -0.14445972, 0.04660619, 0.14119252, -0.27189766, 0.32998061, -0.1620127, 0.29943027, 0.21876492]);
  const W2 = new Float64Array([0.62871994, -0.23432196, 0.1638401, -0.02876664, -0.53018742, -0.33625674, -0.57872319, -0.22037016, 0.73451219, -0.40192462, -0.0759618, 0.26670821, -0.21580192, -0.05525081, -0.14918828, -1.01518117, -0.16226877, 0.48775536, 0.15665141, -0.34170622, 1.15426584, -0.43399239, -0.75897101, 0.26519989, 1.20422542, 0.08170176, 1.18619573, -0.38288927, 0.61522501, 0.3637301, 0.39878735, -0.42862798, -0.0693727, 0.18749291, -0.28314584, 0.04718683, 0.37374164, -0.02201248, 0.89578048, -0.70696951, -0.02876644, -0.05623654, 0.69700148, -0.7503903, 0.06983855, 0.60596989, -0.09549831, 0.75364485, 0.56362842, -0.43302427, -0.08916726, -0.51480718, -0.45242222, 0.01954209, -0.18437553, -0.65542767, 0.2194854, -0.34732287, -0.18522718, 0.88165975, -0.44657291, -0.10778114, -0.26238677, -0.02297598, 0.39602011, 0.45395579, -0.6899758, 0.38131482, 0.57091053, 0.066329, -0.36989006, 0.82658197, -1.63366195, 0.36497267, 0.34733624, -0.12843518, -1.03590799, -0.56667242, -0.12209489, 0.78249159, -2.08303374, -0.04533514, -0.10945963, 0.14038298, -0.47347597, 0.29987462, -0.90393001, 0.81027367, -0.33941072, 0.19884969, 0.87522396, 0.31868622, -0.76946276, -0.41073882, 0.85722686, -0.08545006, -0.76992487, -0.28677609, -1.00313245, 0.12783386, 0.1728436, 0.71473843, -0.13000031, -0.3506244, 0.70088959, 0.39668922, -0.32374849, -0.18658476, -0.08292243, 0.61407854, 0.28687968, 0.2218216, 0.59732168, -0.54776628, 0.16244402, 0.28739754, 0.02546341, -0.57378135, 0.51422093, -0.04858902, 1.48390453, -0.29267222, -0.64645552, 0.03048756, 1.05157142, 1.02253859, -0.09612965, 0.54486893, 1.28959578, -0.13649375, -0.05160025, -0.65083979, 0.40404193, -0.33511861, -0.09092869, -0.3677296, 0.39543597, -0.21703855, -0.90983508, 0.04372587, -0.12645913, 0.07219552, -0.33401422, -0.36758765, 0.20412845, -0.03120644, -0.19770311, 0.21733562, 0.13249198, -1.32034804, 0.75509697, 0.86478052, 0.19214225, 0.65416862, -0.08484749, -0.48412836, 0.21602274, 0.40148529, 0.07746418, 1.20552888, 0.12446551, -0.18972528, -0.05912647, 0.9071618, -0.62578433, -0.25459306, 0.40782904, -0.57428862, -0.0146803, 0.07395741, -0.28007471, 0.47914321, 0.27209217, 0.45318785, -0.8891784, 0.40002671, 0.26753086, 0.44076367, 0.52338638, 0.25003771, 0.39197833, 0.67447595, -0.17805398, 0.17617213, 0.51446866, 0.05797459, 0.09213482, -0.04050456, -0.54425384, 0.14625782, -0.13016084, -0.06444231, -0.51173997, 0.36801052, -0.11309571, 0.96104328, -0.19204557, 0.33726989, -0.53374999, 0.04529358, 0.15277142, 0.509849, 0.79062068, 0.46222685, 0.11433892, 0.79516821, 0.48694495, -0.27891788, -0.5640859, -0.37453234, 0.95299259, -0.87792412, -0.17750971, 0.07672105, 0.45044506, -0.4650693, 0.11755519, -0.58801966, 0.02937998, -0.07457529, -0.86983507, -0.81564126, -0.28426075, 0.36887063, -1.01572975, 0.1387897, 0.3240348, 0.67284089, -0.12052952, 0.00017316, -0.27948332, 0.22913473, 1.1587979, -0.27556149, -0.72228271, 1.23196424, -0.13795553, -0.27720337, -0.30195832, 0.11117176, 0.50040679, 0.37146036, -0.01272207, 0.19529276, -0.0893127, -0.01296985, -1.17371716, -0.20753321, 0.63750495, 0.06666584, 0.38655746, 0.12943873, 1.85012517, -0.09761697, -0.36663912, -0.13691638, 0.77991756, 0.02309491, -0.06852533, -0.14767018, 0.23811651, -0.30330243, 0.15740664, 0.20393993, 0.10006965, 0.02428588, -0.17089029, -0.2135282, -1.08893392, -0.18072822, 0.32709689, -0.24801017, -0.58125944, -0.16589336, 0.32505254, -0.40353177, 0.10040854, 0.00732609, -0.11548299, 0.05065486, -0.66076333, -0.22312989, -0.82135787, 0.38276637, 0.08453765, -0.33883814, -0.38727332, -0.31059584, 0.44577625, -1.44292495, -0.04086017, -0.39701687, -0.09360024, 0.41855149, -0.28613669, 0.429119, 1.17012127, -0.14792799, -0.01587281, -0.12621984, -0.43948346, 0.1776941, -0.68006552, -0.08795923, -0.7379923, -0.31054717, -0.85467817, -1.20917699, 0.50664544, 0.27581075, -0.75773291, 0.98767151, -0.3112697, -0.14864131, 0.35068664, -0.33054521, 0.34524341, -0.40444375, -0.06219724, -0.1614772, -0.07498081, -0.4727252, -0.39419348, 0.83772287, -0.14882572, -0.34527889, 0.50879943, -0.01004583, 0.00207072, -0.17747884, -0.09487019, -0.56562003, 0.50512382, -0.55184357, 0.41833585, -0.15333326, -0.41862171, -0.03667213, -0.06483376, -0.03447758, 0.08807429, -0.54246274, 0.24342099, -0.12868965, -0.09222031, -0.62142009, -0.53745467, 0.26243811, -0.15849904, -0.39114068, 0.2249857, -0.43757701, -0.73408857, 0.04845447, 0.20181919, -0.51523017, 0.04776046, -0.27121923, 0.19336688, 0.02102174, 1.85839199, -0.25379031, 1.18061153, -0.61909411, 1.25435584, 0.8259441, 0.28736397, -0.64972916, 0.97577725, -0.05195807, -0.8278123, -0.04442319, 0.02589251, -1.17398796, 0.54047419, -1.66681676, 0.23686338, 0.25139518, -0.16800947, 0.10911162, 0.32916197, 1.20066286, -1.38081226, 0.0834085]);
  const b2 = new Float64Array([0.22839199, -0.06869452, 0.28456833, 0.07599486, -0.15410599, -0.27936628, -0.26019183, -0.26696157, -0.17444879, -0.00980512, -0.1870744, 0.05553892, 0.12065706, 0.16295789, 0.15797137, -0.00691717]);
  const W3 = new Float64Array([0.40534857, -0.90793936, 0.3325431, -0.34009484, 0.05819459, 0.50365571, -0.8798512, -0.53267366, -0.52592731, 0.98219583, -0.36927924, -0.19925158, 0.77553604, 0.69315608, 0.61338876, 0.12301313, -0.00091092, -0.00122856, 0.00108022, -0.0002136, 0.00028832, -0.00148943, -0.00076635, 0.1210248, 0.00146162, 0.00260385, 0.00121324, -0.00085099, -0.00041146, -0.06056726, 0.10921337, 0.00139551, 0.00521299, 0.00228777, -0.00650049, 0.00045195, -0.00026342, 0.00058552, 0.00326363, -0.13249789, -0.00517233, -0.00491634, -0.00150322, 0.00016704, 0.00208288, 0.1582026, -0.31062787, -0.00434516, 0.00315715, 0.00046297, -0.00316454, -0.00037269, 0.00111673, -0.0018535, -0.00026883, -0.01272536, -0.00164658, 0.00032673, 0.00079463, -0.0015404, 0.00039479, 0.03332332, -0.09674194, 0.00017231, 0.45638725, 0.53459894, -0.14289287, -0.44480918, -0.54465852, 0.85056455, 0.2291249, -0.6785143, -0.28156744, 0.34240435, -0.04632177, 1.02117878, -0.07190558, 0.6873022, 0.95163175, 1.52251458]);
  const b3 = new Float64Array([0.29324723, 0.0739221, 0.01674306, 0.05172712, 0.30922134]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([-0.37367955, -0.35655271, -0.20250552, -0.34481252, -0.09999207, -0.00379505, -0.0184631, -0.46863095, 0.75725387, -5.56230644, -0.10896188, 0.15297558, -0.07864012, 0.38746442, -0.11763881, -0.00024774, 0.18476201, 0.01598787, -0.14243465, -0.19989418, 0.39618945, 0.71850921, 0.01053419, 0.12605924, -0.46636395, 0.39170941, 0.12634164, 0.06641563, 0.47845474, -0.01313837, -0.08148162, 0.54502727, -0.1764148, 0.61669693, 0.20005133, -0.17687406, 0.69256141, -0.01875002, 0.56533594, -0.07870909, 0.00186146, 0.60913202, -0.19844768, 0.19290289, 0.08998624, -0.14195802, 0.07428855, 0.30363257, 0.39243164, 0.18022127, -0.00272998, 0.91734827, -1.10212008, -1.37015113, -0.08101384, 0.10213716, 0.86257978, -0.67292438, 0.63858139, 0.25765421, -0.43942791, -0.32244815, 0.98060971, 1.96213201, 0.02376881, 0.31505169, 0.96824986, -1.68711116, 0.61034008, -0.20836064, -0.3895434, 6.72936062, 0.38123824, 0.41431277, 0.53324557, 0.97596945, 4.53033208, 0.65570391, 0.39096668, 0.681621, 0.269472, 1.40211212, 0.79839522, 0.13178913, 0.60215126, -0.70030552, -0.04554696, 0.46055073, 0.04508601, 0.20535651, -0.12727416, 0.19360687, 0.20414665, 0.4604987, -1.29870183, -1.85396709, 0.01555748, 0.75731396, 0.40710334, 0.46626982, -0.68093211, 0.21134125, 0.0396087, -0.28116609, -0.42211123, 0.13349404, -1.19753039, -1.2921438, 0.39829841, 0.12484378, 1.01845594, 1.31458948, -0.44088747, 0.59211759, 0.61404855, 0.66642877, 0.44078828, -0.97065452, -0.34028084, 0.06517759, 1.09645698, 0.12170389, -0.47970173, 0.15599535, -0.1598288, 0.34552495, 0.20994686, -0.24241985, 0.26566471, 0.09404231, -0.00185984, -0.81831437, -0.19537278, -0.26085131, -1.08576424, -0.25281467, 0.04222919, -0.02200046, 1.19190821, 0.19308774, -0.98198101, -0.67181255, 0.04610372, -0.39923057, -0.71626144, -0.5321834, 0.59444319, -0.55059216, -0.16036236, 1.5852253, 0.32265167, -0.82676289, 0.32637174, 1.19828749, -0.09963534, -0.24286612, 0.18423258, 1.65997562, 0.43896263, 0.25142909, 0.05714172, -0.99009309, -0.36277681, 0.17678746, 0.17065356, 0.2999573, -0.51305639, -0.31900132, -0.38967836, -0.14481157, 0.53511676, -0.25737027, -0.08766127, 0.19116151, 0.31669896, -0.14177168, -0.02731271, 0.28196278, 0.45748175, -0.40196382, -0.00271061, -4.2760882, 0.50166892, 0.47782012, -0.2335934, -0.2096391, -0.08637055, 0.35546883, -0.27549609, -0.47947386, 0.02405826, 0.10702495, -0.97608948, 0.63812046, 0.09055079, 0.09075505, 0.67105247, -0.46830954, -0.00370852, 0.67238786, -0.07310662, -0.47338603, 0.48125339, 0.22048789, 0.06709343, 0.54923078, 0.27169977, -0.02955572, 0.66595845, -0.39870067, 0.33382914, -0.71592502, 0.1115227, 0.56116495, 0.36052893, -0.44526205, -0.05939491, -0.04559796, -0.12845957, -0.27877536, -0.09645798, -0.2513095, 0.1988506, 0.88071396, -2.8585234, -0.1656975, -0.22059098, 0.80286704, 0.92415699, -0.08535674, -0.00570063, 0.43308276, 0.24646164, -0.30896173, -0.17709841, -0.16859489, -0.15774939, -0.05108047, -0.76321227, -0.46590614, 0.84741596, -0.3566829, 0.00479685, 0.79825508, -2.21178896, -0.58848294, -0.16492905, -0.23970558, 1.07348152, -0.22593733, -0.47028359, -0.36294249, -0.72077299, 0.41848149, 0.50949535, -0.26921403, -0.45160998, 0.07504819, 0.08655836, 0.30108809, 0.40760542, -0.09314225, -0.18551259, 0.36098076, 0.08008493, -0.17594103, 0.3667882, -0.44959867, 0.94495331, 0.87365067, -0.73656855, -0.31275431, 0.51375214, -0.31321416, -0.61473491, -0.0932328, 0.04089805, -0.11793739, -0.52247519, -0.01954783, 0.04350873, 0.12541805, 0.3495806, -1.01111869, -0.0974116, -0.1912975, 2.49225844, 0.22999173, 0.23385168, -0.82609385, 1.22146573, 1.4350237, 0.31956772, 0.14606169, -0.42307349, 1.24482024, 0.68868796, -0.33224636, -0.03911759, -0.17637863, 0.79316499, -0.2576309, -0.08840788, 0.11548682, 0.05044824, -0.06249549, -0.35326178, -0.14798324, -0.58278107, 1.20958241, 2.59958687, -0.02749967, -0.30519525, -0.45608573, -0.86478838, 0.03342703, -0.09224473, 0.46655865, -0.06266845, 0.5347212, -0.20895469, 1.66416341, -1.4152917, -0.60786259, 0.55932773, 0.38941846, -0.68389871, 0.03803172, 0.17996907, -0.34566564, 0.2400251, -0.10166361, 0.08876131, 0.53118647, 0.40190514, -0.25326954, -0.08875649, 0.08922969, 0.74948099, 0.13952352, -0.41164292, -0.11052886, 0.12421492, -0.08321668, -0.39260526, 0.36233751, 0.4535305, -0.47458518, -0.02055333, -0.44815799, 0.17378572, 0.01454993, -0.3984546, -6.08163587, 0.08393767, -0.0802907, -0.28299343, 0.1077149, 0.6893537, -0.29118718, 0.09575081, 0.69732582, 0.08771233, 0.18128787, 0.67841872, 1.03419939, 0.11464642, -0.64055245, -0.58039127, -1.5393959, 0.66563946, -0.00675712, 0.27619461, -0.01867601, 0.17199815, 0.73896864, -0.49929605, -0.24071797, -0.7735635, 0.36787024, 0.57473598, -0.51470644, 0.10868302, 0.18825567, 0.1433809, 0.44983215, 0.3110922, -0.25781091, -0.01701182, -0.39485142, -0.39225882, -0.4238235, -0.60147618, -0.35322348, -0.15462529, -0.86085885, 0.25426956, -0.48359618, -0.35139001, -0.51315284, 0.05513217, -0.14865726, -0.04124857, -0.4791491, -0.37826954, -0.09199109, 0.0408116, -0.71096745, 0.47174394, -0.11793403, -0.4191609, 0.4345681, -0.70465425, -0.40856462, 0.0919282, 0.89103857, 0.59984947, 0.57940104, -0.00256685, -0.76798229, 0.20545285, -0.19435572, 0.21449673, 0.37891476, -0.73462311, 0.18232847, -0.2191685, -0.17950424, 0.34939034, -0.21671032, -0.14725652, 0.12579731, 0.22736849, -0.4166054, -0.05767994, -0.46284717, -0.24598771, -0.13211549, 0.43400898, 2.46541811, -0.13484735, -0.46557604, 0.1443944, -0.75097079, 0.08695359, -0.27418249, 0.27396717, 0.49244486, 0.15266717, -0.04167017, 0.19010627, -0.41786312, -0.50348014, -0.38997942, 0.00378595, 0.11517839, 0.44369593, -0.54882049, 0.45807867, -0.27621376, -0.10687869, 0.27263099, -0.33355399, 0.03720111, 0.41795753, -0.30067931, 0.12384626, -0.45012036, -0.06015577, 0.46563994, -0.14275769, 0.43840605, -0.56701322, 1.00767277, 0.0803451, 0.0447841, -0.07561186, 0.28511836, 1.11742957, -0.51139321, 0.33867884, -1.17233547, 0.87519597, -0.07655837, -0.03732289, 1.72099088, -0.34952614, 0.60401773, 0.07677419, 0.33020227, -0.60501811, -0.15547007, 0.03979151, -1.40981826, 0.07536672, 0.84747206, -0.80652364, -0.88702868, -0.88839648, 0.91457139, -0.32258107, -1.39670974, -0.86226824, 0.27821097, 0.09137227, -0.71161177, -0.63268748, -0.76203644, 0.03391525, 0.33700284, -0.56546525, -0.27671503, -0.20754898, 0.43492654, -0.26994894, 0.07466348, -0.27469881, -0.30835253, 0.57311595, -0.19135086, -0.00758429, 0.12949078, -0.16737298, -0.06388467, 1.41276559, -1.67826086, 0.11256297, -0.32221906, 0.43195997, -0.73009905, -0.39425429, -0.47782929, 0.11098235, -0.43118211, 0.37777208, -0.24384072, -2.00377526, -0.51397144, 1.02314473, -1.30342489, -0.40097514, 0.21788535, 0.27843285, 0.25252678, 0.70999984, -0.39310426, 0.40489407, -0.03706699, -2.5781379, 0.99043761, 0.28416039, 0.13143118, 0.10564484, -2.33127565, -0.17048388, 0.17486396, -0.0031519, 0.01805415, -1.19640746, -0.30936341, 0.15886225, -0.484087, -0.08683084, -0.052608, -0.52811952, -0.65461897, 0.22361188, -0.38490041, 1.99846423, -0.88974626, -1.36016117, -0.49243242, -0.66310326, -0.65699192, -0.79859392, -0.7749947, -0.05590271, -0.60458855, -0.58833825, 1.03412362, -0.22991797, -0.87396657, -0.6471435, 0.02844965, 0.27442076, -0.36558448, -0.44646803, 1.12875554, 0.02185584, -0.15329332, -0.07330369, -0.57722641, 0.29980512, 0.3628283, -0.22857184, 0.37883553, -0.43993042, 0.23424024, -0.0569633, -0.01990152, 0.60615148, -0.46456648, 0.36658781, 0.78312321, 0.3605576, 0.23405065, -0.36872698, 0.16792231, -0.12076227, 0.47399395, -0.10557934, -1.43560677, -0.34419375, 0.01495153, 0.03885159, -0.24674312, 0.23616006, 0.31404975, 0.21750481, -0.23447034, -0.03676641, 0.61439293, -0.18655758, -0.8651777, 0.11925246, 0.32495045, -0.20426155, -1.05076869, -0.21879875, 0.01617589, 2.70643336, 1.85281517, 0.48081075, -0.32559781, 1.68891186, 0.77603167, 0.51296821, 0.42898649, 0.02403734, 1.43319528, 0.57855442, -0.39464524, 0.74732705, -0.09617027, 0.78749603, -0.41332401, -0.28330427, -0.32226869, -0.14388052, -0.14778918, -0.44224577, -0.03196901, -0.26794169, 0.68220969, 3.34307011, 0.24847419, -0.42382943, 0.13333863, 0.43854206, -0.02462593, 0.00078187, 0.1077558, 0.23829599, 0.31174832, -0.0336766, 0.27630817, 1.44303172, -0.00855537, -0.35891216, 0.82465093, -0.03742278, 0.06036493, -0.52377809, -0.40656264, 0.82444246, -0.61697638, 0.67558564, 0.35191594, -0.5282224, 0.08434215, -0.2426511, 0.09583508, 0.48456962, 0.06679809, -0.40040208, -0.14114741, -0.0809227, -0.63092641, -0.25910505, -0.08592117, -0.06482869, -0.1376199, -0.09884876, 0.14393889, 0.08368564, -0.3665201, 2.16754599, 0.09285028, 0.00570206, -0.11009174, 0.23646948, -0.06039455, -0.23766702, 0.02402643, -1.0695568, -0.71394596, -0.89580276, 0.10851547, -1.86642874, -2.81318044, 0.71277625, -0.46263081, 1.2825585, -1.55471817, -0.26411604, 0.10458911, -1.48794279, 4.07206127, 1.31527352, -0.04915247, -0.52165964, -1.31206989, 0.64806435, 0.21286685, 0.17138245, 0.0345549, -0.72553987, -0.23402846, 0.64149571, 0.05777905, -0.25660845, -0.3842559, 0.03229333, -0.16330155, 0.32827579, 0.13020282, 0.14202244, 0.01069589, 0.19832888, -0.93914962, -1.88289994, -0.33112048, 0.34987486, 0.11804352, -0.01903019, -0.17841263, -0.18961072, -0.26241155, -0.8174164, -0.30740354, -0.50447569, -0.41903202, -0.43410489, 0.16935845, -0.02955339, -0.17022146, -0.77974612, 0.23589389, 0.47154188, 0.25611629, 0.89312216, -0.0613999, -0.15859704, -0.15004505, -0.41511767, 0.46238897, -0.09387331, -0.40414429, 0.19147374, 0.1022777, 0.49361063, 0.14043876, -0.43516633, 0.7815562, 1.21948261, 0.79322107, 0.0776158, -0.27952406, 0.01147481, 0.77572859, -0.11681408, -0.06998583, -1.11363813, 0.54957064, -0.54022562, -0.46586264, 0.60722995, -1.64414979, 0.45673288, 0.46779158, -0.06719015, -0.55520683, 0.32890803, 0.78577772, -2.6444638, -2.90255869, 0.36102429, -0.0334389, -1.58583811, 0.27455064, -0.30671148, -0.97595235, 1.72980814, 1.02317419, 1.80727898, 0.18082774, 0.94389273, 0.11869972, -0.43875856, 1.16373003, 0.07606694, 0.61445033, -0.51274564, -1.01994078, 1.04995413, -0.21807333, 0.80522455, -0.34545427, -0.27150112, -0.71709678, -0.2013548, -0.57043752, -0.51418037, -0.6807708, 0.02921568, -0.39214251, 0.23959787, -0.74707022, 0.42279153, -0.45915771, 0.7834428, 0.14834117, -0.50917047, 0.30374902, 0.84473329, -0.26804779, -0.5402964, -0.77252725, 2.51228808, -0.45100941, 0.55281235, 0.88084719, 0.62645937, 0.76525407, -0.20325039, 1.02253575, 6.13240714, 0.65163466, -0.42165712, 1.21040695, -1.04166048, 2.15892272, -0.1828163, 0.29330258, 2.68353962, 1.17765899, 0.84806436, -0.11848513, 0.21901076, 0.55115811, 0.38551364, -0.06697084, 0.16517862, 0.1283943, 0.64718835, -0.47028789, 0.3972625, 0.52069881, -0.93649364, -2.08205695, 0.09803816, 0.36423555, -0.11349227, 0.92488823, 0.08206258, 0.50652821, -0.42065908, 0.10856862, -0.0654208, -0.1372549, 0.49674405, 0.38003519, 0.60424828, 0.32020323, -1.57378214, 0.51755184, 0.39012964, 0.50056123, -1.49999621, -1.3814717, -0.06494532, 0.08884502, -0.50213344, -0.4514629, -2.0837348, 0.25719078, -0.13371639, -0.51934369, -1.20131608, -0.01717315, 0.13690821, -0.7813616, 0.11606223, -0.54944106, 0.00886557, 0.15375807, -0.32474046, 0.05596555, -0.14689821, 0.02835635, -0.28388456, 0.21699988, -3.48653378, -0.39647272, 0.40088006, 0.01416231, 0.18881201, -0.05630252, -0.12417696, 0.7780627, -0.35005511, -0.0427732, -0.01765561, -0.81225087, 0.37245777, -0.14276719, 0.03233728, 1.186064, 0.17462922, -0.51487399, 0.60124582, 0.33224874, -0.05486804, -0.11303612, 0.13779535, 0.13642379, 0.39657825, 0.23303783, -0.1261119, 0.04866497, 0.15551102, 0.96474035, -0.53098741, -0.03982736, 0.72189164, 0.53049708, 0.75787783, 0.09097524, 0.01830308, 0.39389232, 0.27012072, 0.54644018, 1.12601875, 0.01968803, -0.45336743, 3.13538151, 0.28449194, -0.14325775, 0.23172357, -0.1098143, -0.43297551, 0.55169826, -0.29991348, 0.1422041, -0.20385603, 0.58512631, -0.93381751, -0.38023049, 0.18913321, 0.76018968, 0.43824838, 0.33898552, -0.40985546, 0.2983509, -0.52846436, 1.24588521, 0.33262407, 0.14892457, -0.00878468, -0.6532851, 1.70561891, 0.22941184, 0.37914114, -0.22506072, -0.3429072, 0.83438116, 0.31039006, -0.12009891, -0.76953382, 0.16039463, 0.22640251, 0.66662906, -0.01887328, 0.00694876, 1.14695765, 0.11555568, 0.30689163, -0.58892017, -0.63082043, -0.58159424, -0.42239301, 0.12747927, -0.9863424, -0.27425589, 0.12827138, -0.37054683, -0.17097179, -0.3826806, 0.10933824, 0.00680591, -1.96163135, -0.05833431, -0.44803859, 0.95302928, -0.65686424, -0.4095714, 0.05578588, -2.64474972, -2.04286411, -0.46660226, 0.7275184, -0.50159665, -1.07010678, -1.1152038, -0.10196977, 0.17893571, -0.49192931, -0.86016558, -0.36944581, 0.30919506, 0.5008314, 0.72367374]);
  const b1 = new Float64Array([-0.22109897, 0.21784641, 0.2099804, -0.01431288, 0.01443251, -0.13592099, 0.01625457, -0.22994792, -0.08768779, -0.20622678, -0.08855239, 0.29967456, -0.1238973, -0.1281671, 0.1176462, -0.18593962, -0.14445972, 0.04660619, 0.14119252, -0.27189766, 0.32998061, -0.1620127, 0.29943027, 0.21876492]);
  const W2 = new Float64Array([0.62871994, -0.23432196, 0.1638401, -0.02876664, -0.53018742, -0.33625674, -0.57872319, -0.22037016, 0.73451219, -0.40192462, -0.0759618, 0.26670821, -0.21580192, -0.05525081, -0.14918828, -1.01518117, -0.16226877, 0.48775536, 0.15665141, -0.34170622, 1.15426584, -0.43399239, -0.75897101, 0.26519989, 1.20422542, 0.08170176, 1.18619573, -0.38288927, 0.61522501, 0.3637301, 0.39878735, -0.42862798, -0.0693727, 0.18749291, -0.28314584, 0.04718683, 0.37374164, -0.02201248, 0.89578048, -0.70696951, -0.02876644, -0.05623654, 0.69700148, -0.7503903, 0.06983855, 0.60596989, -0.09549831, 0.75364485, 0.56362842, -0.43302427, -0.08916726, -0.51480718, -0.45242222, 0.01954209, -0.18437553, -0.65542767, 0.2194854, -0.34732287, -0.18522718, 0.88165975, -0.44657291, -0.10778114, -0.26238677, -0.02297598, 0.39602011, 0.45395579, -0.6899758, 0.38131482, 0.57091053, 0.066329, -0.36989006, 0.82658197, -1.63366195, 0.36497267, 0.34733624, -0.12843518, -1.03590799, -0.56667242, -0.12209489, 0.78249159, -2.08303374, -0.04533514, -0.10945963, 0.14038298, -0.47347597, 0.29987462, -0.90393001, 0.81027367, -0.33941072, 0.19884969, 0.87522396, 0.31868622, -0.76946276, -0.41073882, 0.85722686, -0.08545006, -0.76992487, -0.28677609, -1.00313245, 0.12783386, 0.1728436, 0.71473843, -0.13000031, -0.3506244, 0.70088959, 0.39668922, -0.32374849, -0.18658476, -0.08292243, 0.61407854, 0.28687968, 0.2218216, 0.59732168, -0.54776628, 0.16244402, 0.28739754, 0.02546341, -0.57378135, 0.51422093, -0.04858902, 1.48390453, -0.29267222, -0.64645552, 0.03048756, 1.05157142, 1.02253859, -0.09612965, 0.54486893, 1.28959578, -0.13649375, -0.05160025, -0.65083979, 0.40404193, -0.33511861, -0.09092869, -0.3677296, 0.39543597, -0.21703855, -0.90983508, 0.04372587, -0.12645913, 0.07219552, -0.33401422, -0.36758765, 0.20412845, -0.03120644, -0.19770311, 0.21733562, 0.13249198, -1.32034804, 0.75509697, 0.86478052, 0.19214225, 0.65416862, -0.08484749, -0.48412836, 0.21602274, 0.40148529, 0.07746418, 1.20552888, 0.12446551, -0.18972528, -0.05912647, 0.9071618, -0.62578433, -0.25459306, 0.40782904, -0.57428862, -0.0146803, 0.07395741, -0.28007471, 0.47914321, 0.27209217, 0.45318785, -0.8891784, 0.40002671, 0.26753086, 0.44076367, 0.52338638, 0.25003771, 0.39197833, 0.67447595, -0.17805398, 0.17617213, 0.51446866, 0.05797459, 0.09213482, -0.04050456, -0.54425384, 0.14625782, -0.13016084, -0.06444231, -0.51173997, 0.36801052, -0.11309571, 0.96104328, -0.19204557, 0.33726989, -0.53374999, 0.04529358, 0.15277142, 0.509849, 0.79062068, 0.46222685, 0.11433892, 0.79516821, 0.48694495, -0.27891788, -0.5640859, -0.37453234, 0.95299259, -0.87792412, -0.17750971, 0.07672105, 0.45044506, -0.4650693, 0.11755519, -0.58801966, 0.02937998, -0.07457529, -0.86983507, -0.81564126, -0.28426075, 0.36887063, -1.01572975, 0.1387897, 0.3240348, 0.67284089, -0.12052952, 0.00017316, -0.27948332, 0.22913473, 1.1587979, -0.27556149, -0.72228271, 1.23196424, -0.13795553, -0.27720337, -0.30195832, 0.11117176, 0.50040679, 0.37146036, -0.01272207, 0.19529276, -0.0893127, -0.01296985, -1.17371716, -0.20753321, 0.63750495, 0.06666584, 0.38655746, 0.12943873, 1.85012517, -0.09761697, -0.36663912, -0.13691638, 0.77991756, 0.02309491, -0.06852533, -0.14767018, 0.23811651, -0.30330243, 0.15740664, 0.20393993, 0.10006965, 0.02428588, -0.17089029, -0.2135282, -1.08893392, -0.18072822, 0.32709689, -0.24801017, -0.58125944, -0.16589336, 0.32505254, -0.40353177, 0.10040854, 0.00732609, -0.11548299, 0.05065486, -0.66076333, -0.22312989, -0.82135787, 0.38276637, 0.08453765, -0.33883814, -0.38727332, -0.31059584, 0.44577625, -1.44292495, -0.04086017, -0.39701687, -0.09360024, 0.41855149, -0.28613669, 0.429119, 1.17012127, -0.14792799, -0.01587281, -0.12621984, -0.43948346, 0.1776941, -0.68006552, -0.08795923, -0.7379923, -0.31054717, -0.85467817, -1.20917699, 0.50664544, 0.27581075, -0.75773291, 0.98767151, -0.3112697, -0.14864131, 0.35068664, -0.33054521, 0.34524341, -0.40444375, -0.06219724, -0.1614772, -0.07498081, -0.4727252, -0.39419348, 0.83772287, -0.14882572, -0.34527889, 0.50879943, -0.01004583, 0.00207072, -0.17747884, -0.09487019, -0.56562003, 0.50512382, -0.55184357, 0.41833585, -0.15333326, -0.41862171, -0.03667213, -0.06483376, -0.03447758, 0.08807429, -0.54246274, 0.24342099, -0.12868965, -0.09222031, -0.62142009, -0.53745467, 0.26243811, -0.15849904, -0.39114068, 0.2249857, -0.43757701, -0.73408857, 0.04845447, 0.20181919, -0.51523017, 0.04776046, -0.27121923, 0.19336688, 0.02102174, 1.85839199, -0.25379031, 1.18061153, -0.61909411, 1.25435584, 0.8259441, 0.28736397, -0.64972916, 0.97577725, -0.05195807, -0.8278123, -0.04442319, 0.02589251, -1.17398796, 0.54047419, -1.66681676, 0.23686338, 0.25139518, -0.16800947, 0.10911162, 0.32916197, 1.20066286, -1.38081226, 0.0834085]);
  const b2 = new Float64Array([0.22839199, -0.06869452, 0.28456833, 0.07599486, -0.15410599, -0.27936628, -0.26019183, -0.26696157, -0.17444879, -0.00980512, -0.1870744, 0.05553892, 0.12065706, 0.16295789, 0.15797137, -0.00691717]);
  const W3 = new Float64Array([0.40534857, -0.90793936, 0.3325431, -0.34009484, 0.05819459, 0.50365571, -0.8798512, -0.53267366, -0.52592731, 0.98219583, -0.36927924, -0.19925158, 0.77553604, 0.69315608, 0.61338876, 0.12301313, -0.00091092, -0.00122856, 0.00108022, -0.0002136, 0.00028832, -0.00148943, -0.00076635, 0.1210248, 0.00146162, 0.00260385, 0.00121324, -0.00085099, -0.00041146, -0.06056726, 0.10921337, 0.00139551, 0.00521299, 0.00228777, -0.00650049, 0.00045195, -0.00026342, 0.00058552, 0.00326363, -0.13249789, -0.00517233, -0.00491634, -0.00150322, 0.00016704, 0.00208288, 0.1582026, -0.31062787, -0.00434516, 0.00315715, 0.00046297, -0.00316454, -0.00037269, 0.00111673, -0.0018535, -0.00026883, -0.01272536, -0.00164658, 0.00032673, 0.00079463, -0.0015404, 0.00039479, 0.03332332, -0.09674194, 0.00017231, 0.45638725, 0.53459894, -0.14289287, -0.44480918, -0.54465852, 0.85056455, 0.2291249, -0.6785143, -0.28156744, 0.34240435, -0.04632177, 1.02117878, -0.07190558, 0.6873022, 0.95163175, 1.52251458]);
  const b3 = new Float64Array([0.29324723, 0.0739221, 0.01674306, 0.05172712, 0.30922134]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
