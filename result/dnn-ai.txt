function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.01353763, 0.33004579, 0.00822616, 0.35886842, -1.8043078, -0.28737237, -1.0453292, 0.24874919, -0.10174036, -1.11253133, 0.08927255, 0.28386112, 0.40620077, 0.46601179, -0.36965952, -0.7883053, -0.52672495, 0.14665191, 0.94482201, -0.22358885, 0.88238582, -0.31405656, -1.23027474, 0.24459965, 0.35644041, 0.45450046, 0.22327586, -0.41711781, 1.07324058, 0.14492001, 0.66761213, -0.88113821, -1.00930285, -0.02323608, 0.3485386, 1.12997017, -0.38948433, -1.50377966, -0.20525646, -0.26115277, 0.55535867, 0.98115912, 1.14310444, -0.08293662, 0.60836983, 0.16594984, -0.08123755, -0.29320216, -0.52253673, -0.50471543, 0.91532098, -0.83047454, 0.70283846, 1.33374397, -0.21118957, -0.9244585, -1.42482559, 0.88322182, 0.2929653, -1.51227091, 0.01202583, -0.62201216, -0.36549951, -0.36860756, 0.30137762, -1.05455404, -0.88196043, -0.19761823, -1.67982454, -0.80329458, -0.57782571, 0.16502944, 1.16107027, 0.6895862, -0.30984632, -0.34606926, 0.21010942, -0.31738846, -0.84660976, 0.41070288, -0.32580529, 0.21973769, 1.12284974, 1.10679773, -0.03820944, 0.80354207, -0.04363122, -0.40746628, 0.10703161, 1.83956862, -0.39698054, -0.95863469, -0.22049276, -0.68196694, 0.47033164, 0.11297586, 1.07466775, -1.13625291, 0.14936161, 0.73538546, 1.34063303, -0.11588482, 1.28566019, 0.69886582, -0.299315, -0.735367, -0.82077065, -1.96054824, 0.46425557, 0.62114962, 2.15340803, 1.68387003, 0.62807547, -0.56508205, -1.56955429, -0.45706567, -1.06938015, 0.6750363, 0.93741609, -1.01710549, -1.8473554, -0.34364676, -0.76717197, -0.19704449, 0.24256599, -0.55460014, -0.97617686, -0.44756122, -1.02536779, 0.66638365, 0.46005452, 0.24310196, 0.86563037, -1.2290433, -0.00113239, -1.15364606, -0.87377765, 1.6713482, 0.52855141, -0.17363456, 0.91696888, -1.10985885, -1.5243074, 0.9761965, 0.31145549, -0.58665213, 1.22871917, -0.59877613, 0.65385255, -0.92051302, -0.2711693, 0.22297875, -0.8978512, -0.14816036, 0.51428622, -0.39897055, 0.43804816, -0.91959658, -0.26208953, -0.29252112, -0.64102587, -0.17579119, 0.90543102, -0.17870907, 0.42985301, -1.90492336, 0.01802391, -1.36326535, -0.3144239, -0.19380372, 0.26309362, 0.87697086, 0.47192111, 0.1949243, -0.2468271, -0.28650022, 0.15104356, -0.861016, 0.32493731, -0.50074332, 0.25153338, 0.8328458, 0.34134375, -0.31576444, -0.03568048, -0.38104081, -0.47314062, -0.28784945, -1.19867547, -0.79143758, 0.90188296, 0.38034246, -0.47631209, -0.89336872, -0.41036732, -0.48138741, 1.09583185, -0.99661435, 0.08076235, -0.49414971, -1.22027001, 1.56720959, 0.08880457, 0.75347388, -1.75220911, -0.33509859, -0.91128483, 0.27891256, 0.13860914, 0.17900179, 0.8122974, 1.33074093, 0.59727895, -0.18771788, 0.35020193, 1.03713473, -0.48408231, -0.64742854, -0.65957732, 0.56555961, -0.01060409, -0.59797346, -1.05377489, 0.26839501, -0.32737094, 0.14230516, -0.37118777, -0.19830392, 0.47338522, 0.40227788, -1.37520557, 1.4363408, -0.87528554, 0.05729977, -0.5434167, 1.60246163, -1.13718579, 0.08578295, -0.33596302, -1.8826895, 0.18656253, -2.93147655, -1.82463798, -0.94091564, 0.50760705, -0.7890835, -0.62621456, -1.34781718, -0.79295788, 0.71804484, -0.06598897, -0.05808285, -0.08141327, -1.93631289, 0.27288844, -1.06419151, -1.63321224, 0.1701352, -0.9013602, 0.29463475, -0.63456307, 0.07824167, 1.37120164, -0.40002507, -0.60511997, 0.2689902, 0.04597612, -0.41143101, 1.58415349, -2.43439951, -0.83129515, -0.2529449, 0.04291178, -1.00371506, -0.21624652, -0.14257832, 0.17296709, -0.12851589, -1.39841487, -0.99308546, -1.72815296, -1.29411529, 0.39527531, -0.74653114, -0.85842851, -0.01747029, -0.30605403, 0.42024614, -0.24371279, 0.68022871, 0.47450622, -0.40783863, -0.25584687, -0.91955627, 0.81593108, -0.46059048, 0.50886525, -0.70145985, 0.37938827, -0.0998973, 0.80061903, 0.13207972, 0.07266292, -1.14253882, 0.60273412, 0.50173371, -1.72907423, -0.15339819, 0.41576297, 0.84295162, -0.83613549, -1.12048261, 0.58126163, 0.99710691, -0.01646309, -1.16660096, 0.38705826, 1.70153535, 0.02727584, -0.16799862, -0.36408064, 0.07791623, -0.31789771, -0.007193, -0.6430638, -1.12449685, 0.7891154, -0.24357575, 0.19557035, -0.05439458, 1.24705975, 1.20973283, 0.36633439, 1.28412419, -0.25684119, 0.89556026, 1.04482913, 0.19260308, -1.7103272, -0.14829397, 1.4270135, 0.23366284, 0.13620669, 0.34447991, -0.37962617, 2.47950023, -0.20932541, 1.11942843, 0.83462928, -0.42820488, 1.29229121, 0.09469087, -0.42387939, -1.62349615, -0.83591992, 0.12298494, -0.53489658, 0.72756261, 0.38510085, -0.60442851, -0.67783326, -0.11256074, -0.89013123, 0.02775493, 0.60432029, -0.73807407, 0.31089978, 0.88021578, -0.5026667, -1.5279745, 0.39883845, 1.40364461, -1.19497576, 1.35951285, -0.07658098, -0.02113873, 1.02044114, 0.39347002, -1.06690989, 1.09797369, 0.58155837, 0.3028738, -0.88253536, -0.38626964, 2.11092549, -0.64696919, 0.36342441, -0.26248011, -0.92060058, -0.03358354, 1.31767736, -1.49901898, 1.95655645, -0.46726006, 0.37177961, -0.34350788, -0.27663622, -0.81936785, 1.30580043, 0.86094474, -0.2773493, -0.59054939, 3.37515957, 0.00940809, 1.18891187, -0.83915445, -1.0685727, 0.39880899, 0.65391805, 1.31192557, 0.47820242, -1.14756935, -0.73953691, -0.17785303, 0.54325952, -0.9192833, -0.54161194, 0.433652, 0.04882988, 0.52501944, 0.5940361, 0.45584547, -1.3232963, -0.03810959, -0.88891145, -1.81903104, 0.19025916, 0.95983911, 0.03045051, -0.55432255, 2.03470434, 1.28866079, 0.27879056, 0.94065308, 0.71351668, 0.21981579, -0.88403057, 0.44617074, 0.01738964, -2.08127998, -1.19496811, -0.66561216, -0.72493995, 1.09988579, -0.4135468, 0.08857152, -0.05203288, 0.6249899, -1.22359741, 0.58312852, 0.10478994, 0.4513955, 0.88894505, 0.82011591, -2.17584612, -0.96862101, -0.36922893, 0.1650896, 0.26820634, 2.10671904, -0.03665456, -1.27609059, -1.47058312, 0.71920294, -0.19835522, -0.88089632, 1.62586673, 1.97167109, -0.50472787, -0.59846377, 0.91871982, 1.12659493, -0.79233935, -0.35904759, 0.23787154, 0.28275118, -1.26777857, -1.33518839, 0.14652714, -0.19810054, -0.95455203, -0.95850448, 0.55588354, -0.55020351, 1.38334709, 1.11369773, -0.54884052, -0.77168292, -0.55468131, -0.98166333, 0.2563449, -0.81293219, 0.2951542, -0.03110814, -0.72873402, -1.62959823, -1.15859875, 0.06083274, 0.14124272, -0.8184945, 0.28423672, 0.52048695, -0.04103425, 1.78710824, -0.14592822, 0.21848889, -0.08227564, -0.21762868, 0.08389486, -0.61639157, 1.18522209, 0.50670967, 0.56782973, -0.76316632, 0.06394491, -0.82670245, 2.23858176, -0.46628851, -0.961605, 1.06560819, -1.35179779, -1.01563361, 1.17578018, -0.70350101, 0.45990498, 1.87333076, -1.0318943, 0.61502059, 0.00653848, -0.05961907, -1.30829462, -2.06287894, -0.2454776, -0.82224822, 0.18908161, -1.06871801, 0.02792408, -1.23603097, -0.60452983, -0.81519541, -0.97303824, 1.50324211, 1.5601864, -0.39084941, -0.20388797, 0.2796566, -0.24204798, 0.7810208, -1.67772718, -1.35091061, -0.42328995, 0.61189013, 0.29815532, -0.05999768, 0.60308285, -0.80656043, 0.6945748, -0.45935382, -1.04975775, 1.17191653, 0.02270975, -0.80137794, 0.06882234, -0.52399749, -0.10259893, -0.22645157, -0.13349001, -0.63448583, -0.39926832, 0.26909307, -1.47855374, 0.80809594, 0.40510109, 0.25790394, -0.25019665, 0.25188169, -0.09530154, 1.06564047, -0.93125429, -0.76430469, -0.08740516, 0.32870052, 0.42334882, -1.53016779, 2.54399191, -1.28062878, -0.63207921, 1.00250408, 1.2390698, 0.43718348, -0.26344179, -1.26285751, -1.38353294, -1.19560457, 0.36403555, 1.30837566, -0.74671108, -1.08680289, -0.64096716, -1.07698792, -2.47885815, -0.6788102, -2.28634948, 0.17607594, -1.91128657, -0.34688336, 0.68977429, -1.05933711, -1.20012373, -1.24633229, 1.85759755, 0.88453415, -0.21140062, 1.85373059, -0.92836131, 0.07317612, -0.23366802, 0.12253088, -0.28590968, 0.52141721, 0.1543498, 0.27456854, -0.24960454, 0.46044237, -0.43738137, 0.47345797, -1.54742205, 1.57917609, -0.28329407, 0.5189566, 1.01688854, -0.27816722, -0.01866198, 0.54939753, -1.33931495, 1.68587293, 0.85208831, 1.22644248, 0.71163242, 0.9397495, -0.08276695, 0.47398808, -0.45569571, 0.86097458, 0.00048273, 0.20124949, 0.15013739, -1.10784673, 0.95877738, -0.78955273, -0.23631765, -0.47930061, 0.88673255, 0.70759046, -0.39689871, 1.46099923, 0.33377888, 1.1108557, 0.45788554, 0.0481544, 0.20687298, 0.11671373, -1.21880586, -0.31520967, -0.62730701, -0.66276557, 0.73131128, -0.06292041, 0.03633975, -0.90907993, 0.42428064, 0.24893022, -0.48655309, 1.08818806, -0.71592885, 0.02553074, -1.34215111, 1.20580465, 0.7892667, -0.2617037, -0.36170489, -0.38105274, -0.40079438, -0.60922555, 0.20923854, 0.49649407, 0.27576769, -0.40345314, 0.65731804, 0.26866603, -1.42493628, 0.7264225, -0.32203832, 0.36505339, -0.07521714, -0.32734552, 1.32712114, 1.26320072, -0.25948844, -1.45039225, 0.05594043, -1.17164528, 0.46281827, -0.33233146, 0.15262256, 0.27637895, -0.30329345, -0.62363844, 0.58898957, -1.90779837, 0.23901863, -2.06830301, -0.16346558, -0.59890411, -0.21634316, -1.03207702, 0.33435914, -0.48444242, -0.03396762, -0.54908697, -0.02300152, 1.14485933, 0.43642413, -1.33648919, 1.45039924, -0.68232564, -1.35017492, -0.08131544, -0.03926632, -0.04106236, 0.67553513, -0.98204592, 0.20062502, 0.12694253, -0.67060096, -0.05767077, 0.06034381, -0.52695029, 0.9873127, 1.15924799, -1.04478594, 0.51445103, -1.7733777, 0.36352996, 0.2670504, -0.44389911, -0.00951745, -1.37471798, -0.30043155, 0.45265041, -0.44108126, -0.93380974, 0.01123475, 1.04638666, 0.02761617, -0.94500398, 0.03733002, 1.42081918, -0.35939667, 0.33362599, 0.40669021, -0.11269968, 0.77173548, -0.21439775, -1.04443905, -0.13415581, -0.39751096, 0.09126597, 0.04284529, 0.05834636, 0.3982566, 0.14497739, -0.20426588, -0.55688591, -1.55756943, 1.38392311, -0.39793361, 0.26196548, -0.83255368, -1.3107868, 0.50036997, -0.82801969, -0.58475799, -1.0591635, 0.15133576, 2.04529368, -0.68842042, 0.28711827, -1.37213556, -1.34335526, 0.02993351, -1.1432537, 0.03299097, -0.40009081, 0.38683951, 0.31083133, -0.25719153, 0.50859074, -0.74614072, 0.99722077, -0.09831068, 0.66781027, -1.2738888, 0.47515389, 0.09352394, 0.9429222, 0.46048472, -1.22296615, 0.64618544, 0.6449593, -1.22759011, -0.07691448, -1.3100073, 0.20930579, 0.79554914, 1.03814966, 0.40682959, -1.73714393, -0.29190177, -0.48984985, 0.00214294, 0.91133783, 0.51477812, 1.64060769, -0.61057218, 0.95273783, -0.88578953, 1.77219631, 0.59130063, -0.32097308, -0.35905662, 0.01161622, -0.01568177, -0.88759929, -0.7713039, -0.41152533, 2.45777636, -1.58511195, 0.13247956, 0.04229733, -0.07462446, -0.9459986, 0.63875347, 0.69926503, -0.8543972, -0.39546391, 0.67162687, 1.35228365, 0.58572566, 1.75912831, 0.29326272, -1.13289563, 0.62465929, 0.98947382, -0.20522795, -2.12739971, -1.04702689, 1.18651795, -0.31853552, 0.39955208, 0.08361013, -0.95678834, -0.32676923, 0.40535131, -0.97981103, 0.94860515, -0.61414279, -0.17724566, 0.3503274, -0.76590623, 1.63489894, 0.40914546, -0.73365926, 0.30539378, 0.41657822, -1.03489467, -1.23730987, -1.30256017, -0.12196743, 1.16289091, 0.27911987, -1.2217759, -0.34503518, -1.00755712, 0.01551766, 0.09303302, -1.54178759, -0.01936236, 0.30015587, 0.95025814, -0.02177135, -0.45531962, -0.99627715, -0.64815898, -0.28520845, -1.44974135, -0.48359967, -1.33158817, 0.88718995, -0.11618905, -0.26768185, 1.3709179, 0.70524479, -0.8055552, -1.16428222, 0.71161186, -1.40778667, 0.00096492, 0.36006822, -2.26280628, -0.05334779, 0.78429873, 1.15036266, -0.81036249, 0.54243173, 0.42424546, 0.27426405, 1.06936654, 0.6329521, -0.34132517, 0.84449937, 0.28570044, 0.87163393, -0.47233544, -0.85648959, 0.47400729, 0.01110332, 0.67257133, 1.31111735, -0.2898128, -0.94529257, -0.83928096, -0.65803623, -0.08353724, 0.14915999, 1.11215025, 0.27924469, 0.0000738, 0.19885291, -1.4247189, -0.46160807, 0.31642785, -0.1533155, 0.92100929, 0.64763556, 0.37827734, 0.41355769, 0.64846488, -0.95333607, -1.01451795, -0.67380126, -0.05538561, -0.53975594, 0.19015177, 1.04901076, 0.37847728, -1.79111798, -1.00846756, 1.56261716, 0.11540556, -0.61465476, -0.45954402, 1.6428576, -0.06294454, 0.26805408, -0.69999105, -1.08314572, 0.75169248, -1.35559255, 1.1866959, -0.89518608, -0.3926671, -0.69710601, -0.8669487, 0.75390949, -0.38128266, 1.54026393, -0.82151451, 0.45958341, 0.02998691, 0.23534219, -0.78983861, -0.79727194, -1.09944124, -0.38560402, -0.22343808, -0.20402028, 0.61939086, 0.29833457, 0.37687584, -0.76114405, 0.39441621, -0.02458621, 0.27814813, 2.40745216, -1.038333, 0.28583734, -0.23793059, 0.5170437, 0.0345758, -0.68674429, -0.14673694, 0.47579262, 0.56150987, -0.29034949, -1.39513466, 0.16279504, 0.19849221, 0.15716695, -0.22527721, -0.25705518, 0.8348101, 1.03030865, 1.28043115, 0.40420117, 0.89848864, 0.36055001, -0.0360149, -1.40861735, 0.67723824, 1.86397402, -0.75142316, -0.25173146, -1.93040481, -0.76291218, 0.59095251, 1.22924994, 0.11181195, 0.88024352, -0.55190819, -0.26173056, 0.28357247]);
  const b1 = new Float64Array([-0.33803904, -0.41199716, 0.23537183, -1.86581431, -1.20584533, -0.9003628, -0.23468973, 1.48437045, 1.69851188, 0.00904361, 0.85693675, 1.11730444, -0.52523835, 0.10553836, -0.58736075, -0.55050102, 0.15546679, -0.34885019, 0.1078346, 0.93300956, 0.79232931, -0.64502515, 0.45764037, -1.16121005]);
  const W2 = new Float64Array([-0.37393596, 1.15159192, 0.1824523, -0.26731168, -0.05720911, 1.22917534, -0.65294829, 1.11971149, -1.13803583, 0.63761103, -0.80219408, 1.51076734, 0.7556884, 0.66370524, -0.72021671, 0.95904115, 1.17129982, 0.13724208, -0.25796409, -0.67093495, -0.8481125, -0.59613772, 0.40108825, -1.22309996, 0.02788715, -1.11743334, -1.75283051, 1.44006025, 0.4980622, -0.44821891, -2.05165984, 0.06757798, -0.40158825, -0.48044753, -1.91191021, -0.08516204, 0.32755059, 0.257059, -0.47080251, 0.77802562, -0.59647752, 0.4817021, 1.83715776, -0.41060871, 2.10544493, 1.17642669, 0.28051111, 0.70949608, -1.87113232, 0.29283219, 0.8749088, -0.31603489, -1.0309071, -0.45341995, 0.00841106, 0.72869273, 0.15711421, -1.30128222, -0.41848939, 1.225724, -1.00430937, 0.2451959, 0.79998026, -1.06129922, -0.11982485, -1.20106105, -0.62456607, -0.15552228, 0.12346151, 1.44376752, -0.90881401, -2.00251175, -0.13106688, 1.61555104, -0.01993398, -0.57081676, -0.28402101, -0.1202483, 0.48173195, 0.65486338, -1.19537666, 0.62894913, -0.68055514, -0.03374258, 1.4037704, 0.55617319, -0.43865489, -0.62407863, -0.27697099, -0.42535534, -0.00807031, 0.07915315, 1.23584973, 1.17849946, -0.30729302, 0.71722793, 0.99789332, -0.59876214, -0.54309198, -0.4875348, 1.0291547, 0.07426415, -1.16285702, 0.2806771, -0.63933091, 1.29977618, -0.05650382, -1.31500905, 1.64094374, -0.86615416, 0.12522957, 0.36908618, 0.02242452, -0.36184338, 0.41283739, 0.92970976, 1.25696344, -0.3920845, 0.80658633, 0.39181255, -0.26912701, 0.61990196, -0.37500373, 0.60756543, -0.2613478, 0.51118007, 0.48030318, -0.45001615, 0.62112434, -0.85692381, 1.14525004, 1.05514542, 1.18478062, -0.9881818, -0.04680184, -0.80426325, -1.37269497, 0.31740059, -0.97367495, -0.42071306, 0.28631208, -0.10009326, -0.44460278, 1.24403238, -1.18172427, 0.26976427, 0.09967376, -0.73058992, 0.07600814, -0.13118571, 0.27249978, 2.31938678, 2.12266929, -0.12111302, -0.15099536, 0.29593842, -0.07509284, 0.70728875, -0.71132184, -0.83456501, 0.24882145, 0.68493987, -1.24411918, 1.17403925, -1.48874288, 1.11127771, -0.34766508, -0.28889369, -0.7540399, -0.11086791, 0.17926852, -0.21841317, -0.48013146, 0.13428403, 0.62632146, -1.93608508, 0.10728109, 0.56790619, -0.9381842, 0.23102297, -1.09967062, 0.17799278, -0.6050789, -0.03983778, 0.33762052, 0.02211713, -1.06561457, 0.48493016, 0.52019998, -0.40988775, -0.80706783, 0.2438401, 0.92342536, -1.52169421, -0.9678237, -0.6663503, -0.83531222, -0.68603232, -1.50448275, -0.80241329, 1.01972238, -0.84030593, 0.5255291, -0.67163656, -0.01983866, 0.12733629, 0.06356106, 0.95674683, -0.6215231, 0.47508335, -0.91732075, 1.8727386, -0.92733999, 0.17772118, 0.93397587, -0.04179366, -0.59211293, -0.97818168, -0.5108185, 1.12361486, -1.45571118, -0.36752689, -2.11969873, -0.82018984, 0.07669453, -0.92883921, -1.07035619, -0.62071617, -0.02441466, 0.09043094, 0.76772715, -0.03782876, 0.79126769, -0.38076047, -0.11128709, 0.56056888, 0.77171572, 0.49218078, -0.52601905, 0.11524593, -0.48788334, -0.65093358, 0.48619194, -0.83163586, -0.42640748, -1.19322989, 0.37777299, -0.70048548, -0.19711715, -0.92501285, 1.10698014, 0.10865249, -0.51710111, 0.57562304, 0.15451576, -0.95704581, 0.07407998, -0.25408551, -0.72939843, 0.76491823, 0.46609309, 0.9151154, -0.75122485, 1.30949255, -1.03661842, -1.37269412, -0.23854504, 0.60642854, -0.20613723, -0.01670691, -1.10057402, 0.24909788, -0.32045183, 1.92793561, -1.04890597, -0.5575572, 0.81939539, 0.99730708, -0.60469149, 0.58263532, 0.11393718, -0.1370322, 1.55949979, 0.18674661, 0.34536312, 1.2830411, 0.598958, -0.2560096, 0.28673034, -1.29651739, -1.71210647, 0.28755095, -0.43922679, 0.12284636, -2.29089728, 0.72477991, -0.72295875, 0.57439889, -0.62560759, 0.27973925, -0.31288745, 0.06977422, -0.8227549, 0.35568983, -1.00727143, -0.37975161, 0.53490521, -0.70696187, -0.1187228, 0.1897815, 1.35314167, -0.83817844, 0.36107685, -0.61934454, -0.1730371, -0.65831284, 0.96953733, 1.37187261, -0.199083, 1.37850158, 0.48947045, 0.31776558, 0.12565091, -0.67340861, -1.46128265, -0.83852442, -0.5616771, -0.19457766, -0.79513763, 0.35494343, 1.32228119, 0.62192466, 0.46410584, -0.08150468, -2.23702122, -0.05699212, -1.40969157, 0.60770803, 0.10871173, -0.01374249, 0.60270589, -0.73252127, 1.54233596, 0.90063162, 0.9340128, 0.04812008, 0.82313356, 1.38611692, 0.72022567, -0.65223893, 0.36735085, 0.60760194, 0.02439624, 1.3103059, 0.82208795, 0.41823298, 0.5034998, 0.30243541, 1.70421588, -0.37265761, 0.3634581, 0.52574083, -0.14121102, 0.51754939, 0.62700858, 1.09632402, -0.44525945, -1.35334186, 0.62940564, -0.03276213, -1.49986349, -1.61982869, 2.90043762, 0.3555833, 0.48901361, -0.68326327, -0.13736634, -1.50559777, 1.02251844, 1.37456423, 0.58204983, 0.16109986, 0.04656059, -0.02393766]);
  const b2 = new Float64Array([0.97756761, 0.31510598, -0.21962734, 0.55374228, -0.34200414, 0.5648376, -0.92900536, -0.36524739, 0.01789908, -0.24071138, 0.97067257, -0.93959335, 0.12036402, -0.1950135, -0.97384342, 0.78758166]);
  const W3 = new Float64Array([-0.76960695, 5.15217418, -3.77723283, 5.99151854, -2.61459115, -0.46627972, 3.36831449, -3.5877499, -1.76761523, -1.68114449, 1.17336251, 1.01949448, 0.00197056, -1.85023263, -2.06701869, 3.89292567, 0.2048345, 5.73578781, -0.16248639, 9.5874503, -0.07341634, 1.56959133, 3.68601423, -1.54709651, -2.23975633, -1.4534332, 0.41155521, 1.01740522, 1.85402974, -0.19461385, 1.76018761, 0.6388913, -0.39833903, 0.47443812, -0.79544527, 2.52206524, -0.93447859, -0.16794007, 1.17231198, 1.63514377, 0.47211038, -2.80765087, 0.21835063, 0.55174123, -4.68990561, -0.33312896, -2.15559096, -1.18054021, -0.8439894, 0.7389541, -0.10558286, 6.25279766, 4.24262548, 2.44618573, 1.49688804, 5.10312286, -1.68127428, 4.64046684, 1.61767399, 0.11329596, 0.57305959, -3.42452796, 0.29882436, -5.86476771, -0.57829303, 6.99275046, -4.36504698, 9.84829271, -5.72671088, -0.56801083, -0.42461716, -0.98922995, -4.67538224, -0.70191396, 3.26758545, 2.08732536, -0.88101073, 0.23819944, -0.7274521, 0.65386717]);
  const b3 = new Float64Array([0.71053979, -0.03406348, -0.75847829, -0.22446394, -0.67711414]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.01353763, 0.33004579, 0.00822616, 0.35886842, -1.8043078, -0.28737237, -1.0453292, 0.24874919, -0.10174036, -1.11253133, 0.08927255, 0.28386112, 0.40620077, 0.46601179, -0.36965952, -0.7883053, -0.52672495, 0.14665191, 0.94482201, -0.22358885, 0.88238582, -0.31405656, -1.23027474, 0.24459965, 0.35644041, 0.45450046, 0.22327586, -0.41711781, 1.07324058, 0.14492001, 0.66761213, -0.88113821, -1.00930285, -0.02323608, 0.3485386, 1.12997017, -0.38948433, -1.50377966, -0.20525646, -0.26115277, 0.55535867, 0.98115912, 1.14310444, -0.08293662, 0.60836983, 0.16594984, -0.08123755, -0.29320216, -0.52253673, -0.50471543, 0.91532098, -0.83047454, 0.70283846, 1.33374397, -0.21118957, -0.9244585, -1.42482559, 0.88322182, 0.2929653, -1.51227091, 0.01202583, -0.62201216, -0.36549951, -0.36860756, 0.30137762, -1.05455404, -0.88196043, -0.19761823, -1.67982454, -0.80329458, -0.57782571, 0.16502944, 1.16107027, 0.6895862, -0.30984632, -0.34606926, 0.21010942, -0.31738846, -0.84660976, 0.41070288, -0.32580529, 0.21973769, 1.12284974, 1.10679773, -0.03820944, 0.80354207, -0.04363122, -0.40746628, 0.10703161, 1.83956862, -0.39698054, -0.95863469, -0.22049276, -0.68196694, 0.47033164, 0.11297586, 1.07466775, -1.13625291, 0.14936161, 0.73538546, 1.34063303, -0.11588482, 1.28566019, 0.69886582, -0.299315, -0.735367, -0.82077065, -1.96054824, 0.46425557, 0.62114962, 2.15340803, 1.68387003, 0.62807547, -0.56508205, -1.56955429, -0.45706567, -1.06938015, 0.6750363, 0.93741609, -1.01710549, -1.8473554, -0.34364676, -0.76717197, -0.19704449, 0.24256599, -0.55460014, -0.97617686, -0.44756122, -1.02536779, 0.66638365, 0.46005452, 0.24310196, 0.86563037, -1.2290433, -0.00113239, -1.15364606, -0.87377765, 1.6713482, 0.52855141, -0.17363456, 0.91696888, -1.10985885, -1.5243074, 0.9761965, 0.31145549, -0.58665213, 1.22871917, -0.59877613, 0.65385255, -0.92051302, -0.2711693, 0.22297875, -0.8978512, -0.14816036, 0.51428622, -0.39897055, 0.43804816, -0.91959658, -0.26208953, -0.29252112, -0.64102587, -0.17579119, 0.90543102, -0.17870907, 0.42985301, -1.90492336, 0.01802391, -1.36326535, -0.3144239, -0.19380372, 0.26309362, 0.87697086, 0.47192111, 0.1949243, -0.2468271, -0.28650022, 0.15104356, -0.861016, 0.32493731, -0.50074332, 0.25153338, 0.8328458, 0.34134375, -0.31576444, -0.03568048, -0.38104081, -0.47314062, -0.28784945, -1.19867547, -0.79143758, 0.90188296, 0.38034246, -0.47631209, -0.89336872, -0.41036732, -0.48138741, 1.09583185, -0.99661435, 0.08076235, -0.49414971, -1.22027001, 1.56720959, 0.08880457, 0.75347388, -1.75220911, -0.33509859, -0.91128483, 0.27891256, 0.13860914, 0.17900179, 0.8122974, 1.33074093, 0.59727895, -0.18771788, 0.35020193, 1.03713473, -0.48408231, -0.64742854, -0.65957732, 0.56555961, -0.01060409, -0.59797346, -1.05377489, 0.26839501, -0.32737094, 0.14230516, -0.37118777, -0.19830392, 0.47338522, 0.40227788, -1.37520557, 1.4363408, -0.87528554, 0.05729977, -0.5434167, 1.60246163, -1.13718579, 0.08578295, -0.33596302, -1.8826895, 0.18656253, -2.93147655, -1.82463798, -0.94091564, 0.50760705, -0.7890835, -0.62621456, -1.34781718, -0.79295788, 0.71804484, -0.06598897, -0.05808285, -0.08141327, -1.93631289, 0.27288844, -1.06419151, -1.63321224, 0.1701352, -0.9013602, 0.29463475, -0.63456307, 0.07824167, 1.37120164, -0.40002507, -0.60511997, 0.2689902, 0.04597612, -0.41143101, 1.58415349, -2.43439951, -0.83129515, -0.2529449, 0.04291178, -1.00371506, -0.21624652, -0.14257832, 0.17296709, -0.12851589, -1.39841487, -0.99308546, -1.72815296, -1.29411529, 0.39527531, -0.74653114, -0.85842851, -0.01747029, -0.30605403, 0.42024614, -0.24371279, 0.68022871, 0.47450622, -0.40783863, -0.25584687, -0.91955627, 0.81593108, -0.46059048, 0.50886525, -0.70145985, 0.37938827, -0.0998973, 0.80061903, 0.13207972, 0.07266292, -1.14253882, 0.60273412, 0.50173371, -1.72907423, -0.15339819, 0.41576297, 0.84295162, -0.83613549, -1.12048261, 0.58126163, 0.99710691, -0.01646309, -1.16660096, 0.38705826, 1.70153535, 0.02727584, -0.16799862, -0.36408064, 0.07791623, -0.31789771, -0.007193, -0.6430638, -1.12449685, 0.7891154, -0.24357575, 0.19557035, -0.05439458, 1.24705975, 1.20973283, 0.36633439, 1.28412419, -0.25684119, 0.89556026, 1.04482913, 0.19260308, -1.7103272, -0.14829397, 1.4270135, 0.23366284, 0.13620669, 0.34447991, -0.37962617, 2.47950023, -0.20932541, 1.11942843, 0.83462928, -0.42820488, 1.29229121, 0.09469087, -0.42387939, -1.62349615, -0.83591992, 0.12298494, -0.53489658, 0.72756261, 0.38510085, -0.60442851, -0.67783326, -0.11256074, -0.89013123, 0.02775493, 0.60432029, -0.73807407, 0.31089978, 0.88021578, -0.5026667, -1.5279745, 0.39883845, 1.40364461, -1.19497576, 1.35951285, -0.07658098, -0.02113873, 1.02044114, 0.39347002, -1.06690989, 1.09797369, 0.58155837, 0.3028738, -0.88253536, -0.38626964, 2.11092549, -0.64696919, 0.36342441, -0.26248011, -0.92060058, -0.03358354, 1.31767736, -1.49901898, 1.95655645, -0.46726006, 0.37177961, -0.34350788, -0.27663622, -0.81936785, 1.30580043, 0.86094474, -0.2773493, -0.59054939, 3.37515957, 0.00940809, 1.18891187, -0.83915445, -1.0685727, 0.39880899, 0.65391805, 1.31192557, 0.47820242, -1.14756935, -0.73953691, -0.17785303, 0.54325952, -0.9192833, -0.54161194, 0.433652, 0.04882988, 0.52501944, 0.5940361, 0.45584547, -1.3232963, -0.03810959, -0.88891145, -1.81903104, 0.19025916, 0.95983911, 0.03045051, -0.55432255, 2.03470434, 1.28866079, 0.27879056, 0.94065308, 0.71351668, 0.21981579, -0.88403057, 0.44617074, 0.01738964, -2.08127998, -1.19496811, -0.66561216, -0.72493995, 1.09988579, -0.4135468, 0.08857152, -0.05203288, 0.6249899, -1.22359741, 0.58312852, 0.10478994, 0.4513955, 0.88894505, 0.82011591, -2.17584612, -0.96862101, -0.36922893, 0.1650896, 0.26820634, 2.10671904, -0.03665456, -1.27609059, -1.47058312, 0.71920294, -0.19835522, -0.88089632, 1.62586673, 1.97167109, -0.50472787, -0.59846377, 0.91871982, 1.12659493, -0.79233935, -0.35904759, 0.23787154, 0.28275118, -1.26777857, -1.33518839, 0.14652714, -0.19810054, -0.95455203, -0.95850448, 0.55588354, -0.55020351, 1.38334709, 1.11369773, -0.54884052, -0.77168292, -0.55468131, -0.98166333, 0.2563449, -0.81293219, 0.2951542, -0.03110814, -0.72873402, -1.62959823, -1.15859875, 0.06083274, 0.14124272, -0.8184945, 0.28423672, 0.52048695, -0.04103425, 1.78710824, -0.14592822, 0.21848889, -0.08227564, -0.21762868, 0.08389486, -0.61639157, 1.18522209, 0.50670967, 0.56782973, -0.76316632, 0.06394491, -0.82670245, 2.23858176, -0.46628851, -0.961605, 1.06560819, -1.35179779, -1.01563361, 1.17578018, -0.70350101, 0.45990498, 1.87333076, -1.0318943, 0.61502059, 0.00653848, -0.05961907, -1.30829462, -2.06287894, -0.2454776, -0.82224822, 0.18908161, -1.06871801, 0.02792408, -1.23603097, -0.60452983, -0.81519541, -0.97303824, 1.50324211, 1.5601864, -0.39084941, -0.20388797, 0.2796566, -0.24204798, 0.7810208, -1.67772718, -1.35091061, -0.42328995, 0.61189013, 0.29815532, -0.05999768, 0.60308285, -0.80656043, 0.6945748, -0.45935382, -1.04975775, 1.17191653, 0.02270975, -0.80137794, 0.06882234, -0.52399749, -0.10259893, -0.22645157, -0.13349001, -0.63448583, -0.39926832, 0.26909307, -1.47855374, 0.80809594, 0.40510109, 0.25790394, -0.25019665, 0.25188169, -0.09530154, 1.06564047, -0.93125429, -0.76430469, -0.08740516, 0.32870052, 0.42334882, -1.53016779, 2.54399191, -1.28062878, -0.63207921, 1.00250408, 1.2390698, 0.43718348, -0.26344179, -1.26285751, -1.38353294, -1.19560457, 0.36403555, 1.30837566, -0.74671108, -1.08680289, -0.64096716, -1.07698792, -2.47885815, -0.6788102, -2.28634948, 0.17607594, -1.91128657, -0.34688336, 0.68977429, -1.05933711, -1.20012373, -1.24633229, 1.85759755, 0.88453415, -0.21140062, 1.85373059, -0.92836131, 0.07317612, -0.23366802, 0.12253088, -0.28590968, 0.52141721, 0.1543498, 0.27456854, -0.24960454, 0.46044237, -0.43738137, 0.47345797, -1.54742205, 1.57917609, -0.28329407, 0.5189566, 1.01688854, -0.27816722, -0.01866198, 0.54939753, -1.33931495, 1.68587293, 0.85208831, 1.22644248, 0.71163242, 0.9397495, -0.08276695, 0.47398808, -0.45569571, 0.86097458, 0.00048273, 0.20124949, 0.15013739, -1.10784673, 0.95877738, -0.78955273, -0.23631765, -0.47930061, 0.88673255, 0.70759046, -0.39689871, 1.46099923, 0.33377888, 1.1108557, 0.45788554, 0.0481544, 0.20687298, 0.11671373, -1.21880586, -0.31520967, -0.62730701, -0.66276557, 0.73131128, -0.06292041, 0.03633975, -0.90907993, 0.42428064, 0.24893022, -0.48655309, 1.08818806, -0.71592885, 0.02553074, -1.34215111, 1.20580465, 0.7892667, -0.2617037, -0.36170489, -0.38105274, -0.40079438, -0.60922555, 0.20923854, 0.49649407, 0.27576769, -0.40345314, 0.65731804, 0.26866603, -1.42493628, 0.7264225, -0.32203832, 0.36505339, -0.07521714, -0.32734552, 1.32712114, 1.26320072, -0.25948844, -1.45039225, 0.05594043, -1.17164528, 0.46281827, -0.33233146, 0.15262256, 0.27637895, -0.30329345, -0.62363844, 0.58898957, -1.90779837, 0.23901863, -2.06830301, -0.16346558, -0.59890411, -0.21634316, -1.03207702, 0.33435914, -0.48444242, -0.03396762, -0.54908697, -0.02300152, 1.14485933, 0.43642413, -1.33648919, 1.45039924, -0.68232564, -1.35017492, -0.08131544, -0.03926632, -0.04106236, 0.67553513, -0.98204592, 0.20062502, 0.12694253, -0.67060096, -0.05767077, 0.06034381, -0.52695029, 0.9873127, 1.15924799, -1.04478594, 0.51445103, -1.7733777, 0.36352996, 0.2670504, -0.44389911, -0.00951745, -1.37471798, -0.30043155, 0.45265041, -0.44108126, -0.93380974, 0.01123475, 1.04638666, 0.02761617, -0.94500398, 0.03733002, 1.42081918, -0.35939667, 0.33362599, 0.40669021, -0.11269968, 0.77173548, -0.21439775, -1.04443905, -0.13415581, -0.39751096, 0.09126597, 0.04284529, 0.05834636, 0.3982566, 0.14497739, -0.20426588, -0.55688591, -1.55756943, 1.38392311, -0.39793361, 0.26196548, -0.83255368, -1.3107868, 0.50036997, -0.82801969, -0.58475799, -1.0591635, 0.15133576, 2.04529368, -0.68842042, 0.28711827, -1.37213556, -1.34335526, 0.02993351, -1.1432537, 0.03299097, -0.40009081, 0.38683951, 0.31083133, -0.25719153, 0.50859074, -0.74614072, 0.99722077, -0.09831068, 0.66781027, -1.2738888, 0.47515389, 0.09352394, 0.9429222, 0.46048472, -1.22296615, 0.64618544, 0.6449593, -1.22759011, -0.07691448, -1.3100073, 0.20930579, 0.79554914, 1.03814966, 0.40682959, -1.73714393, -0.29190177, -0.48984985, 0.00214294, 0.91133783, 0.51477812, 1.64060769, -0.61057218, 0.95273783, -0.88578953, 1.77219631, 0.59130063, -0.32097308, -0.35905662, 0.01161622, -0.01568177, -0.88759929, -0.7713039, -0.41152533, 2.45777636, -1.58511195, 0.13247956, 0.04229733, -0.07462446, -0.9459986, 0.63875347, 0.69926503, -0.8543972, -0.39546391, 0.67162687, 1.35228365, 0.58572566, 1.75912831, 0.29326272, -1.13289563, 0.62465929, 0.98947382, -0.20522795, -2.12739971, -1.04702689, 1.18651795, -0.31853552, 0.39955208, 0.08361013, -0.95678834, -0.32676923, 0.40535131, -0.97981103, 0.94860515, -0.61414279, -0.17724566, 0.3503274, -0.76590623, 1.63489894, 0.40914546, -0.73365926, 0.30539378, 0.41657822, -1.03489467, -1.23730987, -1.30256017, -0.12196743, 1.16289091, 0.27911987, -1.2217759, -0.34503518, -1.00755712, 0.01551766, 0.09303302, -1.54178759, -0.01936236, 0.30015587, 0.95025814, -0.02177135, -0.45531962, -0.99627715, -0.64815898, -0.28520845, -1.44974135, -0.48359967, -1.33158817, 0.88718995, -0.11618905, -0.26768185, 1.3709179, 0.70524479, -0.8055552, -1.16428222, 0.71161186, -1.40778667, 0.00096492, 0.36006822, -2.26280628, -0.05334779, 0.78429873, 1.15036266, -0.81036249, 0.54243173, 0.42424546, 0.27426405, 1.06936654, 0.6329521, -0.34132517, 0.84449937, 0.28570044, 0.87163393, -0.47233544, -0.85648959, 0.47400729, 0.01110332, 0.67257133, 1.31111735, -0.2898128, -0.94529257, -0.83928096, -0.65803623, -0.08353724, 0.14915999, 1.11215025, 0.27924469, 0.0000738, 0.19885291, -1.4247189, -0.46160807, 0.31642785, -0.1533155, 0.92100929, 0.64763556, 0.37827734, 0.41355769, 0.64846488, -0.95333607, -1.01451795, -0.67380126, -0.05538561, -0.53975594, 0.19015177, 1.04901076, 0.37847728, -1.79111798, -1.00846756, 1.56261716, 0.11540556, -0.61465476, -0.45954402, 1.6428576, -0.06294454, 0.26805408, -0.69999105, -1.08314572, 0.75169248, -1.35559255, 1.1866959, -0.89518608, -0.3926671, -0.69710601, -0.8669487, 0.75390949, -0.38128266, 1.54026393, -0.82151451, 0.45958341, 0.02998691, 0.23534219, -0.78983861, -0.79727194, -1.09944124, -0.38560402, -0.22343808, -0.20402028, 0.61939086, 0.29833457, 0.37687584, -0.76114405, 0.39441621, -0.02458621, 0.27814813, 2.40745216, -1.038333, 0.28583734, -0.23793059, 0.5170437, 0.0345758, -0.68674429, -0.14673694, 0.47579262, 0.56150987, -0.29034949, -1.39513466, 0.16279504, 0.19849221, 0.15716695, -0.22527721, -0.25705518, 0.8348101, 1.03030865, 1.28043115, 0.40420117, 0.89848864, 0.36055001, -0.0360149, -1.40861735, 0.67723824, 1.86397402, -0.75142316, -0.25173146, -1.93040481, -0.76291218, 0.59095251, 1.22924994, 0.11181195, 0.88024352, -0.55190819, -0.26173056, 0.28357247]);
  const b1 = new Float64Array([-0.33803904, -0.41199716, 0.23537183, -1.86581431, -1.20584533, -0.9003628, -0.23468973, 1.48437045, 1.69851188, 0.00904361, 0.85693675, 1.11730444, -0.52523835, 0.10553836, -0.58736075, -0.55050102, 0.15546679, -0.34885019, 0.1078346, 0.93300956, 0.79232931, -0.64502515, 0.45764037, -1.16121005]);
  const W2 = new Float64Array([-0.37393596, 1.15159192, 0.1824523, -0.26731168, -0.05720911, 1.22917534, -0.65294829, 1.11971149, -1.13803583, 0.63761103, -0.80219408, 1.51076734, 0.7556884, 0.66370524, -0.72021671, 0.95904115, 1.17129982, 0.13724208, -0.25796409, -0.67093495, -0.8481125, -0.59613772, 0.40108825, -1.22309996, 0.02788715, -1.11743334, -1.75283051, 1.44006025, 0.4980622, -0.44821891, -2.05165984, 0.06757798, -0.40158825, -0.48044753, -1.91191021, -0.08516204, 0.32755059, 0.257059, -0.47080251, 0.77802562, -0.59647752, 0.4817021, 1.83715776, -0.41060871, 2.10544493, 1.17642669, 0.28051111, 0.70949608, -1.87113232, 0.29283219, 0.8749088, -0.31603489, -1.0309071, -0.45341995, 0.00841106, 0.72869273, 0.15711421, -1.30128222, -0.41848939, 1.225724, -1.00430937, 0.2451959, 0.79998026, -1.06129922, -0.11982485, -1.20106105, -0.62456607, -0.15552228, 0.12346151, 1.44376752, -0.90881401, -2.00251175, -0.13106688, 1.61555104, -0.01993398, -0.57081676, -0.28402101, -0.1202483, 0.48173195, 0.65486338, -1.19537666, 0.62894913, -0.68055514, -0.03374258, 1.4037704, 0.55617319, -0.43865489, -0.62407863, -0.27697099, -0.42535534, -0.00807031, 0.07915315, 1.23584973, 1.17849946, -0.30729302, 0.71722793, 0.99789332, -0.59876214, -0.54309198, -0.4875348, 1.0291547, 0.07426415, -1.16285702, 0.2806771, -0.63933091, 1.29977618, -0.05650382, -1.31500905, 1.64094374, -0.86615416, 0.12522957, 0.36908618, 0.02242452, -0.36184338, 0.41283739, 0.92970976, 1.25696344, -0.3920845, 0.80658633, 0.39181255, -0.26912701, 0.61990196, -0.37500373, 0.60756543, -0.2613478, 0.51118007, 0.48030318, -0.45001615, 0.62112434, -0.85692381, 1.14525004, 1.05514542, 1.18478062, -0.9881818, -0.04680184, -0.80426325, -1.37269497, 0.31740059, -0.97367495, -0.42071306, 0.28631208, -0.10009326, -0.44460278, 1.24403238, -1.18172427, 0.26976427, 0.09967376, -0.73058992, 0.07600814, -0.13118571, 0.27249978, 2.31938678, 2.12266929, -0.12111302, -0.15099536, 0.29593842, -0.07509284, 0.70728875, -0.71132184, -0.83456501, 0.24882145, 0.68493987, -1.24411918, 1.17403925, -1.48874288, 1.11127771, -0.34766508, -0.28889369, -0.7540399, -0.11086791, 0.17926852, -0.21841317, -0.48013146, 0.13428403, 0.62632146, -1.93608508, 0.10728109, 0.56790619, -0.9381842, 0.23102297, -1.09967062, 0.17799278, -0.6050789, -0.03983778, 0.33762052, 0.02211713, -1.06561457, 0.48493016, 0.52019998, -0.40988775, -0.80706783, 0.2438401, 0.92342536, -1.52169421, -0.9678237, -0.6663503, -0.83531222, -0.68603232, -1.50448275, -0.80241329, 1.01972238, -0.84030593, 0.5255291, -0.67163656, -0.01983866, 0.12733629, 0.06356106, 0.95674683, -0.6215231, 0.47508335, -0.91732075, 1.8727386, -0.92733999, 0.17772118, 0.93397587, -0.04179366, -0.59211293, -0.97818168, -0.5108185, 1.12361486, -1.45571118, -0.36752689, -2.11969873, -0.82018984, 0.07669453, -0.92883921, -1.07035619, -0.62071617, -0.02441466, 0.09043094, 0.76772715, -0.03782876, 0.79126769, -0.38076047, -0.11128709, 0.56056888, 0.77171572, 0.49218078, -0.52601905, 0.11524593, -0.48788334, -0.65093358, 0.48619194, -0.83163586, -0.42640748, -1.19322989, 0.37777299, -0.70048548, -0.19711715, -0.92501285, 1.10698014, 0.10865249, -0.51710111, 0.57562304, 0.15451576, -0.95704581, 0.07407998, -0.25408551, -0.72939843, 0.76491823, 0.46609309, 0.9151154, -0.75122485, 1.30949255, -1.03661842, -1.37269412, -0.23854504, 0.60642854, -0.20613723, -0.01670691, -1.10057402, 0.24909788, -0.32045183, 1.92793561, -1.04890597, -0.5575572, 0.81939539, 0.99730708, -0.60469149, 0.58263532, 0.11393718, -0.1370322, 1.55949979, 0.18674661, 0.34536312, 1.2830411, 0.598958, -0.2560096, 0.28673034, -1.29651739, -1.71210647, 0.28755095, -0.43922679, 0.12284636, -2.29089728, 0.72477991, -0.72295875, 0.57439889, -0.62560759, 0.27973925, -0.31288745, 0.06977422, -0.8227549, 0.35568983, -1.00727143, -0.37975161, 0.53490521, -0.70696187, -0.1187228, 0.1897815, 1.35314167, -0.83817844, 0.36107685, -0.61934454, -0.1730371, -0.65831284, 0.96953733, 1.37187261, -0.199083, 1.37850158, 0.48947045, 0.31776558, 0.12565091, -0.67340861, -1.46128265, -0.83852442, -0.5616771, -0.19457766, -0.79513763, 0.35494343, 1.32228119, 0.62192466, 0.46410584, -0.08150468, -2.23702122, -0.05699212, -1.40969157, 0.60770803, 0.10871173, -0.01374249, 0.60270589, -0.73252127, 1.54233596, 0.90063162, 0.9340128, 0.04812008, 0.82313356, 1.38611692, 0.72022567, -0.65223893, 0.36735085, 0.60760194, 0.02439624, 1.3103059, 0.82208795, 0.41823298, 0.5034998, 0.30243541, 1.70421588, -0.37265761, 0.3634581, 0.52574083, -0.14121102, 0.51754939, 0.62700858, 1.09632402, -0.44525945, -1.35334186, 0.62940564, -0.03276213, -1.49986349, -1.61982869, 2.90043762, 0.3555833, 0.48901361, -0.68326327, -0.13736634, -1.50559777, 1.02251844, 1.37456423, 0.58204983, 0.16109986, 0.04656059, -0.02393766]);
  const b2 = new Float64Array([0.97756761, 0.31510598, -0.21962734, 0.55374228, -0.34200414, 0.5648376, -0.92900536, -0.36524739, 0.01789908, -0.24071138, 0.97067257, -0.93959335, 0.12036402, -0.1950135, -0.97384342, 0.78758166]);
  const W3 = new Float64Array([-0.76960695, 5.15217418, -3.77723283, 5.99151854, -2.61459115, -0.46627972, 3.36831449, -3.5877499, -1.76761523, -1.68114449, 1.17336251, 1.01949448, 0.00197056, -1.85023263, -2.06701869, 3.89292567, 0.2048345, 5.73578781, -0.16248639, 9.5874503, -0.07341634, 1.56959133, 3.68601423, -1.54709651, -2.23975633, -1.4534332, 0.41155521, 1.01740522, 1.85402974, -0.19461385, 1.76018761, 0.6388913, -0.39833903, 0.47443812, -0.79544527, 2.52206524, -0.93447859, -0.16794007, 1.17231198, 1.63514377, 0.47211038, -2.80765087, 0.21835063, 0.55174123, -4.68990561, -0.33312896, -2.15559096, -1.18054021, -0.8439894, 0.7389541, -0.10558286, 6.25279766, 4.24262548, 2.44618573, 1.49688804, 5.10312286, -1.68127428, 4.64046684, 1.61767399, 0.11329596, 0.57305959, -3.42452796, 0.29882436, -5.86476771, -0.57829303, 6.99275046, -4.36504698, 9.84829271, -5.72671088, -0.56801083, -0.42461716, -0.98922995, -4.67538224, -0.70191396, 3.26758545, 2.08732536, -0.88101073, 0.23819944, -0.7274521, 0.65386717]);
  const b3 = new Float64Array([0.71053979, -0.03406348, -0.75847829, -0.22446394, -0.67711414]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.01353763, 0.33004579, 0.00822616, 0.35886842, -1.8043078, -0.28737237, -1.0453292, 0.24874919, -0.10174036, -1.11253133, 0.08927255, 0.28386112, 0.40620077, 0.46601179, -0.36965952, -0.7883053, -0.52672495, 0.14665191, 0.94482201, -0.22358885, 0.88238582, -0.31405656, -1.23027474, 0.24459965, 0.35644041, 0.45450046, 0.22327586, -0.41711781, 1.07324058, 0.14492001, 0.66761213, -0.88113821, -1.00930285, -0.02323608, 0.3485386, 1.12997017, -0.38948433, -1.50377966, -0.20525646, -0.26115277, 0.55535867, 0.98115912, 1.14310444, -0.08293662, 0.60836983, 0.16594984, -0.08123755, -0.29320216, -0.52253673, -0.50471543, 0.91532098, -0.83047454, 0.70283846, 1.33374397, -0.21118957, -0.9244585, -1.42482559, 0.88322182, 0.2929653, -1.51227091, 0.01202583, -0.62201216, -0.36549951, -0.36860756, 0.30137762, -1.05455404, -0.88196043, -0.19761823, -1.67982454, -0.80329458, -0.57782571, 0.16502944, 1.16107027, 0.6895862, -0.30984632, -0.34606926, 0.21010942, -0.31738846, -0.84660976, 0.41070288, -0.32580529, 0.21973769, 1.12284974, 1.10679773, -0.03820944, 0.80354207, -0.04363122, -0.40746628, 0.10703161, 1.83956862, -0.39698054, -0.95863469, -0.22049276, -0.68196694, 0.47033164, 0.11297586, 1.07466775, -1.13625291, 0.14936161, 0.73538546, 1.34063303, -0.11588482, 1.28566019, 0.69886582, -0.299315, -0.735367, -0.82077065, -1.96054824, 0.46425557, 0.62114962, 2.15340803, 1.68387003, 0.62807547, -0.56508205, -1.56955429, -0.45706567, -1.06938015, 0.6750363, 0.93741609, -1.01710549, -1.8473554, -0.34364676, -0.76717197, -0.19704449, 0.24256599, -0.55460014, -0.97617686, -0.44756122, -1.02536779, 0.66638365, 0.46005452, 0.24310196, 0.86563037, -1.2290433, -0.00113239, -1.15364606, -0.87377765, 1.6713482, 0.52855141, -0.17363456, 0.91696888, -1.10985885, -1.5243074, 0.9761965, 0.31145549, -0.58665213, 1.22871917, -0.59877613, 0.65385255, -0.92051302, -0.2711693, 0.22297875, -0.8978512, -0.14816036, 0.51428622, -0.39897055, 0.43804816, -0.91959658, -0.26208953, -0.29252112, -0.64102587, -0.17579119, 0.90543102, -0.17870907, 0.42985301, -1.90492336, 0.01802391, -1.36326535, -0.3144239, -0.19380372, 0.26309362, 0.87697086, 0.47192111, 0.1949243, -0.2468271, -0.28650022, 0.15104356, -0.861016, 0.32493731, -0.50074332, 0.25153338, 0.8328458, 0.34134375, -0.31576444, -0.03568048, -0.38104081, -0.47314062, -0.28784945, -1.19867547, -0.79143758, 0.90188296, 0.38034246, -0.47631209, -0.89336872, -0.41036732, -0.48138741, 1.09583185, -0.99661435, 0.08076235, -0.49414971, -1.22027001, 1.56720959, 0.08880457, 0.75347388, -1.75220911, -0.33509859, -0.91128483, 0.27891256, 0.13860914, 0.17900179, 0.8122974, 1.33074093, 0.59727895, -0.18771788, 0.35020193, 1.03713473, -0.48408231, -0.64742854, -0.65957732, 0.56555961, -0.01060409, -0.59797346, -1.05377489, 0.26839501, -0.32737094, 0.14230516, -0.37118777, -0.19830392, 0.47338522, 0.40227788, -1.37520557, 1.4363408, -0.87528554, 0.05729977, -0.5434167, 1.60246163, -1.13718579, 0.08578295, -0.33596302, -1.8826895, 0.18656253, -2.93147655, -1.82463798, -0.94091564, 0.50760705, -0.7890835, -0.62621456, -1.34781718, -0.79295788, 0.71804484, -0.06598897, -0.05808285, -0.08141327, -1.93631289, 0.27288844, -1.06419151, -1.63321224, 0.1701352, -0.9013602, 0.29463475, -0.63456307, 0.07824167, 1.37120164, -0.40002507, -0.60511997, 0.2689902, 0.04597612, -0.41143101, 1.58415349, -2.43439951, -0.83129515, -0.2529449, 0.04291178, -1.00371506, -0.21624652, -0.14257832, 0.17296709, -0.12851589, -1.39841487, -0.99308546, -1.72815296, -1.29411529, 0.39527531, -0.74653114, -0.85842851, -0.01747029, -0.30605403, 0.42024614, -0.24371279, 0.68022871, 0.47450622, -0.40783863, -0.25584687, -0.91955627, 0.81593108, -0.46059048, 0.50886525, -0.70145985, 0.37938827, -0.0998973, 0.80061903, 0.13207972, 0.07266292, -1.14253882, 0.60273412, 0.50173371, -1.72907423, -0.15339819, 0.41576297, 0.84295162, -0.83613549, -1.12048261, 0.58126163, 0.99710691, -0.01646309, -1.16660096, 0.38705826, 1.70153535, 0.02727584, -0.16799862, -0.36408064, 0.07791623, -0.31789771, -0.007193, -0.6430638, -1.12449685, 0.7891154, -0.24357575, 0.19557035, -0.05439458, 1.24705975, 1.20973283, 0.36633439, 1.28412419, -0.25684119, 0.89556026, 1.04482913, 0.19260308, -1.7103272, -0.14829397, 1.4270135, 0.23366284, 0.13620669, 0.34447991, -0.37962617, 2.47950023, -0.20932541, 1.11942843, 0.83462928, -0.42820488, 1.29229121, 0.09469087, -0.42387939, -1.62349615, -0.83591992, 0.12298494, -0.53489658, 0.72756261, 0.38510085, -0.60442851, -0.67783326, -0.11256074, -0.89013123, 0.02775493, 0.60432029, -0.73807407, 0.31089978, 0.88021578, -0.5026667, -1.5279745, 0.39883845, 1.40364461, -1.19497576, 1.35951285, -0.07658098, -0.02113873, 1.02044114, 0.39347002, -1.06690989, 1.09797369, 0.58155837, 0.3028738, -0.88253536, -0.38626964, 2.11092549, -0.64696919, 0.36342441, -0.26248011, -0.92060058, -0.03358354, 1.31767736, -1.49901898, 1.95655645, -0.46726006, 0.37177961, -0.34350788, -0.27663622, -0.81936785, 1.30580043, 0.86094474, -0.2773493, -0.59054939, 3.37515957, 0.00940809, 1.18891187, -0.83915445, -1.0685727, 0.39880899, 0.65391805, 1.31192557, 0.47820242, -1.14756935, -0.73953691, -0.17785303, 0.54325952, -0.9192833, -0.54161194, 0.433652, 0.04882988, 0.52501944, 0.5940361, 0.45584547, -1.3232963, -0.03810959, -0.88891145, -1.81903104, 0.19025916, 0.95983911, 0.03045051, -0.55432255, 2.03470434, 1.28866079, 0.27879056, 0.94065308, 0.71351668, 0.21981579, -0.88403057, 0.44617074, 0.01738964, -2.08127998, -1.19496811, -0.66561216, -0.72493995, 1.09988579, -0.4135468, 0.08857152, -0.05203288, 0.6249899, -1.22359741, 0.58312852, 0.10478994, 0.4513955, 0.88894505, 0.82011591, -2.17584612, -0.96862101, -0.36922893, 0.1650896, 0.26820634, 2.10671904, -0.03665456, -1.27609059, -1.47058312, 0.71920294, -0.19835522, -0.88089632, 1.62586673, 1.97167109, -0.50472787, -0.59846377, 0.91871982, 1.12659493, -0.79233935, -0.35904759, 0.23787154, 0.28275118, -1.26777857, -1.33518839, 0.14652714, -0.19810054, -0.95455203, -0.95850448, 0.55588354, -0.55020351, 1.38334709, 1.11369773, -0.54884052, -0.77168292, -0.55468131, -0.98166333, 0.2563449, -0.81293219, 0.2951542, -0.03110814, -0.72873402, -1.62959823, -1.15859875, 0.06083274, 0.14124272, -0.8184945, 0.28423672, 0.52048695, -0.04103425, 1.78710824, -0.14592822, 0.21848889, -0.08227564, -0.21762868, 0.08389486, -0.61639157, 1.18522209, 0.50670967, 0.56782973, -0.76316632, 0.06394491, -0.82670245, 2.23858176, -0.46628851, -0.961605, 1.06560819, -1.35179779, -1.01563361, 1.17578018, -0.70350101, 0.45990498, 1.87333076, -1.0318943, 0.61502059, 0.00653848, -0.05961907, -1.30829462, -2.06287894, -0.2454776, -0.82224822, 0.18908161, -1.06871801, 0.02792408, -1.23603097, -0.60452983, -0.81519541, -0.97303824, 1.50324211, 1.5601864, -0.39084941, -0.20388797, 0.2796566, -0.24204798, 0.7810208, -1.67772718, -1.35091061, -0.42328995, 0.61189013, 0.29815532, -0.05999768, 0.60308285, -0.80656043, 0.6945748, -0.45935382, -1.04975775, 1.17191653, 0.02270975, -0.80137794, 0.06882234, -0.52399749, -0.10259893, -0.22645157, -0.13349001, -0.63448583, -0.39926832, 0.26909307, -1.47855374, 0.80809594, 0.40510109, 0.25790394, -0.25019665, 0.25188169, -0.09530154, 1.06564047, -0.93125429, -0.76430469, -0.08740516, 0.32870052, 0.42334882, -1.53016779, 2.54399191, -1.28062878, -0.63207921, 1.00250408, 1.2390698, 0.43718348, -0.26344179, -1.26285751, -1.38353294, -1.19560457, 0.36403555, 1.30837566, -0.74671108, -1.08680289, -0.64096716, -1.07698792, -2.47885815, -0.6788102, -2.28634948, 0.17607594, -1.91128657, -0.34688336, 0.68977429, -1.05933711, -1.20012373, -1.24633229, 1.85759755, 0.88453415, -0.21140062, 1.85373059, -0.92836131, 0.07317612, -0.23366802, 0.12253088, -0.28590968, 0.52141721, 0.1543498, 0.27456854, -0.24960454, 0.46044237, -0.43738137, 0.47345797, -1.54742205, 1.57917609, -0.28329407, 0.5189566, 1.01688854, -0.27816722, -0.01866198, 0.54939753, -1.33931495, 1.68587293, 0.85208831, 1.22644248, 0.71163242, 0.9397495, -0.08276695, 0.47398808, -0.45569571, 0.86097458, 0.00048273, 0.20124949, 0.15013739, -1.10784673, 0.95877738, -0.78955273, -0.23631765, -0.47930061, 0.88673255, 0.70759046, -0.39689871, 1.46099923, 0.33377888, 1.1108557, 0.45788554, 0.0481544, 0.20687298, 0.11671373, -1.21880586, -0.31520967, -0.62730701, -0.66276557, 0.73131128, -0.06292041, 0.03633975, -0.90907993, 0.42428064, 0.24893022, -0.48655309, 1.08818806, -0.71592885, 0.02553074, -1.34215111, 1.20580465, 0.7892667, -0.2617037, -0.36170489, -0.38105274, -0.40079438, -0.60922555, 0.20923854, 0.49649407, 0.27576769, -0.40345314, 0.65731804, 0.26866603, -1.42493628, 0.7264225, -0.32203832, 0.36505339, -0.07521714, -0.32734552, 1.32712114, 1.26320072, -0.25948844, -1.45039225, 0.05594043, -1.17164528, 0.46281827, -0.33233146, 0.15262256, 0.27637895, -0.30329345, -0.62363844, 0.58898957, -1.90779837, 0.23901863, -2.06830301, -0.16346558, -0.59890411, -0.21634316, -1.03207702, 0.33435914, -0.48444242, -0.03396762, -0.54908697, -0.02300152, 1.14485933, 0.43642413, -1.33648919, 1.45039924, -0.68232564, -1.35017492, -0.08131544, -0.03926632, -0.04106236, 0.67553513, -0.98204592, 0.20062502, 0.12694253, -0.67060096, -0.05767077, 0.06034381, -0.52695029, 0.9873127, 1.15924799, -1.04478594, 0.51445103, -1.7733777, 0.36352996, 0.2670504, -0.44389911, -0.00951745, -1.37471798, -0.30043155, 0.45265041, -0.44108126, -0.93380974, 0.01123475, 1.04638666, 0.02761617, -0.94500398, 0.03733002, 1.42081918, -0.35939667, 0.33362599, 0.40669021, -0.11269968, 0.77173548, -0.21439775, -1.04443905, -0.13415581, -0.39751096, 0.09126597, 0.04284529, 0.05834636, 0.3982566, 0.14497739, -0.20426588, -0.55688591, -1.55756943, 1.38392311, -0.39793361, 0.26196548, -0.83255368, -1.3107868, 0.50036997, -0.82801969, -0.58475799, -1.0591635, 0.15133576, 2.04529368, -0.68842042, 0.28711827, -1.37213556, -1.34335526, 0.02993351, -1.1432537, 0.03299097, -0.40009081, 0.38683951, 0.31083133, -0.25719153, 0.50859074, -0.74614072, 0.99722077, -0.09831068, 0.66781027, -1.2738888, 0.47515389, 0.09352394, 0.9429222, 0.46048472, -1.22296615, 0.64618544, 0.6449593, -1.22759011, -0.07691448, -1.3100073, 0.20930579, 0.79554914, 1.03814966, 0.40682959, -1.73714393, -0.29190177, -0.48984985, 0.00214294, 0.91133783, 0.51477812, 1.64060769, -0.61057218, 0.95273783, -0.88578953, 1.77219631, 0.59130063, -0.32097308, -0.35905662, 0.01161622, -0.01568177, -0.88759929, -0.7713039, -0.41152533, 2.45777636, -1.58511195, 0.13247956, 0.04229733, -0.07462446, -0.9459986, 0.63875347, 0.69926503, -0.8543972, -0.39546391, 0.67162687, 1.35228365, 0.58572566, 1.75912831, 0.29326272, -1.13289563, 0.62465929, 0.98947382, -0.20522795, -2.12739971, -1.04702689, 1.18651795, -0.31853552, 0.39955208, 0.08361013, -0.95678834, -0.32676923, 0.40535131, -0.97981103, 0.94860515, -0.61414279, -0.17724566, 0.3503274, -0.76590623, 1.63489894, 0.40914546, -0.73365926, 0.30539378, 0.41657822, -1.03489467, -1.23730987, -1.30256017, -0.12196743, 1.16289091, 0.27911987, -1.2217759, -0.34503518, -1.00755712, 0.01551766, 0.09303302, -1.54178759, -0.01936236, 0.30015587, 0.95025814, -0.02177135, -0.45531962, -0.99627715, -0.64815898, -0.28520845, -1.44974135, -0.48359967, -1.33158817, 0.88718995, -0.11618905, -0.26768185, 1.3709179, 0.70524479, -0.8055552, -1.16428222, 0.71161186, -1.40778667, 0.00096492, 0.36006822, -2.26280628, -0.05334779, 0.78429873, 1.15036266, -0.81036249, 0.54243173, 0.42424546, 0.27426405, 1.06936654, 0.6329521, -0.34132517, 0.84449937, 0.28570044, 0.87163393, -0.47233544, -0.85648959, 0.47400729, 0.01110332, 0.67257133, 1.31111735, -0.2898128, -0.94529257, -0.83928096, -0.65803623, -0.08353724, 0.14915999, 1.11215025, 0.27924469, 0.0000738, 0.19885291, -1.4247189, -0.46160807, 0.31642785, -0.1533155, 0.92100929, 0.64763556, 0.37827734, 0.41355769, 0.64846488, -0.95333607, -1.01451795, -0.67380126, -0.05538561, -0.53975594, 0.19015177, 1.04901076, 0.37847728, -1.79111798, -1.00846756, 1.56261716, 0.11540556, -0.61465476, -0.45954402, 1.6428576, -0.06294454, 0.26805408, -0.69999105, -1.08314572, 0.75169248, -1.35559255, 1.1866959, -0.89518608, -0.3926671, -0.69710601, -0.8669487, 0.75390949, -0.38128266, 1.54026393, -0.82151451, 0.45958341, 0.02998691, 0.23534219, -0.78983861, -0.79727194, -1.09944124, -0.38560402, -0.22343808, -0.20402028, 0.61939086, 0.29833457, 0.37687584, -0.76114405, 0.39441621, -0.02458621, 0.27814813, 2.40745216, -1.038333, 0.28583734, -0.23793059, 0.5170437, 0.0345758, -0.68674429, -0.14673694, 0.47579262, 0.56150987, -0.29034949, -1.39513466, 0.16279504, 0.19849221, 0.15716695, -0.22527721, -0.25705518, 0.8348101, 1.03030865, 1.28043115, 0.40420117, 0.89848864, 0.36055001, -0.0360149, -1.40861735, 0.67723824, 1.86397402, -0.75142316, -0.25173146, -1.93040481, -0.76291218, 0.59095251, 1.22924994, 0.11181195, 0.88024352, -0.55190819, -0.26173056, 0.28357247]);
  const b1 = new Float64Array([-0.33803904, -0.41199716, 0.23537183, -1.86581431, -1.20584533, -0.9003628, -0.23468973, 1.48437045, 1.69851188, 0.00904361, 0.85693675, 1.11730444, -0.52523835, 0.10553836, -0.58736075, -0.55050102, 0.15546679, -0.34885019, 0.1078346, 0.93300956, 0.79232931, -0.64502515, 0.45764037, -1.16121005]);
  const W2 = new Float64Array([-0.37393596, 1.15159192, 0.1824523, -0.26731168, -0.05720911, 1.22917534, -0.65294829, 1.11971149, -1.13803583, 0.63761103, -0.80219408, 1.51076734, 0.7556884, 0.66370524, -0.72021671, 0.95904115, 1.17129982, 0.13724208, -0.25796409, -0.67093495, -0.8481125, -0.59613772, 0.40108825, -1.22309996, 0.02788715, -1.11743334, -1.75283051, 1.44006025, 0.4980622, -0.44821891, -2.05165984, 0.06757798, -0.40158825, -0.48044753, -1.91191021, -0.08516204, 0.32755059, 0.257059, -0.47080251, 0.77802562, -0.59647752, 0.4817021, 1.83715776, -0.41060871, 2.10544493, 1.17642669, 0.28051111, 0.70949608, -1.87113232, 0.29283219, 0.8749088, -0.31603489, -1.0309071, -0.45341995, 0.00841106, 0.72869273, 0.15711421, -1.30128222, -0.41848939, 1.225724, -1.00430937, 0.2451959, 0.79998026, -1.06129922, -0.11982485, -1.20106105, -0.62456607, -0.15552228, 0.12346151, 1.44376752, -0.90881401, -2.00251175, -0.13106688, 1.61555104, -0.01993398, -0.57081676, -0.28402101, -0.1202483, 0.48173195, 0.65486338, -1.19537666, 0.62894913, -0.68055514, -0.03374258, 1.4037704, 0.55617319, -0.43865489, -0.62407863, -0.27697099, -0.42535534, -0.00807031, 0.07915315, 1.23584973, 1.17849946, -0.30729302, 0.71722793, 0.99789332, -0.59876214, -0.54309198, -0.4875348, 1.0291547, 0.07426415, -1.16285702, 0.2806771, -0.63933091, 1.29977618, -0.05650382, -1.31500905, 1.64094374, -0.86615416, 0.12522957, 0.36908618, 0.02242452, -0.36184338, 0.41283739, 0.92970976, 1.25696344, -0.3920845, 0.80658633, 0.39181255, -0.26912701, 0.61990196, -0.37500373, 0.60756543, -0.2613478, 0.51118007, 0.48030318, -0.45001615, 0.62112434, -0.85692381, 1.14525004, 1.05514542, 1.18478062, -0.9881818, -0.04680184, -0.80426325, -1.37269497, 0.31740059, -0.97367495, -0.42071306, 0.28631208, -0.10009326, -0.44460278, 1.24403238, -1.18172427, 0.26976427, 0.09967376, -0.73058992, 0.07600814, -0.13118571, 0.27249978, 2.31938678, 2.12266929, -0.12111302, -0.15099536, 0.29593842, -0.07509284, 0.70728875, -0.71132184, -0.83456501, 0.24882145, 0.68493987, -1.24411918, 1.17403925, -1.48874288, 1.11127771, -0.34766508, -0.28889369, -0.7540399, -0.11086791, 0.17926852, -0.21841317, -0.48013146, 0.13428403, 0.62632146, -1.93608508, 0.10728109, 0.56790619, -0.9381842, 0.23102297, -1.09967062, 0.17799278, -0.6050789, -0.03983778, 0.33762052, 0.02211713, -1.06561457, 0.48493016, 0.52019998, -0.40988775, -0.80706783, 0.2438401, 0.92342536, -1.52169421, -0.9678237, -0.6663503, -0.83531222, -0.68603232, -1.50448275, -0.80241329, 1.01972238, -0.84030593, 0.5255291, -0.67163656, -0.01983866, 0.12733629, 0.06356106, 0.95674683, -0.6215231, 0.47508335, -0.91732075, 1.8727386, -0.92733999, 0.17772118, 0.93397587, -0.04179366, -0.59211293, -0.97818168, -0.5108185, 1.12361486, -1.45571118, -0.36752689, -2.11969873, -0.82018984, 0.07669453, -0.92883921, -1.07035619, -0.62071617, -0.02441466, 0.09043094, 0.76772715, -0.03782876, 0.79126769, -0.38076047, -0.11128709, 0.56056888, 0.77171572, 0.49218078, -0.52601905, 0.11524593, -0.48788334, -0.65093358, 0.48619194, -0.83163586, -0.42640748, -1.19322989, 0.37777299, -0.70048548, -0.19711715, -0.92501285, 1.10698014, 0.10865249, -0.51710111, 0.57562304, 0.15451576, -0.95704581, 0.07407998, -0.25408551, -0.72939843, 0.76491823, 0.46609309, 0.9151154, -0.75122485, 1.30949255, -1.03661842, -1.37269412, -0.23854504, 0.60642854, -0.20613723, -0.01670691, -1.10057402, 0.24909788, -0.32045183, 1.92793561, -1.04890597, -0.5575572, 0.81939539, 0.99730708, -0.60469149, 0.58263532, 0.11393718, -0.1370322, 1.55949979, 0.18674661, 0.34536312, 1.2830411, 0.598958, -0.2560096, 0.28673034, -1.29651739, -1.71210647, 0.28755095, -0.43922679, 0.12284636, -2.29089728, 0.72477991, -0.72295875, 0.57439889, -0.62560759, 0.27973925, -0.31288745, 0.06977422, -0.8227549, 0.35568983, -1.00727143, -0.37975161, 0.53490521, -0.70696187, -0.1187228, 0.1897815, 1.35314167, -0.83817844, 0.36107685, -0.61934454, -0.1730371, -0.65831284, 0.96953733, 1.37187261, -0.199083, 1.37850158, 0.48947045, 0.31776558, 0.12565091, -0.67340861, -1.46128265, -0.83852442, -0.5616771, -0.19457766, -0.79513763, 0.35494343, 1.32228119, 0.62192466, 0.46410584, -0.08150468, -2.23702122, -0.05699212, -1.40969157, 0.60770803, 0.10871173, -0.01374249, 0.60270589, -0.73252127, 1.54233596, 0.90063162, 0.9340128, 0.04812008, 0.82313356, 1.38611692, 0.72022567, -0.65223893, 0.36735085, 0.60760194, 0.02439624, 1.3103059, 0.82208795, 0.41823298, 0.5034998, 0.30243541, 1.70421588, -0.37265761, 0.3634581, 0.52574083, -0.14121102, 0.51754939, 0.62700858, 1.09632402, -0.44525945, -1.35334186, 0.62940564, -0.03276213, -1.49986349, -1.61982869, 2.90043762, 0.3555833, 0.48901361, -0.68326327, -0.13736634, -1.50559777, 1.02251844, 1.37456423, 0.58204983, 0.16109986, 0.04656059, -0.02393766]);
  const b2 = new Float64Array([0.97756761, 0.31510598, -0.21962734, 0.55374228, -0.34200414, 0.5648376, -0.92900536, -0.36524739, 0.01789908, -0.24071138, 0.97067257, -0.93959335, 0.12036402, -0.1950135, -0.97384342, 0.78758166]);
  const W3 = new Float64Array([-0.76960695, 5.15217418, -3.77723283, 5.99151854, -2.61459115, -0.46627972, 3.36831449, -3.5877499, -1.76761523, -1.68114449, 1.17336251, 1.01949448, 0.00197056, -1.85023263, -2.06701869, 3.89292567, 0.2048345, 5.73578781, -0.16248639, 9.5874503, -0.07341634, 1.56959133, 3.68601423, -1.54709651, -2.23975633, -1.4534332, 0.41155521, 1.01740522, 1.85402974, -0.19461385, 1.76018761, 0.6388913, -0.39833903, 0.47443812, -0.79544527, 2.52206524, -0.93447859, -0.16794007, 1.17231198, 1.63514377, 0.47211038, -2.80765087, 0.21835063, 0.55174123, -4.68990561, -0.33312896, -2.15559096, -1.18054021, -0.8439894, 0.7389541, -0.10558286, 6.25279766, 4.24262548, 2.44618573, 1.49688804, 5.10312286, -1.68127428, 4.64046684, 1.61767399, 0.11329596, 0.57305959, -3.42452796, 0.29882436, -5.86476771, -0.57829303, 6.99275046, -4.36504698, 9.84829271, -5.72671088, -0.56801083, -0.42461716, -0.98922995, -4.67538224, -0.70191396, 3.26758545, 2.08732536, -0.88101073, 0.23819944, -0.7274521, 0.65386717]);
  const b3 = new Float64Array([0.71053979, -0.03406348, -0.75847829, -0.22446394, -0.67711414]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.01353763, 0.33004579, 0.00822616, 0.35886842, -1.8043078, -0.28737237, -1.0453292, 0.24874919, -0.10174036, -1.11253133, 0.08927255, 0.28386112, 0.40620077, 0.46601179, -0.36965952, -0.7883053, -0.52672495, 0.14665191, 0.94482201, -0.22358885, 0.88238582, -0.31405656, -1.23027474, 0.24459965, 0.35644041, 0.45450046, 0.22327586, -0.41711781, 1.07324058, 0.14492001, 0.66761213, -0.88113821, -1.00930285, -0.02323608, 0.3485386, 1.12997017, -0.38948433, -1.50377966, -0.20525646, -0.26115277, 0.55535867, 0.98115912, 1.14310444, -0.08293662, 0.60836983, 0.16594984, -0.08123755, -0.29320216, -0.52253673, -0.50471543, 0.91532098, -0.83047454, 0.70283846, 1.33374397, -0.21118957, -0.9244585, -1.42482559, 0.88322182, 0.2929653, -1.51227091, 0.01202583, -0.62201216, -0.36549951, -0.36860756, 0.30137762, -1.05455404, -0.88196043, -0.19761823, -1.67982454, -0.80329458, -0.57782571, 0.16502944, 1.16107027, 0.6895862, -0.30984632, -0.34606926, 0.21010942, -0.31738846, -0.84660976, 0.41070288, -0.32580529, 0.21973769, 1.12284974, 1.10679773, -0.03820944, 0.80354207, -0.04363122, -0.40746628, 0.10703161, 1.83956862, -0.39698054, -0.95863469, -0.22049276, -0.68196694, 0.47033164, 0.11297586, 1.07466775, -1.13625291, 0.14936161, 0.73538546, 1.34063303, -0.11588482, 1.28566019, 0.69886582, -0.299315, -0.735367, -0.82077065, -1.96054824, 0.46425557, 0.62114962, 2.15340803, 1.68387003, 0.62807547, -0.56508205, -1.56955429, -0.45706567, -1.06938015, 0.6750363, 0.93741609, -1.01710549, -1.8473554, -0.34364676, -0.76717197, -0.19704449, 0.24256599, -0.55460014, -0.97617686, -0.44756122, -1.02536779, 0.66638365, 0.46005452, 0.24310196, 0.86563037, -1.2290433, -0.00113239, -1.15364606, -0.87377765, 1.6713482, 0.52855141, -0.17363456, 0.91696888, -1.10985885, -1.5243074, 0.9761965, 0.31145549, -0.58665213, 1.22871917, -0.59877613, 0.65385255, -0.92051302, -0.2711693, 0.22297875, -0.8978512, -0.14816036, 0.51428622, -0.39897055, 0.43804816, -0.91959658, -0.26208953, -0.29252112, -0.64102587, -0.17579119, 0.90543102, -0.17870907, 0.42985301, -1.90492336, 0.01802391, -1.36326535, -0.3144239, -0.19380372, 0.26309362, 0.87697086, 0.47192111, 0.1949243, -0.2468271, -0.28650022, 0.15104356, -0.861016, 0.32493731, -0.50074332, 0.25153338, 0.8328458, 0.34134375, -0.31576444, -0.03568048, -0.38104081, -0.47314062, -0.28784945, -1.19867547, -0.79143758, 0.90188296, 0.38034246, -0.47631209, -0.89336872, -0.41036732, -0.48138741, 1.09583185, -0.99661435, 0.08076235, -0.49414971, -1.22027001, 1.56720959, 0.08880457, 0.75347388, -1.75220911, -0.33509859, -0.91128483, 0.27891256, 0.13860914, 0.17900179, 0.8122974, 1.33074093, 0.59727895, -0.18771788, 0.35020193, 1.03713473, -0.48408231, -0.64742854, -0.65957732, 0.56555961, -0.01060409, -0.59797346, -1.05377489, 0.26839501, -0.32737094, 0.14230516, -0.37118777, -0.19830392, 0.47338522, 0.40227788, -1.37520557, 1.4363408, -0.87528554, 0.05729977, -0.5434167, 1.60246163, -1.13718579, 0.08578295, -0.33596302, -1.8826895, 0.18656253, -2.93147655, -1.82463798, -0.94091564, 0.50760705, -0.7890835, -0.62621456, -1.34781718, -0.79295788, 0.71804484, -0.06598897, -0.05808285, -0.08141327, -1.93631289, 0.27288844, -1.06419151, -1.63321224, 0.1701352, -0.9013602, 0.29463475, -0.63456307, 0.07824167, 1.37120164, -0.40002507, -0.60511997, 0.2689902, 0.04597612, -0.41143101, 1.58415349, -2.43439951, -0.83129515, -0.2529449, 0.04291178, -1.00371506, -0.21624652, -0.14257832, 0.17296709, -0.12851589, -1.39841487, -0.99308546, -1.72815296, -1.29411529, 0.39527531, -0.74653114, -0.85842851, -0.01747029, -0.30605403, 0.42024614, -0.24371279, 0.68022871, 0.47450622, -0.40783863, -0.25584687, -0.91955627, 0.81593108, -0.46059048, 0.50886525, -0.70145985, 0.37938827, -0.0998973, 0.80061903, 0.13207972, 0.07266292, -1.14253882, 0.60273412, 0.50173371, -1.72907423, -0.15339819, 0.41576297, 0.84295162, -0.83613549, -1.12048261, 0.58126163, 0.99710691, -0.01646309, -1.16660096, 0.38705826, 1.70153535, 0.02727584, -0.16799862, -0.36408064, 0.07791623, -0.31789771, -0.007193, -0.6430638, -1.12449685, 0.7891154, -0.24357575, 0.19557035, -0.05439458, 1.24705975, 1.20973283, 0.36633439, 1.28412419, -0.25684119, 0.89556026, 1.04482913, 0.19260308, -1.7103272, -0.14829397, 1.4270135, 0.23366284, 0.13620669, 0.34447991, -0.37962617, 2.47950023, -0.20932541, 1.11942843, 0.83462928, -0.42820488, 1.29229121, 0.09469087, -0.42387939, -1.62349615, -0.83591992, 0.12298494, -0.53489658, 0.72756261, 0.38510085, -0.60442851, -0.67783326, -0.11256074, -0.89013123, 0.02775493, 0.60432029, -0.73807407, 0.31089978, 0.88021578, -0.5026667, -1.5279745, 0.39883845, 1.40364461, -1.19497576, 1.35951285, -0.07658098, -0.02113873, 1.02044114, 0.39347002, -1.06690989, 1.09797369, 0.58155837, 0.3028738, -0.88253536, -0.38626964, 2.11092549, -0.64696919, 0.36342441, -0.26248011, -0.92060058, -0.03358354, 1.31767736, -1.49901898, 1.95655645, -0.46726006, 0.37177961, -0.34350788, -0.27663622, -0.81936785, 1.30580043, 0.86094474, -0.2773493, -0.59054939, 3.37515957, 0.00940809, 1.18891187, -0.83915445, -1.0685727, 0.39880899, 0.65391805, 1.31192557, 0.47820242, -1.14756935, -0.73953691, -0.17785303, 0.54325952, -0.9192833, -0.54161194, 0.433652, 0.04882988, 0.52501944, 0.5940361, 0.45584547, -1.3232963, -0.03810959, -0.88891145, -1.81903104, 0.19025916, 0.95983911, 0.03045051, -0.55432255, 2.03470434, 1.28866079, 0.27879056, 0.94065308, 0.71351668, 0.21981579, -0.88403057, 0.44617074, 0.01738964, -2.08127998, -1.19496811, -0.66561216, -0.72493995, 1.09988579, -0.4135468, 0.08857152, -0.05203288, 0.6249899, -1.22359741, 0.58312852, 0.10478994, 0.4513955, 0.88894505, 0.82011591, -2.17584612, -0.96862101, -0.36922893, 0.1650896, 0.26820634, 2.10671904, -0.03665456, -1.27609059, -1.47058312, 0.71920294, -0.19835522, -0.88089632, 1.62586673, 1.97167109, -0.50472787, -0.59846377, 0.91871982, 1.12659493, -0.79233935, -0.35904759, 0.23787154, 0.28275118, -1.26777857, -1.33518839, 0.14652714, -0.19810054, -0.95455203, -0.95850448, 0.55588354, -0.55020351, 1.38334709, 1.11369773, -0.54884052, -0.77168292, -0.55468131, -0.98166333, 0.2563449, -0.81293219, 0.2951542, -0.03110814, -0.72873402, -1.62959823, -1.15859875, 0.06083274, 0.14124272, -0.8184945, 0.28423672, 0.52048695, -0.04103425, 1.78710824, -0.14592822, 0.21848889, -0.08227564, -0.21762868, 0.08389486, -0.61639157, 1.18522209, 0.50670967, 0.56782973, -0.76316632, 0.06394491, -0.82670245, 2.23858176, -0.46628851, -0.961605, 1.06560819, -1.35179779, -1.01563361, 1.17578018, -0.70350101, 0.45990498, 1.87333076, -1.0318943, 0.61502059, 0.00653848, -0.05961907, -1.30829462, -2.06287894, -0.2454776, -0.82224822, 0.18908161, -1.06871801, 0.02792408, -1.23603097, -0.60452983, -0.81519541, -0.97303824, 1.50324211, 1.5601864, -0.39084941, -0.20388797, 0.2796566, -0.24204798, 0.7810208, -1.67772718, -1.35091061, -0.42328995, 0.61189013, 0.29815532, -0.05999768, 0.60308285, -0.80656043, 0.6945748, -0.45935382, -1.04975775, 1.17191653, 0.02270975, -0.80137794, 0.06882234, -0.52399749, -0.10259893, -0.22645157, -0.13349001, -0.63448583, -0.39926832, 0.26909307, -1.47855374, 0.80809594, 0.40510109, 0.25790394, -0.25019665, 0.25188169, -0.09530154, 1.06564047, -0.93125429, -0.76430469, -0.08740516, 0.32870052, 0.42334882, -1.53016779, 2.54399191, -1.28062878, -0.63207921, 1.00250408, 1.2390698, 0.43718348, -0.26344179, -1.26285751, -1.38353294, -1.19560457, 0.36403555, 1.30837566, -0.74671108, -1.08680289, -0.64096716, -1.07698792, -2.47885815, -0.6788102, -2.28634948, 0.17607594, -1.91128657, -0.34688336, 0.68977429, -1.05933711, -1.20012373, -1.24633229, 1.85759755, 0.88453415, -0.21140062, 1.85373059, -0.92836131, 0.07317612, -0.23366802, 0.12253088, -0.28590968, 0.52141721, 0.1543498, 0.27456854, -0.24960454, 0.46044237, -0.43738137, 0.47345797, -1.54742205, 1.57917609, -0.28329407, 0.5189566, 1.01688854, -0.27816722, -0.01866198, 0.54939753, -1.33931495, 1.68587293, 0.85208831, 1.22644248, 0.71163242, 0.9397495, -0.08276695, 0.47398808, -0.45569571, 0.86097458, 0.00048273, 0.20124949, 0.15013739, -1.10784673, 0.95877738, -0.78955273, -0.23631765, -0.47930061, 0.88673255, 0.70759046, -0.39689871, 1.46099923, 0.33377888, 1.1108557, 0.45788554, 0.0481544, 0.20687298, 0.11671373, -1.21880586, -0.31520967, -0.62730701, -0.66276557, 0.73131128, -0.06292041, 0.03633975, -0.90907993, 0.42428064, 0.24893022, -0.48655309, 1.08818806, -0.71592885, 0.02553074, -1.34215111, 1.20580465, 0.7892667, -0.2617037, -0.36170489, -0.38105274, -0.40079438, -0.60922555, 0.20923854, 0.49649407, 0.27576769, -0.40345314, 0.65731804, 0.26866603, -1.42493628, 0.7264225, -0.32203832, 0.36505339, -0.07521714, -0.32734552, 1.32712114, 1.26320072, -0.25948844, -1.45039225, 0.05594043, -1.17164528, 0.46281827, -0.33233146, 0.15262256, 0.27637895, -0.30329345, -0.62363844, 0.58898957, -1.90779837, 0.23901863, -2.06830301, -0.16346558, -0.59890411, -0.21634316, -1.03207702, 0.33435914, -0.48444242, -0.03396762, -0.54908697, -0.02300152, 1.14485933, 0.43642413, -1.33648919, 1.45039924, -0.68232564, -1.35017492, -0.08131544, -0.03926632, -0.04106236, 0.67553513, -0.98204592, 0.20062502, 0.12694253, -0.67060096, -0.05767077, 0.06034381, -0.52695029, 0.9873127, 1.15924799, -1.04478594, 0.51445103, -1.7733777, 0.36352996, 0.2670504, -0.44389911, -0.00951745, -1.37471798, -0.30043155, 0.45265041, -0.44108126, -0.93380974, 0.01123475, 1.04638666, 0.02761617, -0.94500398, 0.03733002, 1.42081918, -0.35939667, 0.33362599, 0.40669021, -0.11269968, 0.77173548, -0.21439775, -1.04443905, -0.13415581, -0.39751096, 0.09126597, 0.04284529, 0.05834636, 0.3982566, 0.14497739, -0.20426588, -0.55688591, -1.55756943, 1.38392311, -0.39793361, 0.26196548, -0.83255368, -1.3107868, 0.50036997, -0.82801969, -0.58475799, -1.0591635, 0.15133576, 2.04529368, -0.68842042, 0.28711827, -1.37213556, -1.34335526, 0.02993351, -1.1432537, 0.03299097, -0.40009081, 0.38683951, 0.31083133, -0.25719153, 0.50859074, -0.74614072, 0.99722077, -0.09831068, 0.66781027, -1.2738888, 0.47515389, 0.09352394, 0.9429222, 0.46048472, -1.22296615, 0.64618544, 0.6449593, -1.22759011, -0.07691448, -1.3100073, 0.20930579, 0.79554914, 1.03814966, 0.40682959, -1.73714393, -0.29190177, -0.48984985, 0.00214294, 0.91133783, 0.51477812, 1.64060769, -0.61057218, 0.95273783, -0.88578953, 1.77219631, 0.59130063, -0.32097308, -0.35905662, 0.01161622, -0.01568177, -0.88759929, -0.7713039, -0.41152533, 2.45777636, -1.58511195, 0.13247956, 0.04229733, -0.07462446, -0.9459986, 0.63875347, 0.69926503, -0.8543972, -0.39546391, 0.67162687, 1.35228365, 0.58572566, 1.75912831, 0.29326272, -1.13289563, 0.62465929, 0.98947382, -0.20522795, -2.12739971, -1.04702689, 1.18651795, -0.31853552, 0.39955208, 0.08361013, -0.95678834, -0.32676923, 0.40535131, -0.97981103, 0.94860515, -0.61414279, -0.17724566, 0.3503274, -0.76590623, 1.63489894, 0.40914546, -0.73365926, 0.30539378, 0.41657822, -1.03489467, -1.23730987, -1.30256017, -0.12196743, 1.16289091, 0.27911987, -1.2217759, -0.34503518, -1.00755712, 0.01551766, 0.09303302, -1.54178759, -0.01936236, 0.30015587, 0.95025814, -0.02177135, -0.45531962, -0.99627715, -0.64815898, -0.28520845, -1.44974135, -0.48359967, -1.33158817, 0.88718995, -0.11618905, -0.26768185, 1.3709179, 0.70524479, -0.8055552, -1.16428222, 0.71161186, -1.40778667, 0.00096492, 0.36006822, -2.26280628, -0.05334779, 0.78429873, 1.15036266, -0.81036249, 0.54243173, 0.42424546, 0.27426405, 1.06936654, 0.6329521, -0.34132517, 0.84449937, 0.28570044, 0.87163393, -0.47233544, -0.85648959, 0.47400729, 0.01110332, 0.67257133, 1.31111735, -0.2898128, -0.94529257, -0.83928096, -0.65803623, -0.08353724, 0.14915999, 1.11215025, 0.27924469, 0.0000738, 0.19885291, -1.4247189, -0.46160807, 0.31642785, -0.1533155, 0.92100929, 0.64763556, 0.37827734, 0.41355769, 0.64846488, -0.95333607, -1.01451795, -0.67380126, -0.05538561, -0.53975594, 0.19015177, 1.04901076, 0.37847728, -1.79111798, -1.00846756, 1.56261716, 0.11540556, -0.61465476, -0.45954402, 1.6428576, -0.06294454, 0.26805408, -0.69999105, -1.08314572, 0.75169248, -1.35559255, 1.1866959, -0.89518608, -0.3926671, -0.69710601, -0.8669487, 0.75390949, -0.38128266, 1.54026393, -0.82151451, 0.45958341, 0.02998691, 0.23534219, -0.78983861, -0.79727194, -1.09944124, -0.38560402, -0.22343808, -0.20402028, 0.61939086, 0.29833457, 0.37687584, -0.76114405, 0.39441621, -0.02458621, 0.27814813, 2.40745216, -1.038333, 0.28583734, -0.23793059, 0.5170437, 0.0345758, -0.68674429, -0.14673694, 0.47579262, 0.56150987, -0.29034949, -1.39513466, 0.16279504, 0.19849221, 0.15716695, -0.22527721, -0.25705518, 0.8348101, 1.03030865, 1.28043115, 0.40420117, 0.89848864, 0.36055001, -0.0360149, -1.40861735, 0.67723824, 1.86397402, -0.75142316, -0.25173146, -1.93040481, -0.76291218, 0.59095251, 1.22924994, 0.11181195, 0.88024352, -0.55190819, -0.26173056, 0.28357247]);
  const b1 = new Float64Array([-0.33803904, -0.41199716, 0.23537183, -1.86581431, -1.20584533, -0.9003628, -0.23468973, 1.48437045, 1.69851188, 0.00904361, 0.85693675, 1.11730444, -0.52523835, 0.10553836, -0.58736075, -0.55050102, 0.15546679, -0.34885019, 0.1078346, 0.93300956, 0.79232931, -0.64502515, 0.45764037, -1.16121005]);
  const W2 = new Float64Array([-0.37393596, 1.15159192, 0.1824523, -0.26731168, -0.05720911, 1.22917534, -0.65294829, 1.11971149, -1.13803583, 0.63761103, -0.80219408, 1.51076734, 0.7556884, 0.66370524, -0.72021671, 0.95904115, 1.17129982, 0.13724208, -0.25796409, -0.67093495, -0.8481125, -0.59613772, 0.40108825, -1.22309996, 0.02788715, -1.11743334, -1.75283051, 1.44006025, 0.4980622, -0.44821891, -2.05165984, 0.06757798, -0.40158825, -0.48044753, -1.91191021, -0.08516204, 0.32755059, 0.257059, -0.47080251, 0.77802562, -0.59647752, 0.4817021, 1.83715776, -0.41060871, 2.10544493, 1.17642669, 0.28051111, 0.70949608, -1.87113232, 0.29283219, 0.8749088, -0.31603489, -1.0309071, -0.45341995, 0.00841106, 0.72869273, 0.15711421, -1.30128222, -0.41848939, 1.225724, -1.00430937, 0.2451959, 0.79998026, -1.06129922, -0.11982485, -1.20106105, -0.62456607, -0.15552228, 0.12346151, 1.44376752, -0.90881401, -2.00251175, -0.13106688, 1.61555104, -0.01993398, -0.57081676, -0.28402101, -0.1202483, 0.48173195, 0.65486338, -1.19537666, 0.62894913, -0.68055514, -0.03374258, 1.4037704, 0.55617319, -0.43865489, -0.62407863, -0.27697099, -0.42535534, -0.00807031, 0.07915315, 1.23584973, 1.17849946, -0.30729302, 0.71722793, 0.99789332, -0.59876214, -0.54309198, -0.4875348, 1.0291547, 0.07426415, -1.16285702, 0.2806771, -0.63933091, 1.29977618, -0.05650382, -1.31500905, 1.64094374, -0.86615416, 0.12522957, 0.36908618, 0.02242452, -0.36184338, 0.41283739, 0.92970976, 1.25696344, -0.3920845, 0.80658633, 0.39181255, -0.26912701, 0.61990196, -0.37500373, 0.60756543, -0.2613478, 0.51118007, 0.48030318, -0.45001615, 0.62112434, -0.85692381, 1.14525004, 1.05514542, 1.18478062, -0.9881818, -0.04680184, -0.80426325, -1.37269497, 0.31740059, -0.97367495, -0.42071306, 0.28631208, -0.10009326, -0.44460278, 1.24403238, -1.18172427, 0.26976427, 0.09967376, -0.73058992, 0.07600814, -0.13118571, 0.27249978, 2.31938678, 2.12266929, -0.12111302, -0.15099536, 0.29593842, -0.07509284, 0.70728875, -0.71132184, -0.83456501, 0.24882145, 0.68493987, -1.24411918, 1.17403925, -1.48874288, 1.11127771, -0.34766508, -0.28889369, -0.7540399, -0.11086791, 0.17926852, -0.21841317, -0.48013146, 0.13428403, 0.62632146, -1.93608508, 0.10728109, 0.56790619, -0.9381842, 0.23102297, -1.09967062, 0.17799278, -0.6050789, -0.03983778, 0.33762052, 0.02211713, -1.06561457, 0.48493016, 0.52019998, -0.40988775, -0.80706783, 0.2438401, 0.92342536, -1.52169421, -0.9678237, -0.6663503, -0.83531222, -0.68603232, -1.50448275, -0.80241329, 1.01972238, -0.84030593, 0.5255291, -0.67163656, -0.01983866, 0.12733629, 0.06356106, 0.95674683, -0.6215231, 0.47508335, -0.91732075, 1.8727386, -0.92733999, 0.17772118, 0.93397587, -0.04179366, -0.59211293, -0.97818168, -0.5108185, 1.12361486, -1.45571118, -0.36752689, -2.11969873, -0.82018984, 0.07669453, -0.92883921, -1.07035619, -0.62071617, -0.02441466, 0.09043094, 0.76772715, -0.03782876, 0.79126769, -0.38076047, -0.11128709, 0.56056888, 0.77171572, 0.49218078, -0.52601905, 0.11524593, -0.48788334, -0.65093358, 0.48619194, -0.83163586, -0.42640748, -1.19322989, 0.37777299, -0.70048548, -0.19711715, -0.92501285, 1.10698014, 0.10865249, -0.51710111, 0.57562304, 0.15451576, -0.95704581, 0.07407998, -0.25408551, -0.72939843, 0.76491823, 0.46609309, 0.9151154, -0.75122485, 1.30949255, -1.03661842, -1.37269412, -0.23854504, 0.60642854, -0.20613723, -0.01670691, -1.10057402, 0.24909788, -0.32045183, 1.92793561, -1.04890597, -0.5575572, 0.81939539, 0.99730708, -0.60469149, 0.58263532, 0.11393718, -0.1370322, 1.55949979, 0.18674661, 0.34536312, 1.2830411, 0.598958, -0.2560096, 0.28673034, -1.29651739, -1.71210647, 0.28755095, -0.43922679, 0.12284636, -2.29089728, 0.72477991, -0.72295875, 0.57439889, -0.62560759, 0.27973925, -0.31288745, 0.06977422, -0.8227549, 0.35568983, -1.00727143, -0.37975161, 0.53490521, -0.70696187, -0.1187228, 0.1897815, 1.35314167, -0.83817844, 0.36107685, -0.61934454, -0.1730371, -0.65831284, 0.96953733, 1.37187261, -0.199083, 1.37850158, 0.48947045, 0.31776558, 0.12565091, -0.67340861, -1.46128265, -0.83852442, -0.5616771, -0.19457766, -0.79513763, 0.35494343, 1.32228119, 0.62192466, 0.46410584, -0.08150468, -2.23702122, -0.05699212, -1.40969157, 0.60770803, 0.10871173, -0.01374249, 0.60270589, -0.73252127, 1.54233596, 0.90063162, 0.9340128, 0.04812008, 0.82313356, 1.38611692, 0.72022567, -0.65223893, 0.36735085, 0.60760194, 0.02439624, 1.3103059, 0.82208795, 0.41823298, 0.5034998, 0.30243541, 1.70421588, -0.37265761, 0.3634581, 0.52574083, -0.14121102, 0.51754939, 0.62700858, 1.09632402, -0.44525945, -1.35334186, 0.62940564, -0.03276213, -1.49986349, -1.61982869, 2.90043762, 0.3555833, 0.48901361, -0.68326327, -0.13736634, -1.50559777, 1.02251844, 1.37456423, 0.58204983, 0.16109986, 0.04656059, -0.02393766]);
  const b2 = new Float64Array([0.97756761, 0.31510598, -0.21962734, 0.55374228, -0.34200414, 0.5648376, -0.92900536, -0.36524739, 0.01789908, -0.24071138, 0.97067257, -0.93959335, 0.12036402, -0.1950135, -0.97384342, 0.78758166]);
  const W3 = new Float64Array([-0.76960695, 5.15217418, -3.77723283, 5.99151854, -2.61459115, -0.46627972, 3.36831449, -3.5877499, -1.76761523, -1.68114449, 1.17336251, 1.01949448, 0.00197056, -1.85023263, -2.06701869, 3.89292567, 0.2048345, 5.73578781, -0.16248639, 9.5874503, -0.07341634, 1.56959133, 3.68601423, -1.54709651, -2.23975633, -1.4534332, 0.41155521, 1.01740522, 1.85402974, -0.19461385, 1.76018761, 0.6388913, -0.39833903, 0.47443812, -0.79544527, 2.52206524, -0.93447859, -0.16794007, 1.17231198, 1.63514377, 0.47211038, -2.80765087, 0.21835063, 0.55174123, -4.68990561, -0.33312896, -2.15559096, -1.18054021, -0.8439894, 0.7389541, -0.10558286, 6.25279766, 4.24262548, 2.44618573, 1.49688804, 5.10312286, -1.68127428, 4.64046684, 1.61767399, 0.11329596, 0.57305959, -3.42452796, 0.29882436, -5.86476771, -0.57829303, 6.99275046, -4.36504698, 9.84829271, -5.72671088, -0.56801083, -0.42461716, -0.98922995, -4.67538224, -0.70191396, 3.26758545, 2.08732536, -0.88101073, 0.23819944, -0.7274521, 0.65386717]);
  const b3 = new Float64Array([0.71053979, -0.03406348, -0.75847829, -0.22446394, -0.67711414]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.01353763, 0.33004579, 0.00822616, 0.35886842, -1.8043078, -0.28737237, -1.0453292, 0.24874919, -0.10174036, -1.11253133, 0.08927255, 0.28386112, 0.40620077, 0.46601179, -0.36965952, -0.7883053, -0.52672495, 0.14665191, 0.94482201, -0.22358885, 0.88238582, -0.31405656, -1.23027474, 0.24459965, 0.35644041, 0.45450046, 0.22327586, -0.41711781, 1.07324058, 0.14492001, 0.66761213, -0.88113821, -1.00930285, -0.02323608, 0.3485386, 1.12997017, -0.38948433, -1.50377966, -0.20525646, -0.26115277, 0.55535867, 0.98115912, 1.14310444, -0.08293662, 0.60836983, 0.16594984, -0.08123755, -0.29320216, -0.52253673, -0.50471543, 0.91532098, -0.83047454, 0.70283846, 1.33374397, -0.21118957, -0.9244585, -1.42482559, 0.88322182, 0.2929653, -1.51227091, 0.01202583, -0.62201216, -0.36549951, -0.36860756, 0.30137762, -1.05455404, -0.88196043, -0.19761823, -1.67982454, -0.80329458, -0.57782571, 0.16502944, 1.16107027, 0.6895862, -0.30984632, -0.34606926, 0.21010942, -0.31738846, -0.84660976, 0.41070288, -0.32580529, 0.21973769, 1.12284974, 1.10679773, -0.03820944, 0.80354207, -0.04363122, -0.40746628, 0.10703161, 1.83956862, -0.39698054, -0.95863469, -0.22049276, -0.68196694, 0.47033164, 0.11297586, 1.07466775, -1.13625291, 0.14936161, 0.73538546, 1.34063303, -0.11588482, 1.28566019, 0.69886582, -0.299315, -0.735367, -0.82077065, -1.96054824, 0.46425557, 0.62114962, 2.15340803, 1.68387003, 0.62807547, -0.56508205, -1.56955429, -0.45706567, -1.06938015, 0.6750363, 0.93741609, -1.01710549, -1.8473554, -0.34364676, -0.76717197, -0.19704449, 0.24256599, -0.55460014, -0.97617686, -0.44756122, -1.02536779, 0.66638365, 0.46005452, 0.24310196, 0.86563037, -1.2290433, -0.00113239, -1.15364606, -0.87377765, 1.6713482, 0.52855141, -0.17363456, 0.91696888, -1.10985885, -1.5243074, 0.9761965, 0.31145549, -0.58665213, 1.22871917, -0.59877613, 0.65385255, -0.92051302, -0.2711693, 0.22297875, -0.8978512, -0.14816036, 0.51428622, -0.39897055, 0.43804816, -0.91959658, -0.26208953, -0.29252112, -0.64102587, -0.17579119, 0.90543102, -0.17870907, 0.42985301, -1.90492336, 0.01802391, -1.36326535, -0.3144239, -0.19380372, 0.26309362, 0.87697086, 0.47192111, 0.1949243, -0.2468271, -0.28650022, 0.15104356, -0.861016, 0.32493731, -0.50074332, 0.25153338, 0.8328458, 0.34134375, -0.31576444, -0.03568048, -0.38104081, -0.47314062, -0.28784945, -1.19867547, -0.79143758, 0.90188296, 0.38034246, -0.47631209, -0.89336872, -0.41036732, -0.48138741, 1.09583185, -0.99661435, 0.08076235, -0.49414971, -1.22027001, 1.56720959, 0.08880457, 0.75347388, -1.75220911, -0.33509859, -0.91128483, 0.27891256, 0.13860914, 0.17900179, 0.8122974, 1.33074093, 0.59727895, -0.18771788, 0.35020193, 1.03713473, -0.48408231, -0.64742854, -0.65957732, 0.56555961, -0.01060409, -0.59797346, -1.05377489, 0.26839501, -0.32737094, 0.14230516, -0.37118777, -0.19830392, 0.47338522, 0.40227788, -1.37520557, 1.4363408, -0.87528554, 0.05729977, -0.5434167, 1.60246163, -1.13718579, 0.08578295, -0.33596302, -1.8826895, 0.18656253, -2.93147655, -1.82463798, -0.94091564, 0.50760705, -0.7890835, -0.62621456, -1.34781718, -0.79295788, 0.71804484, -0.06598897, -0.05808285, -0.08141327, -1.93631289, 0.27288844, -1.06419151, -1.63321224, 0.1701352, -0.9013602, 0.29463475, -0.63456307, 0.07824167, 1.37120164, -0.40002507, -0.60511997, 0.2689902, 0.04597612, -0.41143101, 1.58415349, -2.43439951, -0.83129515, -0.2529449, 0.04291178, -1.00371506, -0.21624652, -0.14257832, 0.17296709, -0.12851589, -1.39841487, -0.99308546, -1.72815296, -1.29411529, 0.39527531, -0.74653114, -0.85842851, -0.01747029, -0.30605403, 0.42024614, -0.24371279, 0.68022871, 0.47450622, -0.40783863, -0.25584687, -0.91955627, 0.81593108, -0.46059048, 0.50886525, -0.70145985, 0.37938827, -0.0998973, 0.80061903, 0.13207972, 0.07266292, -1.14253882, 0.60273412, 0.50173371, -1.72907423, -0.15339819, 0.41576297, 0.84295162, -0.83613549, -1.12048261, 0.58126163, 0.99710691, -0.01646309, -1.16660096, 0.38705826, 1.70153535, 0.02727584, -0.16799862, -0.36408064, 0.07791623, -0.31789771, -0.007193, -0.6430638, -1.12449685, 0.7891154, -0.24357575, 0.19557035, -0.05439458, 1.24705975, 1.20973283, 0.36633439, 1.28412419, -0.25684119, 0.89556026, 1.04482913, 0.19260308, -1.7103272, -0.14829397, 1.4270135, 0.23366284, 0.13620669, 0.34447991, -0.37962617, 2.47950023, -0.20932541, 1.11942843, 0.83462928, -0.42820488, 1.29229121, 0.09469087, -0.42387939, -1.62349615, -0.83591992, 0.12298494, -0.53489658, 0.72756261, 0.38510085, -0.60442851, -0.67783326, -0.11256074, -0.89013123, 0.02775493, 0.60432029, -0.73807407, 0.31089978, 0.88021578, -0.5026667, -1.5279745, 0.39883845, 1.40364461, -1.19497576, 1.35951285, -0.07658098, -0.02113873, 1.02044114, 0.39347002, -1.06690989, 1.09797369, 0.58155837, 0.3028738, -0.88253536, -0.38626964, 2.11092549, -0.64696919, 0.36342441, -0.26248011, -0.92060058, -0.03358354, 1.31767736, -1.49901898, 1.95655645, -0.46726006, 0.37177961, -0.34350788, -0.27663622, -0.81936785, 1.30580043, 0.86094474, -0.2773493, -0.59054939, 3.37515957, 0.00940809, 1.18891187, -0.83915445, -1.0685727, 0.39880899, 0.65391805, 1.31192557, 0.47820242, -1.14756935, -0.73953691, -0.17785303, 0.54325952, -0.9192833, -0.54161194, 0.433652, 0.04882988, 0.52501944, 0.5940361, 0.45584547, -1.3232963, -0.03810959, -0.88891145, -1.81903104, 0.19025916, 0.95983911, 0.03045051, -0.55432255, 2.03470434, 1.28866079, 0.27879056, 0.94065308, 0.71351668, 0.21981579, -0.88403057, 0.44617074, 0.01738964, -2.08127998, -1.19496811, -0.66561216, -0.72493995, 1.09988579, -0.4135468, 0.08857152, -0.05203288, 0.6249899, -1.22359741, 0.58312852, 0.10478994, 0.4513955, 0.88894505, 0.82011591, -2.17584612, -0.96862101, -0.36922893, 0.1650896, 0.26820634, 2.10671904, -0.03665456, -1.27609059, -1.47058312, 0.71920294, -0.19835522, -0.88089632, 1.62586673, 1.97167109, -0.50472787, -0.59846377, 0.91871982, 1.12659493, -0.79233935, -0.35904759, 0.23787154, 0.28275118, -1.26777857, -1.33518839, 0.14652714, -0.19810054, -0.95455203, -0.95850448, 0.55588354, -0.55020351, 1.38334709, 1.11369773, -0.54884052, -0.77168292, -0.55468131, -0.98166333, 0.2563449, -0.81293219, 0.2951542, -0.03110814, -0.72873402, -1.62959823, -1.15859875, 0.06083274, 0.14124272, -0.8184945, 0.28423672, 0.52048695, -0.04103425, 1.78710824, -0.14592822, 0.21848889, -0.08227564, -0.21762868, 0.08389486, -0.61639157, 1.18522209, 0.50670967, 0.56782973, -0.76316632, 0.06394491, -0.82670245, 2.23858176, -0.46628851, -0.961605, 1.06560819, -1.35179779, -1.01563361, 1.17578018, -0.70350101, 0.45990498, 1.87333076, -1.0318943, 0.61502059, 0.00653848, -0.05961907, -1.30829462, -2.06287894, -0.2454776, -0.82224822, 0.18908161, -1.06871801, 0.02792408, -1.23603097, -0.60452983, -0.81519541, -0.97303824, 1.50324211, 1.5601864, -0.39084941, -0.20388797, 0.2796566, -0.24204798, 0.7810208, -1.67772718, -1.35091061, -0.42328995, 0.61189013, 0.29815532, -0.05999768, 0.60308285, -0.80656043, 0.6945748, -0.45935382, -1.04975775, 1.17191653, 0.02270975, -0.80137794, 0.06882234, -0.52399749, -0.10259893, -0.22645157, -0.13349001, -0.63448583, -0.39926832, 0.26909307, -1.47855374, 0.80809594, 0.40510109, 0.25790394, -0.25019665, 0.25188169, -0.09530154, 1.06564047, -0.93125429, -0.76430469, -0.08740516, 0.32870052, 0.42334882, -1.53016779, 2.54399191, -1.28062878, -0.63207921, 1.00250408, 1.2390698, 0.43718348, -0.26344179, -1.26285751, -1.38353294, -1.19560457, 0.36403555, 1.30837566, -0.74671108, -1.08680289, -0.64096716, -1.07698792, -2.47885815, -0.6788102, -2.28634948, 0.17607594, -1.91128657, -0.34688336, 0.68977429, -1.05933711, -1.20012373, -1.24633229, 1.85759755, 0.88453415, -0.21140062, 1.85373059, -0.92836131, 0.07317612, -0.23366802, 0.12253088, -0.28590968, 0.52141721, 0.1543498, 0.27456854, -0.24960454, 0.46044237, -0.43738137, 0.47345797, -1.54742205, 1.57917609, -0.28329407, 0.5189566, 1.01688854, -0.27816722, -0.01866198, 0.54939753, -1.33931495, 1.68587293, 0.85208831, 1.22644248, 0.71163242, 0.9397495, -0.08276695, 0.47398808, -0.45569571, 0.86097458, 0.00048273, 0.20124949, 0.15013739, -1.10784673, 0.95877738, -0.78955273, -0.23631765, -0.47930061, 0.88673255, 0.70759046, -0.39689871, 1.46099923, 0.33377888, 1.1108557, 0.45788554, 0.0481544, 0.20687298, 0.11671373, -1.21880586, -0.31520967, -0.62730701, -0.66276557, 0.73131128, -0.06292041, 0.03633975, -0.90907993, 0.42428064, 0.24893022, -0.48655309, 1.08818806, -0.71592885, 0.02553074, -1.34215111, 1.20580465, 0.7892667, -0.2617037, -0.36170489, -0.38105274, -0.40079438, -0.60922555, 0.20923854, 0.49649407, 0.27576769, -0.40345314, 0.65731804, 0.26866603, -1.42493628, 0.7264225, -0.32203832, 0.36505339, -0.07521714, -0.32734552, 1.32712114, 1.26320072, -0.25948844, -1.45039225, 0.05594043, -1.17164528, 0.46281827, -0.33233146, 0.15262256, 0.27637895, -0.30329345, -0.62363844, 0.58898957, -1.90779837, 0.23901863, -2.06830301, -0.16346558, -0.59890411, -0.21634316, -1.03207702, 0.33435914, -0.48444242, -0.03396762, -0.54908697, -0.02300152, 1.14485933, 0.43642413, -1.33648919, 1.45039924, -0.68232564, -1.35017492, -0.08131544, -0.03926632, -0.04106236, 0.67553513, -0.98204592, 0.20062502, 0.12694253, -0.67060096, -0.05767077, 0.06034381, -0.52695029, 0.9873127, 1.15924799, -1.04478594, 0.51445103, -1.7733777, 0.36352996, 0.2670504, -0.44389911, -0.00951745, -1.37471798, -0.30043155, 0.45265041, -0.44108126, -0.93380974, 0.01123475, 1.04638666, 0.02761617, -0.94500398, 0.03733002, 1.42081918, -0.35939667, 0.33362599, 0.40669021, -0.11269968, 0.77173548, -0.21439775, -1.04443905, -0.13415581, -0.39751096, 0.09126597, 0.04284529, 0.05834636, 0.3982566, 0.14497739, -0.20426588, -0.55688591, -1.55756943, 1.38392311, -0.39793361, 0.26196548, -0.83255368, -1.3107868, 0.50036997, -0.82801969, -0.58475799, -1.0591635, 0.15133576, 2.04529368, -0.68842042, 0.28711827, -1.37213556, -1.34335526, 0.02993351, -1.1432537, 0.03299097, -0.40009081, 0.38683951, 0.31083133, -0.25719153, 0.50859074, -0.74614072, 0.99722077, -0.09831068, 0.66781027, -1.2738888, 0.47515389, 0.09352394, 0.9429222, 0.46048472, -1.22296615, 0.64618544, 0.6449593, -1.22759011, -0.07691448, -1.3100073, 0.20930579, 0.79554914, 1.03814966, 0.40682959, -1.73714393, -0.29190177, -0.48984985, 0.00214294, 0.91133783, 0.51477812, 1.64060769, -0.61057218, 0.95273783, -0.88578953, 1.77219631, 0.59130063, -0.32097308, -0.35905662, 0.01161622, -0.01568177, -0.88759929, -0.7713039, -0.41152533, 2.45777636, -1.58511195, 0.13247956, 0.04229733, -0.07462446, -0.9459986, 0.63875347, 0.69926503, -0.8543972, -0.39546391, 0.67162687, 1.35228365, 0.58572566, 1.75912831, 0.29326272, -1.13289563, 0.62465929, 0.98947382, -0.20522795, -2.12739971, -1.04702689, 1.18651795, -0.31853552, 0.39955208, 0.08361013, -0.95678834, -0.32676923, 0.40535131, -0.97981103, 0.94860515, -0.61414279, -0.17724566, 0.3503274, -0.76590623, 1.63489894, 0.40914546, -0.73365926, 0.30539378, 0.41657822, -1.03489467, -1.23730987, -1.30256017, -0.12196743, 1.16289091, 0.27911987, -1.2217759, -0.34503518, -1.00755712, 0.01551766, 0.09303302, -1.54178759, -0.01936236, 0.30015587, 0.95025814, -0.02177135, -0.45531962, -0.99627715, -0.64815898, -0.28520845, -1.44974135, -0.48359967, -1.33158817, 0.88718995, -0.11618905, -0.26768185, 1.3709179, 0.70524479, -0.8055552, -1.16428222, 0.71161186, -1.40778667, 0.00096492, 0.36006822, -2.26280628, -0.05334779, 0.78429873, 1.15036266, -0.81036249, 0.54243173, 0.42424546, 0.27426405, 1.06936654, 0.6329521, -0.34132517, 0.84449937, 0.28570044, 0.87163393, -0.47233544, -0.85648959, 0.47400729, 0.01110332, 0.67257133, 1.31111735, -0.2898128, -0.94529257, -0.83928096, -0.65803623, -0.08353724, 0.14915999, 1.11215025, 0.27924469, 0.0000738, 0.19885291, -1.4247189, -0.46160807, 0.31642785, -0.1533155, 0.92100929, 0.64763556, 0.37827734, 0.41355769, 0.64846488, -0.95333607, -1.01451795, -0.67380126, -0.05538561, -0.53975594, 0.19015177, 1.04901076, 0.37847728, -1.79111798, -1.00846756, 1.56261716, 0.11540556, -0.61465476, -0.45954402, 1.6428576, -0.06294454, 0.26805408, -0.69999105, -1.08314572, 0.75169248, -1.35559255, 1.1866959, -0.89518608, -0.3926671, -0.69710601, -0.8669487, 0.75390949, -0.38128266, 1.54026393, -0.82151451, 0.45958341, 0.02998691, 0.23534219, -0.78983861, -0.79727194, -1.09944124, -0.38560402, -0.22343808, -0.20402028, 0.61939086, 0.29833457, 0.37687584, -0.76114405, 0.39441621, -0.02458621, 0.27814813, 2.40745216, -1.038333, 0.28583734, -0.23793059, 0.5170437, 0.0345758, -0.68674429, -0.14673694, 0.47579262, 0.56150987, -0.29034949, -1.39513466, 0.16279504, 0.19849221, 0.15716695, -0.22527721, -0.25705518, 0.8348101, 1.03030865, 1.28043115, 0.40420117, 0.89848864, 0.36055001, -0.0360149, -1.40861735, 0.67723824, 1.86397402, -0.75142316, -0.25173146, -1.93040481, -0.76291218, 0.59095251, 1.22924994, 0.11181195, 0.88024352, -0.55190819, -0.26173056, 0.28357247]);
  const b1 = new Float64Array([-0.33803904, -0.41199716, 0.23537183, -1.86581431, -1.20584533, -0.9003628, -0.23468973, 1.48437045, 1.69851188, 0.00904361, 0.85693675, 1.11730444, -0.52523835, 0.10553836, -0.58736075, -0.55050102, 0.15546679, -0.34885019, 0.1078346, 0.93300956, 0.79232931, -0.64502515, 0.45764037, -1.16121005]);
  const W2 = new Float64Array([-0.37393596, 1.15159192, 0.1824523, -0.26731168, -0.05720911, 1.22917534, -0.65294829, 1.11971149, -1.13803583, 0.63761103, -0.80219408, 1.51076734, 0.7556884, 0.66370524, -0.72021671, 0.95904115, 1.17129982, 0.13724208, -0.25796409, -0.67093495, -0.8481125, -0.59613772, 0.40108825, -1.22309996, 0.02788715, -1.11743334, -1.75283051, 1.44006025, 0.4980622, -0.44821891, -2.05165984, 0.06757798, -0.40158825, -0.48044753, -1.91191021, -0.08516204, 0.32755059, 0.257059, -0.47080251, 0.77802562, -0.59647752, 0.4817021, 1.83715776, -0.41060871, 2.10544493, 1.17642669, 0.28051111, 0.70949608, -1.87113232, 0.29283219, 0.8749088, -0.31603489, -1.0309071, -0.45341995, 0.00841106, 0.72869273, 0.15711421, -1.30128222, -0.41848939, 1.225724, -1.00430937, 0.2451959, 0.79998026, -1.06129922, -0.11982485, -1.20106105, -0.62456607, -0.15552228, 0.12346151, 1.44376752, -0.90881401, -2.00251175, -0.13106688, 1.61555104, -0.01993398, -0.57081676, -0.28402101, -0.1202483, 0.48173195, 0.65486338, -1.19537666, 0.62894913, -0.68055514, -0.03374258, 1.4037704, 0.55617319, -0.43865489, -0.62407863, -0.27697099, -0.42535534, -0.00807031, 0.07915315, 1.23584973, 1.17849946, -0.30729302, 0.71722793, 0.99789332, -0.59876214, -0.54309198, -0.4875348, 1.0291547, 0.07426415, -1.16285702, 0.2806771, -0.63933091, 1.29977618, -0.05650382, -1.31500905, 1.64094374, -0.86615416, 0.12522957, 0.36908618, 0.02242452, -0.36184338, 0.41283739, 0.92970976, 1.25696344, -0.3920845, 0.80658633, 0.39181255, -0.26912701, 0.61990196, -0.37500373, 0.60756543, -0.2613478, 0.51118007, 0.48030318, -0.45001615, 0.62112434, -0.85692381, 1.14525004, 1.05514542, 1.18478062, -0.9881818, -0.04680184, -0.80426325, -1.37269497, 0.31740059, -0.97367495, -0.42071306, 0.28631208, -0.10009326, -0.44460278, 1.24403238, -1.18172427, 0.26976427, 0.09967376, -0.73058992, 0.07600814, -0.13118571, 0.27249978, 2.31938678, 2.12266929, -0.12111302, -0.15099536, 0.29593842, -0.07509284, 0.70728875, -0.71132184, -0.83456501, 0.24882145, 0.68493987, -1.24411918, 1.17403925, -1.48874288, 1.11127771, -0.34766508, -0.28889369, -0.7540399, -0.11086791, 0.17926852, -0.21841317, -0.48013146, 0.13428403, 0.62632146, -1.93608508, 0.10728109, 0.56790619, -0.9381842, 0.23102297, -1.09967062, 0.17799278, -0.6050789, -0.03983778, 0.33762052, 0.02211713, -1.06561457, 0.48493016, 0.52019998, -0.40988775, -0.80706783, 0.2438401, 0.92342536, -1.52169421, -0.9678237, -0.6663503, -0.83531222, -0.68603232, -1.50448275, -0.80241329, 1.01972238, -0.84030593, 0.5255291, -0.67163656, -0.01983866, 0.12733629, 0.06356106, 0.95674683, -0.6215231, 0.47508335, -0.91732075, 1.8727386, -0.92733999, 0.17772118, 0.93397587, -0.04179366, -0.59211293, -0.97818168, -0.5108185, 1.12361486, -1.45571118, -0.36752689, -2.11969873, -0.82018984, 0.07669453, -0.92883921, -1.07035619, -0.62071617, -0.02441466, 0.09043094, 0.76772715, -0.03782876, 0.79126769, -0.38076047, -0.11128709, 0.56056888, 0.77171572, 0.49218078, -0.52601905, 0.11524593, -0.48788334, -0.65093358, 0.48619194, -0.83163586, -0.42640748, -1.19322989, 0.37777299, -0.70048548, -0.19711715, -0.92501285, 1.10698014, 0.10865249, -0.51710111, 0.57562304, 0.15451576, -0.95704581, 0.07407998, -0.25408551, -0.72939843, 0.76491823, 0.46609309, 0.9151154, -0.75122485, 1.30949255, -1.03661842, -1.37269412, -0.23854504, 0.60642854, -0.20613723, -0.01670691, -1.10057402, 0.24909788, -0.32045183, 1.92793561, -1.04890597, -0.5575572, 0.81939539, 0.99730708, -0.60469149, 0.58263532, 0.11393718, -0.1370322, 1.55949979, 0.18674661, 0.34536312, 1.2830411, 0.598958, -0.2560096, 0.28673034, -1.29651739, -1.71210647, 0.28755095, -0.43922679, 0.12284636, -2.29089728, 0.72477991, -0.72295875, 0.57439889, -0.62560759, 0.27973925, -0.31288745, 0.06977422, -0.8227549, 0.35568983, -1.00727143, -0.37975161, 0.53490521, -0.70696187, -0.1187228, 0.1897815, 1.35314167, -0.83817844, 0.36107685, -0.61934454, -0.1730371, -0.65831284, 0.96953733, 1.37187261, -0.199083, 1.37850158, 0.48947045, 0.31776558, 0.12565091, -0.67340861, -1.46128265, -0.83852442, -0.5616771, -0.19457766, -0.79513763, 0.35494343, 1.32228119, 0.62192466, 0.46410584, -0.08150468, -2.23702122, -0.05699212, -1.40969157, 0.60770803, 0.10871173, -0.01374249, 0.60270589, -0.73252127, 1.54233596, 0.90063162, 0.9340128, 0.04812008, 0.82313356, 1.38611692, 0.72022567, -0.65223893, 0.36735085, 0.60760194, 0.02439624, 1.3103059, 0.82208795, 0.41823298, 0.5034998, 0.30243541, 1.70421588, -0.37265761, 0.3634581, 0.52574083, -0.14121102, 0.51754939, 0.62700858, 1.09632402, -0.44525945, -1.35334186, 0.62940564, -0.03276213, -1.49986349, -1.61982869, 2.90043762, 0.3555833, 0.48901361, -0.68326327, -0.13736634, -1.50559777, 1.02251844, 1.37456423, 0.58204983, 0.16109986, 0.04656059, -0.02393766]);
  const b2 = new Float64Array([0.97756761, 0.31510598, -0.21962734, 0.55374228, -0.34200414, 0.5648376, -0.92900536, -0.36524739, 0.01789908, -0.24071138, 0.97067257, -0.93959335, 0.12036402, -0.1950135, -0.97384342, 0.78758166]);
  const W3 = new Float64Array([-0.76960695, 5.15217418, -3.77723283, 5.99151854, -2.61459115, -0.46627972, 3.36831449, -3.5877499, -1.76761523, -1.68114449, 1.17336251, 1.01949448, 0.00197056, -1.85023263, -2.06701869, 3.89292567, 0.2048345, 5.73578781, -0.16248639, 9.5874503, -0.07341634, 1.56959133, 3.68601423, -1.54709651, -2.23975633, -1.4534332, 0.41155521, 1.01740522, 1.85402974, -0.19461385, 1.76018761, 0.6388913, -0.39833903, 0.47443812, -0.79544527, 2.52206524, -0.93447859, -0.16794007, 1.17231198, 1.63514377, 0.47211038, -2.80765087, 0.21835063, 0.55174123, -4.68990561, -0.33312896, -2.15559096, -1.18054021, -0.8439894, 0.7389541, -0.10558286, 6.25279766, 4.24262548, 2.44618573, 1.49688804, 5.10312286, -1.68127428, 4.64046684, 1.61767399, 0.11329596, 0.57305959, -3.42452796, 0.29882436, -5.86476771, -0.57829303, 6.99275046, -4.36504698, 9.84829271, -5.72671088, -0.56801083, -0.42461716, -0.98922995, -4.67538224, -0.70191396, 3.26758545, 2.08732536, -0.88101073, 0.23819944, -0.7274521, 0.65386717]);
  const b3 = new Float64Array([0.71053979, -0.03406348, -0.75847829, -0.22446394, -0.67711414]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([1.01353763, 0.33004579, 0.00822616, 0.35886842, -1.8043078, -0.28737237, -1.0453292, 0.24874919, -0.10174036, -1.11253133, 0.08927255, 0.28386112, 0.40620077, 0.46601179, -0.36965952, -0.7883053, -0.52672495, 0.14665191, 0.94482201, -0.22358885, 0.88238582, -0.31405656, -1.23027474, 0.24459965, 0.35644041, 0.45450046, 0.22327586, -0.41711781, 1.07324058, 0.14492001, 0.66761213, -0.88113821, -1.00930285, -0.02323608, 0.3485386, 1.12997017, -0.38948433, -1.50377966, -0.20525646, -0.26115277, 0.55535867, 0.98115912, 1.14310444, -0.08293662, 0.60836983, 0.16594984, -0.08123755, -0.29320216, -0.52253673, -0.50471543, 0.91532098, -0.83047454, 0.70283846, 1.33374397, -0.21118957, -0.9244585, -1.42482559, 0.88322182, 0.2929653, -1.51227091, 0.01202583, -0.62201216, -0.36549951, -0.36860756, 0.30137762, -1.05455404, -0.88196043, -0.19761823, -1.67982454, -0.80329458, -0.57782571, 0.16502944, 1.16107027, 0.6895862, -0.30984632, -0.34606926, 0.21010942, -0.31738846, -0.84660976, 0.41070288, -0.32580529, 0.21973769, 1.12284974, 1.10679773, -0.03820944, 0.80354207, -0.04363122, -0.40746628, 0.10703161, 1.83956862, -0.39698054, -0.95863469, -0.22049276, -0.68196694, 0.47033164, 0.11297586, 1.07466775, -1.13625291, 0.14936161, 0.73538546, 1.34063303, -0.11588482, 1.28566019, 0.69886582, -0.299315, -0.735367, -0.82077065, -1.96054824, 0.46425557, 0.62114962, 2.15340803, 1.68387003, 0.62807547, -0.56508205, -1.56955429, -0.45706567, -1.06938015, 0.6750363, 0.93741609, -1.01710549, -1.8473554, -0.34364676, -0.76717197, -0.19704449, 0.24256599, -0.55460014, -0.97617686, -0.44756122, -1.02536779, 0.66638365, 0.46005452, 0.24310196, 0.86563037, -1.2290433, -0.00113239, -1.15364606, -0.87377765, 1.6713482, 0.52855141, -0.17363456, 0.91696888, -1.10985885, -1.5243074, 0.9761965, 0.31145549, -0.58665213, 1.22871917, -0.59877613, 0.65385255, -0.92051302, -0.2711693, 0.22297875, -0.8978512, -0.14816036, 0.51428622, -0.39897055, 0.43804816, -0.91959658, -0.26208953, -0.29252112, -0.64102587, -0.17579119, 0.90543102, -0.17870907, 0.42985301, -1.90492336, 0.01802391, -1.36326535, -0.3144239, -0.19380372, 0.26309362, 0.87697086, 0.47192111, 0.1949243, -0.2468271, -0.28650022, 0.15104356, -0.861016, 0.32493731, -0.50074332, 0.25153338, 0.8328458, 0.34134375, -0.31576444, -0.03568048, -0.38104081, -0.47314062, -0.28784945, -1.19867547, -0.79143758, 0.90188296, 0.38034246, -0.47631209, -0.89336872, -0.41036732, -0.48138741, 1.09583185, -0.99661435, 0.08076235, -0.49414971, -1.22027001, 1.56720959, 0.08880457, 0.75347388, -1.75220911, -0.33509859, -0.91128483, 0.27891256, 0.13860914, 0.17900179, 0.8122974, 1.33074093, 0.59727895, -0.18771788, 0.35020193, 1.03713473, -0.48408231, -0.64742854, -0.65957732, 0.56555961, -0.01060409, -0.59797346, -1.05377489, 0.26839501, -0.32737094, 0.14230516, -0.37118777, -0.19830392, 0.47338522, 0.40227788, -1.37520557, 1.4363408, -0.87528554, 0.05729977, -0.5434167, 1.60246163, -1.13718579, 0.08578295, -0.33596302, -1.8826895, 0.18656253, -2.93147655, -1.82463798, -0.94091564, 0.50760705, -0.7890835, -0.62621456, -1.34781718, -0.79295788, 0.71804484, -0.06598897, -0.05808285, -0.08141327, -1.93631289, 0.27288844, -1.06419151, -1.63321224, 0.1701352, -0.9013602, 0.29463475, -0.63456307, 0.07824167, 1.37120164, -0.40002507, -0.60511997, 0.2689902, 0.04597612, -0.41143101, 1.58415349, -2.43439951, -0.83129515, -0.2529449, 0.04291178, -1.00371506, -0.21624652, -0.14257832, 0.17296709, -0.12851589, -1.39841487, -0.99308546, -1.72815296, -1.29411529, 0.39527531, -0.74653114, -0.85842851, -0.01747029, -0.30605403, 0.42024614, -0.24371279, 0.68022871, 0.47450622, -0.40783863, -0.25584687, -0.91955627, 0.81593108, -0.46059048, 0.50886525, -0.70145985, 0.37938827, -0.0998973, 0.80061903, 0.13207972, 0.07266292, -1.14253882, 0.60273412, 0.50173371, -1.72907423, -0.15339819, 0.41576297, 0.84295162, -0.83613549, -1.12048261, 0.58126163, 0.99710691, -0.01646309, -1.16660096, 0.38705826, 1.70153535, 0.02727584, -0.16799862, -0.36408064, 0.07791623, -0.31789771, -0.007193, -0.6430638, -1.12449685, 0.7891154, -0.24357575, 0.19557035, -0.05439458, 1.24705975, 1.20973283, 0.36633439, 1.28412419, -0.25684119, 0.89556026, 1.04482913, 0.19260308, -1.7103272, -0.14829397, 1.4270135, 0.23366284, 0.13620669, 0.34447991, -0.37962617, 2.47950023, -0.20932541, 1.11942843, 0.83462928, -0.42820488, 1.29229121, 0.09469087, -0.42387939, -1.62349615, -0.83591992, 0.12298494, -0.53489658, 0.72756261, 0.38510085, -0.60442851, -0.67783326, -0.11256074, -0.89013123, 0.02775493, 0.60432029, -0.73807407, 0.31089978, 0.88021578, -0.5026667, -1.5279745, 0.39883845, 1.40364461, -1.19497576, 1.35951285, -0.07658098, -0.02113873, 1.02044114, 0.39347002, -1.06690989, 1.09797369, 0.58155837, 0.3028738, -0.88253536, -0.38626964, 2.11092549, -0.64696919, 0.36342441, -0.26248011, -0.92060058, -0.03358354, 1.31767736, -1.49901898, 1.95655645, -0.46726006, 0.37177961, -0.34350788, -0.27663622, -0.81936785, 1.30580043, 0.86094474, -0.2773493, -0.59054939, 3.37515957, 0.00940809, 1.18891187, -0.83915445, -1.0685727, 0.39880899, 0.65391805, 1.31192557, 0.47820242, -1.14756935, -0.73953691, -0.17785303, 0.54325952, -0.9192833, -0.54161194, 0.433652, 0.04882988, 0.52501944, 0.5940361, 0.45584547, -1.3232963, -0.03810959, -0.88891145, -1.81903104, 0.19025916, 0.95983911, 0.03045051, -0.55432255, 2.03470434, 1.28866079, 0.27879056, 0.94065308, 0.71351668, 0.21981579, -0.88403057, 0.44617074, 0.01738964, -2.08127998, -1.19496811, -0.66561216, -0.72493995, 1.09988579, -0.4135468, 0.08857152, -0.05203288, 0.6249899, -1.22359741, 0.58312852, 0.10478994, 0.4513955, 0.88894505, 0.82011591, -2.17584612, -0.96862101, -0.36922893, 0.1650896, 0.26820634, 2.10671904, -0.03665456, -1.27609059, -1.47058312, 0.71920294, -0.19835522, -0.88089632, 1.62586673, 1.97167109, -0.50472787, -0.59846377, 0.91871982, 1.12659493, -0.79233935, -0.35904759, 0.23787154, 0.28275118, -1.26777857, -1.33518839, 0.14652714, -0.19810054, -0.95455203, -0.95850448, 0.55588354, -0.55020351, 1.38334709, 1.11369773, -0.54884052, -0.77168292, -0.55468131, -0.98166333, 0.2563449, -0.81293219, 0.2951542, -0.03110814, -0.72873402, -1.62959823, -1.15859875, 0.06083274, 0.14124272, -0.8184945, 0.28423672, 0.52048695, -0.04103425, 1.78710824, -0.14592822, 0.21848889, -0.08227564, -0.21762868, 0.08389486, -0.61639157, 1.18522209, 0.50670967, 0.56782973, -0.76316632, 0.06394491, -0.82670245, 2.23858176, -0.46628851, -0.961605, 1.06560819, -1.35179779, -1.01563361, 1.17578018, -0.70350101, 0.45990498, 1.87333076, -1.0318943, 0.61502059, 0.00653848, -0.05961907, -1.30829462, -2.06287894, -0.2454776, -0.82224822, 0.18908161, -1.06871801, 0.02792408, -1.23603097, -0.60452983, -0.81519541, -0.97303824, 1.50324211, 1.5601864, -0.39084941, -0.20388797, 0.2796566, -0.24204798, 0.7810208, -1.67772718, -1.35091061, -0.42328995, 0.61189013, 0.29815532, -0.05999768, 0.60308285, -0.80656043, 0.6945748, -0.45935382, -1.04975775, 1.17191653, 0.02270975, -0.80137794, 0.06882234, -0.52399749, -0.10259893, -0.22645157, -0.13349001, -0.63448583, -0.39926832, 0.26909307, -1.47855374, 0.80809594, 0.40510109, 0.25790394, -0.25019665, 0.25188169, -0.09530154, 1.06564047, -0.93125429, -0.76430469, -0.08740516, 0.32870052, 0.42334882, -1.53016779, 2.54399191, -1.28062878, -0.63207921, 1.00250408, 1.2390698, 0.43718348, -0.26344179, -1.26285751, -1.38353294, -1.19560457, 0.36403555, 1.30837566, -0.74671108, -1.08680289, -0.64096716, -1.07698792, -2.47885815, -0.6788102, -2.28634948, 0.17607594, -1.91128657, -0.34688336, 0.68977429, -1.05933711, -1.20012373, -1.24633229, 1.85759755, 0.88453415, -0.21140062, 1.85373059, -0.92836131, 0.07317612, -0.23366802, 0.12253088, -0.28590968, 0.52141721, 0.1543498, 0.27456854, -0.24960454, 0.46044237, -0.43738137, 0.47345797, -1.54742205, 1.57917609, -0.28329407, 0.5189566, 1.01688854, -0.27816722, -0.01866198, 0.54939753, -1.33931495, 1.68587293, 0.85208831, 1.22644248, 0.71163242, 0.9397495, -0.08276695, 0.47398808, -0.45569571, 0.86097458, 0.00048273, 0.20124949, 0.15013739, -1.10784673, 0.95877738, -0.78955273, -0.23631765, -0.47930061, 0.88673255, 0.70759046, -0.39689871, 1.46099923, 0.33377888, 1.1108557, 0.45788554, 0.0481544, 0.20687298, 0.11671373, -1.21880586, -0.31520967, -0.62730701, -0.66276557, 0.73131128, -0.06292041, 0.03633975, -0.90907993, 0.42428064, 0.24893022, -0.48655309, 1.08818806, -0.71592885, 0.02553074, -1.34215111, 1.20580465, 0.7892667, -0.2617037, -0.36170489, -0.38105274, -0.40079438, -0.60922555, 0.20923854, 0.49649407, 0.27576769, -0.40345314, 0.65731804, 0.26866603, -1.42493628, 0.7264225, -0.32203832, 0.36505339, -0.07521714, -0.32734552, 1.32712114, 1.26320072, -0.25948844, -1.45039225, 0.05594043, -1.17164528, 0.46281827, -0.33233146, 0.15262256, 0.27637895, -0.30329345, -0.62363844, 0.58898957, -1.90779837, 0.23901863, -2.06830301, -0.16346558, -0.59890411, -0.21634316, -1.03207702, 0.33435914, -0.48444242, -0.03396762, -0.54908697, -0.02300152, 1.14485933, 0.43642413, -1.33648919, 1.45039924, -0.68232564, -1.35017492, -0.08131544, -0.03926632, -0.04106236, 0.67553513, -0.98204592, 0.20062502, 0.12694253, -0.67060096, -0.05767077, 0.06034381, -0.52695029, 0.9873127, 1.15924799, -1.04478594, 0.51445103, -1.7733777, 0.36352996, 0.2670504, -0.44389911, -0.00951745, -1.37471798, -0.30043155, 0.45265041, -0.44108126, -0.93380974, 0.01123475, 1.04638666, 0.02761617, -0.94500398, 0.03733002, 1.42081918, -0.35939667, 0.33362599, 0.40669021, -0.11269968, 0.77173548, -0.21439775, -1.04443905, -0.13415581, -0.39751096, 0.09126597, 0.04284529, 0.05834636, 0.3982566, 0.14497739, -0.20426588, -0.55688591, -1.55756943, 1.38392311, -0.39793361, 0.26196548, -0.83255368, -1.3107868, 0.50036997, -0.82801969, -0.58475799, -1.0591635, 0.15133576, 2.04529368, -0.68842042, 0.28711827, -1.37213556, -1.34335526, 0.02993351, -1.1432537, 0.03299097, -0.40009081, 0.38683951, 0.31083133, -0.25719153, 0.50859074, -0.74614072, 0.99722077, -0.09831068, 0.66781027, -1.2738888, 0.47515389, 0.09352394, 0.9429222, 0.46048472, -1.22296615, 0.64618544, 0.6449593, -1.22759011, -0.07691448, -1.3100073, 0.20930579, 0.79554914, 1.03814966, 0.40682959, -1.73714393, -0.29190177, -0.48984985, 0.00214294, 0.91133783, 0.51477812, 1.64060769, -0.61057218, 0.95273783, -0.88578953, 1.77219631, 0.59130063, -0.32097308, -0.35905662, 0.01161622, -0.01568177, -0.88759929, -0.7713039, -0.41152533, 2.45777636, -1.58511195, 0.13247956, 0.04229733, -0.07462446, -0.9459986, 0.63875347, 0.69926503, -0.8543972, -0.39546391, 0.67162687, 1.35228365, 0.58572566, 1.75912831, 0.29326272, -1.13289563, 0.62465929, 0.98947382, -0.20522795, -2.12739971, -1.04702689, 1.18651795, -0.31853552, 0.39955208, 0.08361013, -0.95678834, -0.32676923, 0.40535131, -0.97981103, 0.94860515, -0.61414279, -0.17724566, 0.3503274, -0.76590623, 1.63489894, 0.40914546, -0.73365926, 0.30539378, 0.41657822, -1.03489467, -1.23730987, -1.30256017, -0.12196743, 1.16289091, 0.27911987, -1.2217759, -0.34503518, -1.00755712, 0.01551766, 0.09303302, -1.54178759, -0.01936236, 0.30015587, 0.95025814, -0.02177135, -0.45531962, -0.99627715, -0.64815898, -0.28520845, -1.44974135, -0.48359967, -1.33158817, 0.88718995, -0.11618905, -0.26768185, 1.3709179, 0.70524479, -0.8055552, -1.16428222, 0.71161186, -1.40778667, 0.00096492, 0.36006822, -2.26280628, -0.05334779, 0.78429873, 1.15036266, -0.81036249, 0.54243173, 0.42424546, 0.27426405, 1.06936654, 0.6329521, -0.34132517, 0.84449937, 0.28570044, 0.87163393, -0.47233544, -0.85648959, 0.47400729, 0.01110332, 0.67257133, 1.31111735, -0.2898128, -0.94529257, -0.83928096, -0.65803623, -0.08353724, 0.14915999, 1.11215025, 0.27924469, 0.0000738, 0.19885291, -1.4247189, -0.46160807, 0.31642785, -0.1533155, 0.92100929, 0.64763556, 0.37827734, 0.41355769, 0.64846488, -0.95333607, -1.01451795, -0.67380126, -0.05538561, -0.53975594, 0.19015177, 1.04901076, 0.37847728, -1.79111798, -1.00846756, 1.56261716, 0.11540556, -0.61465476, -0.45954402, 1.6428576, -0.06294454, 0.26805408, -0.69999105, -1.08314572, 0.75169248, -1.35559255, 1.1866959, -0.89518608, -0.3926671, -0.69710601, -0.8669487, 0.75390949, -0.38128266, 1.54026393, -0.82151451, 0.45958341, 0.02998691, 0.23534219, -0.78983861, -0.79727194, -1.09944124, -0.38560402, -0.22343808, -0.20402028, 0.61939086, 0.29833457, 0.37687584, -0.76114405, 0.39441621, -0.02458621, 0.27814813, 2.40745216, -1.038333, 0.28583734, -0.23793059, 0.5170437, 0.0345758, -0.68674429, -0.14673694, 0.47579262, 0.56150987, -0.29034949, -1.39513466, 0.16279504, 0.19849221, 0.15716695, -0.22527721, -0.25705518, 0.8348101, 1.03030865, 1.28043115, 0.40420117, 0.89848864, 0.36055001, -0.0360149, -1.40861735, 0.67723824, 1.86397402, -0.75142316, -0.25173146, -1.93040481, -0.76291218, 0.59095251, 1.22924994, 0.11181195, 0.88024352, -0.55190819, -0.26173056, 0.28357247]);
  const b1 = new Float64Array([-0.33803904, -0.41199716, 0.23537183, -1.86581431, -1.20584533, -0.9003628, -0.23468973, 1.48437045, 1.69851188, 0.00904361, 0.85693675, 1.11730444, -0.52523835, 0.10553836, -0.58736075, -0.55050102, 0.15546679, -0.34885019, 0.1078346, 0.93300956, 0.79232931, -0.64502515, 0.45764037, -1.16121005]);
  const W2 = new Float64Array([-0.37393596, 1.15159192, 0.1824523, -0.26731168, -0.05720911, 1.22917534, -0.65294829, 1.11971149, -1.13803583, 0.63761103, -0.80219408, 1.51076734, 0.7556884, 0.66370524, -0.72021671, 0.95904115, 1.17129982, 0.13724208, -0.25796409, -0.67093495, -0.8481125, -0.59613772, 0.40108825, -1.22309996, 0.02788715, -1.11743334, -1.75283051, 1.44006025, 0.4980622, -0.44821891, -2.05165984, 0.06757798, -0.40158825, -0.48044753, -1.91191021, -0.08516204, 0.32755059, 0.257059, -0.47080251, 0.77802562, -0.59647752, 0.4817021, 1.83715776, -0.41060871, 2.10544493, 1.17642669, 0.28051111, 0.70949608, -1.87113232, 0.29283219, 0.8749088, -0.31603489, -1.0309071, -0.45341995, 0.00841106, 0.72869273, 0.15711421, -1.30128222, -0.41848939, 1.225724, -1.00430937, 0.2451959, 0.79998026, -1.06129922, -0.11982485, -1.20106105, -0.62456607, -0.15552228, 0.12346151, 1.44376752, -0.90881401, -2.00251175, -0.13106688, 1.61555104, -0.01993398, -0.57081676, -0.28402101, -0.1202483, 0.48173195, 0.65486338, -1.19537666, 0.62894913, -0.68055514, -0.03374258, 1.4037704, 0.55617319, -0.43865489, -0.62407863, -0.27697099, -0.42535534, -0.00807031, 0.07915315, 1.23584973, 1.17849946, -0.30729302, 0.71722793, 0.99789332, -0.59876214, -0.54309198, -0.4875348, 1.0291547, 0.07426415, -1.16285702, 0.2806771, -0.63933091, 1.29977618, -0.05650382, -1.31500905, 1.64094374, -0.86615416, 0.12522957, 0.36908618, 0.02242452, -0.36184338, 0.41283739, 0.92970976, 1.25696344, -0.3920845, 0.80658633, 0.39181255, -0.26912701, 0.61990196, -0.37500373, 0.60756543, -0.2613478, 0.51118007, 0.48030318, -0.45001615, 0.62112434, -0.85692381, 1.14525004, 1.05514542, 1.18478062, -0.9881818, -0.04680184, -0.80426325, -1.37269497, 0.31740059, -0.97367495, -0.42071306, 0.28631208, -0.10009326, -0.44460278, 1.24403238, -1.18172427, 0.26976427, 0.09967376, -0.73058992, 0.07600814, -0.13118571, 0.27249978, 2.31938678, 2.12266929, -0.12111302, -0.15099536, 0.29593842, -0.07509284, 0.70728875, -0.71132184, -0.83456501, 0.24882145, 0.68493987, -1.24411918, 1.17403925, -1.48874288, 1.11127771, -0.34766508, -0.28889369, -0.7540399, -0.11086791, 0.17926852, -0.21841317, -0.48013146, 0.13428403, 0.62632146, -1.93608508, 0.10728109, 0.56790619, -0.9381842, 0.23102297, -1.09967062, 0.17799278, -0.6050789, -0.03983778, 0.33762052, 0.02211713, -1.06561457, 0.48493016, 0.52019998, -0.40988775, -0.80706783, 0.2438401, 0.92342536, -1.52169421, -0.9678237, -0.6663503, -0.83531222, -0.68603232, -1.50448275, -0.80241329, 1.01972238, -0.84030593, 0.5255291, -0.67163656, -0.01983866, 0.12733629, 0.06356106, 0.95674683, -0.6215231, 0.47508335, -0.91732075, 1.8727386, -0.92733999, 0.17772118, 0.93397587, -0.04179366, -0.59211293, -0.97818168, -0.5108185, 1.12361486, -1.45571118, -0.36752689, -2.11969873, -0.82018984, 0.07669453, -0.92883921, -1.07035619, -0.62071617, -0.02441466, 0.09043094, 0.76772715, -0.03782876, 0.79126769, -0.38076047, -0.11128709, 0.56056888, 0.77171572, 0.49218078, -0.52601905, 0.11524593, -0.48788334, -0.65093358, 0.48619194, -0.83163586, -0.42640748, -1.19322989, 0.37777299, -0.70048548, -0.19711715, -0.92501285, 1.10698014, 0.10865249, -0.51710111, 0.57562304, 0.15451576, -0.95704581, 0.07407998, -0.25408551, -0.72939843, 0.76491823, 0.46609309, 0.9151154, -0.75122485, 1.30949255, -1.03661842, -1.37269412, -0.23854504, 0.60642854, -0.20613723, -0.01670691, -1.10057402, 0.24909788, -0.32045183, 1.92793561, -1.04890597, -0.5575572, 0.81939539, 0.99730708, -0.60469149, 0.58263532, 0.11393718, -0.1370322, 1.55949979, 0.18674661, 0.34536312, 1.2830411, 0.598958, -0.2560096, 0.28673034, -1.29651739, -1.71210647, 0.28755095, -0.43922679, 0.12284636, -2.29089728, 0.72477991, -0.72295875, 0.57439889, -0.62560759, 0.27973925, -0.31288745, 0.06977422, -0.8227549, 0.35568983, -1.00727143, -0.37975161, 0.53490521, -0.70696187, -0.1187228, 0.1897815, 1.35314167, -0.83817844, 0.36107685, -0.61934454, -0.1730371, -0.65831284, 0.96953733, 1.37187261, -0.199083, 1.37850158, 0.48947045, 0.31776558, 0.12565091, -0.67340861, -1.46128265, -0.83852442, -0.5616771, -0.19457766, -0.79513763, 0.35494343, 1.32228119, 0.62192466, 0.46410584, -0.08150468, -2.23702122, -0.05699212, -1.40969157, 0.60770803, 0.10871173, -0.01374249, 0.60270589, -0.73252127, 1.54233596, 0.90063162, 0.9340128, 0.04812008, 0.82313356, 1.38611692, 0.72022567, -0.65223893, 0.36735085, 0.60760194, 0.02439624, 1.3103059, 0.82208795, 0.41823298, 0.5034998, 0.30243541, 1.70421588, -0.37265761, 0.3634581, 0.52574083, -0.14121102, 0.51754939, 0.62700858, 1.09632402, -0.44525945, -1.35334186, 0.62940564, -0.03276213, -1.49986349, -1.61982869, 2.90043762, 0.3555833, 0.48901361, -0.68326327, -0.13736634, -1.50559777, 1.02251844, 1.37456423, 0.58204983, 0.16109986, 0.04656059, -0.02393766]);
  const b2 = new Float64Array([0.97756761, 0.31510598, -0.21962734, 0.55374228, -0.34200414, 0.5648376, -0.92900536, -0.36524739, 0.01789908, -0.24071138, 0.97067257, -0.93959335, 0.12036402, -0.1950135, -0.97384342, 0.78758166]);
  const W3 = new Float64Array([-0.76960695, 5.15217418, -3.77723283, 5.99151854, -2.61459115, -0.46627972, 3.36831449, -3.5877499, -1.76761523, -1.68114449, 1.17336251, 1.01949448, 0.00197056, -1.85023263, -2.06701869, 3.89292567, 0.2048345, 5.73578781, -0.16248639, 9.5874503, -0.07341634, 1.56959133, 3.68601423, -1.54709651, -2.23975633, -1.4534332, 0.41155521, 1.01740522, 1.85402974, -0.19461385, 1.76018761, 0.6388913, -0.39833903, 0.47443812, -0.79544527, 2.52206524, -0.93447859, -0.16794007, 1.17231198, 1.63514377, 0.47211038, -2.80765087, 0.21835063, 0.55174123, -4.68990561, -0.33312896, -2.15559096, -1.18054021, -0.8439894, 0.7389541, -0.10558286, 6.25279766, 4.24262548, 2.44618573, 1.49688804, 5.10312286, -1.68127428, 4.64046684, 1.61767399, 0.11329596, 0.57305959, -3.42452796, 0.29882436, -5.86476771, -0.57829303, 6.99275046, -4.36504698, 9.84829271, -5.72671088, -0.56801083, -0.42461716, -0.98922995, -4.67538224, -0.70191396, 3.26758545, 2.08732536, -0.88101073, 0.23819944, -0.7274521, 0.65386717]);
  const b3 = new Float64Array([0.71053979, -0.03406348, -0.75847829, -0.22446394, -0.67711414]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
