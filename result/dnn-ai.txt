function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.18751687, -0.03841178, -0.22435289, -0.07381462, 0.17132232, -0.48441334, 0.07362537, -0.21292008, 0.7976389, -5.70850609, -0.25282853, 0.25198737, 0.09398154, 0.37057773, -0.23158349, 0.36320623, -0.22301462, -0.06543675, -0.07055231, 0.09977913, 0.23809225, 1.16551059, -0.15373578, -0.22026586, -0.70836227, 0.35976411, 0.2479004, 0.22785852, 0.73391917, -0.35032471, -0.33574089, 0.43452106, -0.27586612, 0.799619, 0.24977642, -0.48173788, 0.45784678, 0.33145226, 0.83239095, -0.27154949, -0.20032677, 0.45093149, -0.42840741, 0.50841366, -0.1649333, -0.3410757, 0.08504802, -0.00712836, 0.80926349, 0.39961172, -0.24514685, 1.40975662, -1.54465762, -1.67325107, 0.26739317, 0.59078417, 0.87573574, -1.02743223, 1.02371596, 0.45927069, -0.33729903, -0.51052906, 1.41542057, 1.64107601, 0.41185924, 0.29404307, 1.40592063, -1.8655735, 0.6460826, -0.39898047, -0.42319701, 7.1446657, 0.54213213, 0.96186971, 0.42916886, 1.23754621, 4.73902174, 0.99373808, 0.64375443, 0.65481331, 0.05096682, 1.71922385, 0.8084697, -0.09894255, 0.44294278, -0.56937126, 0.02388452, 0.34094382, 0.01189408, 0.2847581, -0.18520108, 0.15901692, 0.02765835, 0.79788156, -0.97327022, -2.36835645, 0.35570536, 0.51655708, 0.54888757, 0.42808751, -1.18212533, 0.23410423, 0.23288433, -0.43364689, -0.29487431, -0.18176476, -1.73637409, -1.01618254, 0.15354953, 0.39340749, 1.44566675, 1.46378978, -0.59605309, 0.88573009, 0.42099233, 0.52526792, 0.32693032, -0.68110761, -0.26704532, -0.14339462, 1.45899702, -0.16685595, -0.05402112, 0.17807256, 0.38631022, 0.22742169, 0.27549736, -0.33294552, 0.46841613, -0.02278885, -0.02216948, -0.85691917, -0.42489951, -0.11162277, -1.14742033, -0.00438203, -0.10951721, -0.33625655, 0.79139449, 0.0790255, -0.87192952, -0.67882304, 0.13959419, 0.00503402, -0.69886643, -0.31460633, 0.50893138, -0.77960155, -0.48639898, 1.56383969, 0.38633647, -1.12795729, 0.05687525, 1.09993164, -0.35936305, -0.40618855, -0.09202552, 1.33766126, 0.32468417, 0.35447609, 0.16299633, -0.7316578, -0.42094939, 0.06647965, -0.07530339, 0.06166169, -0.51528472, -0.14360148, -0.84241919, 0.05015186, 0.84337022, -0.20236728, 0.07466748, 0.1366084, 0.26390766, 0.16222262, 0.03260931, 0.0105901, 0.23975622, -0.13032354, -0.18541625, -4.23983715, 0.38280185, 0.95359695, -0.29144767, -0.21945577, -0.22815564, 0.25319759, -0.50850599, -0.3644887, 0.27419585, 0.31212036, -0.93548478, 0.51279339, 0.2925673, 0.21847364, 0.85492561, -0.14701953, -0.58225853, 0.78172712, 0.23901164, 0.02049537, 0.13357553, 0.0511719, -0.25598102, 0.76518346, 0.09605561, -0.42653966, 0.76150904, -0.51362025, 0.50990635, -1.0947448, 0.16287685, 0.48830585, 0.18277015, -0.65685644, 0.23790632, -0.48663847, -0.28048232, -0.37974724, 0.4819406, -0.32180262, 0.75715797, 1.3621568, -2.7371082, 0.14861172, -0.41905348, 1.36346477, 1.38970207, -0.12099715, -0.22768903, 0.4029705, -0.00925094, -0.35363064, -0.12957676, -0.11928546, -0.15655103, 0.1376488, -0.5071198, -0.64672935, 0.80012365, -0.34596017, 0.25986987, 0.65108299, -2.1770202, -0.6884504, -0.06153838, -0.08929835, 1.32326531, -0.68394296, -0.20783063, -0.39155247, -1.11246267, 0.76069939, 0.90360035, -0.63081854, -0.47274011, -0.22651906, 0.27265636, 0.17756186, 0.72478318, 0.27532048, -0.14775899, 0.16672682, 0.12823117, 0.38310115, 0.21310285, -0.42382001, 1.02110949, 0.76166636, -0.66621299, -0.19080162, 0.78558746, -0.49083511, -0.51150934, 0.37349403, 0.2051815, -0.02111854, -0.45937454, -0.32162393, -0.25313708, 0.69064845, 0.34143897, -1.22075415, -0.0529835, 0.13979904, 1.61969799, 0.0124979, 0.24933727, -1.01085725, 1.66328988, 0.7996873, 0.57001745, 0.18486377, -0.80626215, 0.88041383, 0.49309304, -0.11719085, -0.31853038, -0.18427466, 0.6628835, 0.05278763, -0.14413451, -0.35322581, -0.35857553, -0.0487353, -0.49048334, -0.42414612, -0.24393564, 1.38184539, 2.72949798, -0.04876864, -0.24487631, -0.49575136, -0.77215415, 0.52141237, 0.31319116, 0.50882555, 0.15023232, 0.72939245, 0.43339594, 1.54212749, -1.06064229, -0.58366106, 0.47176364, 0.45495476, -0.80565184, -0.08505918, -0.17917018, -0.48461375, 0.4226609, -0.01937764, -0.15781294, -0.0111943, 0.4637539, -0.22996495, 0.12502233, -0.06168194, 1.15526894, 0.09526128, -0.59891101, -0.70016005, -0.58324131, -0.46642778, 0.02916348, 0.20610958, 0.43151871, -0.56254623, -0.2288588, -0.29412742, 0.03655579, 0.09901785, -0.23393498, -6.42747912, 0.14722914, -0.08677057, -0.0168222, 0.19534585, 1.01745469, -0.43236682, -0.0697075, 0.81575424, 0.32429898, -0.10337549, 0.97022527, 0.94612692, 0.06569938, -0.10246203, -0.7860776, -0.76446712, 0.78644171, -0.02763688, -0.01265279, -0.07041382, -0.161399, 0.76450826, -0.16695896, -0.44235422, -0.50353129, 0.18980192, 0.62752692, -0.1052071, -0.16357766, 0.20138973, 0.34251188, 0.56200829, 0.41846627, -0.62266725, 0.04263304, -0.5736839, -0.13131578, -0.51005468, -0.70326252, -0.09270821, -0.08713873, -0.7326027, 0.36599391, -0.4287493, -0.62667171, -0.4457687, 0.30613137, -0.21009481, -0.50548048, -0.92141492, -0.00300258, 0.09507273, 0.19295302, -1.0641009, 0.1013885, 0.00150847, -0.37741615, 0.32321336, -0.67385329, -0.69369511, 0.04009679, 0.69200813, 0.75113262, 0.57015973, -0.34952083, -0.60910561, 0.38212407, -0.42693657, -0.03890997, 0.22674511, -0.12096495, -0.1589244, -0.13080018, 0.14136774, 0.10851526, -0.1256176, 0.03589377, 0.35579171, 0.40343071, -0.33241466, -0.50242179, -0.36989624, -0.75518329, -0.58602425, -0.00819035, 2.57129563, -0.5373093, -0.61924259, 0.29400275, -0.90302839, 0.03331877, -0.57696681, 0.51992889, 0.51470342, 0.34729907, -0.34163617, 0.58187713, -0.53543713, -0.75721697, -0.32069211, -0.15708814, 0.36092845, 0.05377594, -0.730953, 0.2228279, -0.56226945, 0.17398214, 0.22129267, -0.69446968, 0.01203425, 0.61994392, -0.58853393, 0.55355338, -1.04769237, 0.49841444, 0.51540718, 0.10900034, 0.3826657, -0.0259537, 1.22691641, 0.05620455, 0.40188375, -0.21715831, 0.01649466, 1.22403175, -0.01900993, 0.5227549, -1.59054311, 1.28047544, -0.26411406, -0.04377671, 1.91090727, -0.02117513, 0.45924483, 0.36733737, 0.41802939, -0.53918015, -0.19645528, -0.32257121, -1.41167578, 0.49487673, 0.7895108, -1.14313968, -1.22070578, -0.44101964, 0.99174852, -0.51284863, -1.04071269, -1.24848436, 0.06764751, 0.13380368, -0.47983358, -0.05246349, -1.23978111, 0.36596549, 0.28078307, -0.54565513, -0.26000334, -0.60055496, 0.48910999, 0.20479397, 0.51723505, 0.06640906, 0.00049171, -0.04177677, -0.11303608, -0.04536118, 0.06096111, 0.19507256, -0.3309958, 1.94250694, -1.50588042, -0.05399908, -0.47188488, 0.55173704, -0.53533909, -0.37033699, -0.3043047, -0.03333376, -0.3237057, 0.11394763, 0.02206434, -1.9054434, -0.67640894, 0.99342816, -1.55696064, 0.19534164, 0.47847718, 0.1563291, 0.03730322, 0.85411632, -0.24498287, 0.19257193, -0.33676692, -2.46419136, 0.96954253, 0.02951214, 0.10489121, 0.03765621, -2.37218214, -0.23843583, 0.43014482, 0.20560761, 0.00100657, -1.05677248, -0.04513662, 0.35921868, -0.12652313, 0.03134359, 0.13284522, -0.54893577, -0.28553787, 0.30827473, -0.04887834, 1.90351307, -0.35135519, -1.09254446, 0.03008808, -0.79388526, -0.61322525, -0.76433969, -0.47275471, 0.05540432, -0.59597771, -0.63779685, 0.97907328, -0.39368657, -1.43599957, -0.40842378, -0.28484966, 0.27470965, -0.30043331, -0.95771378, 0.80176444, 0.02840583, 0.28634745, -0.01966477, -0.14885119, 0.42187158, 0.61308969, 0.09001487, -0.02612796, -0.03063985, -0.04290293, 0.00925968, -0.35533358, 0.25714459, -0.20773739, 0.51400345, 0.87872485, 0.42519634, 0.08778923, -0.43745201, 0.55610466, 0.11200182, 0.88919807, -0.31280797, -1.75054016, -0.45594087, -0.27389769, 0.46059653, -0.10440213, 0.36138392, 0.75007137, -0.13612981, -0.32163254, -0.21220274, 1.18530894, 0.07313769, -0.86247124, 0.33882731, 0.25354659, -0.24342188, -1.01228813, -0.51100921, 0.02896706, 2.40783189, 1.73204242, 0.5452871, -0.21622341, 2.19419024, 0.84892397, 0.48000989, 0.58940248, -0.21915, 1.27322437, 0.33579232, -0.99826096, 0.41365574, -0.37638748, 0.53802782, -0.77447362, -0.00793017, 0.32023896, 0.05823228, 0.18073692, 0.1046946, -0.08201785, -0.35469453, 0.44202203, 3.38262268, 0.43405027, -0.74903389, 0.15335664, 0.25268914, -0.29613346, -0.09109073, 0.04919036, 0.23780852, -0.05947584, -0.36353745, 0.45666353, 1.68605013, 0.08608026, -0.29136739, 0.87078687, -0.1269408, 0.07154087, -0.87534967, -0.34806518, 0.83057069, -0.4144312, 1.1777417, 0.43899784, -0.80702697, -0.04993844, -0.36276116, -0.02072821, 0.01366432, 0.28692414, -0.6185237, -0.0169286, -0.15478852, -0.81032138, -0.28485572, -0.12755834, -0.09993367, 0.21346504, 0.03883752, 0.10316277, -0.03626839, -0.47801431, 2.13321319, 0.52282039, -0.04750158, -0.13000853, -0.02146982, -0.04516328, -0.38284421, -0.02436252, -1.07942005, -0.84455695, -1.02756863, 0.10401592, -2.12853528, -2.99178286, 0.78364103, -0.49250135, 1.27568736, -2.04522456, -0.47624405, 0.59562095, -1.30441229, 4.06217586, 1.34162409, -0.36462015, -0.42435203, -1.03407517, 0.5963522, 0.03392318, 0.1767664, 0.30419042, -0.53557971, -0.20454628, 0.65269783, 0.31527136, -0.32127939, 0.41976118, -0.25189552, -0.03391449, 0.52701834, 0.48112655, 0.13258622, -0.19962566, 0.33972082, -1.1021552, -1.9345884, -0.50820036, 0.64101698, 0.3315283, 0.32863618, 0.003872, -0.35723957, -0.30955463, -0.62611932, 0.04519902, -0.62372282, -0.32675715, -0.43798726, -0.18664184, 0.05374833, -0.30014456, -0.60778719, 0.23160433, 0.29993221, 0.05338349, 1.03468933, -0.62714734, -0.17103604, -0.28355501, -0.16496096, 0.13555782, -0.07778238, -0.27474521, 0.20799431, 0.12256054, 0.33327159, 0.10529675, -0.16320797, 0.66838676, 1.58688066, 0.58346473, 0.01045102, 0.15903179, 0.11359124, 1.06734044, 0.21279817, 0.21449645, -1.03581475, 0.04527902, -1.00576865, -0.73976219, 0.26675068, -1.56109696, 0.71305765, 0.24256133, -0.06394795, -0.78907323, 0.40128514, 0.79892295, -3.35665032, -3.06803214, 0.09928104, 0.29789193, -1.41064474, 0.04647113, 0.21739552, -0.61376438, 1.83552206, 1.46826232, 2.0269204, 0.12627185, 1.22774938, 0.51771178, -0.51816727, 0.69098581, 0.61558862, 0.48946173, -0.5831934, -1.24344883, 0.52446555, 0.05367796, 0.61857383, 0.10876427, -0.01699804, -0.51316084, -0.41404233, -0.8521734, -0.8064554, -0.68019481, 0.16976938, -0.40146202, -0.21131428, -1.28528709, 0.16852307, -0.56698042, 0.44709569, 0.65492674, -0.69464936, 0.32539558, 1.02684513, -0.49823183, -0.9747896, -0.56845233, 2.91013396, -0.66553922, 0.46920291, 0.57879879, 0.78648176, 0.90402773, -0.41841911, 1.14570912, 6.14875853, 0.47061449, -0.63686861, 1.23816552, -0.66214544, 1.97087324, 0.24489263, 0.87313751, 2.70163591, 1.18217292, 0.47088689, -0.00359317, 0.03543365, 0.60870657, 0.52061604, 0.47483508, 0.03949101, 0.41879854, 0.52641985, -0.78736972, -0.03891616, 0.03440318, -0.68180895, -1.56249199, 0.08880429, 0.55499309, 0.31077506, 1.07337313, -0.03696371, 0.86548976, -0.67729459, 0.04051647, 0.01968593, -0.10966711, 1.14524694, 0.55067893, 0.41931056, 0.60522918, -1.42260329, 0.66299012, 0.36375824, 0.24182685, -1.5371834, -1.43025942, 0.14601799, -0.5096286, -0.40289614, -0.48317662, -1.68171425, 0.29666104, -0.17815484, -0.44467907, -1.23439415, -0.28641557, 0.27142055, -1.01329003, -0.26975134, -0.44699911, 0.30170191, -0.11532552, -0.3769779, -0.17547293, 0.07777373, -0.11191987, -0.58646849, 0.02707869, -3.17457958, 0.07662237, 0.22221327, 0.29398227, -0.01660972, 0.26541498, -0.13799007, 0.33309236, -0.46056132, -0.38894969, -0.16332453, -0.65735248, 0.33233183, -0.00361671, 0.06755678, 1.4766171, 0.44074406, -0.84657117, 0.94558367, -0.12916527, -0.12965207, -0.11549527, 0.40281948, 0.06914727, 0.3338568, -0.37800444, 0.09010942, 0.0820346, 0.30829713, 0.44446002, -0.66163325, 0.26539719, 0.4345563, 0.32980218, 0.7792028, -0.18514572, 0.27791496, 0.59048807, 0.3583155, 0.76049078, 1.3039203, -0.20465942, -0.39075544, 2.78561924, 0.00241835, -0.6299361, 0.37278659, -0.2289434, -0.76146955, 0.63480776, -0.64239221, 0.60374876, -0.21906154, 0.71090604, -1.2366859, 0.00388196, 0.37612946, 0.44370578, 0.30367975, 0.52652139, -0.74932916, 0.49790434, -0.59631578, 1.51821748, 0.47055281, 0.48059816, 0.06605667, -0.4404968, 1.73859531, -0.26314235, 0.02865621, 0.3103519, -0.35352141, 0.98191159, 0.23906019, 0.01541167, -0.59200723, 0.53600937, -0.31391911, 0.66656467, -0.78176461, 0.07482009, 1.06664424, 0.53364666, 0.43938989, -0.22146247, -0.93669805, -1.05526017, -0.75399638, -0.05645284, -0.89405665, -0.40373497, 0.27984824, -0.44931997, 0.03035205, -0.53703213, 0.27552859, 0.2409624, -1.87119379, 0.15385687, -1.05211707, 1.45934375, -0.49536057, -0.36149619, 0.33441159, -2.74056227, -1.45011401, -0.62813062, 0.95767555, -0.48312213, -1.26895443, -1.74430673, 0.04074296, -0.02154889, -0.4879136, -0.277464, -0.99840767, 0.52637701, 0.5114064, 0.55550763]);
  const b1 = new Float64Array([-0.40304461, 0.2867866, -0.51754964, 0.18056497, -0.09987043, 0.13204174, -0.19104881, -0.30511605, -0.55417469, -0.43741034, -0.02825568, 0.66002674, -0.26575721, -0.30885087, 0.36987441, -0.380272, -0.41469484, -0.32717178, 0.21091105, -0.06154481, 0.1639695, -0.27779871, 0.34740951, -0.00574977]);
  const W2 = new Float64Array([0.49742184, 0.2701709, 0.2416587, -0.04090219, -0.64631697, -0.14872842, -0.10607225, -0.18948658, 0.9681721, -0.33363824, -0.4596618, 0.46461683, -0.65078463, -0.51708427, -0.16386569, -0.83319763, -0.20172136, 0.82824665, -0.03165856, 0.06020365, 1.23889815, -0.24108692, -0.92408505, 0.52359565, 0.88809359, -0.09799744, 1.18618107, -0.48443255, 0.81334277, 1.06415956, 0.11329293, -0.6452383, -0.48502863, 0.13289146, -0.3066348, 0.40622181, 0.27196449, 0.40995392, 0.69915193, -1.0635735, 0.11517423, 0.0743683, 0.73388901, -0.45874536, 0.11611886, 0.44654633, 0.1088385, 0.97829123, 0.86859925, -0.16455989, -0.54255044, -0.80218657, -0.63273981, 0.38238395, -0.13195992, -1.04762185, 0.12770794, -0.47792382, -0.52106167, 1.11897499, -0.25612183, -0.06089182, -0.38032868, 0.18558696, 0.18015189, 0.37836134, -0.83035901, 0.42673391, 0.97455367, -0.00693873, 0.03522508, 1.42680285, -1.41555668, 0.58557649, 0.33712292, -0.20978284, -0.65225913, -0.34662386, 0.05795577, 0.94909605, -2.2617062, -0.05107038, -0.37156391, 0.49918128, -0.73147602, 0.37925154, -0.89450395, 0.53703389, -0.79501837, -0.2073069, 0.74730858, -0.00728347, -0.8621106, -0.32760311, 0.57343088, -0.21925875, -0.4987331, -0.4297812, -0.91120101, 0.0573319, 0.39403648, 0.71361222, -0.46246056, -0.42928284, 0.75175551, 0.38329441, -0.33329001, -0.37309771, -0.14493611, 0.73226434, 0.76747524, 0.2892354, 0.66396827, -0.85926688, 0.54428417, -0.06886843, -0.07771797, -0.42681733, 0.72297933, 0.09360983, 1.9032481, -0.32632336, -0.80487878, 0.26798353, 1.38953219, 1.318899, -0.32986891, 0.22499063, 1.19227759, 0.10874312, -0.13859815, -0.7804797, 0.50732848, -0.47369606, -0.04184164, -0.68423282, 0.21045537, 0.10852326, -0.17465358, 0.31885954, 0.2259333, -0.06669726, 0.00704479, 0.10906991, 0.570565, 0.01114135, -0.48362518, -0.22542937, -0.11799724, -1.45035402, 0.86400691, 0.52034845, 0.70069959, 0.60639649, 0.21413436, -1.02356417, 0.68848258, 0.79070753, 0.08717379, 1.38278219, -0.24315337, -0.5724403, -0.46859081, 0.90573742, -0.46069346, -0.81604963, 0.22241534, -0.75960816, -0.06851195, 0.14607414, -0.23248313, 0.19005009, 0.11575768, 0.89351047, -0.98635462, 0.42747579, -0.07240452, 0.30016531, 0.2036589, 0.31897773, 0.4527186, 0.23884514, -0.0782251, 0.26443168, 0.61374707, 0.14996746, 0.05259172, -0.0217804, -0.83900914, 0.44380836, -0.33426436, 0.17700124, -0.50589101, 0.52085745, 0.22196792, 1.2907889, 0.00571341, 0.00232991, -0.36301417, -0.24121594, 0.12479124, 0.58384441, 0.86311386, 0.12419842, 0.17038601, 0.91458746, 0.67071427, -0.39798669, -0.51826393, -0.37343351, 0.57717957, -0.97552687, 0.53097065, -0.06287701, 0.04546558, -0.31933836, 0.10784922, -0.39659517, -0.15757021, -0.50335945, -0.76082921, -1.05229157, 0.16817322, 0.52884007, -0.36098478, -0.11318515, 0.22989134, 0.34381858, 0.0669243, -0.14813005, 0.08917504, 0.7751505, 1.4016455, -0.30921807, -0.95690566, 0.98566069, -0.42612494, -0.36155716, 0.04946343, 0.18947356, -0.01949018, 0.19106311, -0.28991268, 0.28836568, -0.43247855, 0.42044336, -1.33284837, 0.07472669, 0.56981618, 0.13022847, 0.53847443, 0.14056122, 1.46781617, -0.41829698, -0.38389335, -0.212882, 0.69100854, -0.16112432, 0.14595478, -0.22270496, 0.23233383, -0.10450854, 0.06127683, 0.67236523, 0.48835229, -0.07856454, -0.40087845, -0.20469104, -1.09499615, -0.4344285, 0.4479616, -0.09133954, -0.22713278, -0.31787193, 0.52844062, -0.31780789, -0.08441193, 0.20729514, 0.13806283, 0.01605483, -0.80467832, -0.53626214, -0.94848937, 0.40894448, -0.06825849, 0.07984258, -0.44004928, -0.28742863, 1.03337509, -1.71762136, 0.01582602, -0.22492322, -0.50079192, 0.63876221, -0.02197984, 0.79900854, 0.95325577, -0.09355779, -0.26736876, 0.21466341, -0.14525178, 0.27615788, -0.3548629, -0.22727126, -0.64929232, -0.06269505, -0.12988673, -1.04999104, 0.19183403, 0.25055181, -0.70964561, 1.07621375, -0.44816552, 0.16558835, 0.47580189, -0.11483704, 0.26067449, -0.32505968, 0.24051296, 0.31591766, -0.17336423, -0.61704354, -0.16210109, 0.41513782, -0.46296907, 0.13696706, 0.4431142, 0.04925874, 0.22100849, -0.42835487, 0.12358795, -0.77300101, 0.42749732, -0.73892787, 0.45062177, -0.23938644, 0.02570303, 0.42273458, -0.06724032, 0.02073538, 0.09020777, -0.78568047, 0.2978014, -0.22948501, -0.05172835, -0.46080662, -0.46789116, 0.62918596, 0.30791443, -0.79462593, 0.86875073, -0.60306365, -0.99546292, 0.24379307, -0.04513759, -0.84100038, 0.3387626, -0.07362891, -0.1047774, 0.06100704, 1.79399345, -0.47892611, 0.48443674, -0.75560892, 0.8826609, 0.86134156, 0.21083928, -0.49515355, 0.63949203, -0.359488, -0.9210628, 0.05247154, 0.38446747, -0.9522999, 0.76780629, -1.63713308, -0.06342243, 0.12586696, 0.15683632, 0.24899466, 0.60627014, 1.47409243, -1.46277048, 0.20132634]);
  const b2 = new Float64Array([0.11682907, -0.50937404, 0.21846102, 0.07370458, 0.08833389, -0.72271608, -0.12503709, -0.64264663, -0.09674821, -0.23134642, -0.29921666, 0.32653802, 0.24655441, 0.30427226, -0.33355322, -0.30503259]);
  const W3 = new Float64Array([0.29100223, -0.92424891, 0.16506631, -0.53655394, -0.51327677, 0.3786885, -0.70113286, 0.02267003, -0.2549664, 1.11993976, 0.09727572, 0.00706621, 0.33344295, 0.76226658, 0.94181009, 0.35118035, 0.42726134, 0.22991702, -0.01230126, -0.12150831, -0.04629924, 0.21564567, 0.20728856, -0.17828013, -0.13236183, 0.26501108, 0.03878625, 0.21948781, 0.02980976, -0.06937907, -0.20738504, 0.10001369, 0.10652699, 0.02677934, -0.17999333, 0.06365331, -0.22002631, 0.07676843, -0.05925772, 0.08119549, -0.1661487, 0.10005132, 0.0709875, -0.34686521, 0.15381904, -0.05761472, -0.50283043, 0.55281659, -0.04942607, 0.26374359, -0.35845166, -0.14056122, -0.29800959, 0.0301322, -0.09249378, -0.22953077, 0.12496077, 0.10493339, -0.40052988, 0.05406226, -0.02245186, 0.24994585, -0.42162684, 0.12714062, 0.4363011, 0.72847381, 0.09922832, -0.58609149, -0.68535566, 0.17518889, -0.1268902, -0.8263128, -0.29506825, 0.15811458, 0.09708295, 0.81655744, -0.28845783, 0.41453705, 0.96100708, 2.22371473]);
  const b3 = new Float64Array([0.31920444, -0.07969788, 0.00923981, 0.13447447, 0.42624309]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.18751687, -0.03841178, -0.22435289, -0.07381462, 0.17132232, -0.48441334, 0.07362537, -0.21292008, 0.7976389, -5.70850609, -0.25282853, 0.25198737, 0.09398154, 0.37057773, -0.23158349, 0.36320623, -0.22301462, -0.06543675, -0.07055231, 0.09977913, 0.23809225, 1.16551059, -0.15373578, -0.22026586, -0.70836227, 0.35976411, 0.2479004, 0.22785852, 0.73391917, -0.35032471, -0.33574089, 0.43452106, -0.27586612, 0.799619, 0.24977642, -0.48173788, 0.45784678, 0.33145226, 0.83239095, -0.27154949, -0.20032677, 0.45093149, -0.42840741, 0.50841366, -0.1649333, -0.3410757, 0.08504802, -0.00712836, 0.80926349, 0.39961172, -0.24514685, 1.40975662, -1.54465762, -1.67325107, 0.26739317, 0.59078417, 0.87573574, -1.02743223, 1.02371596, 0.45927069, -0.33729903, -0.51052906, 1.41542057, 1.64107601, 0.41185924, 0.29404307, 1.40592063, -1.8655735, 0.6460826, -0.39898047, -0.42319701, 7.1446657, 0.54213213, 0.96186971, 0.42916886, 1.23754621, 4.73902174, 0.99373808, 0.64375443, 0.65481331, 0.05096682, 1.71922385, 0.8084697, -0.09894255, 0.44294278, -0.56937126, 0.02388452, 0.34094382, 0.01189408, 0.2847581, -0.18520108, 0.15901692, 0.02765835, 0.79788156, -0.97327022, -2.36835645, 0.35570536, 0.51655708, 0.54888757, 0.42808751, -1.18212533, 0.23410423, 0.23288433, -0.43364689, -0.29487431, -0.18176476, -1.73637409, -1.01618254, 0.15354953, 0.39340749, 1.44566675, 1.46378978, -0.59605309, 0.88573009, 0.42099233, 0.52526792, 0.32693032, -0.68110761, -0.26704532, -0.14339462, 1.45899702, -0.16685595, -0.05402112, 0.17807256, 0.38631022, 0.22742169, 0.27549736, -0.33294552, 0.46841613, -0.02278885, -0.02216948, -0.85691917, -0.42489951, -0.11162277, -1.14742033, -0.00438203, -0.10951721, -0.33625655, 0.79139449, 0.0790255, -0.87192952, -0.67882304, 0.13959419, 0.00503402, -0.69886643, -0.31460633, 0.50893138, -0.77960155, -0.48639898, 1.56383969, 0.38633647, -1.12795729, 0.05687525, 1.09993164, -0.35936305, -0.40618855, -0.09202552, 1.33766126, 0.32468417, 0.35447609, 0.16299633, -0.7316578, -0.42094939, 0.06647965, -0.07530339, 0.06166169, -0.51528472, -0.14360148, -0.84241919, 0.05015186, 0.84337022, -0.20236728, 0.07466748, 0.1366084, 0.26390766, 0.16222262, 0.03260931, 0.0105901, 0.23975622, -0.13032354, -0.18541625, -4.23983715, 0.38280185, 0.95359695, -0.29144767, -0.21945577, -0.22815564, 0.25319759, -0.50850599, -0.3644887, 0.27419585, 0.31212036, -0.93548478, 0.51279339, 0.2925673, 0.21847364, 0.85492561, -0.14701953, -0.58225853, 0.78172712, 0.23901164, 0.02049537, 0.13357553, 0.0511719, -0.25598102, 0.76518346, 0.09605561, -0.42653966, 0.76150904, -0.51362025, 0.50990635, -1.0947448, 0.16287685, 0.48830585, 0.18277015, -0.65685644, 0.23790632, -0.48663847, -0.28048232, -0.37974724, 0.4819406, -0.32180262, 0.75715797, 1.3621568, -2.7371082, 0.14861172, -0.41905348, 1.36346477, 1.38970207, -0.12099715, -0.22768903, 0.4029705, -0.00925094, -0.35363064, -0.12957676, -0.11928546, -0.15655103, 0.1376488, -0.5071198, -0.64672935, 0.80012365, -0.34596017, 0.25986987, 0.65108299, -2.1770202, -0.6884504, -0.06153838, -0.08929835, 1.32326531, -0.68394296, -0.20783063, -0.39155247, -1.11246267, 0.76069939, 0.90360035, -0.63081854, -0.47274011, -0.22651906, 0.27265636, 0.17756186, 0.72478318, 0.27532048, -0.14775899, 0.16672682, 0.12823117, 0.38310115, 0.21310285, -0.42382001, 1.02110949, 0.76166636, -0.66621299, -0.19080162, 0.78558746, -0.49083511, -0.51150934, 0.37349403, 0.2051815, -0.02111854, -0.45937454, -0.32162393, -0.25313708, 0.69064845, 0.34143897, -1.22075415, -0.0529835, 0.13979904, 1.61969799, 0.0124979, 0.24933727, -1.01085725, 1.66328988, 0.7996873, 0.57001745, 0.18486377, -0.80626215, 0.88041383, 0.49309304, -0.11719085, -0.31853038, -0.18427466, 0.6628835, 0.05278763, -0.14413451, -0.35322581, -0.35857553, -0.0487353, -0.49048334, -0.42414612, -0.24393564, 1.38184539, 2.72949798, -0.04876864, -0.24487631, -0.49575136, -0.77215415, 0.52141237, 0.31319116, 0.50882555, 0.15023232, 0.72939245, 0.43339594, 1.54212749, -1.06064229, -0.58366106, 0.47176364, 0.45495476, -0.80565184, -0.08505918, -0.17917018, -0.48461375, 0.4226609, -0.01937764, -0.15781294, -0.0111943, 0.4637539, -0.22996495, 0.12502233, -0.06168194, 1.15526894, 0.09526128, -0.59891101, -0.70016005, -0.58324131, -0.46642778, 0.02916348, 0.20610958, 0.43151871, -0.56254623, -0.2288588, -0.29412742, 0.03655579, 0.09901785, -0.23393498, -6.42747912, 0.14722914, -0.08677057, -0.0168222, 0.19534585, 1.01745469, -0.43236682, -0.0697075, 0.81575424, 0.32429898, -0.10337549, 0.97022527, 0.94612692, 0.06569938, -0.10246203, -0.7860776, -0.76446712, 0.78644171, -0.02763688, -0.01265279, -0.07041382, -0.161399, 0.76450826, -0.16695896, -0.44235422, -0.50353129, 0.18980192, 0.62752692, -0.1052071, -0.16357766, 0.20138973, 0.34251188, 0.56200829, 0.41846627, -0.62266725, 0.04263304, -0.5736839, -0.13131578, -0.51005468, -0.70326252, -0.09270821, -0.08713873, -0.7326027, 0.36599391, -0.4287493, -0.62667171, -0.4457687, 0.30613137, -0.21009481, -0.50548048, -0.92141492, -0.00300258, 0.09507273, 0.19295302, -1.0641009, 0.1013885, 0.00150847, -0.37741615, 0.32321336, -0.67385329, -0.69369511, 0.04009679, 0.69200813, 0.75113262, 0.57015973, -0.34952083, -0.60910561, 0.38212407, -0.42693657, -0.03890997, 0.22674511, -0.12096495, -0.1589244, -0.13080018, 0.14136774, 0.10851526, -0.1256176, 0.03589377, 0.35579171, 0.40343071, -0.33241466, -0.50242179, -0.36989624, -0.75518329, -0.58602425, -0.00819035, 2.57129563, -0.5373093, -0.61924259, 0.29400275, -0.90302839, 0.03331877, -0.57696681, 0.51992889, 0.51470342, 0.34729907, -0.34163617, 0.58187713, -0.53543713, -0.75721697, -0.32069211, -0.15708814, 0.36092845, 0.05377594, -0.730953, 0.2228279, -0.56226945, 0.17398214, 0.22129267, -0.69446968, 0.01203425, 0.61994392, -0.58853393, 0.55355338, -1.04769237, 0.49841444, 0.51540718, 0.10900034, 0.3826657, -0.0259537, 1.22691641, 0.05620455, 0.40188375, -0.21715831, 0.01649466, 1.22403175, -0.01900993, 0.5227549, -1.59054311, 1.28047544, -0.26411406, -0.04377671, 1.91090727, -0.02117513, 0.45924483, 0.36733737, 0.41802939, -0.53918015, -0.19645528, -0.32257121, -1.41167578, 0.49487673, 0.7895108, -1.14313968, -1.22070578, -0.44101964, 0.99174852, -0.51284863, -1.04071269, -1.24848436, 0.06764751, 0.13380368, -0.47983358, -0.05246349, -1.23978111, 0.36596549, 0.28078307, -0.54565513, -0.26000334, -0.60055496, 0.48910999, 0.20479397, 0.51723505, 0.06640906, 0.00049171, -0.04177677, -0.11303608, -0.04536118, 0.06096111, 0.19507256, -0.3309958, 1.94250694, -1.50588042, -0.05399908, -0.47188488, 0.55173704, -0.53533909, -0.37033699, -0.3043047, -0.03333376, -0.3237057, 0.11394763, 0.02206434, -1.9054434, -0.67640894, 0.99342816, -1.55696064, 0.19534164, 0.47847718, 0.1563291, 0.03730322, 0.85411632, -0.24498287, 0.19257193, -0.33676692, -2.46419136, 0.96954253, 0.02951214, 0.10489121, 0.03765621, -2.37218214, -0.23843583, 0.43014482, 0.20560761, 0.00100657, -1.05677248, -0.04513662, 0.35921868, -0.12652313, 0.03134359, 0.13284522, -0.54893577, -0.28553787, 0.30827473, -0.04887834, 1.90351307, -0.35135519, -1.09254446, 0.03008808, -0.79388526, -0.61322525, -0.76433969, -0.47275471, 0.05540432, -0.59597771, -0.63779685, 0.97907328, -0.39368657, -1.43599957, -0.40842378, -0.28484966, 0.27470965, -0.30043331, -0.95771378, 0.80176444, 0.02840583, 0.28634745, -0.01966477, -0.14885119, 0.42187158, 0.61308969, 0.09001487, -0.02612796, -0.03063985, -0.04290293, 0.00925968, -0.35533358, 0.25714459, -0.20773739, 0.51400345, 0.87872485, 0.42519634, 0.08778923, -0.43745201, 0.55610466, 0.11200182, 0.88919807, -0.31280797, -1.75054016, -0.45594087, -0.27389769, 0.46059653, -0.10440213, 0.36138392, 0.75007137, -0.13612981, -0.32163254, -0.21220274, 1.18530894, 0.07313769, -0.86247124, 0.33882731, 0.25354659, -0.24342188, -1.01228813, -0.51100921, 0.02896706, 2.40783189, 1.73204242, 0.5452871, -0.21622341, 2.19419024, 0.84892397, 0.48000989, 0.58940248, -0.21915, 1.27322437, 0.33579232, -0.99826096, 0.41365574, -0.37638748, 0.53802782, -0.77447362, -0.00793017, 0.32023896, 0.05823228, 0.18073692, 0.1046946, -0.08201785, -0.35469453, 0.44202203, 3.38262268, 0.43405027, -0.74903389, 0.15335664, 0.25268914, -0.29613346, -0.09109073, 0.04919036, 0.23780852, -0.05947584, -0.36353745, 0.45666353, 1.68605013, 0.08608026, -0.29136739, 0.87078687, -0.1269408, 0.07154087, -0.87534967, -0.34806518, 0.83057069, -0.4144312, 1.1777417, 0.43899784, -0.80702697, -0.04993844, -0.36276116, -0.02072821, 0.01366432, 0.28692414, -0.6185237, -0.0169286, -0.15478852, -0.81032138, -0.28485572, -0.12755834, -0.09993367, 0.21346504, 0.03883752, 0.10316277, -0.03626839, -0.47801431, 2.13321319, 0.52282039, -0.04750158, -0.13000853, -0.02146982, -0.04516328, -0.38284421, -0.02436252, -1.07942005, -0.84455695, -1.02756863, 0.10401592, -2.12853528, -2.99178286, 0.78364103, -0.49250135, 1.27568736, -2.04522456, -0.47624405, 0.59562095, -1.30441229, 4.06217586, 1.34162409, -0.36462015, -0.42435203, -1.03407517, 0.5963522, 0.03392318, 0.1767664, 0.30419042, -0.53557971, -0.20454628, 0.65269783, 0.31527136, -0.32127939, 0.41976118, -0.25189552, -0.03391449, 0.52701834, 0.48112655, 0.13258622, -0.19962566, 0.33972082, -1.1021552, -1.9345884, -0.50820036, 0.64101698, 0.3315283, 0.32863618, 0.003872, -0.35723957, -0.30955463, -0.62611932, 0.04519902, -0.62372282, -0.32675715, -0.43798726, -0.18664184, 0.05374833, -0.30014456, -0.60778719, 0.23160433, 0.29993221, 0.05338349, 1.03468933, -0.62714734, -0.17103604, -0.28355501, -0.16496096, 0.13555782, -0.07778238, -0.27474521, 0.20799431, 0.12256054, 0.33327159, 0.10529675, -0.16320797, 0.66838676, 1.58688066, 0.58346473, 0.01045102, 0.15903179, 0.11359124, 1.06734044, 0.21279817, 0.21449645, -1.03581475, 0.04527902, -1.00576865, -0.73976219, 0.26675068, -1.56109696, 0.71305765, 0.24256133, -0.06394795, -0.78907323, 0.40128514, 0.79892295, -3.35665032, -3.06803214, 0.09928104, 0.29789193, -1.41064474, 0.04647113, 0.21739552, -0.61376438, 1.83552206, 1.46826232, 2.0269204, 0.12627185, 1.22774938, 0.51771178, -0.51816727, 0.69098581, 0.61558862, 0.48946173, -0.5831934, -1.24344883, 0.52446555, 0.05367796, 0.61857383, 0.10876427, -0.01699804, -0.51316084, -0.41404233, -0.8521734, -0.8064554, -0.68019481, 0.16976938, -0.40146202, -0.21131428, -1.28528709, 0.16852307, -0.56698042, 0.44709569, 0.65492674, -0.69464936, 0.32539558, 1.02684513, -0.49823183, -0.9747896, -0.56845233, 2.91013396, -0.66553922, 0.46920291, 0.57879879, 0.78648176, 0.90402773, -0.41841911, 1.14570912, 6.14875853, 0.47061449, -0.63686861, 1.23816552, -0.66214544, 1.97087324, 0.24489263, 0.87313751, 2.70163591, 1.18217292, 0.47088689, -0.00359317, 0.03543365, 0.60870657, 0.52061604, 0.47483508, 0.03949101, 0.41879854, 0.52641985, -0.78736972, -0.03891616, 0.03440318, -0.68180895, -1.56249199, 0.08880429, 0.55499309, 0.31077506, 1.07337313, -0.03696371, 0.86548976, -0.67729459, 0.04051647, 0.01968593, -0.10966711, 1.14524694, 0.55067893, 0.41931056, 0.60522918, -1.42260329, 0.66299012, 0.36375824, 0.24182685, -1.5371834, -1.43025942, 0.14601799, -0.5096286, -0.40289614, -0.48317662, -1.68171425, 0.29666104, -0.17815484, -0.44467907, -1.23439415, -0.28641557, 0.27142055, -1.01329003, -0.26975134, -0.44699911, 0.30170191, -0.11532552, -0.3769779, -0.17547293, 0.07777373, -0.11191987, -0.58646849, 0.02707869, -3.17457958, 0.07662237, 0.22221327, 0.29398227, -0.01660972, 0.26541498, -0.13799007, 0.33309236, -0.46056132, -0.38894969, -0.16332453, -0.65735248, 0.33233183, -0.00361671, 0.06755678, 1.4766171, 0.44074406, -0.84657117, 0.94558367, -0.12916527, -0.12965207, -0.11549527, 0.40281948, 0.06914727, 0.3338568, -0.37800444, 0.09010942, 0.0820346, 0.30829713, 0.44446002, -0.66163325, 0.26539719, 0.4345563, 0.32980218, 0.7792028, -0.18514572, 0.27791496, 0.59048807, 0.3583155, 0.76049078, 1.3039203, -0.20465942, -0.39075544, 2.78561924, 0.00241835, -0.6299361, 0.37278659, -0.2289434, -0.76146955, 0.63480776, -0.64239221, 0.60374876, -0.21906154, 0.71090604, -1.2366859, 0.00388196, 0.37612946, 0.44370578, 0.30367975, 0.52652139, -0.74932916, 0.49790434, -0.59631578, 1.51821748, 0.47055281, 0.48059816, 0.06605667, -0.4404968, 1.73859531, -0.26314235, 0.02865621, 0.3103519, -0.35352141, 0.98191159, 0.23906019, 0.01541167, -0.59200723, 0.53600937, -0.31391911, 0.66656467, -0.78176461, 0.07482009, 1.06664424, 0.53364666, 0.43938989, -0.22146247, -0.93669805, -1.05526017, -0.75399638, -0.05645284, -0.89405665, -0.40373497, 0.27984824, -0.44931997, 0.03035205, -0.53703213, 0.27552859, 0.2409624, -1.87119379, 0.15385687, -1.05211707, 1.45934375, -0.49536057, -0.36149619, 0.33441159, -2.74056227, -1.45011401, -0.62813062, 0.95767555, -0.48312213, -1.26895443, -1.74430673, 0.04074296, -0.02154889, -0.4879136, -0.277464, -0.99840767, 0.52637701, 0.5114064, 0.55550763]);
  const b1 = new Float64Array([-0.40304461, 0.2867866, -0.51754964, 0.18056497, -0.09987043, 0.13204174, -0.19104881, -0.30511605, -0.55417469, -0.43741034, -0.02825568, 0.66002674, -0.26575721, -0.30885087, 0.36987441, -0.380272, -0.41469484, -0.32717178, 0.21091105, -0.06154481, 0.1639695, -0.27779871, 0.34740951, -0.00574977]);
  const W2 = new Float64Array([0.49742184, 0.2701709, 0.2416587, -0.04090219, -0.64631697, -0.14872842, -0.10607225, -0.18948658, 0.9681721, -0.33363824, -0.4596618, 0.46461683, -0.65078463, -0.51708427, -0.16386569, -0.83319763, -0.20172136, 0.82824665, -0.03165856, 0.06020365, 1.23889815, -0.24108692, -0.92408505, 0.52359565, 0.88809359, -0.09799744, 1.18618107, -0.48443255, 0.81334277, 1.06415956, 0.11329293, -0.6452383, -0.48502863, 0.13289146, -0.3066348, 0.40622181, 0.27196449, 0.40995392, 0.69915193, -1.0635735, 0.11517423, 0.0743683, 0.73388901, -0.45874536, 0.11611886, 0.44654633, 0.1088385, 0.97829123, 0.86859925, -0.16455989, -0.54255044, -0.80218657, -0.63273981, 0.38238395, -0.13195992, -1.04762185, 0.12770794, -0.47792382, -0.52106167, 1.11897499, -0.25612183, -0.06089182, -0.38032868, 0.18558696, 0.18015189, 0.37836134, -0.83035901, 0.42673391, 0.97455367, -0.00693873, 0.03522508, 1.42680285, -1.41555668, 0.58557649, 0.33712292, -0.20978284, -0.65225913, -0.34662386, 0.05795577, 0.94909605, -2.2617062, -0.05107038, -0.37156391, 0.49918128, -0.73147602, 0.37925154, -0.89450395, 0.53703389, -0.79501837, -0.2073069, 0.74730858, -0.00728347, -0.8621106, -0.32760311, 0.57343088, -0.21925875, -0.4987331, -0.4297812, -0.91120101, 0.0573319, 0.39403648, 0.71361222, -0.46246056, -0.42928284, 0.75175551, 0.38329441, -0.33329001, -0.37309771, -0.14493611, 0.73226434, 0.76747524, 0.2892354, 0.66396827, -0.85926688, 0.54428417, -0.06886843, -0.07771797, -0.42681733, 0.72297933, 0.09360983, 1.9032481, -0.32632336, -0.80487878, 0.26798353, 1.38953219, 1.318899, -0.32986891, 0.22499063, 1.19227759, 0.10874312, -0.13859815, -0.7804797, 0.50732848, -0.47369606, -0.04184164, -0.68423282, 0.21045537, 0.10852326, -0.17465358, 0.31885954, 0.2259333, -0.06669726, 0.00704479, 0.10906991, 0.570565, 0.01114135, -0.48362518, -0.22542937, -0.11799724, -1.45035402, 0.86400691, 0.52034845, 0.70069959, 0.60639649, 0.21413436, -1.02356417, 0.68848258, 0.79070753, 0.08717379, 1.38278219, -0.24315337, -0.5724403, -0.46859081, 0.90573742, -0.46069346, -0.81604963, 0.22241534, -0.75960816, -0.06851195, 0.14607414, -0.23248313, 0.19005009, 0.11575768, 0.89351047, -0.98635462, 0.42747579, -0.07240452, 0.30016531, 0.2036589, 0.31897773, 0.4527186, 0.23884514, -0.0782251, 0.26443168, 0.61374707, 0.14996746, 0.05259172, -0.0217804, -0.83900914, 0.44380836, -0.33426436, 0.17700124, -0.50589101, 0.52085745, 0.22196792, 1.2907889, 0.00571341, 0.00232991, -0.36301417, -0.24121594, 0.12479124, 0.58384441, 0.86311386, 0.12419842, 0.17038601, 0.91458746, 0.67071427, -0.39798669, -0.51826393, -0.37343351, 0.57717957, -0.97552687, 0.53097065, -0.06287701, 0.04546558, -0.31933836, 0.10784922, -0.39659517, -0.15757021, -0.50335945, -0.76082921, -1.05229157, 0.16817322, 0.52884007, -0.36098478, -0.11318515, 0.22989134, 0.34381858, 0.0669243, -0.14813005, 0.08917504, 0.7751505, 1.4016455, -0.30921807, -0.95690566, 0.98566069, -0.42612494, -0.36155716, 0.04946343, 0.18947356, -0.01949018, 0.19106311, -0.28991268, 0.28836568, -0.43247855, 0.42044336, -1.33284837, 0.07472669, 0.56981618, 0.13022847, 0.53847443, 0.14056122, 1.46781617, -0.41829698, -0.38389335, -0.212882, 0.69100854, -0.16112432, 0.14595478, -0.22270496, 0.23233383, -0.10450854, 0.06127683, 0.67236523, 0.48835229, -0.07856454, -0.40087845, -0.20469104, -1.09499615, -0.4344285, 0.4479616, -0.09133954, -0.22713278, -0.31787193, 0.52844062, -0.31780789, -0.08441193, 0.20729514, 0.13806283, 0.01605483, -0.80467832, -0.53626214, -0.94848937, 0.40894448, -0.06825849, 0.07984258, -0.44004928, -0.28742863, 1.03337509, -1.71762136, 0.01582602, -0.22492322, -0.50079192, 0.63876221, -0.02197984, 0.79900854, 0.95325577, -0.09355779, -0.26736876, 0.21466341, -0.14525178, 0.27615788, -0.3548629, -0.22727126, -0.64929232, -0.06269505, -0.12988673, -1.04999104, 0.19183403, 0.25055181, -0.70964561, 1.07621375, -0.44816552, 0.16558835, 0.47580189, -0.11483704, 0.26067449, -0.32505968, 0.24051296, 0.31591766, -0.17336423, -0.61704354, -0.16210109, 0.41513782, -0.46296907, 0.13696706, 0.4431142, 0.04925874, 0.22100849, -0.42835487, 0.12358795, -0.77300101, 0.42749732, -0.73892787, 0.45062177, -0.23938644, 0.02570303, 0.42273458, -0.06724032, 0.02073538, 0.09020777, -0.78568047, 0.2978014, -0.22948501, -0.05172835, -0.46080662, -0.46789116, 0.62918596, 0.30791443, -0.79462593, 0.86875073, -0.60306365, -0.99546292, 0.24379307, -0.04513759, -0.84100038, 0.3387626, -0.07362891, -0.1047774, 0.06100704, 1.79399345, -0.47892611, 0.48443674, -0.75560892, 0.8826609, 0.86134156, 0.21083928, -0.49515355, 0.63949203, -0.359488, -0.9210628, 0.05247154, 0.38446747, -0.9522999, 0.76780629, -1.63713308, -0.06342243, 0.12586696, 0.15683632, 0.24899466, 0.60627014, 1.47409243, -1.46277048, 0.20132634]);
  const b2 = new Float64Array([0.11682907, -0.50937404, 0.21846102, 0.07370458, 0.08833389, -0.72271608, -0.12503709, -0.64264663, -0.09674821, -0.23134642, -0.29921666, 0.32653802, 0.24655441, 0.30427226, -0.33355322, -0.30503259]);
  const W3 = new Float64Array([0.29100223, -0.92424891, 0.16506631, -0.53655394, -0.51327677, 0.3786885, -0.70113286, 0.02267003, -0.2549664, 1.11993976, 0.09727572, 0.00706621, 0.33344295, 0.76226658, 0.94181009, 0.35118035, 0.42726134, 0.22991702, -0.01230126, -0.12150831, -0.04629924, 0.21564567, 0.20728856, -0.17828013, -0.13236183, 0.26501108, 0.03878625, 0.21948781, 0.02980976, -0.06937907, -0.20738504, 0.10001369, 0.10652699, 0.02677934, -0.17999333, 0.06365331, -0.22002631, 0.07676843, -0.05925772, 0.08119549, -0.1661487, 0.10005132, 0.0709875, -0.34686521, 0.15381904, -0.05761472, -0.50283043, 0.55281659, -0.04942607, 0.26374359, -0.35845166, -0.14056122, -0.29800959, 0.0301322, -0.09249378, -0.22953077, 0.12496077, 0.10493339, -0.40052988, 0.05406226, -0.02245186, 0.24994585, -0.42162684, 0.12714062, 0.4363011, 0.72847381, 0.09922832, -0.58609149, -0.68535566, 0.17518889, -0.1268902, -0.8263128, -0.29506825, 0.15811458, 0.09708295, 0.81655744, -0.28845783, 0.41453705, 0.96100708, 2.22371473]);
  const b3 = new Float64Array([0.31920444, -0.07969788, 0.00923981, 0.13447447, 0.42624309]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.18751687, -0.03841178, -0.22435289, -0.07381462, 0.17132232, -0.48441334, 0.07362537, -0.21292008, 0.7976389, -5.70850609, -0.25282853, 0.25198737, 0.09398154, 0.37057773, -0.23158349, 0.36320623, -0.22301462, -0.06543675, -0.07055231, 0.09977913, 0.23809225, 1.16551059, -0.15373578, -0.22026586, -0.70836227, 0.35976411, 0.2479004, 0.22785852, 0.73391917, -0.35032471, -0.33574089, 0.43452106, -0.27586612, 0.799619, 0.24977642, -0.48173788, 0.45784678, 0.33145226, 0.83239095, -0.27154949, -0.20032677, 0.45093149, -0.42840741, 0.50841366, -0.1649333, -0.3410757, 0.08504802, -0.00712836, 0.80926349, 0.39961172, -0.24514685, 1.40975662, -1.54465762, -1.67325107, 0.26739317, 0.59078417, 0.87573574, -1.02743223, 1.02371596, 0.45927069, -0.33729903, -0.51052906, 1.41542057, 1.64107601, 0.41185924, 0.29404307, 1.40592063, -1.8655735, 0.6460826, -0.39898047, -0.42319701, 7.1446657, 0.54213213, 0.96186971, 0.42916886, 1.23754621, 4.73902174, 0.99373808, 0.64375443, 0.65481331, 0.05096682, 1.71922385, 0.8084697, -0.09894255, 0.44294278, -0.56937126, 0.02388452, 0.34094382, 0.01189408, 0.2847581, -0.18520108, 0.15901692, 0.02765835, 0.79788156, -0.97327022, -2.36835645, 0.35570536, 0.51655708, 0.54888757, 0.42808751, -1.18212533, 0.23410423, 0.23288433, -0.43364689, -0.29487431, -0.18176476, -1.73637409, -1.01618254, 0.15354953, 0.39340749, 1.44566675, 1.46378978, -0.59605309, 0.88573009, 0.42099233, 0.52526792, 0.32693032, -0.68110761, -0.26704532, -0.14339462, 1.45899702, -0.16685595, -0.05402112, 0.17807256, 0.38631022, 0.22742169, 0.27549736, -0.33294552, 0.46841613, -0.02278885, -0.02216948, -0.85691917, -0.42489951, -0.11162277, -1.14742033, -0.00438203, -0.10951721, -0.33625655, 0.79139449, 0.0790255, -0.87192952, -0.67882304, 0.13959419, 0.00503402, -0.69886643, -0.31460633, 0.50893138, -0.77960155, -0.48639898, 1.56383969, 0.38633647, -1.12795729, 0.05687525, 1.09993164, -0.35936305, -0.40618855, -0.09202552, 1.33766126, 0.32468417, 0.35447609, 0.16299633, -0.7316578, -0.42094939, 0.06647965, -0.07530339, 0.06166169, -0.51528472, -0.14360148, -0.84241919, 0.05015186, 0.84337022, -0.20236728, 0.07466748, 0.1366084, 0.26390766, 0.16222262, 0.03260931, 0.0105901, 0.23975622, -0.13032354, -0.18541625, -4.23983715, 0.38280185, 0.95359695, -0.29144767, -0.21945577, -0.22815564, 0.25319759, -0.50850599, -0.3644887, 0.27419585, 0.31212036, -0.93548478, 0.51279339, 0.2925673, 0.21847364, 0.85492561, -0.14701953, -0.58225853, 0.78172712, 0.23901164, 0.02049537, 0.13357553, 0.0511719, -0.25598102, 0.76518346, 0.09605561, -0.42653966, 0.76150904, -0.51362025, 0.50990635, -1.0947448, 0.16287685, 0.48830585, 0.18277015, -0.65685644, 0.23790632, -0.48663847, -0.28048232, -0.37974724, 0.4819406, -0.32180262, 0.75715797, 1.3621568, -2.7371082, 0.14861172, -0.41905348, 1.36346477, 1.38970207, -0.12099715, -0.22768903, 0.4029705, -0.00925094, -0.35363064, -0.12957676, -0.11928546, -0.15655103, 0.1376488, -0.5071198, -0.64672935, 0.80012365, -0.34596017, 0.25986987, 0.65108299, -2.1770202, -0.6884504, -0.06153838, -0.08929835, 1.32326531, -0.68394296, -0.20783063, -0.39155247, -1.11246267, 0.76069939, 0.90360035, -0.63081854, -0.47274011, -0.22651906, 0.27265636, 0.17756186, 0.72478318, 0.27532048, -0.14775899, 0.16672682, 0.12823117, 0.38310115, 0.21310285, -0.42382001, 1.02110949, 0.76166636, -0.66621299, -0.19080162, 0.78558746, -0.49083511, -0.51150934, 0.37349403, 0.2051815, -0.02111854, -0.45937454, -0.32162393, -0.25313708, 0.69064845, 0.34143897, -1.22075415, -0.0529835, 0.13979904, 1.61969799, 0.0124979, 0.24933727, -1.01085725, 1.66328988, 0.7996873, 0.57001745, 0.18486377, -0.80626215, 0.88041383, 0.49309304, -0.11719085, -0.31853038, -0.18427466, 0.6628835, 0.05278763, -0.14413451, -0.35322581, -0.35857553, -0.0487353, -0.49048334, -0.42414612, -0.24393564, 1.38184539, 2.72949798, -0.04876864, -0.24487631, -0.49575136, -0.77215415, 0.52141237, 0.31319116, 0.50882555, 0.15023232, 0.72939245, 0.43339594, 1.54212749, -1.06064229, -0.58366106, 0.47176364, 0.45495476, -0.80565184, -0.08505918, -0.17917018, -0.48461375, 0.4226609, -0.01937764, -0.15781294, -0.0111943, 0.4637539, -0.22996495, 0.12502233, -0.06168194, 1.15526894, 0.09526128, -0.59891101, -0.70016005, -0.58324131, -0.46642778, 0.02916348, 0.20610958, 0.43151871, -0.56254623, -0.2288588, -0.29412742, 0.03655579, 0.09901785, -0.23393498, -6.42747912, 0.14722914, -0.08677057, -0.0168222, 0.19534585, 1.01745469, -0.43236682, -0.0697075, 0.81575424, 0.32429898, -0.10337549, 0.97022527, 0.94612692, 0.06569938, -0.10246203, -0.7860776, -0.76446712, 0.78644171, -0.02763688, -0.01265279, -0.07041382, -0.161399, 0.76450826, -0.16695896, -0.44235422, -0.50353129, 0.18980192, 0.62752692, -0.1052071, -0.16357766, 0.20138973, 0.34251188, 0.56200829, 0.41846627, -0.62266725, 0.04263304, -0.5736839, -0.13131578, -0.51005468, -0.70326252, -0.09270821, -0.08713873, -0.7326027, 0.36599391, -0.4287493, -0.62667171, -0.4457687, 0.30613137, -0.21009481, -0.50548048, -0.92141492, -0.00300258, 0.09507273, 0.19295302, -1.0641009, 0.1013885, 0.00150847, -0.37741615, 0.32321336, -0.67385329, -0.69369511, 0.04009679, 0.69200813, 0.75113262, 0.57015973, -0.34952083, -0.60910561, 0.38212407, -0.42693657, -0.03890997, 0.22674511, -0.12096495, -0.1589244, -0.13080018, 0.14136774, 0.10851526, -0.1256176, 0.03589377, 0.35579171, 0.40343071, -0.33241466, -0.50242179, -0.36989624, -0.75518329, -0.58602425, -0.00819035, 2.57129563, -0.5373093, -0.61924259, 0.29400275, -0.90302839, 0.03331877, -0.57696681, 0.51992889, 0.51470342, 0.34729907, -0.34163617, 0.58187713, -0.53543713, -0.75721697, -0.32069211, -0.15708814, 0.36092845, 0.05377594, -0.730953, 0.2228279, -0.56226945, 0.17398214, 0.22129267, -0.69446968, 0.01203425, 0.61994392, -0.58853393, 0.55355338, -1.04769237, 0.49841444, 0.51540718, 0.10900034, 0.3826657, -0.0259537, 1.22691641, 0.05620455, 0.40188375, -0.21715831, 0.01649466, 1.22403175, -0.01900993, 0.5227549, -1.59054311, 1.28047544, -0.26411406, -0.04377671, 1.91090727, -0.02117513, 0.45924483, 0.36733737, 0.41802939, -0.53918015, -0.19645528, -0.32257121, -1.41167578, 0.49487673, 0.7895108, -1.14313968, -1.22070578, -0.44101964, 0.99174852, -0.51284863, -1.04071269, -1.24848436, 0.06764751, 0.13380368, -0.47983358, -0.05246349, -1.23978111, 0.36596549, 0.28078307, -0.54565513, -0.26000334, -0.60055496, 0.48910999, 0.20479397, 0.51723505, 0.06640906, 0.00049171, -0.04177677, -0.11303608, -0.04536118, 0.06096111, 0.19507256, -0.3309958, 1.94250694, -1.50588042, -0.05399908, -0.47188488, 0.55173704, -0.53533909, -0.37033699, -0.3043047, -0.03333376, -0.3237057, 0.11394763, 0.02206434, -1.9054434, -0.67640894, 0.99342816, -1.55696064, 0.19534164, 0.47847718, 0.1563291, 0.03730322, 0.85411632, -0.24498287, 0.19257193, -0.33676692, -2.46419136, 0.96954253, 0.02951214, 0.10489121, 0.03765621, -2.37218214, -0.23843583, 0.43014482, 0.20560761, 0.00100657, -1.05677248, -0.04513662, 0.35921868, -0.12652313, 0.03134359, 0.13284522, -0.54893577, -0.28553787, 0.30827473, -0.04887834, 1.90351307, -0.35135519, -1.09254446, 0.03008808, -0.79388526, -0.61322525, -0.76433969, -0.47275471, 0.05540432, -0.59597771, -0.63779685, 0.97907328, -0.39368657, -1.43599957, -0.40842378, -0.28484966, 0.27470965, -0.30043331, -0.95771378, 0.80176444, 0.02840583, 0.28634745, -0.01966477, -0.14885119, 0.42187158, 0.61308969, 0.09001487, -0.02612796, -0.03063985, -0.04290293, 0.00925968, -0.35533358, 0.25714459, -0.20773739, 0.51400345, 0.87872485, 0.42519634, 0.08778923, -0.43745201, 0.55610466, 0.11200182, 0.88919807, -0.31280797, -1.75054016, -0.45594087, -0.27389769, 0.46059653, -0.10440213, 0.36138392, 0.75007137, -0.13612981, -0.32163254, -0.21220274, 1.18530894, 0.07313769, -0.86247124, 0.33882731, 0.25354659, -0.24342188, -1.01228813, -0.51100921, 0.02896706, 2.40783189, 1.73204242, 0.5452871, -0.21622341, 2.19419024, 0.84892397, 0.48000989, 0.58940248, -0.21915, 1.27322437, 0.33579232, -0.99826096, 0.41365574, -0.37638748, 0.53802782, -0.77447362, -0.00793017, 0.32023896, 0.05823228, 0.18073692, 0.1046946, -0.08201785, -0.35469453, 0.44202203, 3.38262268, 0.43405027, -0.74903389, 0.15335664, 0.25268914, -0.29613346, -0.09109073, 0.04919036, 0.23780852, -0.05947584, -0.36353745, 0.45666353, 1.68605013, 0.08608026, -0.29136739, 0.87078687, -0.1269408, 0.07154087, -0.87534967, -0.34806518, 0.83057069, -0.4144312, 1.1777417, 0.43899784, -0.80702697, -0.04993844, -0.36276116, -0.02072821, 0.01366432, 0.28692414, -0.6185237, -0.0169286, -0.15478852, -0.81032138, -0.28485572, -0.12755834, -0.09993367, 0.21346504, 0.03883752, 0.10316277, -0.03626839, -0.47801431, 2.13321319, 0.52282039, -0.04750158, -0.13000853, -0.02146982, -0.04516328, -0.38284421, -0.02436252, -1.07942005, -0.84455695, -1.02756863, 0.10401592, -2.12853528, -2.99178286, 0.78364103, -0.49250135, 1.27568736, -2.04522456, -0.47624405, 0.59562095, -1.30441229, 4.06217586, 1.34162409, -0.36462015, -0.42435203, -1.03407517, 0.5963522, 0.03392318, 0.1767664, 0.30419042, -0.53557971, -0.20454628, 0.65269783, 0.31527136, -0.32127939, 0.41976118, -0.25189552, -0.03391449, 0.52701834, 0.48112655, 0.13258622, -0.19962566, 0.33972082, -1.1021552, -1.9345884, -0.50820036, 0.64101698, 0.3315283, 0.32863618, 0.003872, -0.35723957, -0.30955463, -0.62611932, 0.04519902, -0.62372282, -0.32675715, -0.43798726, -0.18664184, 0.05374833, -0.30014456, -0.60778719, 0.23160433, 0.29993221, 0.05338349, 1.03468933, -0.62714734, -0.17103604, -0.28355501, -0.16496096, 0.13555782, -0.07778238, -0.27474521, 0.20799431, 0.12256054, 0.33327159, 0.10529675, -0.16320797, 0.66838676, 1.58688066, 0.58346473, 0.01045102, 0.15903179, 0.11359124, 1.06734044, 0.21279817, 0.21449645, -1.03581475, 0.04527902, -1.00576865, -0.73976219, 0.26675068, -1.56109696, 0.71305765, 0.24256133, -0.06394795, -0.78907323, 0.40128514, 0.79892295, -3.35665032, -3.06803214, 0.09928104, 0.29789193, -1.41064474, 0.04647113, 0.21739552, -0.61376438, 1.83552206, 1.46826232, 2.0269204, 0.12627185, 1.22774938, 0.51771178, -0.51816727, 0.69098581, 0.61558862, 0.48946173, -0.5831934, -1.24344883, 0.52446555, 0.05367796, 0.61857383, 0.10876427, -0.01699804, -0.51316084, -0.41404233, -0.8521734, -0.8064554, -0.68019481, 0.16976938, -0.40146202, -0.21131428, -1.28528709, 0.16852307, -0.56698042, 0.44709569, 0.65492674, -0.69464936, 0.32539558, 1.02684513, -0.49823183, -0.9747896, -0.56845233, 2.91013396, -0.66553922, 0.46920291, 0.57879879, 0.78648176, 0.90402773, -0.41841911, 1.14570912, 6.14875853, 0.47061449, -0.63686861, 1.23816552, -0.66214544, 1.97087324, 0.24489263, 0.87313751, 2.70163591, 1.18217292, 0.47088689, -0.00359317, 0.03543365, 0.60870657, 0.52061604, 0.47483508, 0.03949101, 0.41879854, 0.52641985, -0.78736972, -0.03891616, 0.03440318, -0.68180895, -1.56249199, 0.08880429, 0.55499309, 0.31077506, 1.07337313, -0.03696371, 0.86548976, -0.67729459, 0.04051647, 0.01968593, -0.10966711, 1.14524694, 0.55067893, 0.41931056, 0.60522918, -1.42260329, 0.66299012, 0.36375824, 0.24182685, -1.5371834, -1.43025942, 0.14601799, -0.5096286, -0.40289614, -0.48317662, -1.68171425, 0.29666104, -0.17815484, -0.44467907, -1.23439415, -0.28641557, 0.27142055, -1.01329003, -0.26975134, -0.44699911, 0.30170191, -0.11532552, -0.3769779, -0.17547293, 0.07777373, -0.11191987, -0.58646849, 0.02707869, -3.17457958, 0.07662237, 0.22221327, 0.29398227, -0.01660972, 0.26541498, -0.13799007, 0.33309236, -0.46056132, -0.38894969, -0.16332453, -0.65735248, 0.33233183, -0.00361671, 0.06755678, 1.4766171, 0.44074406, -0.84657117, 0.94558367, -0.12916527, -0.12965207, -0.11549527, 0.40281948, 0.06914727, 0.3338568, -0.37800444, 0.09010942, 0.0820346, 0.30829713, 0.44446002, -0.66163325, 0.26539719, 0.4345563, 0.32980218, 0.7792028, -0.18514572, 0.27791496, 0.59048807, 0.3583155, 0.76049078, 1.3039203, -0.20465942, -0.39075544, 2.78561924, 0.00241835, -0.6299361, 0.37278659, -0.2289434, -0.76146955, 0.63480776, -0.64239221, 0.60374876, -0.21906154, 0.71090604, -1.2366859, 0.00388196, 0.37612946, 0.44370578, 0.30367975, 0.52652139, -0.74932916, 0.49790434, -0.59631578, 1.51821748, 0.47055281, 0.48059816, 0.06605667, -0.4404968, 1.73859531, -0.26314235, 0.02865621, 0.3103519, -0.35352141, 0.98191159, 0.23906019, 0.01541167, -0.59200723, 0.53600937, -0.31391911, 0.66656467, -0.78176461, 0.07482009, 1.06664424, 0.53364666, 0.43938989, -0.22146247, -0.93669805, -1.05526017, -0.75399638, -0.05645284, -0.89405665, -0.40373497, 0.27984824, -0.44931997, 0.03035205, -0.53703213, 0.27552859, 0.2409624, -1.87119379, 0.15385687, -1.05211707, 1.45934375, -0.49536057, -0.36149619, 0.33441159, -2.74056227, -1.45011401, -0.62813062, 0.95767555, -0.48312213, -1.26895443, -1.74430673, 0.04074296, -0.02154889, -0.4879136, -0.277464, -0.99840767, 0.52637701, 0.5114064, 0.55550763]);
  const b1 = new Float64Array([-0.40304461, 0.2867866, -0.51754964, 0.18056497, -0.09987043, 0.13204174, -0.19104881, -0.30511605, -0.55417469, -0.43741034, -0.02825568, 0.66002674, -0.26575721, -0.30885087, 0.36987441, -0.380272, -0.41469484, -0.32717178, 0.21091105, -0.06154481, 0.1639695, -0.27779871, 0.34740951, -0.00574977]);
  const W2 = new Float64Array([0.49742184, 0.2701709, 0.2416587, -0.04090219, -0.64631697, -0.14872842, -0.10607225, -0.18948658, 0.9681721, -0.33363824, -0.4596618, 0.46461683, -0.65078463, -0.51708427, -0.16386569, -0.83319763, -0.20172136, 0.82824665, -0.03165856, 0.06020365, 1.23889815, -0.24108692, -0.92408505, 0.52359565, 0.88809359, -0.09799744, 1.18618107, -0.48443255, 0.81334277, 1.06415956, 0.11329293, -0.6452383, -0.48502863, 0.13289146, -0.3066348, 0.40622181, 0.27196449, 0.40995392, 0.69915193, -1.0635735, 0.11517423, 0.0743683, 0.73388901, -0.45874536, 0.11611886, 0.44654633, 0.1088385, 0.97829123, 0.86859925, -0.16455989, -0.54255044, -0.80218657, -0.63273981, 0.38238395, -0.13195992, -1.04762185, 0.12770794, -0.47792382, -0.52106167, 1.11897499, -0.25612183, -0.06089182, -0.38032868, 0.18558696, 0.18015189, 0.37836134, -0.83035901, 0.42673391, 0.97455367, -0.00693873, 0.03522508, 1.42680285, -1.41555668, 0.58557649, 0.33712292, -0.20978284, -0.65225913, -0.34662386, 0.05795577, 0.94909605, -2.2617062, -0.05107038, -0.37156391, 0.49918128, -0.73147602, 0.37925154, -0.89450395, 0.53703389, -0.79501837, -0.2073069, 0.74730858, -0.00728347, -0.8621106, -0.32760311, 0.57343088, -0.21925875, -0.4987331, -0.4297812, -0.91120101, 0.0573319, 0.39403648, 0.71361222, -0.46246056, -0.42928284, 0.75175551, 0.38329441, -0.33329001, -0.37309771, -0.14493611, 0.73226434, 0.76747524, 0.2892354, 0.66396827, -0.85926688, 0.54428417, -0.06886843, -0.07771797, -0.42681733, 0.72297933, 0.09360983, 1.9032481, -0.32632336, -0.80487878, 0.26798353, 1.38953219, 1.318899, -0.32986891, 0.22499063, 1.19227759, 0.10874312, -0.13859815, -0.7804797, 0.50732848, -0.47369606, -0.04184164, -0.68423282, 0.21045537, 0.10852326, -0.17465358, 0.31885954, 0.2259333, -0.06669726, 0.00704479, 0.10906991, 0.570565, 0.01114135, -0.48362518, -0.22542937, -0.11799724, -1.45035402, 0.86400691, 0.52034845, 0.70069959, 0.60639649, 0.21413436, -1.02356417, 0.68848258, 0.79070753, 0.08717379, 1.38278219, -0.24315337, -0.5724403, -0.46859081, 0.90573742, -0.46069346, -0.81604963, 0.22241534, -0.75960816, -0.06851195, 0.14607414, -0.23248313, 0.19005009, 0.11575768, 0.89351047, -0.98635462, 0.42747579, -0.07240452, 0.30016531, 0.2036589, 0.31897773, 0.4527186, 0.23884514, -0.0782251, 0.26443168, 0.61374707, 0.14996746, 0.05259172, -0.0217804, -0.83900914, 0.44380836, -0.33426436, 0.17700124, -0.50589101, 0.52085745, 0.22196792, 1.2907889, 0.00571341, 0.00232991, -0.36301417, -0.24121594, 0.12479124, 0.58384441, 0.86311386, 0.12419842, 0.17038601, 0.91458746, 0.67071427, -0.39798669, -0.51826393, -0.37343351, 0.57717957, -0.97552687, 0.53097065, -0.06287701, 0.04546558, -0.31933836, 0.10784922, -0.39659517, -0.15757021, -0.50335945, -0.76082921, -1.05229157, 0.16817322, 0.52884007, -0.36098478, -0.11318515, 0.22989134, 0.34381858, 0.0669243, -0.14813005, 0.08917504, 0.7751505, 1.4016455, -0.30921807, -0.95690566, 0.98566069, -0.42612494, -0.36155716, 0.04946343, 0.18947356, -0.01949018, 0.19106311, -0.28991268, 0.28836568, -0.43247855, 0.42044336, -1.33284837, 0.07472669, 0.56981618, 0.13022847, 0.53847443, 0.14056122, 1.46781617, -0.41829698, -0.38389335, -0.212882, 0.69100854, -0.16112432, 0.14595478, -0.22270496, 0.23233383, -0.10450854, 0.06127683, 0.67236523, 0.48835229, -0.07856454, -0.40087845, -0.20469104, -1.09499615, -0.4344285, 0.4479616, -0.09133954, -0.22713278, -0.31787193, 0.52844062, -0.31780789, -0.08441193, 0.20729514, 0.13806283, 0.01605483, -0.80467832, -0.53626214, -0.94848937, 0.40894448, -0.06825849, 0.07984258, -0.44004928, -0.28742863, 1.03337509, -1.71762136, 0.01582602, -0.22492322, -0.50079192, 0.63876221, -0.02197984, 0.79900854, 0.95325577, -0.09355779, -0.26736876, 0.21466341, -0.14525178, 0.27615788, -0.3548629, -0.22727126, -0.64929232, -0.06269505, -0.12988673, -1.04999104, 0.19183403, 0.25055181, -0.70964561, 1.07621375, -0.44816552, 0.16558835, 0.47580189, -0.11483704, 0.26067449, -0.32505968, 0.24051296, 0.31591766, -0.17336423, -0.61704354, -0.16210109, 0.41513782, -0.46296907, 0.13696706, 0.4431142, 0.04925874, 0.22100849, -0.42835487, 0.12358795, -0.77300101, 0.42749732, -0.73892787, 0.45062177, -0.23938644, 0.02570303, 0.42273458, -0.06724032, 0.02073538, 0.09020777, -0.78568047, 0.2978014, -0.22948501, -0.05172835, -0.46080662, -0.46789116, 0.62918596, 0.30791443, -0.79462593, 0.86875073, -0.60306365, -0.99546292, 0.24379307, -0.04513759, -0.84100038, 0.3387626, -0.07362891, -0.1047774, 0.06100704, 1.79399345, -0.47892611, 0.48443674, -0.75560892, 0.8826609, 0.86134156, 0.21083928, -0.49515355, 0.63949203, -0.359488, -0.9210628, 0.05247154, 0.38446747, -0.9522999, 0.76780629, -1.63713308, -0.06342243, 0.12586696, 0.15683632, 0.24899466, 0.60627014, 1.47409243, -1.46277048, 0.20132634]);
  const b2 = new Float64Array([0.11682907, -0.50937404, 0.21846102, 0.07370458, 0.08833389, -0.72271608, -0.12503709, -0.64264663, -0.09674821, -0.23134642, -0.29921666, 0.32653802, 0.24655441, 0.30427226, -0.33355322, -0.30503259]);
  const W3 = new Float64Array([0.29100223, -0.92424891, 0.16506631, -0.53655394, -0.51327677, 0.3786885, -0.70113286, 0.02267003, -0.2549664, 1.11993976, 0.09727572, 0.00706621, 0.33344295, 0.76226658, 0.94181009, 0.35118035, 0.42726134, 0.22991702, -0.01230126, -0.12150831, -0.04629924, 0.21564567, 0.20728856, -0.17828013, -0.13236183, 0.26501108, 0.03878625, 0.21948781, 0.02980976, -0.06937907, -0.20738504, 0.10001369, 0.10652699, 0.02677934, -0.17999333, 0.06365331, -0.22002631, 0.07676843, -0.05925772, 0.08119549, -0.1661487, 0.10005132, 0.0709875, -0.34686521, 0.15381904, -0.05761472, -0.50283043, 0.55281659, -0.04942607, 0.26374359, -0.35845166, -0.14056122, -0.29800959, 0.0301322, -0.09249378, -0.22953077, 0.12496077, 0.10493339, -0.40052988, 0.05406226, -0.02245186, 0.24994585, -0.42162684, 0.12714062, 0.4363011, 0.72847381, 0.09922832, -0.58609149, -0.68535566, 0.17518889, -0.1268902, -0.8263128, -0.29506825, 0.15811458, 0.09708295, 0.81655744, -0.28845783, 0.41453705, 0.96100708, 2.22371473]);
  const b3 = new Float64Array([0.31920444, -0.07969788, 0.00923981, 0.13447447, 0.42624309]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.18751687, -0.03841178, -0.22435289, -0.07381462, 0.17132232, -0.48441334, 0.07362537, -0.21292008, 0.7976389, -5.70850609, -0.25282853, 0.25198737, 0.09398154, 0.37057773, -0.23158349, 0.36320623, -0.22301462, -0.06543675, -0.07055231, 0.09977913, 0.23809225, 1.16551059, -0.15373578, -0.22026586, -0.70836227, 0.35976411, 0.2479004, 0.22785852, 0.73391917, -0.35032471, -0.33574089, 0.43452106, -0.27586612, 0.799619, 0.24977642, -0.48173788, 0.45784678, 0.33145226, 0.83239095, -0.27154949, -0.20032677, 0.45093149, -0.42840741, 0.50841366, -0.1649333, -0.3410757, 0.08504802, -0.00712836, 0.80926349, 0.39961172, -0.24514685, 1.40975662, -1.54465762, -1.67325107, 0.26739317, 0.59078417, 0.87573574, -1.02743223, 1.02371596, 0.45927069, -0.33729903, -0.51052906, 1.41542057, 1.64107601, 0.41185924, 0.29404307, 1.40592063, -1.8655735, 0.6460826, -0.39898047, -0.42319701, 7.1446657, 0.54213213, 0.96186971, 0.42916886, 1.23754621, 4.73902174, 0.99373808, 0.64375443, 0.65481331, 0.05096682, 1.71922385, 0.8084697, -0.09894255, 0.44294278, -0.56937126, 0.02388452, 0.34094382, 0.01189408, 0.2847581, -0.18520108, 0.15901692, 0.02765835, 0.79788156, -0.97327022, -2.36835645, 0.35570536, 0.51655708, 0.54888757, 0.42808751, -1.18212533, 0.23410423, 0.23288433, -0.43364689, -0.29487431, -0.18176476, -1.73637409, -1.01618254, 0.15354953, 0.39340749, 1.44566675, 1.46378978, -0.59605309, 0.88573009, 0.42099233, 0.52526792, 0.32693032, -0.68110761, -0.26704532, -0.14339462, 1.45899702, -0.16685595, -0.05402112, 0.17807256, 0.38631022, 0.22742169, 0.27549736, -0.33294552, 0.46841613, -0.02278885, -0.02216948, -0.85691917, -0.42489951, -0.11162277, -1.14742033, -0.00438203, -0.10951721, -0.33625655, 0.79139449, 0.0790255, -0.87192952, -0.67882304, 0.13959419, 0.00503402, -0.69886643, -0.31460633, 0.50893138, -0.77960155, -0.48639898, 1.56383969, 0.38633647, -1.12795729, 0.05687525, 1.09993164, -0.35936305, -0.40618855, -0.09202552, 1.33766126, 0.32468417, 0.35447609, 0.16299633, -0.7316578, -0.42094939, 0.06647965, -0.07530339, 0.06166169, -0.51528472, -0.14360148, -0.84241919, 0.05015186, 0.84337022, -0.20236728, 0.07466748, 0.1366084, 0.26390766, 0.16222262, 0.03260931, 0.0105901, 0.23975622, -0.13032354, -0.18541625, -4.23983715, 0.38280185, 0.95359695, -0.29144767, -0.21945577, -0.22815564, 0.25319759, -0.50850599, -0.3644887, 0.27419585, 0.31212036, -0.93548478, 0.51279339, 0.2925673, 0.21847364, 0.85492561, -0.14701953, -0.58225853, 0.78172712, 0.23901164, 0.02049537, 0.13357553, 0.0511719, -0.25598102, 0.76518346, 0.09605561, -0.42653966, 0.76150904, -0.51362025, 0.50990635, -1.0947448, 0.16287685, 0.48830585, 0.18277015, -0.65685644, 0.23790632, -0.48663847, -0.28048232, -0.37974724, 0.4819406, -0.32180262, 0.75715797, 1.3621568, -2.7371082, 0.14861172, -0.41905348, 1.36346477, 1.38970207, -0.12099715, -0.22768903, 0.4029705, -0.00925094, -0.35363064, -0.12957676, -0.11928546, -0.15655103, 0.1376488, -0.5071198, -0.64672935, 0.80012365, -0.34596017, 0.25986987, 0.65108299, -2.1770202, -0.6884504, -0.06153838, -0.08929835, 1.32326531, -0.68394296, -0.20783063, -0.39155247, -1.11246267, 0.76069939, 0.90360035, -0.63081854, -0.47274011, -0.22651906, 0.27265636, 0.17756186, 0.72478318, 0.27532048, -0.14775899, 0.16672682, 0.12823117, 0.38310115, 0.21310285, -0.42382001, 1.02110949, 0.76166636, -0.66621299, -0.19080162, 0.78558746, -0.49083511, -0.51150934, 0.37349403, 0.2051815, -0.02111854, -0.45937454, -0.32162393, -0.25313708, 0.69064845, 0.34143897, -1.22075415, -0.0529835, 0.13979904, 1.61969799, 0.0124979, 0.24933727, -1.01085725, 1.66328988, 0.7996873, 0.57001745, 0.18486377, -0.80626215, 0.88041383, 0.49309304, -0.11719085, -0.31853038, -0.18427466, 0.6628835, 0.05278763, -0.14413451, -0.35322581, -0.35857553, -0.0487353, -0.49048334, -0.42414612, -0.24393564, 1.38184539, 2.72949798, -0.04876864, -0.24487631, -0.49575136, -0.77215415, 0.52141237, 0.31319116, 0.50882555, 0.15023232, 0.72939245, 0.43339594, 1.54212749, -1.06064229, -0.58366106, 0.47176364, 0.45495476, -0.80565184, -0.08505918, -0.17917018, -0.48461375, 0.4226609, -0.01937764, -0.15781294, -0.0111943, 0.4637539, -0.22996495, 0.12502233, -0.06168194, 1.15526894, 0.09526128, -0.59891101, -0.70016005, -0.58324131, -0.46642778, 0.02916348, 0.20610958, 0.43151871, -0.56254623, -0.2288588, -0.29412742, 0.03655579, 0.09901785, -0.23393498, -6.42747912, 0.14722914, -0.08677057, -0.0168222, 0.19534585, 1.01745469, -0.43236682, -0.0697075, 0.81575424, 0.32429898, -0.10337549, 0.97022527, 0.94612692, 0.06569938, -0.10246203, -0.7860776, -0.76446712, 0.78644171, -0.02763688, -0.01265279, -0.07041382, -0.161399, 0.76450826, -0.16695896, -0.44235422, -0.50353129, 0.18980192, 0.62752692, -0.1052071, -0.16357766, 0.20138973, 0.34251188, 0.56200829, 0.41846627, -0.62266725, 0.04263304, -0.5736839, -0.13131578, -0.51005468, -0.70326252, -0.09270821, -0.08713873, -0.7326027, 0.36599391, -0.4287493, -0.62667171, -0.4457687, 0.30613137, -0.21009481, -0.50548048, -0.92141492, -0.00300258, 0.09507273, 0.19295302, -1.0641009, 0.1013885, 0.00150847, -0.37741615, 0.32321336, -0.67385329, -0.69369511, 0.04009679, 0.69200813, 0.75113262, 0.57015973, -0.34952083, -0.60910561, 0.38212407, -0.42693657, -0.03890997, 0.22674511, -0.12096495, -0.1589244, -0.13080018, 0.14136774, 0.10851526, -0.1256176, 0.03589377, 0.35579171, 0.40343071, -0.33241466, -0.50242179, -0.36989624, -0.75518329, -0.58602425, -0.00819035, 2.57129563, -0.5373093, -0.61924259, 0.29400275, -0.90302839, 0.03331877, -0.57696681, 0.51992889, 0.51470342, 0.34729907, -0.34163617, 0.58187713, -0.53543713, -0.75721697, -0.32069211, -0.15708814, 0.36092845, 0.05377594, -0.730953, 0.2228279, -0.56226945, 0.17398214, 0.22129267, -0.69446968, 0.01203425, 0.61994392, -0.58853393, 0.55355338, -1.04769237, 0.49841444, 0.51540718, 0.10900034, 0.3826657, -0.0259537, 1.22691641, 0.05620455, 0.40188375, -0.21715831, 0.01649466, 1.22403175, -0.01900993, 0.5227549, -1.59054311, 1.28047544, -0.26411406, -0.04377671, 1.91090727, -0.02117513, 0.45924483, 0.36733737, 0.41802939, -0.53918015, -0.19645528, -0.32257121, -1.41167578, 0.49487673, 0.7895108, -1.14313968, -1.22070578, -0.44101964, 0.99174852, -0.51284863, -1.04071269, -1.24848436, 0.06764751, 0.13380368, -0.47983358, -0.05246349, -1.23978111, 0.36596549, 0.28078307, -0.54565513, -0.26000334, -0.60055496, 0.48910999, 0.20479397, 0.51723505, 0.06640906, 0.00049171, -0.04177677, -0.11303608, -0.04536118, 0.06096111, 0.19507256, -0.3309958, 1.94250694, -1.50588042, -0.05399908, -0.47188488, 0.55173704, -0.53533909, -0.37033699, -0.3043047, -0.03333376, -0.3237057, 0.11394763, 0.02206434, -1.9054434, -0.67640894, 0.99342816, -1.55696064, 0.19534164, 0.47847718, 0.1563291, 0.03730322, 0.85411632, -0.24498287, 0.19257193, -0.33676692, -2.46419136, 0.96954253, 0.02951214, 0.10489121, 0.03765621, -2.37218214, -0.23843583, 0.43014482, 0.20560761, 0.00100657, -1.05677248, -0.04513662, 0.35921868, -0.12652313, 0.03134359, 0.13284522, -0.54893577, -0.28553787, 0.30827473, -0.04887834, 1.90351307, -0.35135519, -1.09254446, 0.03008808, -0.79388526, -0.61322525, -0.76433969, -0.47275471, 0.05540432, -0.59597771, -0.63779685, 0.97907328, -0.39368657, -1.43599957, -0.40842378, -0.28484966, 0.27470965, -0.30043331, -0.95771378, 0.80176444, 0.02840583, 0.28634745, -0.01966477, -0.14885119, 0.42187158, 0.61308969, 0.09001487, -0.02612796, -0.03063985, -0.04290293, 0.00925968, -0.35533358, 0.25714459, -0.20773739, 0.51400345, 0.87872485, 0.42519634, 0.08778923, -0.43745201, 0.55610466, 0.11200182, 0.88919807, -0.31280797, -1.75054016, -0.45594087, -0.27389769, 0.46059653, -0.10440213, 0.36138392, 0.75007137, -0.13612981, -0.32163254, -0.21220274, 1.18530894, 0.07313769, -0.86247124, 0.33882731, 0.25354659, -0.24342188, -1.01228813, -0.51100921, 0.02896706, 2.40783189, 1.73204242, 0.5452871, -0.21622341, 2.19419024, 0.84892397, 0.48000989, 0.58940248, -0.21915, 1.27322437, 0.33579232, -0.99826096, 0.41365574, -0.37638748, 0.53802782, -0.77447362, -0.00793017, 0.32023896, 0.05823228, 0.18073692, 0.1046946, -0.08201785, -0.35469453, 0.44202203, 3.38262268, 0.43405027, -0.74903389, 0.15335664, 0.25268914, -0.29613346, -0.09109073, 0.04919036, 0.23780852, -0.05947584, -0.36353745, 0.45666353, 1.68605013, 0.08608026, -0.29136739, 0.87078687, -0.1269408, 0.07154087, -0.87534967, -0.34806518, 0.83057069, -0.4144312, 1.1777417, 0.43899784, -0.80702697, -0.04993844, -0.36276116, -0.02072821, 0.01366432, 0.28692414, -0.6185237, -0.0169286, -0.15478852, -0.81032138, -0.28485572, -0.12755834, -0.09993367, 0.21346504, 0.03883752, 0.10316277, -0.03626839, -0.47801431, 2.13321319, 0.52282039, -0.04750158, -0.13000853, -0.02146982, -0.04516328, -0.38284421, -0.02436252, -1.07942005, -0.84455695, -1.02756863, 0.10401592, -2.12853528, -2.99178286, 0.78364103, -0.49250135, 1.27568736, -2.04522456, -0.47624405, 0.59562095, -1.30441229, 4.06217586, 1.34162409, -0.36462015, -0.42435203, -1.03407517, 0.5963522, 0.03392318, 0.1767664, 0.30419042, -0.53557971, -0.20454628, 0.65269783, 0.31527136, -0.32127939, 0.41976118, -0.25189552, -0.03391449, 0.52701834, 0.48112655, 0.13258622, -0.19962566, 0.33972082, -1.1021552, -1.9345884, -0.50820036, 0.64101698, 0.3315283, 0.32863618, 0.003872, -0.35723957, -0.30955463, -0.62611932, 0.04519902, -0.62372282, -0.32675715, -0.43798726, -0.18664184, 0.05374833, -0.30014456, -0.60778719, 0.23160433, 0.29993221, 0.05338349, 1.03468933, -0.62714734, -0.17103604, -0.28355501, -0.16496096, 0.13555782, -0.07778238, -0.27474521, 0.20799431, 0.12256054, 0.33327159, 0.10529675, -0.16320797, 0.66838676, 1.58688066, 0.58346473, 0.01045102, 0.15903179, 0.11359124, 1.06734044, 0.21279817, 0.21449645, -1.03581475, 0.04527902, -1.00576865, -0.73976219, 0.26675068, -1.56109696, 0.71305765, 0.24256133, -0.06394795, -0.78907323, 0.40128514, 0.79892295, -3.35665032, -3.06803214, 0.09928104, 0.29789193, -1.41064474, 0.04647113, 0.21739552, -0.61376438, 1.83552206, 1.46826232, 2.0269204, 0.12627185, 1.22774938, 0.51771178, -0.51816727, 0.69098581, 0.61558862, 0.48946173, -0.5831934, -1.24344883, 0.52446555, 0.05367796, 0.61857383, 0.10876427, -0.01699804, -0.51316084, -0.41404233, -0.8521734, -0.8064554, -0.68019481, 0.16976938, -0.40146202, -0.21131428, -1.28528709, 0.16852307, -0.56698042, 0.44709569, 0.65492674, -0.69464936, 0.32539558, 1.02684513, -0.49823183, -0.9747896, -0.56845233, 2.91013396, -0.66553922, 0.46920291, 0.57879879, 0.78648176, 0.90402773, -0.41841911, 1.14570912, 6.14875853, 0.47061449, -0.63686861, 1.23816552, -0.66214544, 1.97087324, 0.24489263, 0.87313751, 2.70163591, 1.18217292, 0.47088689, -0.00359317, 0.03543365, 0.60870657, 0.52061604, 0.47483508, 0.03949101, 0.41879854, 0.52641985, -0.78736972, -0.03891616, 0.03440318, -0.68180895, -1.56249199, 0.08880429, 0.55499309, 0.31077506, 1.07337313, -0.03696371, 0.86548976, -0.67729459, 0.04051647, 0.01968593, -0.10966711, 1.14524694, 0.55067893, 0.41931056, 0.60522918, -1.42260329, 0.66299012, 0.36375824, 0.24182685, -1.5371834, -1.43025942, 0.14601799, -0.5096286, -0.40289614, -0.48317662, -1.68171425, 0.29666104, -0.17815484, -0.44467907, -1.23439415, -0.28641557, 0.27142055, -1.01329003, -0.26975134, -0.44699911, 0.30170191, -0.11532552, -0.3769779, -0.17547293, 0.07777373, -0.11191987, -0.58646849, 0.02707869, -3.17457958, 0.07662237, 0.22221327, 0.29398227, -0.01660972, 0.26541498, -0.13799007, 0.33309236, -0.46056132, -0.38894969, -0.16332453, -0.65735248, 0.33233183, -0.00361671, 0.06755678, 1.4766171, 0.44074406, -0.84657117, 0.94558367, -0.12916527, -0.12965207, -0.11549527, 0.40281948, 0.06914727, 0.3338568, -0.37800444, 0.09010942, 0.0820346, 0.30829713, 0.44446002, -0.66163325, 0.26539719, 0.4345563, 0.32980218, 0.7792028, -0.18514572, 0.27791496, 0.59048807, 0.3583155, 0.76049078, 1.3039203, -0.20465942, -0.39075544, 2.78561924, 0.00241835, -0.6299361, 0.37278659, -0.2289434, -0.76146955, 0.63480776, -0.64239221, 0.60374876, -0.21906154, 0.71090604, -1.2366859, 0.00388196, 0.37612946, 0.44370578, 0.30367975, 0.52652139, -0.74932916, 0.49790434, -0.59631578, 1.51821748, 0.47055281, 0.48059816, 0.06605667, -0.4404968, 1.73859531, -0.26314235, 0.02865621, 0.3103519, -0.35352141, 0.98191159, 0.23906019, 0.01541167, -0.59200723, 0.53600937, -0.31391911, 0.66656467, -0.78176461, 0.07482009, 1.06664424, 0.53364666, 0.43938989, -0.22146247, -0.93669805, -1.05526017, -0.75399638, -0.05645284, -0.89405665, -0.40373497, 0.27984824, -0.44931997, 0.03035205, -0.53703213, 0.27552859, 0.2409624, -1.87119379, 0.15385687, -1.05211707, 1.45934375, -0.49536057, -0.36149619, 0.33441159, -2.74056227, -1.45011401, -0.62813062, 0.95767555, -0.48312213, -1.26895443, -1.74430673, 0.04074296, -0.02154889, -0.4879136, -0.277464, -0.99840767, 0.52637701, 0.5114064, 0.55550763]);
  const b1 = new Float64Array([-0.40304461, 0.2867866, -0.51754964, 0.18056497, -0.09987043, 0.13204174, -0.19104881, -0.30511605, -0.55417469, -0.43741034, -0.02825568, 0.66002674, -0.26575721, -0.30885087, 0.36987441, -0.380272, -0.41469484, -0.32717178, 0.21091105, -0.06154481, 0.1639695, -0.27779871, 0.34740951, -0.00574977]);
  const W2 = new Float64Array([0.49742184, 0.2701709, 0.2416587, -0.04090219, -0.64631697, -0.14872842, -0.10607225, -0.18948658, 0.9681721, -0.33363824, -0.4596618, 0.46461683, -0.65078463, -0.51708427, -0.16386569, -0.83319763, -0.20172136, 0.82824665, -0.03165856, 0.06020365, 1.23889815, -0.24108692, -0.92408505, 0.52359565, 0.88809359, -0.09799744, 1.18618107, -0.48443255, 0.81334277, 1.06415956, 0.11329293, -0.6452383, -0.48502863, 0.13289146, -0.3066348, 0.40622181, 0.27196449, 0.40995392, 0.69915193, -1.0635735, 0.11517423, 0.0743683, 0.73388901, -0.45874536, 0.11611886, 0.44654633, 0.1088385, 0.97829123, 0.86859925, -0.16455989, -0.54255044, -0.80218657, -0.63273981, 0.38238395, -0.13195992, -1.04762185, 0.12770794, -0.47792382, -0.52106167, 1.11897499, -0.25612183, -0.06089182, -0.38032868, 0.18558696, 0.18015189, 0.37836134, -0.83035901, 0.42673391, 0.97455367, -0.00693873, 0.03522508, 1.42680285, -1.41555668, 0.58557649, 0.33712292, -0.20978284, -0.65225913, -0.34662386, 0.05795577, 0.94909605, -2.2617062, -0.05107038, -0.37156391, 0.49918128, -0.73147602, 0.37925154, -0.89450395, 0.53703389, -0.79501837, -0.2073069, 0.74730858, -0.00728347, -0.8621106, -0.32760311, 0.57343088, -0.21925875, -0.4987331, -0.4297812, -0.91120101, 0.0573319, 0.39403648, 0.71361222, -0.46246056, -0.42928284, 0.75175551, 0.38329441, -0.33329001, -0.37309771, -0.14493611, 0.73226434, 0.76747524, 0.2892354, 0.66396827, -0.85926688, 0.54428417, -0.06886843, -0.07771797, -0.42681733, 0.72297933, 0.09360983, 1.9032481, -0.32632336, -0.80487878, 0.26798353, 1.38953219, 1.318899, -0.32986891, 0.22499063, 1.19227759, 0.10874312, -0.13859815, -0.7804797, 0.50732848, -0.47369606, -0.04184164, -0.68423282, 0.21045537, 0.10852326, -0.17465358, 0.31885954, 0.2259333, -0.06669726, 0.00704479, 0.10906991, 0.570565, 0.01114135, -0.48362518, -0.22542937, -0.11799724, -1.45035402, 0.86400691, 0.52034845, 0.70069959, 0.60639649, 0.21413436, -1.02356417, 0.68848258, 0.79070753, 0.08717379, 1.38278219, -0.24315337, -0.5724403, -0.46859081, 0.90573742, -0.46069346, -0.81604963, 0.22241534, -0.75960816, -0.06851195, 0.14607414, -0.23248313, 0.19005009, 0.11575768, 0.89351047, -0.98635462, 0.42747579, -0.07240452, 0.30016531, 0.2036589, 0.31897773, 0.4527186, 0.23884514, -0.0782251, 0.26443168, 0.61374707, 0.14996746, 0.05259172, -0.0217804, -0.83900914, 0.44380836, -0.33426436, 0.17700124, -0.50589101, 0.52085745, 0.22196792, 1.2907889, 0.00571341, 0.00232991, -0.36301417, -0.24121594, 0.12479124, 0.58384441, 0.86311386, 0.12419842, 0.17038601, 0.91458746, 0.67071427, -0.39798669, -0.51826393, -0.37343351, 0.57717957, -0.97552687, 0.53097065, -0.06287701, 0.04546558, -0.31933836, 0.10784922, -0.39659517, -0.15757021, -0.50335945, -0.76082921, -1.05229157, 0.16817322, 0.52884007, -0.36098478, -0.11318515, 0.22989134, 0.34381858, 0.0669243, -0.14813005, 0.08917504, 0.7751505, 1.4016455, -0.30921807, -0.95690566, 0.98566069, -0.42612494, -0.36155716, 0.04946343, 0.18947356, -0.01949018, 0.19106311, -0.28991268, 0.28836568, -0.43247855, 0.42044336, -1.33284837, 0.07472669, 0.56981618, 0.13022847, 0.53847443, 0.14056122, 1.46781617, -0.41829698, -0.38389335, -0.212882, 0.69100854, -0.16112432, 0.14595478, -0.22270496, 0.23233383, -0.10450854, 0.06127683, 0.67236523, 0.48835229, -0.07856454, -0.40087845, -0.20469104, -1.09499615, -0.4344285, 0.4479616, -0.09133954, -0.22713278, -0.31787193, 0.52844062, -0.31780789, -0.08441193, 0.20729514, 0.13806283, 0.01605483, -0.80467832, -0.53626214, -0.94848937, 0.40894448, -0.06825849, 0.07984258, -0.44004928, -0.28742863, 1.03337509, -1.71762136, 0.01582602, -0.22492322, -0.50079192, 0.63876221, -0.02197984, 0.79900854, 0.95325577, -0.09355779, -0.26736876, 0.21466341, -0.14525178, 0.27615788, -0.3548629, -0.22727126, -0.64929232, -0.06269505, -0.12988673, -1.04999104, 0.19183403, 0.25055181, -0.70964561, 1.07621375, -0.44816552, 0.16558835, 0.47580189, -0.11483704, 0.26067449, -0.32505968, 0.24051296, 0.31591766, -0.17336423, -0.61704354, -0.16210109, 0.41513782, -0.46296907, 0.13696706, 0.4431142, 0.04925874, 0.22100849, -0.42835487, 0.12358795, -0.77300101, 0.42749732, -0.73892787, 0.45062177, -0.23938644, 0.02570303, 0.42273458, -0.06724032, 0.02073538, 0.09020777, -0.78568047, 0.2978014, -0.22948501, -0.05172835, -0.46080662, -0.46789116, 0.62918596, 0.30791443, -0.79462593, 0.86875073, -0.60306365, -0.99546292, 0.24379307, -0.04513759, -0.84100038, 0.3387626, -0.07362891, -0.1047774, 0.06100704, 1.79399345, -0.47892611, 0.48443674, -0.75560892, 0.8826609, 0.86134156, 0.21083928, -0.49515355, 0.63949203, -0.359488, -0.9210628, 0.05247154, 0.38446747, -0.9522999, 0.76780629, -1.63713308, -0.06342243, 0.12586696, 0.15683632, 0.24899466, 0.60627014, 1.47409243, -1.46277048, 0.20132634]);
  const b2 = new Float64Array([0.11682907, -0.50937404, 0.21846102, 0.07370458, 0.08833389, -0.72271608, -0.12503709, -0.64264663, -0.09674821, -0.23134642, -0.29921666, 0.32653802, 0.24655441, 0.30427226, -0.33355322, -0.30503259]);
  const W3 = new Float64Array([0.29100223, -0.92424891, 0.16506631, -0.53655394, -0.51327677, 0.3786885, -0.70113286, 0.02267003, -0.2549664, 1.11993976, 0.09727572, 0.00706621, 0.33344295, 0.76226658, 0.94181009, 0.35118035, 0.42726134, 0.22991702, -0.01230126, -0.12150831, -0.04629924, 0.21564567, 0.20728856, -0.17828013, -0.13236183, 0.26501108, 0.03878625, 0.21948781, 0.02980976, -0.06937907, -0.20738504, 0.10001369, 0.10652699, 0.02677934, -0.17999333, 0.06365331, -0.22002631, 0.07676843, -0.05925772, 0.08119549, -0.1661487, 0.10005132, 0.0709875, -0.34686521, 0.15381904, -0.05761472, -0.50283043, 0.55281659, -0.04942607, 0.26374359, -0.35845166, -0.14056122, -0.29800959, 0.0301322, -0.09249378, -0.22953077, 0.12496077, 0.10493339, -0.40052988, 0.05406226, -0.02245186, 0.24994585, -0.42162684, 0.12714062, 0.4363011, 0.72847381, 0.09922832, -0.58609149, -0.68535566, 0.17518889, -0.1268902, -0.8263128, -0.29506825, 0.15811458, 0.09708295, 0.81655744, -0.28845783, 0.41453705, 0.96100708, 2.22371473]);
  const b3 = new Float64Array([0.31920444, -0.07969788, 0.00923981, 0.13447447, 0.42624309]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.18751687, -0.03841178, -0.22435289, -0.07381462, 0.17132232, -0.48441334, 0.07362537, -0.21292008, 0.7976389, -5.70850609, -0.25282853, 0.25198737, 0.09398154, 0.37057773, -0.23158349, 0.36320623, -0.22301462, -0.06543675, -0.07055231, 0.09977913, 0.23809225, 1.16551059, -0.15373578, -0.22026586, -0.70836227, 0.35976411, 0.2479004, 0.22785852, 0.73391917, -0.35032471, -0.33574089, 0.43452106, -0.27586612, 0.799619, 0.24977642, -0.48173788, 0.45784678, 0.33145226, 0.83239095, -0.27154949, -0.20032677, 0.45093149, -0.42840741, 0.50841366, -0.1649333, -0.3410757, 0.08504802, -0.00712836, 0.80926349, 0.39961172, -0.24514685, 1.40975662, -1.54465762, -1.67325107, 0.26739317, 0.59078417, 0.87573574, -1.02743223, 1.02371596, 0.45927069, -0.33729903, -0.51052906, 1.41542057, 1.64107601, 0.41185924, 0.29404307, 1.40592063, -1.8655735, 0.6460826, -0.39898047, -0.42319701, 7.1446657, 0.54213213, 0.96186971, 0.42916886, 1.23754621, 4.73902174, 0.99373808, 0.64375443, 0.65481331, 0.05096682, 1.71922385, 0.8084697, -0.09894255, 0.44294278, -0.56937126, 0.02388452, 0.34094382, 0.01189408, 0.2847581, -0.18520108, 0.15901692, 0.02765835, 0.79788156, -0.97327022, -2.36835645, 0.35570536, 0.51655708, 0.54888757, 0.42808751, -1.18212533, 0.23410423, 0.23288433, -0.43364689, -0.29487431, -0.18176476, -1.73637409, -1.01618254, 0.15354953, 0.39340749, 1.44566675, 1.46378978, -0.59605309, 0.88573009, 0.42099233, 0.52526792, 0.32693032, -0.68110761, -0.26704532, -0.14339462, 1.45899702, -0.16685595, -0.05402112, 0.17807256, 0.38631022, 0.22742169, 0.27549736, -0.33294552, 0.46841613, -0.02278885, -0.02216948, -0.85691917, -0.42489951, -0.11162277, -1.14742033, -0.00438203, -0.10951721, -0.33625655, 0.79139449, 0.0790255, -0.87192952, -0.67882304, 0.13959419, 0.00503402, -0.69886643, -0.31460633, 0.50893138, -0.77960155, -0.48639898, 1.56383969, 0.38633647, -1.12795729, 0.05687525, 1.09993164, -0.35936305, -0.40618855, -0.09202552, 1.33766126, 0.32468417, 0.35447609, 0.16299633, -0.7316578, -0.42094939, 0.06647965, -0.07530339, 0.06166169, -0.51528472, -0.14360148, -0.84241919, 0.05015186, 0.84337022, -0.20236728, 0.07466748, 0.1366084, 0.26390766, 0.16222262, 0.03260931, 0.0105901, 0.23975622, -0.13032354, -0.18541625, -4.23983715, 0.38280185, 0.95359695, -0.29144767, -0.21945577, -0.22815564, 0.25319759, -0.50850599, -0.3644887, 0.27419585, 0.31212036, -0.93548478, 0.51279339, 0.2925673, 0.21847364, 0.85492561, -0.14701953, -0.58225853, 0.78172712, 0.23901164, 0.02049537, 0.13357553, 0.0511719, -0.25598102, 0.76518346, 0.09605561, -0.42653966, 0.76150904, -0.51362025, 0.50990635, -1.0947448, 0.16287685, 0.48830585, 0.18277015, -0.65685644, 0.23790632, -0.48663847, -0.28048232, -0.37974724, 0.4819406, -0.32180262, 0.75715797, 1.3621568, -2.7371082, 0.14861172, -0.41905348, 1.36346477, 1.38970207, -0.12099715, -0.22768903, 0.4029705, -0.00925094, -0.35363064, -0.12957676, -0.11928546, -0.15655103, 0.1376488, -0.5071198, -0.64672935, 0.80012365, -0.34596017, 0.25986987, 0.65108299, -2.1770202, -0.6884504, -0.06153838, -0.08929835, 1.32326531, -0.68394296, -0.20783063, -0.39155247, -1.11246267, 0.76069939, 0.90360035, -0.63081854, -0.47274011, -0.22651906, 0.27265636, 0.17756186, 0.72478318, 0.27532048, -0.14775899, 0.16672682, 0.12823117, 0.38310115, 0.21310285, -0.42382001, 1.02110949, 0.76166636, -0.66621299, -0.19080162, 0.78558746, -0.49083511, -0.51150934, 0.37349403, 0.2051815, -0.02111854, -0.45937454, -0.32162393, -0.25313708, 0.69064845, 0.34143897, -1.22075415, -0.0529835, 0.13979904, 1.61969799, 0.0124979, 0.24933727, -1.01085725, 1.66328988, 0.7996873, 0.57001745, 0.18486377, -0.80626215, 0.88041383, 0.49309304, -0.11719085, -0.31853038, -0.18427466, 0.6628835, 0.05278763, -0.14413451, -0.35322581, -0.35857553, -0.0487353, -0.49048334, -0.42414612, -0.24393564, 1.38184539, 2.72949798, -0.04876864, -0.24487631, -0.49575136, -0.77215415, 0.52141237, 0.31319116, 0.50882555, 0.15023232, 0.72939245, 0.43339594, 1.54212749, -1.06064229, -0.58366106, 0.47176364, 0.45495476, -0.80565184, -0.08505918, -0.17917018, -0.48461375, 0.4226609, -0.01937764, -0.15781294, -0.0111943, 0.4637539, -0.22996495, 0.12502233, -0.06168194, 1.15526894, 0.09526128, -0.59891101, -0.70016005, -0.58324131, -0.46642778, 0.02916348, 0.20610958, 0.43151871, -0.56254623, -0.2288588, -0.29412742, 0.03655579, 0.09901785, -0.23393498, -6.42747912, 0.14722914, -0.08677057, -0.0168222, 0.19534585, 1.01745469, -0.43236682, -0.0697075, 0.81575424, 0.32429898, -0.10337549, 0.97022527, 0.94612692, 0.06569938, -0.10246203, -0.7860776, -0.76446712, 0.78644171, -0.02763688, -0.01265279, -0.07041382, -0.161399, 0.76450826, -0.16695896, -0.44235422, -0.50353129, 0.18980192, 0.62752692, -0.1052071, -0.16357766, 0.20138973, 0.34251188, 0.56200829, 0.41846627, -0.62266725, 0.04263304, -0.5736839, -0.13131578, -0.51005468, -0.70326252, -0.09270821, -0.08713873, -0.7326027, 0.36599391, -0.4287493, -0.62667171, -0.4457687, 0.30613137, -0.21009481, -0.50548048, -0.92141492, -0.00300258, 0.09507273, 0.19295302, -1.0641009, 0.1013885, 0.00150847, -0.37741615, 0.32321336, -0.67385329, -0.69369511, 0.04009679, 0.69200813, 0.75113262, 0.57015973, -0.34952083, -0.60910561, 0.38212407, -0.42693657, -0.03890997, 0.22674511, -0.12096495, -0.1589244, -0.13080018, 0.14136774, 0.10851526, -0.1256176, 0.03589377, 0.35579171, 0.40343071, -0.33241466, -0.50242179, -0.36989624, -0.75518329, -0.58602425, -0.00819035, 2.57129563, -0.5373093, -0.61924259, 0.29400275, -0.90302839, 0.03331877, -0.57696681, 0.51992889, 0.51470342, 0.34729907, -0.34163617, 0.58187713, -0.53543713, -0.75721697, -0.32069211, -0.15708814, 0.36092845, 0.05377594, -0.730953, 0.2228279, -0.56226945, 0.17398214, 0.22129267, -0.69446968, 0.01203425, 0.61994392, -0.58853393, 0.55355338, -1.04769237, 0.49841444, 0.51540718, 0.10900034, 0.3826657, -0.0259537, 1.22691641, 0.05620455, 0.40188375, -0.21715831, 0.01649466, 1.22403175, -0.01900993, 0.5227549, -1.59054311, 1.28047544, -0.26411406, -0.04377671, 1.91090727, -0.02117513, 0.45924483, 0.36733737, 0.41802939, -0.53918015, -0.19645528, -0.32257121, -1.41167578, 0.49487673, 0.7895108, -1.14313968, -1.22070578, -0.44101964, 0.99174852, -0.51284863, -1.04071269, -1.24848436, 0.06764751, 0.13380368, -0.47983358, -0.05246349, -1.23978111, 0.36596549, 0.28078307, -0.54565513, -0.26000334, -0.60055496, 0.48910999, 0.20479397, 0.51723505, 0.06640906, 0.00049171, -0.04177677, -0.11303608, -0.04536118, 0.06096111, 0.19507256, -0.3309958, 1.94250694, -1.50588042, -0.05399908, -0.47188488, 0.55173704, -0.53533909, -0.37033699, -0.3043047, -0.03333376, -0.3237057, 0.11394763, 0.02206434, -1.9054434, -0.67640894, 0.99342816, -1.55696064, 0.19534164, 0.47847718, 0.1563291, 0.03730322, 0.85411632, -0.24498287, 0.19257193, -0.33676692, -2.46419136, 0.96954253, 0.02951214, 0.10489121, 0.03765621, -2.37218214, -0.23843583, 0.43014482, 0.20560761, 0.00100657, -1.05677248, -0.04513662, 0.35921868, -0.12652313, 0.03134359, 0.13284522, -0.54893577, -0.28553787, 0.30827473, -0.04887834, 1.90351307, -0.35135519, -1.09254446, 0.03008808, -0.79388526, -0.61322525, -0.76433969, -0.47275471, 0.05540432, -0.59597771, -0.63779685, 0.97907328, -0.39368657, -1.43599957, -0.40842378, -0.28484966, 0.27470965, -0.30043331, -0.95771378, 0.80176444, 0.02840583, 0.28634745, -0.01966477, -0.14885119, 0.42187158, 0.61308969, 0.09001487, -0.02612796, -0.03063985, -0.04290293, 0.00925968, -0.35533358, 0.25714459, -0.20773739, 0.51400345, 0.87872485, 0.42519634, 0.08778923, -0.43745201, 0.55610466, 0.11200182, 0.88919807, -0.31280797, -1.75054016, -0.45594087, -0.27389769, 0.46059653, -0.10440213, 0.36138392, 0.75007137, -0.13612981, -0.32163254, -0.21220274, 1.18530894, 0.07313769, -0.86247124, 0.33882731, 0.25354659, -0.24342188, -1.01228813, -0.51100921, 0.02896706, 2.40783189, 1.73204242, 0.5452871, -0.21622341, 2.19419024, 0.84892397, 0.48000989, 0.58940248, -0.21915, 1.27322437, 0.33579232, -0.99826096, 0.41365574, -0.37638748, 0.53802782, -0.77447362, -0.00793017, 0.32023896, 0.05823228, 0.18073692, 0.1046946, -0.08201785, -0.35469453, 0.44202203, 3.38262268, 0.43405027, -0.74903389, 0.15335664, 0.25268914, -0.29613346, -0.09109073, 0.04919036, 0.23780852, -0.05947584, -0.36353745, 0.45666353, 1.68605013, 0.08608026, -0.29136739, 0.87078687, -0.1269408, 0.07154087, -0.87534967, -0.34806518, 0.83057069, -0.4144312, 1.1777417, 0.43899784, -0.80702697, -0.04993844, -0.36276116, -0.02072821, 0.01366432, 0.28692414, -0.6185237, -0.0169286, -0.15478852, -0.81032138, -0.28485572, -0.12755834, -0.09993367, 0.21346504, 0.03883752, 0.10316277, -0.03626839, -0.47801431, 2.13321319, 0.52282039, -0.04750158, -0.13000853, -0.02146982, -0.04516328, -0.38284421, -0.02436252, -1.07942005, -0.84455695, -1.02756863, 0.10401592, -2.12853528, -2.99178286, 0.78364103, -0.49250135, 1.27568736, -2.04522456, -0.47624405, 0.59562095, -1.30441229, 4.06217586, 1.34162409, -0.36462015, -0.42435203, -1.03407517, 0.5963522, 0.03392318, 0.1767664, 0.30419042, -0.53557971, -0.20454628, 0.65269783, 0.31527136, -0.32127939, 0.41976118, -0.25189552, -0.03391449, 0.52701834, 0.48112655, 0.13258622, -0.19962566, 0.33972082, -1.1021552, -1.9345884, -0.50820036, 0.64101698, 0.3315283, 0.32863618, 0.003872, -0.35723957, -0.30955463, -0.62611932, 0.04519902, -0.62372282, -0.32675715, -0.43798726, -0.18664184, 0.05374833, -0.30014456, -0.60778719, 0.23160433, 0.29993221, 0.05338349, 1.03468933, -0.62714734, -0.17103604, -0.28355501, -0.16496096, 0.13555782, -0.07778238, -0.27474521, 0.20799431, 0.12256054, 0.33327159, 0.10529675, -0.16320797, 0.66838676, 1.58688066, 0.58346473, 0.01045102, 0.15903179, 0.11359124, 1.06734044, 0.21279817, 0.21449645, -1.03581475, 0.04527902, -1.00576865, -0.73976219, 0.26675068, -1.56109696, 0.71305765, 0.24256133, -0.06394795, -0.78907323, 0.40128514, 0.79892295, -3.35665032, -3.06803214, 0.09928104, 0.29789193, -1.41064474, 0.04647113, 0.21739552, -0.61376438, 1.83552206, 1.46826232, 2.0269204, 0.12627185, 1.22774938, 0.51771178, -0.51816727, 0.69098581, 0.61558862, 0.48946173, -0.5831934, -1.24344883, 0.52446555, 0.05367796, 0.61857383, 0.10876427, -0.01699804, -0.51316084, -0.41404233, -0.8521734, -0.8064554, -0.68019481, 0.16976938, -0.40146202, -0.21131428, -1.28528709, 0.16852307, -0.56698042, 0.44709569, 0.65492674, -0.69464936, 0.32539558, 1.02684513, -0.49823183, -0.9747896, -0.56845233, 2.91013396, -0.66553922, 0.46920291, 0.57879879, 0.78648176, 0.90402773, -0.41841911, 1.14570912, 6.14875853, 0.47061449, -0.63686861, 1.23816552, -0.66214544, 1.97087324, 0.24489263, 0.87313751, 2.70163591, 1.18217292, 0.47088689, -0.00359317, 0.03543365, 0.60870657, 0.52061604, 0.47483508, 0.03949101, 0.41879854, 0.52641985, -0.78736972, -0.03891616, 0.03440318, -0.68180895, -1.56249199, 0.08880429, 0.55499309, 0.31077506, 1.07337313, -0.03696371, 0.86548976, -0.67729459, 0.04051647, 0.01968593, -0.10966711, 1.14524694, 0.55067893, 0.41931056, 0.60522918, -1.42260329, 0.66299012, 0.36375824, 0.24182685, -1.5371834, -1.43025942, 0.14601799, -0.5096286, -0.40289614, -0.48317662, -1.68171425, 0.29666104, -0.17815484, -0.44467907, -1.23439415, -0.28641557, 0.27142055, -1.01329003, -0.26975134, -0.44699911, 0.30170191, -0.11532552, -0.3769779, -0.17547293, 0.07777373, -0.11191987, -0.58646849, 0.02707869, -3.17457958, 0.07662237, 0.22221327, 0.29398227, -0.01660972, 0.26541498, -0.13799007, 0.33309236, -0.46056132, -0.38894969, -0.16332453, -0.65735248, 0.33233183, -0.00361671, 0.06755678, 1.4766171, 0.44074406, -0.84657117, 0.94558367, -0.12916527, -0.12965207, -0.11549527, 0.40281948, 0.06914727, 0.3338568, -0.37800444, 0.09010942, 0.0820346, 0.30829713, 0.44446002, -0.66163325, 0.26539719, 0.4345563, 0.32980218, 0.7792028, -0.18514572, 0.27791496, 0.59048807, 0.3583155, 0.76049078, 1.3039203, -0.20465942, -0.39075544, 2.78561924, 0.00241835, -0.6299361, 0.37278659, -0.2289434, -0.76146955, 0.63480776, -0.64239221, 0.60374876, -0.21906154, 0.71090604, -1.2366859, 0.00388196, 0.37612946, 0.44370578, 0.30367975, 0.52652139, -0.74932916, 0.49790434, -0.59631578, 1.51821748, 0.47055281, 0.48059816, 0.06605667, -0.4404968, 1.73859531, -0.26314235, 0.02865621, 0.3103519, -0.35352141, 0.98191159, 0.23906019, 0.01541167, -0.59200723, 0.53600937, -0.31391911, 0.66656467, -0.78176461, 0.07482009, 1.06664424, 0.53364666, 0.43938989, -0.22146247, -0.93669805, -1.05526017, -0.75399638, -0.05645284, -0.89405665, -0.40373497, 0.27984824, -0.44931997, 0.03035205, -0.53703213, 0.27552859, 0.2409624, -1.87119379, 0.15385687, -1.05211707, 1.45934375, -0.49536057, -0.36149619, 0.33441159, -2.74056227, -1.45011401, -0.62813062, 0.95767555, -0.48312213, -1.26895443, -1.74430673, 0.04074296, -0.02154889, -0.4879136, -0.277464, -0.99840767, 0.52637701, 0.5114064, 0.55550763]);
  const b1 = new Float64Array([-0.40304461, 0.2867866, -0.51754964, 0.18056497, -0.09987043, 0.13204174, -0.19104881, -0.30511605, -0.55417469, -0.43741034, -0.02825568, 0.66002674, -0.26575721, -0.30885087, 0.36987441, -0.380272, -0.41469484, -0.32717178, 0.21091105, -0.06154481, 0.1639695, -0.27779871, 0.34740951, -0.00574977]);
  const W2 = new Float64Array([0.49742184, 0.2701709, 0.2416587, -0.04090219, -0.64631697, -0.14872842, -0.10607225, -0.18948658, 0.9681721, -0.33363824, -0.4596618, 0.46461683, -0.65078463, -0.51708427, -0.16386569, -0.83319763, -0.20172136, 0.82824665, -0.03165856, 0.06020365, 1.23889815, -0.24108692, -0.92408505, 0.52359565, 0.88809359, -0.09799744, 1.18618107, -0.48443255, 0.81334277, 1.06415956, 0.11329293, -0.6452383, -0.48502863, 0.13289146, -0.3066348, 0.40622181, 0.27196449, 0.40995392, 0.69915193, -1.0635735, 0.11517423, 0.0743683, 0.73388901, -0.45874536, 0.11611886, 0.44654633, 0.1088385, 0.97829123, 0.86859925, -0.16455989, -0.54255044, -0.80218657, -0.63273981, 0.38238395, -0.13195992, -1.04762185, 0.12770794, -0.47792382, -0.52106167, 1.11897499, -0.25612183, -0.06089182, -0.38032868, 0.18558696, 0.18015189, 0.37836134, -0.83035901, 0.42673391, 0.97455367, -0.00693873, 0.03522508, 1.42680285, -1.41555668, 0.58557649, 0.33712292, -0.20978284, -0.65225913, -0.34662386, 0.05795577, 0.94909605, -2.2617062, -0.05107038, -0.37156391, 0.49918128, -0.73147602, 0.37925154, -0.89450395, 0.53703389, -0.79501837, -0.2073069, 0.74730858, -0.00728347, -0.8621106, -0.32760311, 0.57343088, -0.21925875, -0.4987331, -0.4297812, -0.91120101, 0.0573319, 0.39403648, 0.71361222, -0.46246056, -0.42928284, 0.75175551, 0.38329441, -0.33329001, -0.37309771, -0.14493611, 0.73226434, 0.76747524, 0.2892354, 0.66396827, -0.85926688, 0.54428417, -0.06886843, -0.07771797, -0.42681733, 0.72297933, 0.09360983, 1.9032481, -0.32632336, -0.80487878, 0.26798353, 1.38953219, 1.318899, -0.32986891, 0.22499063, 1.19227759, 0.10874312, -0.13859815, -0.7804797, 0.50732848, -0.47369606, -0.04184164, -0.68423282, 0.21045537, 0.10852326, -0.17465358, 0.31885954, 0.2259333, -0.06669726, 0.00704479, 0.10906991, 0.570565, 0.01114135, -0.48362518, -0.22542937, -0.11799724, -1.45035402, 0.86400691, 0.52034845, 0.70069959, 0.60639649, 0.21413436, -1.02356417, 0.68848258, 0.79070753, 0.08717379, 1.38278219, -0.24315337, -0.5724403, -0.46859081, 0.90573742, -0.46069346, -0.81604963, 0.22241534, -0.75960816, -0.06851195, 0.14607414, -0.23248313, 0.19005009, 0.11575768, 0.89351047, -0.98635462, 0.42747579, -0.07240452, 0.30016531, 0.2036589, 0.31897773, 0.4527186, 0.23884514, -0.0782251, 0.26443168, 0.61374707, 0.14996746, 0.05259172, -0.0217804, -0.83900914, 0.44380836, -0.33426436, 0.17700124, -0.50589101, 0.52085745, 0.22196792, 1.2907889, 0.00571341, 0.00232991, -0.36301417, -0.24121594, 0.12479124, 0.58384441, 0.86311386, 0.12419842, 0.17038601, 0.91458746, 0.67071427, -0.39798669, -0.51826393, -0.37343351, 0.57717957, -0.97552687, 0.53097065, -0.06287701, 0.04546558, -0.31933836, 0.10784922, -0.39659517, -0.15757021, -0.50335945, -0.76082921, -1.05229157, 0.16817322, 0.52884007, -0.36098478, -0.11318515, 0.22989134, 0.34381858, 0.0669243, -0.14813005, 0.08917504, 0.7751505, 1.4016455, -0.30921807, -0.95690566, 0.98566069, -0.42612494, -0.36155716, 0.04946343, 0.18947356, -0.01949018, 0.19106311, -0.28991268, 0.28836568, -0.43247855, 0.42044336, -1.33284837, 0.07472669, 0.56981618, 0.13022847, 0.53847443, 0.14056122, 1.46781617, -0.41829698, -0.38389335, -0.212882, 0.69100854, -0.16112432, 0.14595478, -0.22270496, 0.23233383, -0.10450854, 0.06127683, 0.67236523, 0.48835229, -0.07856454, -0.40087845, -0.20469104, -1.09499615, -0.4344285, 0.4479616, -0.09133954, -0.22713278, -0.31787193, 0.52844062, -0.31780789, -0.08441193, 0.20729514, 0.13806283, 0.01605483, -0.80467832, -0.53626214, -0.94848937, 0.40894448, -0.06825849, 0.07984258, -0.44004928, -0.28742863, 1.03337509, -1.71762136, 0.01582602, -0.22492322, -0.50079192, 0.63876221, -0.02197984, 0.79900854, 0.95325577, -0.09355779, -0.26736876, 0.21466341, -0.14525178, 0.27615788, -0.3548629, -0.22727126, -0.64929232, -0.06269505, -0.12988673, -1.04999104, 0.19183403, 0.25055181, -0.70964561, 1.07621375, -0.44816552, 0.16558835, 0.47580189, -0.11483704, 0.26067449, -0.32505968, 0.24051296, 0.31591766, -0.17336423, -0.61704354, -0.16210109, 0.41513782, -0.46296907, 0.13696706, 0.4431142, 0.04925874, 0.22100849, -0.42835487, 0.12358795, -0.77300101, 0.42749732, -0.73892787, 0.45062177, -0.23938644, 0.02570303, 0.42273458, -0.06724032, 0.02073538, 0.09020777, -0.78568047, 0.2978014, -0.22948501, -0.05172835, -0.46080662, -0.46789116, 0.62918596, 0.30791443, -0.79462593, 0.86875073, -0.60306365, -0.99546292, 0.24379307, -0.04513759, -0.84100038, 0.3387626, -0.07362891, -0.1047774, 0.06100704, 1.79399345, -0.47892611, 0.48443674, -0.75560892, 0.8826609, 0.86134156, 0.21083928, -0.49515355, 0.63949203, -0.359488, -0.9210628, 0.05247154, 0.38446747, -0.9522999, 0.76780629, -1.63713308, -0.06342243, 0.12586696, 0.15683632, 0.24899466, 0.60627014, 1.47409243, -1.46277048, 0.20132634]);
  const b2 = new Float64Array([0.11682907, -0.50937404, 0.21846102, 0.07370458, 0.08833389, -0.72271608, -0.12503709, -0.64264663, -0.09674821, -0.23134642, -0.29921666, 0.32653802, 0.24655441, 0.30427226, -0.33355322, -0.30503259]);
  const W3 = new Float64Array([0.29100223, -0.92424891, 0.16506631, -0.53655394, -0.51327677, 0.3786885, -0.70113286, 0.02267003, -0.2549664, 1.11993976, 0.09727572, 0.00706621, 0.33344295, 0.76226658, 0.94181009, 0.35118035, 0.42726134, 0.22991702, -0.01230126, -0.12150831, -0.04629924, 0.21564567, 0.20728856, -0.17828013, -0.13236183, 0.26501108, 0.03878625, 0.21948781, 0.02980976, -0.06937907, -0.20738504, 0.10001369, 0.10652699, 0.02677934, -0.17999333, 0.06365331, -0.22002631, 0.07676843, -0.05925772, 0.08119549, -0.1661487, 0.10005132, 0.0709875, -0.34686521, 0.15381904, -0.05761472, -0.50283043, 0.55281659, -0.04942607, 0.26374359, -0.35845166, -0.14056122, -0.29800959, 0.0301322, -0.09249378, -0.22953077, 0.12496077, 0.10493339, -0.40052988, 0.05406226, -0.02245186, 0.24994585, -0.42162684, 0.12714062, 0.4363011, 0.72847381, 0.09922832, -0.58609149, -0.68535566, 0.17518889, -0.1268902, -0.8263128, -0.29506825, 0.15811458, 0.09708295, 0.81655744, -0.28845783, 0.41453705, 0.96100708, 2.22371473]);
  const b3 = new Float64Array([0.31920444, -0.07969788, 0.00923981, 0.13447447, 0.42624309]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.18751687, -0.03841178, -0.22435289, -0.07381462, 0.17132232, -0.48441334, 0.07362537, -0.21292008, 0.7976389, -5.70850609, -0.25282853, 0.25198737, 0.09398154, 0.37057773, -0.23158349, 0.36320623, -0.22301462, -0.06543675, -0.07055231, 0.09977913, 0.23809225, 1.16551059, -0.15373578, -0.22026586, -0.70836227, 0.35976411, 0.2479004, 0.22785852, 0.73391917, -0.35032471, -0.33574089, 0.43452106, -0.27586612, 0.799619, 0.24977642, -0.48173788, 0.45784678, 0.33145226, 0.83239095, -0.27154949, -0.20032677, 0.45093149, -0.42840741, 0.50841366, -0.1649333, -0.3410757, 0.08504802, -0.00712836, 0.80926349, 0.39961172, -0.24514685, 1.40975662, -1.54465762, -1.67325107, 0.26739317, 0.59078417, 0.87573574, -1.02743223, 1.02371596, 0.45927069, -0.33729903, -0.51052906, 1.41542057, 1.64107601, 0.41185924, 0.29404307, 1.40592063, -1.8655735, 0.6460826, -0.39898047, -0.42319701, 7.1446657, 0.54213213, 0.96186971, 0.42916886, 1.23754621, 4.73902174, 0.99373808, 0.64375443, 0.65481331, 0.05096682, 1.71922385, 0.8084697, -0.09894255, 0.44294278, -0.56937126, 0.02388452, 0.34094382, 0.01189408, 0.2847581, -0.18520108, 0.15901692, 0.02765835, 0.79788156, -0.97327022, -2.36835645, 0.35570536, 0.51655708, 0.54888757, 0.42808751, -1.18212533, 0.23410423, 0.23288433, -0.43364689, -0.29487431, -0.18176476, -1.73637409, -1.01618254, 0.15354953, 0.39340749, 1.44566675, 1.46378978, -0.59605309, 0.88573009, 0.42099233, 0.52526792, 0.32693032, -0.68110761, -0.26704532, -0.14339462, 1.45899702, -0.16685595, -0.05402112, 0.17807256, 0.38631022, 0.22742169, 0.27549736, -0.33294552, 0.46841613, -0.02278885, -0.02216948, -0.85691917, -0.42489951, -0.11162277, -1.14742033, -0.00438203, -0.10951721, -0.33625655, 0.79139449, 0.0790255, -0.87192952, -0.67882304, 0.13959419, 0.00503402, -0.69886643, -0.31460633, 0.50893138, -0.77960155, -0.48639898, 1.56383969, 0.38633647, -1.12795729, 0.05687525, 1.09993164, -0.35936305, -0.40618855, -0.09202552, 1.33766126, 0.32468417, 0.35447609, 0.16299633, -0.7316578, -0.42094939, 0.06647965, -0.07530339, 0.06166169, -0.51528472, -0.14360148, -0.84241919, 0.05015186, 0.84337022, -0.20236728, 0.07466748, 0.1366084, 0.26390766, 0.16222262, 0.03260931, 0.0105901, 0.23975622, -0.13032354, -0.18541625, -4.23983715, 0.38280185, 0.95359695, -0.29144767, -0.21945577, -0.22815564, 0.25319759, -0.50850599, -0.3644887, 0.27419585, 0.31212036, -0.93548478, 0.51279339, 0.2925673, 0.21847364, 0.85492561, -0.14701953, -0.58225853, 0.78172712, 0.23901164, 0.02049537, 0.13357553, 0.0511719, -0.25598102, 0.76518346, 0.09605561, -0.42653966, 0.76150904, -0.51362025, 0.50990635, -1.0947448, 0.16287685, 0.48830585, 0.18277015, -0.65685644, 0.23790632, -0.48663847, -0.28048232, -0.37974724, 0.4819406, -0.32180262, 0.75715797, 1.3621568, -2.7371082, 0.14861172, -0.41905348, 1.36346477, 1.38970207, -0.12099715, -0.22768903, 0.4029705, -0.00925094, -0.35363064, -0.12957676, -0.11928546, -0.15655103, 0.1376488, -0.5071198, -0.64672935, 0.80012365, -0.34596017, 0.25986987, 0.65108299, -2.1770202, -0.6884504, -0.06153838, -0.08929835, 1.32326531, -0.68394296, -0.20783063, -0.39155247, -1.11246267, 0.76069939, 0.90360035, -0.63081854, -0.47274011, -0.22651906, 0.27265636, 0.17756186, 0.72478318, 0.27532048, -0.14775899, 0.16672682, 0.12823117, 0.38310115, 0.21310285, -0.42382001, 1.02110949, 0.76166636, -0.66621299, -0.19080162, 0.78558746, -0.49083511, -0.51150934, 0.37349403, 0.2051815, -0.02111854, -0.45937454, -0.32162393, -0.25313708, 0.69064845, 0.34143897, -1.22075415, -0.0529835, 0.13979904, 1.61969799, 0.0124979, 0.24933727, -1.01085725, 1.66328988, 0.7996873, 0.57001745, 0.18486377, -0.80626215, 0.88041383, 0.49309304, -0.11719085, -0.31853038, -0.18427466, 0.6628835, 0.05278763, -0.14413451, -0.35322581, -0.35857553, -0.0487353, -0.49048334, -0.42414612, -0.24393564, 1.38184539, 2.72949798, -0.04876864, -0.24487631, -0.49575136, -0.77215415, 0.52141237, 0.31319116, 0.50882555, 0.15023232, 0.72939245, 0.43339594, 1.54212749, -1.06064229, -0.58366106, 0.47176364, 0.45495476, -0.80565184, -0.08505918, -0.17917018, -0.48461375, 0.4226609, -0.01937764, -0.15781294, -0.0111943, 0.4637539, -0.22996495, 0.12502233, -0.06168194, 1.15526894, 0.09526128, -0.59891101, -0.70016005, -0.58324131, -0.46642778, 0.02916348, 0.20610958, 0.43151871, -0.56254623, -0.2288588, -0.29412742, 0.03655579, 0.09901785, -0.23393498, -6.42747912, 0.14722914, -0.08677057, -0.0168222, 0.19534585, 1.01745469, -0.43236682, -0.0697075, 0.81575424, 0.32429898, -0.10337549, 0.97022527, 0.94612692, 0.06569938, -0.10246203, -0.7860776, -0.76446712, 0.78644171, -0.02763688, -0.01265279, -0.07041382, -0.161399, 0.76450826, -0.16695896, -0.44235422, -0.50353129, 0.18980192, 0.62752692, -0.1052071, -0.16357766, 0.20138973, 0.34251188, 0.56200829, 0.41846627, -0.62266725, 0.04263304, -0.5736839, -0.13131578, -0.51005468, -0.70326252, -0.09270821, -0.08713873, -0.7326027, 0.36599391, -0.4287493, -0.62667171, -0.4457687, 0.30613137, -0.21009481, -0.50548048, -0.92141492, -0.00300258, 0.09507273, 0.19295302, -1.0641009, 0.1013885, 0.00150847, -0.37741615, 0.32321336, -0.67385329, -0.69369511, 0.04009679, 0.69200813, 0.75113262, 0.57015973, -0.34952083, -0.60910561, 0.38212407, -0.42693657, -0.03890997, 0.22674511, -0.12096495, -0.1589244, -0.13080018, 0.14136774, 0.10851526, -0.1256176, 0.03589377, 0.35579171, 0.40343071, -0.33241466, -0.50242179, -0.36989624, -0.75518329, -0.58602425, -0.00819035, 2.57129563, -0.5373093, -0.61924259, 0.29400275, -0.90302839, 0.03331877, -0.57696681, 0.51992889, 0.51470342, 0.34729907, -0.34163617, 0.58187713, -0.53543713, -0.75721697, -0.32069211, -0.15708814, 0.36092845, 0.05377594, -0.730953, 0.2228279, -0.56226945, 0.17398214, 0.22129267, -0.69446968, 0.01203425, 0.61994392, -0.58853393, 0.55355338, -1.04769237, 0.49841444, 0.51540718, 0.10900034, 0.3826657, -0.0259537, 1.22691641, 0.05620455, 0.40188375, -0.21715831, 0.01649466, 1.22403175, -0.01900993, 0.5227549, -1.59054311, 1.28047544, -0.26411406, -0.04377671, 1.91090727, -0.02117513, 0.45924483, 0.36733737, 0.41802939, -0.53918015, -0.19645528, -0.32257121, -1.41167578, 0.49487673, 0.7895108, -1.14313968, -1.22070578, -0.44101964, 0.99174852, -0.51284863, -1.04071269, -1.24848436, 0.06764751, 0.13380368, -0.47983358, -0.05246349, -1.23978111, 0.36596549, 0.28078307, -0.54565513, -0.26000334, -0.60055496, 0.48910999, 0.20479397, 0.51723505, 0.06640906, 0.00049171, -0.04177677, -0.11303608, -0.04536118, 0.06096111, 0.19507256, -0.3309958, 1.94250694, -1.50588042, -0.05399908, -0.47188488, 0.55173704, -0.53533909, -0.37033699, -0.3043047, -0.03333376, -0.3237057, 0.11394763, 0.02206434, -1.9054434, -0.67640894, 0.99342816, -1.55696064, 0.19534164, 0.47847718, 0.1563291, 0.03730322, 0.85411632, -0.24498287, 0.19257193, -0.33676692, -2.46419136, 0.96954253, 0.02951214, 0.10489121, 0.03765621, -2.37218214, -0.23843583, 0.43014482, 0.20560761, 0.00100657, -1.05677248, -0.04513662, 0.35921868, -0.12652313, 0.03134359, 0.13284522, -0.54893577, -0.28553787, 0.30827473, -0.04887834, 1.90351307, -0.35135519, -1.09254446, 0.03008808, -0.79388526, -0.61322525, -0.76433969, -0.47275471, 0.05540432, -0.59597771, -0.63779685, 0.97907328, -0.39368657, -1.43599957, -0.40842378, -0.28484966, 0.27470965, -0.30043331, -0.95771378, 0.80176444, 0.02840583, 0.28634745, -0.01966477, -0.14885119, 0.42187158, 0.61308969, 0.09001487, -0.02612796, -0.03063985, -0.04290293, 0.00925968, -0.35533358, 0.25714459, -0.20773739, 0.51400345, 0.87872485, 0.42519634, 0.08778923, -0.43745201, 0.55610466, 0.11200182, 0.88919807, -0.31280797, -1.75054016, -0.45594087, -0.27389769, 0.46059653, -0.10440213, 0.36138392, 0.75007137, -0.13612981, -0.32163254, -0.21220274, 1.18530894, 0.07313769, -0.86247124, 0.33882731, 0.25354659, -0.24342188, -1.01228813, -0.51100921, 0.02896706, 2.40783189, 1.73204242, 0.5452871, -0.21622341, 2.19419024, 0.84892397, 0.48000989, 0.58940248, -0.21915, 1.27322437, 0.33579232, -0.99826096, 0.41365574, -0.37638748, 0.53802782, -0.77447362, -0.00793017, 0.32023896, 0.05823228, 0.18073692, 0.1046946, -0.08201785, -0.35469453, 0.44202203, 3.38262268, 0.43405027, -0.74903389, 0.15335664, 0.25268914, -0.29613346, -0.09109073, 0.04919036, 0.23780852, -0.05947584, -0.36353745, 0.45666353, 1.68605013, 0.08608026, -0.29136739, 0.87078687, -0.1269408, 0.07154087, -0.87534967, -0.34806518, 0.83057069, -0.4144312, 1.1777417, 0.43899784, -0.80702697, -0.04993844, -0.36276116, -0.02072821, 0.01366432, 0.28692414, -0.6185237, -0.0169286, -0.15478852, -0.81032138, -0.28485572, -0.12755834, -0.09993367, 0.21346504, 0.03883752, 0.10316277, -0.03626839, -0.47801431, 2.13321319, 0.52282039, -0.04750158, -0.13000853, -0.02146982, -0.04516328, -0.38284421, -0.02436252, -1.07942005, -0.84455695, -1.02756863, 0.10401592, -2.12853528, -2.99178286, 0.78364103, -0.49250135, 1.27568736, -2.04522456, -0.47624405, 0.59562095, -1.30441229, 4.06217586, 1.34162409, -0.36462015, -0.42435203, -1.03407517, 0.5963522, 0.03392318, 0.1767664, 0.30419042, -0.53557971, -0.20454628, 0.65269783, 0.31527136, -0.32127939, 0.41976118, -0.25189552, -0.03391449, 0.52701834, 0.48112655, 0.13258622, -0.19962566, 0.33972082, -1.1021552, -1.9345884, -0.50820036, 0.64101698, 0.3315283, 0.32863618, 0.003872, -0.35723957, -0.30955463, -0.62611932, 0.04519902, -0.62372282, -0.32675715, -0.43798726, -0.18664184, 0.05374833, -0.30014456, -0.60778719, 0.23160433, 0.29993221, 0.05338349, 1.03468933, -0.62714734, -0.17103604, -0.28355501, -0.16496096, 0.13555782, -0.07778238, -0.27474521, 0.20799431, 0.12256054, 0.33327159, 0.10529675, -0.16320797, 0.66838676, 1.58688066, 0.58346473, 0.01045102, 0.15903179, 0.11359124, 1.06734044, 0.21279817, 0.21449645, -1.03581475, 0.04527902, -1.00576865, -0.73976219, 0.26675068, -1.56109696, 0.71305765, 0.24256133, -0.06394795, -0.78907323, 0.40128514, 0.79892295, -3.35665032, -3.06803214, 0.09928104, 0.29789193, -1.41064474, 0.04647113, 0.21739552, -0.61376438, 1.83552206, 1.46826232, 2.0269204, 0.12627185, 1.22774938, 0.51771178, -0.51816727, 0.69098581, 0.61558862, 0.48946173, -0.5831934, -1.24344883, 0.52446555, 0.05367796, 0.61857383, 0.10876427, -0.01699804, -0.51316084, -0.41404233, -0.8521734, -0.8064554, -0.68019481, 0.16976938, -0.40146202, -0.21131428, -1.28528709, 0.16852307, -0.56698042, 0.44709569, 0.65492674, -0.69464936, 0.32539558, 1.02684513, -0.49823183, -0.9747896, -0.56845233, 2.91013396, -0.66553922, 0.46920291, 0.57879879, 0.78648176, 0.90402773, -0.41841911, 1.14570912, 6.14875853, 0.47061449, -0.63686861, 1.23816552, -0.66214544, 1.97087324, 0.24489263, 0.87313751, 2.70163591, 1.18217292, 0.47088689, -0.00359317, 0.03543365, 0.60870657, 0.52061604, 0.47483508, 0.03949101, 0.41879854, 0.52641985, -0.78736972, -0.03891616, 0.03440318, -0.68180895, -1.56249199, 0.08880429, 0.55499309, 0.31077506, 1.07337313, -0.03696371, 0.86548976, -0.67729459, 0.04051647, 0.01968593, -0.10966711, 1.14524694, 0.55067893, 0.41931056, 0.60522918, -1.42260329, 0.66299012, 0.36375824, 0.24182685, -1.5371834, -1.43025942, 0.14601799, -0.5096286, -0.40289614, -0.48317662, -1.68171425, 0.29666104, -0.17815484, -0.44467907, -1.23439415, -0.28641557, 0.27142055, -1.01329003, -0.26975134, -0.44699911, 0.30170191, -0.11532552, -0.3769779, -0.17547293, 0.07777373, -0.11191987, -0.58646849, 0.02707869, -3.17457958, 0.07662237, 0.22221327, 0.29398227, -0.01660972, 0.26541498, -0.13799007, 0.33309236, -0.46056132, -0.38894969, -0.16332453, -0.65735248, 0.33233183, -0.00361671, 0.06755678, 1.4766171, 0.44074406, -0.84657117, 0.94558367, -0.12916527, -0.12965207, -0.11549527, 0.40281948, 0.06914727, 0.3338568, -0.37800444, 0.09010942, 0.0820346, 0.30829713, 0.44446002, -0.66163325, 0.26539719, 0.4345563, 0.32980218, 0.7792028, -0.18514572, 0.27791496, 0.59048807, 0.3583155, 0.76049078, 1.3039203, -0.20465942, -0.39075544, 2.78561924, 0.00241835, -0.6299361, 0.37278659, -0.2289434, -0.76146955, 0.63480776, -0.64239221, 0.60374876, -0.21906154, 0.71090604, -1.2366859, 0.00388196, 0.37612946, 0.44370578, 0.30367975, 0.52652139, -0.74932916, 0.49790434, -0.59631578, 1.51821748, 0.47055281, 0.48059816, 0.06605667, -0.4404968, 1.73859531, -0.26314235, 0.02865621, 0.3103519, -0.35352141, 0.98191159, 0.23906019, 0.01541167, -0.59200723, 0.53600937, -0.31391911, 0.66656467, -0.78176461, 0.07482009, 1.06664424, 0.53364666, 0.43938989, -0.22146247, -0.93669805, -1.05526017, -0.75399638, -0.05645284, -0.89405665, -0.40373497, 0.27984824, -0.44931997, 0.03035205, -0.53703213, 0.27552859, 0.2409624, -1.87119379, 0.15385687, -1.05211707, 1.45934375, -0.49536057, -0.36149619, 0.33441159, -2.74056227, -1.45011401, -0.62813062, 0.95767555, -0.48312213, -1.26895443, -1.74430673, 0.04074296, -0.02154889, -0.4879136, -0.277464, -0.99840767, 0.52637701, 0.5114064, 0.55550763]);
  const b1 = new Float64Array([-0.40304461, 0.2867866, -0.51754964, 0.18056497, -0.09987043, 0.13204174, -0.19104881, -0.30511605, -0.55417469, -0.43741034, -0.02825568, 0.66002674, -0.26575721, -0.30885087, 0.36987441, -0.380272, -0.41469484, -0.32717178, 0.21091105, -0.06154481, 0.1639695, -0.27779871, 0.34740951, -0.00574977]);
  const W2 = new Float64Array([0.49742184, 0.2701709, 0.2416587, -0.04090219, -0.64631697, -0.14872842, -0.10607225, -0.18948658, 0.9681721, -0.33363824, -0.4596618, 0.46461683, -0.65078463, -0.51708427, -0.16386569, -0.83319763, -0.20172136, 0.82824665, -0.03165856, 0.06020365, 1.23889815, -0.24108692, -0.92408505, 0.52359565, 0.88809359, -0.09799744, 1.18618107, -0.48443255, 0.81334277, 1.06415956, 0.11329293, -0.6452383, -0.48502863, 0.13289146, -0.3066348, 0.40622181, 0.27196449, 0.40995392, 0.69915193, -1.0635735, 0.11517423, 0.0743683, 0.73388901, -0.45874536, 0.11611886, 0.44654633, 0.1088385, 0.97829123, 0.86859925, -0.16455989, -0.54255044, -0.80218657, -0.63273981, 0.38238395, -0.13195992, -1.04762185, 0.12770794, -0.47792382, -0.52106167, 1.11897499, -0.25612183, -0.06089182, -0.38032868, 0.18558696, 0.18015189, 0.37836134, -0.83035901, 0.42673391, 0.97455367, -0.00693873, 0.03522508, 1.42680285, -1.41555668, 0.58557649, 0.33712292, -0.20978284, -0.65225913, -0.34662386, 0.05795577, 0.94909605, -2.2617062, -0.05107038, -0.37156391, 0.49918128, -0.73147602, 0.37925154, -0.89450395, 0.53703389, -0.79501837, -0.2073069, 0.74730858, -0.00728347, -0.8621106, -0.32760311, 0.57343088, -0.21925875, -0.4987331, -0.4297812, -0.91120101, 0.0573319, 0.39403648, 0.71361222, -0.46246056, -0.42928284, 0.75175551, 0.38329441, -0.33329001, -0.37309771, -0.14493611, 0.73226434, 0.76747524, 0.2892354, 0.66396827, -0.85926688, 0.54428417, -0.06886843, -0.07771797, -0.42681733, 0.72297933, 0.09360983, 1.9032481, -0.32632336, -0.80487878, 0.26798353, 1.38953219, 1.318899, -0.32986891, 0.22499063, 1.19227759, 0.10874312, -0.13859815, -0.7804797, 0.50732848, -0.47369606, -0.04184164, -0.68423282, 0.21045537, 0.10852326, -0.17465358, 0.31885954, 0.2259333, -0.06669726, 0.00704479, 0.10906991, 0.570565, 0.01114135, -0.48362518, -0.22542937, -0.11799724, -1.45035402, 0.86400691, 0.52034845, 0.70069959, 0.60639649, 0.21413436, -1.02356417, 0.68848258, 0.79070753, 0.08717379, 1.38278219, -0.24315337, -0.5724403, -0.46859081, 0.90573742, -0.46069346, -0.81604963, 0.22241534, -0.75960816, -0.06851195, 0.14607414, -0.23248313, 0.19005009, 0.11575768, 0.89351047, -0.98635462, 0.42747579, -0.07240452, 0.30016531, 0.2036589, 0.31897773, 0.4527186, 0.23884514, -0.0782251, 0.26443168, 0.61374707, 0.14996746, 0.05259172, -0.0217804, -0.83900914, 0.44380836, -0.33426436, 0.17700124, -0.50589101, 0.52085745, 0.22196792, 1.2907889, 0.00571341, 0.00232991, -0.36301417, -0.24121594, 0.12479124, 0.58384441, 0.86311386, 0.12419842, 0.17038601, 0.91458746, 0.67071427, -0.39798669, -0.51826393, -0.37343351, 0.57717957, -0.97552687, 0.53097065, -0.06287701, 0.04546558, -0.31933836, 0.10784922, -0.39659517, -0.15757021, -0.50335945, -0.76082921, -1.05229157, 0.16817322, 0.52884007, -0.36098478, -0.11318515, 0.22989134, 0.34381858, 0.0669243, -0.14813005, 0.08917504, 0.7751505, 1.4016455, -0.30921807, -0.95690566, 0.98566069, -0.42612494, -0.36155716, 0.04946343, 0.18947356, -0.01949018, 0.19106311, -0.28991268, 0.28836568, -0.43247855, 0.42044336, -1.33284837, 0.07472669, 0.56981618, 0.13022847, 0.53847443, 0.14056122, 1.46781617, -0.41829698, -0.38389335, -0.212882, 0.69100854, -0.16112432, 0.14595478, -0.22270496, 0.23233383, -0.10450854, 0.06127683, 0.67236523, 0.48835229, -0.07856454, -0.40087845, -0.20469104, -1.09499615, -0.4344285, 0.4479616, -0.09133954, -0.22713278, -0.31787193, 0.52844062, -0.31780789, -0.08441193, 0.20729514, 0.13806283, 0.01605483, -0.80467832, -0.53626214, -0.94848937, 0.40894448, -0.06825849, 0.07984258, -0.44004928, -0.28742863, 1.03337509, -1.71762136, 0.01582602, -0.22492322, -0.50079192, 0.63876221, -0.02197984, 0.79900854, 0.95325577, -0.09355779, -0.26736876, 0.21466341, -0.14525178, 0.27615788, -0.3548629, -0.22727126, -0.64929232, -0.06269505, -0.12988673, -1.04999104, 0.19183403, 0.25055181, -0.70964561, 1.07621375, -0.44816552, 0.16558835, 0.47580189, -0.11483704, 0.26067449, -0.32505968, 0.24051296, 0.31591766, -0.17336423, -0.61704354, -0.16210109, 0.41513782, -0.46296907, 0.13696706, 0.4431142, 0.04925874, 0.22100849, -0.42835487, 0.12358795, -0.77300101, 0.42749732, -0.73892787, 0.45062177, -0.23938644, 0.02570303, 0.42273458, -0.06724032, 0.02073538, 0.09020777, -0.78568047, 0.2978014, -0.22948501, -0.05172835, -0.46080662, -0.46789116, 0.62918596, 0.30791443, -0.79462593, 0.86875073, -0.60306365, -0.99546292, 0.24379307, -0.04513759, -0.84100038, 0.3387626, -0.07362891, -0.1047774, 0.06100704, 1.79399345, -0.47892611, 0.48443674, -0.75560892, 0.8826609, 0.86134156, 0.21083928, -0.49515355, 0.63949203, -0.359488, -0.9210628, 0.05247154, 0.38446747, -0.9522999, 0.76780629, -1.63713308, -0.06342243, 0.12586696, 0.15683632, 0.24899466, 0.60627014, 1.47409243, -1.46277048, 0.20132634]);
  const b2 = new Float64Array([0.11682907, -0.50937404, 0.21846102, 0.07370458, 0.08833389, -0.72271608, -0.12503709, -0.64264663, -0.09674821, -0.23134642, -0.29921666, 0.32653802, 0.24655441, 0.30427226, -0.33355322, -0.30503259]);
  const W3 = new Float64Array([0.29100223, -0.92424891, 0.16506631, -0.53655394, -0.51327677, 0.3786885, -0.70113286, 0.02267003, -0.2549664, 1.11993976, 0.09727572, 0.00706621, 0.33344295, 0.76226658, 0.94181009, 0.35118035, 0.42726134, 0.22991702, -0.01230126, -0.12150831, -0.04629924, 0.21564567, 0.20728856, -0.17828013, -0.13236183, 0.26501108, 0.03878625, 0.21948781, 0.02980976, -0.06937907, -0.20738504, 0.10001369, 0.10652699, 0.02677934, -0.17999333, 0.06365331, -0.22002631, 0.07676843, -0.05925772, 0.08119549, -0.1661487, 0.10005132, 0.0709875, -0.34686521, 0.15381904, -0.05761472, -0.50283043, 0.55281659, -0.04942607, 0.26374359, -0.35845166, -0.14056122, -0.29800959, 0.0301322, -0.09249378, -0.22953077, 0.12496077, 0.10493339, -0.40052988, 0.05406226, -0.02245186, 0.24994585, -0.42162684, 0.12714062, 0.4363011, 0.72847381, 0.09922832, -0.58609149, -0.68535566, 0.17518889, -0.1268902, -0.8263128, -0.29506825, 0.15811458, 0.09708295, 0.81655744, -0.28845783, 0.41453705, 0.96100708, 2.22371473]);
  const b3 = new Float64Array([0.31920444, -0.07969788, 0.00923981, 0.13447447, 0.42624309]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
