function name(){ return "DNN-1"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.43790552, 0.28667445, 0.29146866, -0.10083556, -0.10943076, -0.28717854, 0.34111587, 0.10557079, 0.55717376, -5.61994379, -0.27722839, 0.36063351, 0.0718853, 0.45636362, 0.40585164, 0.16047504, -0.23512074, 0.14881862, -0.33329282, 0.0648078, 0.29152137, 0.64120843, -0.05480317, -0.14874023, -0.40090724, -0.35002197, 0.3091271, 0.4051397, 0.85064322, -0.22651637, -0.16105264, 0.7006894, -0.28201989, 0.48340796, -0.23235781, -0.26979255, 0.43403731, 0.64313606, 0.96556927, 0.03570268, -0.15051028, 0.39582946, -0.22895588, 0.61818475, 0.40916528, -0.69208004, 0.4571102, 0.1735228, 1.07139671, -0.00031113, -0.33939067, 1.32194154, -1.74826511, -1.36365094, 0.25472051, 0.38659474, 0.35009458, -1.19683509, 1.00852354, 0.46808125, -0.52390067, -0.51198914, 1.72981892, 1.55383002, 0.44710828, 0.44927636, 0.90969231, -1.58195574, 1.07800668, -0.66734118, -0.48763575, 7.40851416, 0.54088755, 1.31914028, 0.64460509, 1.45555297, 4.97408468, 0.7954445, 1.2141104, 0.44066381, -0.39116369, 1.92661508, 0.39178036, -0.26493241, -0.00877638, -0.54047246, 0.43857311, 0.2628301, 0.28038817, -0.08991614, 0.00562096, 0.07909606, -0.33394848, 0.81173666, -0.99119724, -2.40418836, 0.20683362, 0.57010329, 0.50706288, 0.04475721, -1.6923782, 0.44234895, 0.28192312, -0.41569071, -0.40097114, -0.21270939, -1.48213758, -1.35673722, 0.64426118, 0.62463704, 1.62307793, 1.55368966, -0.52942548, 1.01280246, 0.46965761, 0.59909363, 0.57445636, -0.58310112, -0.35849256, -0.5103396, 0.97573035, 0.12385534, 0.42429294, -0.17578239, 0.15137795, 0.05255061, 0.21706019, -0.133915, 0.78614439, -0.36118624, 0.01983596, -0.4719965, -0.53748171, -0.06507518, -0.84473667, -0.21252155, 0.01425524, -0.2332369, 0.45602945, -0.0017205, -0.9220035, -0.86182999, 0.46711704, -0.22868938, -0.3984326, -0.56002579, 0.93126113, -0.76314673, -0.13618089, 1.6050381, 0.55343064, -1.25071673, 0.18836974, 1.05970012, -0.58777365, -0.42381295, -0.01989542, 1.21581512, -0.09301666, 0.57711358, 0.06524754, -0.93012569, -0.60666752, 0.03643859, -0.33341537, 0.06469217, -0.85885903, 0.12184405, -0.70331632, -0.35838915, 0.99211349, -0.11757183, 0.08672163, 0.47150356, 0.22588279, 0.56287101, 0.06258171, -0.14941481, -0.02253153, 0.1529853, -0.02648026, -4.14536007, 0.58905402, 0.58733332, -0.24634963, 0.26527182, -0.07549294, -0.08199109, -0.26349965, -0.50722975, 0.23642582, 0.52952442, -1.05311519, 0.77329085, -0.09639001, 0.29902959, 0.74671193, -0.1438305, -0.82805139, 0.74975143, 0.62837672, -0.02263945, 0.44817443, -0.01960781, -0.27410757, 0.58861762, 0.52108862, -0.34019261, 0.50618758, -0.33906053, 0.29810917, -1.06793901, 0.29261285, 0.49198256, 0.20554799, -1.13114923, -0.04443075, -0.71076359, 0.08113087, -0.58061603, 0.59296573, -0.3429898, 0.44819549, 1.59346377, -2.61945133, 0.0115471, -0.09130324, 1.55775826, 1.21915834, 0.01826581, -0.60943431, 0.55488353, 0.41412301, -0.18633928, -0.11519492, 0.14395246, -0.274614, 0.31022997, -0.88624122, -0.76087041, 0.84386313, -0.48345321, 0.53104081, 0.57218027, -2.55074843, -0.56367925, 0.05213854, -0.18528107, 1.71648284, -0.82593726, -0.52529301, -0.06369078, -1.29506084, 0.79300664, 0.52014037, -0.65330576, -0.37278706, -0.1183534, -0.30385234, 0.10153757, 0.50390224, 0.18589201, 0.1572268, 0.37320647, -0.24873547, 0.48522964, 0.61427802, -0.58838985, 1.27024363, 0.33047243, -0.88564803, -0.23824035, 0.9698733, -0.59554315, -0.63276144, 0.62563084, 0.67460072, -0.26991931, -0.42178144, -0.58483235, -0.07731733, 0.32731518, 0.38657588, -1.0380873, -0.04714119, 0.26012602, 1.85201329, 0.01056569, 0.37896189, -0.92339511, 1.60935713, 0.3519358, 1.01701588, 0.41334551, -0.8229241, 0.7446023, 0.19826225, 0.01837637, -0.18924691, -0.22272479, 0.39300219, -0.16064378, -0.01502117, 0.06694503, -0.21591942, -0.44848074, -0.57665888, -0.75902568, -0.18684585, 1.75812951, 2.52716162, 0.04624047, 0.08341713, -0.35477066, -0.79106952, 0.57576331, 0.32384616, 0.22890642, 0.11154918, 0.99016834, 0.27619942, 1.82128783, -1.1147363, -0.1514259, 0.49815359, 0.63262197, -0.85261822, -0.24408185, 0.04092865, -0.40898409, 0.2187659, 0.5939429, 0.25120273, 0.04767159, 0.61222427, -0.22889286, 0.15874019, 0.06538034, 1.04925303, 0.0977568, -1.03568249, -0.79114084, -0.67013313, -0.43621703, -0.45010369, 0.32875039, 0.50793556, -0.25741618, -0.45254671, -0.53803813, 0.16362462, -0.14334803, -0.19935954, -6.5311422, -0.02943762, -0.16420222, -0.10827991, 0.1547662, 1.04737688, -0.27820864, 0.04903922, 0.5033388, 0.63484467, 0.06518909, 1.4467137, 0.99559152, 0.0637428, -0.41627302, -0.52783621, -0.97442636, 0.41868684, 0.19327585, -0.08633218, -0.16769813, -0.02152273, 1.12148376, -0.24177989, -0.21112556, -0.55037804, 0.10022064, 0.32302101, 0.04755423, 0.04394149, -0.07573192, 0.23004496, 0.52188947, 0.47779696, -1.09222283, 0.05517106, -0.47166323, -0.30100395, -0.87782714, -0.63097463, -0.10320982, 0.19983009, -0.83486804, 0.76870876, -0.41389931, -0.95068899, -0.46939508, 0.11882143, 0.18213007, -0.85742938, -0.95910751, 0.01303034, 0.50021041, 0.21806978, -1.35411049, 0.33796412, 0.11304469, -0.27159458, 0.27671941, -0.63896321, -0.85718552, -0.10484049, 0.47597432, 0.66795252, 0.23523047, -0.32766585, -0.71392922, 0.32901856, -0.72913046, -0.32441547, 0.13735976, 0.28795793, -0.20754993, -0.41433265, 0.44773699, 0.12536568, -0.01509058, 0.19212788, 0.04281058, 0.33889086, -0.14777078, -0.66142111, -0.13231776, -0.88677939, -0.78521909, 0.33272822, 2.79950883, -0.72876622, -0.70469221, 0.14997329, -0.57367741, -0.32259341, -0.76819714, 0.75968589, 0.65307013, 0.07837013, -0.24464961, 0.75713633, -0.63777248, -0.09309103, -0.06051813, -0.12197373, 0.18103338, -0.32278231, -0.82417426, 0.15852481, -0.78133597, -0.45692952, 0.40125851, -0.66136018, -0.10561747, 0.40668301, -0.51587459, 0.57578647, -1.1929422, 0.21366893, 0.23895185, 0.13499196, 0.19411319, 0.07774001, 1.46468836, 0.04176726, 0.20548891, -0.58304135, 0.20610866, 1.37245001, 0.0715244, 0.60900116, -1.53037955, 1.42275085, -0.08166345, -0.26229319, 2.29872619, -0.09309751, 0.56090344, 0.42332203, 0.26195289, -0.43361581, 0.06926367, -0.02695036, -1.53261339, 0.81738667, 0.50243947, -1.26820652, -0.98084869, -0.53507638, 0.75451162, -0.33540848, -1.36245481, -1.60953541, -0.08722931, 0.30229661, -0.24172879, 0.38882719, -1.60314125, 0.62924454, 0.06807803, -0.15915038, -0.15915185, -0.41984272, 0.42976239, -0.03614878, 0.43237035, 0.02648312, -0.20609888, -0.09494591, -0.38808155, -0.19664323, -0.18316339, 0.55482654, -0.68394016, 2.24564119, -1.80847715, -0.47006498, -0.31210835, 0.51521929, -0.43384669, -0.76040579, -0.33059709, -0.15571589, -0.55749422, 0.13874144, 0.070883, -1.9380512, -0.57284265, 1.31700903, -2.15368892, 0.61544529, 0.36736054, -0.04128216, 0.0525769, 0.49134459, -0.31473704, 0.04358571, 0.09602795, -2.47298023, 0.83663427, 0.12020037, 0.60157181, 0.12494483, -2.54425341, -0.07002261, 0.4801155, 0.33224919, -0.08470422, -1.09316177, -0.04707545, 0.18678039, -0.05895869, 0.05456543, 0.05315762, -0.38052479, -0.11328626, 0.45199996, 0.10382705, 1.99747534, -0.19385167, -1.08943956, 0.16894069, -0.86439847, -0.58266749, -0.49794542, -0.56735153, -0.08085438, -0.62715865, -1.23537351, 0.78216862, -0.36249201, -1.08253244, 0.12590188, -0.2981104, 0.34463625, -0.80850699, -0.75057165, 0.89106056, 0.14711991, 0.43040693, 0.24400467, -0.28825202, 0.52935872, 0.55507687, 0.22138433, 0.24365673, -0.23308503, -0.07489313, 0.27984791, -0.45942712, 0.37620399, -0.24140955, 0.62330793, 0.77921792, 0.71123988, 0.02079538, -0.52510845, 0.32942113, 0.1607535, 0.96151555, -0.16079034, -1.93859221, -0.36190573, -0.19783436, 0.64001555, -0.11982791, 0.37611482, 0.78146002, -0.29536282, -0.291881, -0.1050257, 0.79742206, -0.17266075, -0.88210515, 0.71315302, 0.10720733, -0.15652838, -0.49973341, -0.45632669, 0.16452009, 2.48697164, 1.11017542, 0.47732019, -0.08347426, 2.54925165, 0.95313778, 0.79396991, 0.67585751, -0.20691878, 1.10924548, 0.55181554, -0.75626899, 0.69224745, -0.10301377, 0.60962182, -0.79353267, -0.04272982, 0.2881041, -0.27729901, -0.44808305, -0.16943179, -0.37507713, -0.19335074, -0.00148306, 3.19323577, 0.1035666, -0.57338948, 0.52968303, 0.32556781, -0.15723568, -0.12659113, 0.12663175, 0.09059224, 0.11972124, -0.07987135, 0.19573581, 1.66614221, -0.02746732, 0.01809177, 0.9322043, 0.23503757, -0.21352856, -0.54890718, -0.38095916, 0.54091449, -0.34022734, 0.72674154, 0.64074993, -0.76762368, -0.04648122, -0.29888653, -0.31396683, -0.18739208, 0.53936865, -0.41735965, -0.1562445, -0.2633629, -0.48597415, -0.08265106, -0.27398756, 0.01136865, 0.1887991, -0.06646916, 0.41479363, -0.09480974, -0.63911342, 2.50579508, 0.71400369, -0.11481813, 0.05201703, -0.11187266, -0.09966212, -0.55138482, -0.10820827, -1.15806636, -0.64752434, -0.86332061, -0.19997056, -2.14528927, -2.87757969, 0.7424284, -0.24504957, 1.32902126, -1.93770945, -0.61731616, 0.25588802, -1.34319156, 4.27656895, 1.87244775, -0.08158902, -0.3864889, -1.17278103, 0.52114927, -0.19224884, 0.10702464, 0.21013826, -0.61004765, -0.40792327, 0.57599278, -0.0397493, -0.41217899, 0.92912994, -0.23223925, 0.08743698, 0.46663486, 0.56753572, 0.32071805, -0.21116781, 0.40453932, -1.02160473, -1.84046832, -1.00500846, 0.60869917, 0.54639748, 0.26393022, -0.02675387, -0.32765293, -0.58487253, -0.79630644, -0.02546589, -0.66765198, -0.4398617, -0.35442079, -0.31269691, 0.0557983, -0.35000629, -0.48865672, 0.19870154, 0.5036284, 0.03823856, 0.99535683, -0.73840532, -0.59068848, -0.31840297, -0.0383206, 0.43449538, -0.02495137, -0.22737291, 0.67246412, -0.0403685, 0.63442454, -0.14994881, 0.03197217, 0.81119842, 1.60716682, 0.7331085, 0.21922967, 0.41034227, 0.34342446, 0.76305537, 0.42669919, 0.3550817, -1.06769092, -0.30641643, -1.34493604, -0.40432105, 0.05680819, -1.51733025, 0.72987137, 0.04370459, -0.0010694, -0.65229962, 0.21843868, 0.97331664, -3.29918687, -3.24643764, 0.29392696, 0.33741948, -1.37560109, -0.16699405, 0.27196616, -0.58381965, 1.81667367, 1.75141047, 1.97774891, 0.1396678, 1.58182969, 0.75116523, -0.61174129, 1.01652231, 0.85792504, 0.39826911, -0.8885599, -1.30460266, 0.14052694, 0.40016586, 0.73007537, 0.03082803, 0.0396427, -0.69563624, -0.03033443, -0.54946731, -0.6848278, -0.25859658, 0.14599258, -0.03088124, -0.13220514, -1.68072428, -0.09271895, -0.6630331, 0.33079586, 0.53328276, -0.64429227, 0.25992795, 1.29739499, -0.44481283, -0.76556351, -0.56668475, 2.47334204, -0.62998962, 0.65989463, 0.66443107, 0.98572862, 1.16980806, -0.35108564, 1.3472356, 5.94033877, 0.30974987, -0.83999408, 1.02026831, -0.15030077, 1.7298327, 0.32290212, 0.95685008, 2.61298772, 1.25082845, 0.80658685, -0.06049918, 0.00472654, 0.52354259, 0.31825409, 0.68213935, -0.05298223, 0.43634643, 0.3128813, -1.14961688, -0.25263141, 0.17612209, -0.78700307, -1.19793967, -0.0570563, 0.39552643, 0.25223549, 0.85410401, 0.04226136, 0.7672748, -0.81128183, 0.34537788, -0.08369965, -0.08769349, 1.60136065, 0.68536087, 0.86071233, 0.37937505, -1.62376555, 0.46391922, 0.03859705, 0.20528158, -1.69123894, -1.41628122, -0.13261515, -0.5322042, -0.07635726, -0.3460316, -1.44325928, 0.37801554, -0.1965497, -0.59632468, -1.10459054, -0.02814148, 0.63280748, -0.48001112, -0.27577878, -0.74510699, -0.17404939, 0.0409552, -0.31708707, 0.20400628, -0.19372669, 0.2039152, -0.87461198, 0.01023884, -3.18606041, -0.10653382, 0.35766341, -0.13387789, -0.4777505, 0.30275907, 0.23928922, 0.42820351, -0.34367539, -0.56442334, -0.671005, -0.493529, 0.08647177, -0.03925029, 0.06683962, 1.38893815, 0.05073875, -0.87379694, 0.77262228, -0.14076952, -0.00650348, -0.39342401, 0.2909445, -0.09741293, 0.24100898, -0.58485485, 0.40464968, 0.2530926, 0.21718034, 0.3653357, -0.63079716, 0.09079719, 0.59786396, 0.28176903, 0.91078974, -0.50806508, 0.17058284, 0.66246559, 0.52250169, 0.77092678, 1.67037803, -0.3148234, -0.62721196, 3.1307736, -0.23737039, -0.25403343, 0.26959777, -0.08163353, -0.84077738, 0.77060027, -1.08085227, 0.62796409, -0.47726477, 0.84447749, -1.54525213, -0.07011557, 0.53000478, 0.03092981, 0.42095566, 0.45938867, -0.45169126, 0.56525877, -0.40021603, 1.595647, 0.42221703, 0.56547121, 0.11456523, -0.61567926, 2.05573337, 0.25747906, 0.07542924, 0.46609067, -0.62387698, 0.6761681, 0.50903264, 0.28322544, -0.75403803, 0.21051104, -0.39142604, 0.78154273, -0.51775019, 0.01510606, 1.23920286, 0.77384772, 0.57167831, 0.18109808, -0.45302109, -0.86129097, -0.7482826, 0.07389122, -0.76530534, -0.33736896, 0.19241592, -0.47162977, -0.20982558, -0.67358201, 0.58463259, 0.24785388, -1.84949452, 0.11330084, -0.8019222, 1.50373494, -1.1112966, -0.5712871, 0.63816383, -2.36288388, -1.32599372, -0.3562986, 0.81400162, -0.68727144, -1.05544968, -1.57924127, 0.14167307, -0.59285951, -0.39955664, -0.30652663, -0.84222451, 0.15224943, 0.58428033, 0.34091398]);
  const b1 = new Float64Array([-0.38756922, -0.01529645, -0.55953228, 0.07328275, 0.3129152, 0.06458981, 0.32244239, -0.21778243, -0.84407298, -0.81866391, -0.14618679, 0.65203703, 0.22879418, -0.45532186, 0.76164877, -0.314204, -0.24818741, -0.53805022, -0.10354619, 0.21180893, 0.33213273, -0.29319018, 0.55788904, 0.4333498]);
  const W2 = new Float64Array([0.09408662, -0.3336107, 0.36611701, -0.11292449, -0.59773382, 0.10727941, -0.04072949, -0.55377516, 1.25220999, -0.31683503, -0.41767058, 0.58706581, -0.67541487, -0.95871286, 0.20463733, -1.01013991, -0.03276556, 0.59471819, -0.27019869, 0.09009908, 1.46542189, -0.22811529, -1.09586614, 0.96074048, 1.34545145, -0.1814754, 1.41500774, -0.24100818, 0.44782941, 1.16077169, -0.00972746, -0.46052183, -0.4810369, 0.71366344, -0.08967912, 0.4997682, 0.51976109, 0.69577377, 0.60622204, -0.65142191, -0.00241908, -0.54516251, 1.15591911, -0.47086452, 0.13457477, -0.12023731, 0.23095488, 1.41638319, 0.50639571, -0.17441286, 0.05495283, -1.19395757, -0.93771248, 0.44948852, -0.28754033, -1.06089319, -0.27942543, 0.01618807, -0.79634621, 0.98867083, -0.32474711, -0.2105568, -0.44205541, 0.1932159, 0.00407995, 0.49608229, -0.94538508, 0.71060845, 1.12277356, -0.35115785, -0.2035635, 1.57852399, -1.14811154, 0.16596729, 0.06889257, -0.41457082, -0.62527615, -0.02929614, 0.2690992, 1.09394444, -2.44932213, -0.09026784, -0.59504263, 0.48833538, -0.55208794, 0.65296831, -0.96156054, 0.51376285, -0.79230113, -0.44862232, 0.55084261, -0.01900226, -0.64967349, -0.16581617, 0.6975699, -0.51454857, -0.77123349, -0.08645361, -0.70749965, 0.18384816, -0.03472589, 0.91085324, -0.65609358, -0.86726516, 0.54576814, 0.24076681, -0.30840465, -0.5313792, 0.07682758, 0.76773534, 0.40358264, 0.27678244, 0.43462538, -1.03705345, 0.49026133, 0.01224966, 0.00974685, -0.66897054, 0.58847769, 0.49725306, 1.97786822, -0.65206801, -0.64586137, 0.12449402, 1.42084643, 1.08103177, -0.22622629, -0.07062538, 1.2315496, 0.08385384, -0.12809868, -0.46131045, 0.43899598, -0.68583177, -0.33213774, -0.81493566, 0.29286754, 0.27728822, -0.25053776, 0.41568725, 0.26782578, 0.31836444, -0.05486111, 0.05135012, 0.65099938, 0.48524417, -0.82651902, -0.13002597, 0.12020949, -1.49604353, 0.75119153, 0.55629104, 0.61860948, 0.5967996, 0.05401974, -1.36556147, 0.75489861, 0.53426738, -0.02746313, 1.42202116, 0.03970474, -0.66756951, -0.36067738, 0.91961792, -0.64077952, -0.79467445, 0.15859935, -0.33707813, 0.02555191, 0.47034752, -0.13964864, 0.84173122, 0.19963754, 0.72483867, -1.34620363, 0.30371552, -0.19587663, 0.31317233, -0.02417105, 0.76240676, 0.83051728, 0.54055567, 0.10106575, 0.52938981, 0.6412371, -0.00061729, -0.11836649, 0.25773459, -1.25443998, 0.45158464, -0.40685816, 0.10939157, -0.23629962, 0.4190113, 0.0151415, 1.65716366, 0.07956642, 0.02683256, -0.22190233, -0.52132491, 0.63351318, 0.54048019, 0.83168563, 0.0931095, 0.14586689, 0.87839571, 0.95732508, 0.07977731, -0.53589549, -0.52639608, 0.76511015, -1.04188714, 0.19347787, 0.22468825, 0.08811923, 0.08738243, -0.08969664, -0.11254295, -0.24766247, -0.2403831, -0.98462404, -1.11993064, 0.30585383, 0.03042275, 0.05862472, -0.33229928, 0.7199741, 0.62506505, 0.25443103, -0.30632027, 0.13891787, 1.26218249, 1.49375002, -0.47224676, -1.28802186, 1.21731295, -0.38098078, -0.20141237, 0.0993211, 0.58353299, 0.02704011, 0.51091819, 0.07117388, -0.01827415, -0.89567564, 0.41927815, -1.39582026, -0.1481669, 0.38432581, 0.57463461, 0.51060598, 0.17994721, 1.4035534, -0.25579197, -0.15656692, -0.49755301, 0.38289493, -0.65186062, 0.27202096, -0.43770286, -0.07496871, 0.24509695, 0.06285006, 0.80449349, 0.19586276, -0.20705442, -0.34880283, 0.16164587, -1.03384473, -0.35670064, 0.32451549, -0.01814135, -0.23833017, 0.14274742, 0.61819362, -0.33721972, -0.15776996, 0.52879497, 0.29705423, 0.14802691, -0.78058979, -0.82254937, -1.01415181, 0.35889543, 0.35376524, 0.28031242, -1.01927209, 0.01748123, 0.77965917, -1.70447032, 0.7109695, -0.2395605, -0.36057536, 0.89973435, -0.3373749, 0.68793303, 0.64306384, -0.39516895, -0.1502043, 0.3654599, -0.17567938, 0.18945543, -0.33888844, -0.55621169, -0.36094855, 0.11007959, 0.14841333, -1.14239413, 0.09839317, 0.15199876, -0.23190643, 0.83805994, -0.49730437, 0.29072051, 0.79214225, 0.14200635, 0.41466407, -0.09274874, -0.18816325, 0.33851638, -0.28400497, -0.61016419, 0.27116654, 0.42679709, -0.62641292, -0.06665195, 0.40810253, 0.26042455, 0.21158194, -0.31835846, 0.12977399, -0.81425096, 0.54051362, -0.6414509, 0.6629502, -0.33285372, 0.38625296, 0.96645365, -0.11185877, -0.23181832, 0.19703774, -0.83886375, 0.31942274, -0.44780846, -0.15595656, -0.38674412, -0.4624189, 0.33090536, 0.27492663, -1.14101775, 0.63248367, -0.87532827, -1.32275133, 0.01978741, -0.14671085, -1.05521662, 0.40408981, -0.02338397, -0.13490036, -0.04447539, 1.74174271, -0.02188144, 0.51412417, -0.59633053, 0.71741391, 0.79324606, -0.14084019, -0.24975723, 0.87418984, 0.11675874, -0.76452367, 0.33141206, 0.18592844, -1.07480724, 0.6472541, -1.48832534, -0.38231212, -0.25332417, -0.25638358, 0.68149747, 0.54311154, 2.01129709, -1.43876073, 0.53272536]);
  const b2 = new Float64Array([0.45261435, -0.58040696, 0.43784002, -0.13910446, -0.04917782, -1.18926154, -0.07066224, -0.07420014, -0.24871637, -0.40754841, -0.17683533, 0.12829796, -0.21241861, 0.12076317, -0.53071385, -0.73627336]);
  const W3 = new Float64Array([0.28760016, -0.65285029, 0.17789713, -0.37839225, -0.49782331, 0.20575594, -0.57984674, -0.06839554, -0.56013671, 1.4471775, 0.32217413, 0.26936003, 0.20922666, 0.85309594, 0.82658278, 0.15407085, 0.66951093, 0.5982665, 0.11036723, -0.05378329, -0.14516461, 0.6068251, 0.3924409, -0.27878296, -0.0267743, 0.42463176, 0.10916228, 0.31222802, 0.01673425, 0.39181743, 0.14771481, -0.15766715, -0.15471667, -0.03070172, 0.03738149, 0.30431959, -0.35748545, 0.26403693, -0.00691465, 0.18535786, -0.61252353, -0.10790325, -0.07356613, -0.34770727, 0.47243495, -0.1431949, -0.24873549, 0.88625045, -0.330639, 0.19223645, -0.04578304, -0.18134003, -0.20291801, 0.06774271, -0.09382678, -0.13392066, -0.20538409, 0.21255898, -0.19718467, 0.16805043, -0.07026935, 0.0300879, -0.49981019, 0.45200394, 0.80342781, 0.73019016, 0.21863719, -0.45671054, -0.51988824, 0.53328331, -0.41895041, -0.74322876, -0.08556457, 0.56082165, 0.03300213, 0.99750375, -0.23713926, 0.48294345, 0.72406865, 1.83102798]);
  const b3 = new Float64Array([0.15357762, -0.05741838, 0.28322824, 0.31032363, 0.52176329]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-2"; }
function type(){ return Type.NORMAL; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.43790552, 0.28667445, 0.29146866, -0.10083556, -0.10943076, -0.28717854, 0.34111587, 0.10557079, 0.55717376, -5.61994379, -0.27722839, 0.36063351, 0.0718853, 0.45636362, 0.40585164, 0.16047504, -0.23512074, 0.14881862, -0.33329282, 0.0648078, 0.29152137, 0.64120843, -0.05480317, -0.14874023, -0.40090724, -0.35002197, 0.3091271, 0.4051397, 0.85064322, -0.22651637, -0.16105264, 0.7006894, -0.28201989, 0.48340796, -0.23235781, -0.26979255, 0.43403731, 0.64313606, 0.96556927, 0.03570268, -0.15051028, 0.39582946, -0.22895588, 0.61818475, 0.40916528, -0.69208004, 0.4571102, 0.1735228, 1.07139671, -0.00031113, -0.33939067, 1.32194154, -1.74826511, -1.36365094, 0.25472051, 0.38659474, 0.35009458, -1.19683509, 1.00852354, 0.46808125, -0.52390067, -0.51198914, 1.72981892, 1.55383002, 0.44710828, 0.44927636, 0.90969231, -1.58195574, 1.07800668, -0.66734118, -0.48763575, 7.40851416, 0.54088755, 1.31914028, 0.64460509, 1.45555297, 4.97408468, 0.7954445, 1.2141104, 0.44066381, -0.39116369, 1.92661508, 0.39178036, -0.26493241, -0.00877638, -0.54047246, 0.43857311, 0.2628301, 0.28038817, -0.08991614, 0.00562096, 0.07909606, -0.33394848, 0.81173666, -0.99119724, -2.40418836, 0.20683362, 0.57010329, 0.50706288, 0.04475721, -1.6923782, 0.44234895, 0.28192312, -0.41569071, -0.40097114, -0.21270939, -1.48213758, -1.35673722, 0.64426118, 0.62463704, 1.62307793, 1.55368966, -0.52942548, 1.01280246, 0.46965761, 0.59909363, 0.57445636, -0.58310112, -0.35849256, -0.5103396, 0.97573035, 0.12385534, 0.42429294, -0.17578239, 0.15137795, 0.05255061, 0.21706019, -0.133915, 0.78614439, -0.36118624, 0.01983596, -0.4719965, -0.53748171, -0.06507518, -0.84473667, -0.21252155, 0.01425524, -0.2332369, 0.45602945, -0.0017205, -0.9220035, -0.86182999, 0.46711704, -0.22868938, -0.3984326, -0.56002579, 0.93126113, -0.76314673, -0.13618089, 1.6050381, 0.55343064, -1.25071673, 0.18836974, 1.05970012, -0.58777365, -0.42381295, -0.01989542, 1.21581512, -0.09301666, 0.57711358, 0.06524754, -0.93012569, -0.60666752, 0.03643859, -0.33341537, 0.06469217, -0.85885903, 0.12184405, -0.70331632, -0.35838915, 0.99211349, -0.11757183, 0.08672163, 0.47150356, 0.22588279, 0.56287101, 0.06258171, -0.14941481, -0.02253153, 0.1529853, -0.02648026, -4.14536007, 0.58905402, 0.58733332, -0.24634963, 0.26527182, -0.07549294, -0.08199109, -0.26349965, -0.50722975, 0.23642582, 0.52952442, -1.05311519, 0.77329085, -0.09639001, 0.29902959, 0.74671193, -0.1438305, -0.82805139, 0.74975143, 0.62837672, -0.02263945, 0.44817443, -0.01960781, -0.27410757, 0.58861762, 0.52108862, -0.34019261, 0.50618758, -0.33906053, 0.29810917, -1.06793901, 0.29261285, 0.49198256, 0.20554799, -1.13114923, -0.04443075, -0.71076359, 0.08113087, -0.58061603, 0.59296573, -0.3429898, 0.44819549, 1.59346377, -2.61945133, 0.0115471, -0.09130324, 1.55775826, 1.21915834, 0.01826581, -0.60943431, 0.55488353, 0.41412301, -0.18633928, -0.11519492, 0.14395246, -0.274614, 0.31022997, -0.88624122, -0.76087041, 0.84386313, -0.48345321, 0.53104081, 0.57218027, -2.55074843, -0.56367925, 0.05213854, -0.18528107, 1.71648284, -0.82593726, -0.52529301, -0.06369078, -1.29506084, 0.79300664, 0.52014037, -0.65330576, -0.37278706, -0.1183534, -0.30385234, 0.10153757, 0.50390224, 0.18589201, 0.1572268, 0.37320647, -0.24873547, 0.48522964, 0.61427802, -0.58838985, 1.27024363, 0.33047243, -0.88564803, -0.23824035, 0.9698733, -0.59554315, -0.63276144, 0.62563084, 0.67460072, -0.26991931, -0.42178144, -0.58483235, -0.07731733, 0.32731518, 0.38657588, -1.0380873, -0.04714119, 0.26012602, 1.85201329, 0.01056569, 0.37896189, -0.92339511, 1.60935713, 0.3519358, 1.01701588, 0.41334551, -0.8229241, 0.7446023, 0.19826225, 0.01837637, -0.18924691, -0.22272479, 0.39300219, -0.16064378, -0.01502117, 0.06694503, -0.21591942, -0.44848074, -0.57665888, -0.75902568, -0.18684585, 1.75812951, 2.52716162, 0.04624047, 0.08341713, -0.35477066, -0.79106952, 0.57576331, 0.32384616, 0.22890642, 0.11154918, 0.99016834, 0.27619942, 1.82128783, -1.1147363, -0.1514259, 0.49815359, 0.63262197, -0.85261822, -0.24408185, 0.04092865, -0.40898409, 0.2187659, 0.5939429, 0.25120273, 0.04767159, 0.61222427, -0.22889286, 0.15874019, 0.06538034, 1.04925303, 0.0977568, -1.03568249, -0.79114084, -0.67013313, -0.43621703, -0.45010369, 0.32875039, 0.50793556, -0.25741618, -0.45254671, -0.53803813, 0.16362462, -0.14334803, -0.19935954, -6.5311422, -0.02943762, -0.16420222, -0.10827991, 0.1547662, 1.04737688, -0.27820864, 0.04903922, 0.5033388, 0.63484467, 0.06518909, 1.4467137, 0.99559152, 0.0637428, -0.41627302, -0.52783621, -0.97442636, 0.41868684, 0.19327585, -0.08633218, -0.16769813, -0.02152273, 1.12148376, -0.24177989, -0.21112556, -0.55037804, 0.10022064, 0.32302101, 0.04755423, 0.04394149, -0.07573192, 0.23004496, 0.52188947, 0.47779696, -1.09222283, 0.05517106, -0.47166323, -0.30100395, -0.87782714, -0.63097463, -0.10320982, 0.19983009, -0.83486804, 0.76870876, -0.41389931, -0.95068899, -0.46939508, 0.11882143, 0.18213007, -0.85742938, -0.95910751, 0.01303034, 0.50021041, 0.21806978, -1.35411049, 0.33796412, 0.11304469, -0.27159458, 0.27671941, -0.63896321, -0.85718552, -0.10484049, 0.47597432, 0.66795252, 0.23523047, -0.32766585, -0.71392922, 0.32901856, -0.72913046, -0.32441547, 0.13735976, 0.28795793, -0.20754993, -0.41433265, 0.44773699, 0.12536568, -0.01509058, 0.19212788, 0.04281058, 0.33889086, -0.14777078, -0.66142111, -0.13231776, -0.88677939, -0.78521909, 0.33272822, 2.79950883, -0.72876622, -0.70469221, 0.14997329, -0.57367741, -0.32259341, -0.76819714, 0.75968589, 0.65307013, 0.07837013, -0.24464961, 0.75713633, -0.63777248, -0.09309103, -0.06051813, -0.12197373, 0.18103338, -0.32278231, -0.82417426, 0.15852481, -0.78133597, -0.45692952, 0.40125851, -0.66136018, -0.10561747, 0.40668301, -0.51587459, 0.57578647, -1.1929422, 0.21366893, 0.23895185, 0.13499196, 0.19411319, 0.07774001, 1.46468836, 0.04176726, 0.20548891, -0.58304135, 0.20610866, 1.37245001, 0.0715244, 0.60900116, -1.53037955, 1.42275085, -0.08166345, -0.26229319, 2.29872619, -0.09309751, 0.56090344, 0.42332203, 0.26195289, -0.43361581, 0.06926367, -0.02695036, -1.53261339, 0.81738667, 0.50243947, -1.26820652, -0.98084869, -0.53507638, 0.75451162, -0.33540848, -1.36245481, -1.60953541, -0.08722931, 0.30229661, -0.24172879, 0.38882719, -1.60314125, 0.62924454, 0.06807803, -0.15915038, -0.15915185, -0.41984272, 0.42976239, -0.03614878, 0.43237035, 0.02648312, -0.20609888, -0.09494591, -0.38808155, -0.19664323, -0.18316339, 0.55482654, -0.68394016, 2.24564119, -1.80847715, -0.47006498, -0.31210835, 0.51521929, -0.43384669, -0.76040579, -0.33059709, -0.15571589, -0.55749422, 0.13874144, 0.070883, -1.9380512, -0.57284265, 1.31700903, -2.15368892, 0.61544529, 0.36736054, -0.04128216, 0.0525769, 0.49134459, -0.31473704, 0.04358571, 0.09602795, -2.47298023, 0.83663427, 0.12020037, 0.60157181, 0.12494483, -2.54425341, -0.07002261, 0.4801155, 0.33224919, -0.08470422, -1.09316177, -0.04707545, 0.18678039, -0.05895869, 0.05456543, 0.05315762, -0.38052479, -0.11328626, 0.45199996, 0.10382705, 1.99747534, -0.19385167, -1.08943956, 0.16894069, -0.86439847, -0.58266749, -0.49794542, -0.56735153, -0.08085438, -0.62715865, -1.23537351, 0.78216862, -0.36249201, -1.08253244, 0.12590188, -0.2981104, 0.34463625, -0.80850699, -0.75057165, 0.89106056, 0.14711991, 0.43040693, 0.24400467, -0.28825202, 0.52935872, 0.55507687, 0.22138433, 0.24365673, -0.23308503, -0.07489313, 0.27984791, -0.45942712, 0.37620399, -0.24140955, 0.62330793, 0.77921792, 0.71123988, 0.02079538, -0.52510845, 0.32942113, 0.1607535, 0.96151555, -0.16079034, -1.93859221, -0.36190573, -0.19783436, 0.64001555, -0.11982791, 0.37611482, 0.78146002, -0.29536282, -0.291881, -0.1050257, 0.79742206, -0.17266075, -0.88210515, 0.71315302, 0.10720733, -0.15652838, -0.49973341, -0.45632669, 0.16452009, 2.48697164, 1.11017542, 0.47732019, -0.08347426, 2.54925165, 0.95313778, 0.79396991, 0.67585751, -0.20691878, 1.10924548, 0.55181554, -0.75626899, 0.69224745, -0.10301377, 0.60962182, -0.79353267, -0.04272982, 0.2881041, -0.27729901, -0.44808305, -0.16943179, -0.37507713, -0.19335074, -0.00148306, 3.19323577, 0.1035666, -0.57338948, 0.52968303, 0.32556781, -0.15723568, -0.12659113, 0.12663175, 0.09059224, 0.11972124, -0.07987135, 0.19573581, 1.66614221, -0.02746732, 0.01809177, 0.9322043, 0.23503757, -0.21352856, -0.54890718, -0.38095916, 0.54091449, -0.34022734, 0.72674154, 0.64074993, -0.76762368, -0.04648122, -0.29888653, -0.31396683, -0.18739208, 0.53936865, -0.41735965, -0.1562445, -0.2633629, -0.48597415, -0.08265106, -0.27398756, 0.01136865, 0.1887991, -0.06646916, 0.41479363, -0.09480974, -0.63911342, 2.50579508, 0.71400369, -0.11481813, 0.05201703, -0.11187266, -0.09966212, -0.55138482, -0.10820827, -1.15806636, -0.64752434, -0.86332061, -0.19997056, -2.14528927, -2.87757969, 0.7424284, -0.24504957, 1.32902126, -1.93770945, -0.61731616, 0.25588802, -1.34319156, 4.27656895, 1.87244775, -0.08158902, -0.3864889, -1.17278103, 0.52114927, -0.19224884, 0.10702464, 0.21013826, -0.61004765, -0.40792327, 0.57599278, -0.0397493, -0.41217899, 0.92912994, -0.23223925, 0.08743698, 0.46663486, 0.56753572, 0.32071805, -0.21116781, 0.40453932, -1.02160473, -1.84046832, -1.00500846, 0.60869917, 0.54639748, 0.26393022, -0.02675387, -0.32765293, -0.58487253, -0.79630644, -0.02546589, -0.66765198, -0.4398617, -0.35442079, -0.31269691, 0.0557983, -0.35000629, -0.48865672, 0.19870154, 0.5036284, 0.03823856, 0.99535683, -0.73840532, -0.59068848, -0.31840297, -0.0383206, 0.43449538, -0.02495137, -0.22737291, 0.67246412, -0.0403685, 0.63442454, -0.14994881, 0.03197217, 0.81119842, 1.60716682, 0.7331085, 0.21922967, 0.41034227, 0.34342446, 0.76305537, 0.42669919, 0.3550817, -1.06769092, -0.30641643, -1.34493604, -0.40432105, 0.05680819, -1.51733025, 0.72987137, 0.04370459, -0.0010694, -0.65229962, 0.21843868, 0.97331664, -3.29918687, -3.24643764, 0.29392696, 0.33741948, -1.37560109, -0.16699405, 0.27196616, -0.58381965, 1.81667367, 1.75141047, 1.97774891, 0.1396678, 1.58182969, 0.75116523, -0.61174129, 1.01652231, 0.85792504, 0.39826911, -0.8885599, -1.30460266, 0.14052694, 0.40016586, 0.73007537, 0.03082803, 0.0396427, -0.69563624, -0.03033443, -0.54946731, -0.6848278, -0.25859658, 0.14599258, -0.03088124, -0.13220514, -1.68072428, -0.09271895, -0.6630331, 0.33079586, 0.53328276, -0.64429227, 0.25992795, 1.29739499, -0.44481283, -0.76556351, -0.56668475, 2.47334204, -0.62998962, 0.65989463, 0.66443107, 0.98572862, 1.16980806, -0.35108564, 1.3472356, 5.94033877, 0.30974987, -0.83999408, 1.02026831, -0.15030077, 1.7298327, 0.32290212, 0.95685008, 2.61298772, 1.25082845, 0.80658685, -0.06049918, 0.00472654, 0.52354259, 0.31825409, 0.68213935, -0.05298223, 0.43634643, 0.3128813, -1.14961688, -0.25263141, 0.17612209, -0.78700307, -1.19793967, -0.0570563, 0.39552643, 0.25223549, 0.85410401, 0.04226136, 0.7672748, -0.81128183, 0.34537788, -0.08369965, -0.08769349, 1.60136065, 0.68536087, 0.86071233, 0.37937505, -1.62376555, 0.46391922, 0.03859705, 0.20528158, -1.69123894, -1.41628122, -0.13261515, -0.5322042, -0.07635726, -0.3460316, -1.44325928, 0.37801554, -0.1965497, -0.59632468, -1.10459054, -0.02814148, 0.63280748, -0.48001112, -0.27577878, -0.74510699, -0.17404939, 0.0409552, -0.31708707, 0.20400628, -0.19372669, 0.2039152, -0.87461198, 0.01023884, -3.18606041, -0.10653382, 0.35766341, -0.13387789, -0.4777505, 0.30275907, 0.23928922, 0.42820351, -0.34367539, -0.56442334, -0.671005, -0.493529, 0.08647177, -0.03925029, 0.06683962, 1.38893815, 0.05073875, -0.87379694, 0.77262228, -0.14076952, -0.00650348, -0.39342401, 0.2909445, -0.09741293, 0.24100898, -0.58485485, 0.40464968, 0.2530926, 0.21718034, 0.3653357, -0.63079716, 0.09079719, 0.59786396, 0.28176903, 0.91078974, -0.50806508, 0.17058284, 0.66246559, 0.52250169, 0.77092678, 1.67037803, -0.3148234, -0.62721196, 3.1307736, -0.23737039, -0.25403343, 0.26959777, -0.08163353, -0.84077738, 0.77060027, -1.08085227, 0.62796409, -0.47726477, 0.84447749, -1.54525213, -0.07011557, 0.53000478, 0.03092981, 0.42095566, 0.45938867, -0.45169126, 0.56525877, -0.40021603, 1.595647, 0.42221703, 0.56547121, 0.11456523, -0.61567926, 2.05573337, 0.25747906, 0.07542924, 0.46609067, -0.62387698, 0.6761681, 0.50903264, 0.28322544, -0.75403803, 0.21051104, -0.39142604, 0.78154273, -0.51775019, 0.01510606, 1.23920286, 0.77384772, 0.57167831, 0.18109808, -0.45302109, -0.86129097, -0.7482826, 0.07389122, -0.76530534, -0.33736896, 0.19241592, -0.47162977, -0.20982558, -0.67358201, 0.58463259, 0.24785388, -1.84949452, 0.11330084, -0.8019222, 1.50373494, -1.1112966, -0.5712871, 0.63816383, -2.36288388, -1.32599372, -0.3562986, 0.81400162, -0.68727144, -1.05544968, -1.57924127, 0.14167307, -0.59285951, -0.39955664, -0.30652663, -0.84222451, 0.15224943, 0.58428033, 0.34091398]);
  const b1 = new Float64Array([-0.38756922, -0.01529645, -0.55953228, 0.07328275, 0.3129152, 0.06458981, 0.32244239, -0.21778243, -0.84407298, -0.81866391, -0.14618679, 0.65203703, 0.22879418, -0.45532186, 0.76164877, -0.314204, -0.24818741, -0.53805022, -0.10354619, 0.21180893, 0.33213273, -0.29319018, 0.55788904, 0.4333498]);
  const W2 = new Float64Array([0.09408662, -0.3336107, 0.36611701, -0.11292449, -0.59773382, 0.10727941, -0.04072949, -0.55377516, 1.25220999, -0.31683503, -0.41767058, 0.58706581, -0.67541487, -0.95871286, 0.20463733, -1.01013991, -0.03276556, 0.59471819, -0.27019869, 0.09009908, 1.46542189, -0.22811529, -1.09586614, 0.96074048, 1.34545145, -0.1814754, 1.41500774, -0.24100818, 0.44782941, 1.16077169, -0.00972746, -0.46052183, -0.4810369, 0.71366344, -0.08967912, 0.4997682, 0.51976109, 0.69577377, 0.60622204, -0.65142191, -0.00241908, -0.54516251, 1.15591911, -0.47086452, 0.13457477, -0.12023731, 0.23095488, 1.41638319, 0.50639571, -0.17441286, 0.05495283, -1.19395757, -0.93771248, 0.44948852, -0.28754033, -1.06089319, -0.27942543, 0.01618807, -0.79634621, 0.98867083, -0.32474711, -0.2105568, -0.44205541, 0.1932159, 0.00407995, 0.49608229, -0.94538508, 0.71060845, 1.12277356, -0.35115785, -0.2035635, 1.57852399, -1.14811154, 0.16596729, 0.06889257, -0.41457082, -0.62527615, -0.02929614, 0.2690992, 1.09394444, -2.44932213, -0.09026784, -0.59504263, 0.48833538, -0.55208794, 0.65296831, -0.96156054, 0.51376285, -0.79230113, -0.44862232, 0.55084261, -0.01900226, -0.64967349, -0.16581617, 0.6975699, -0.51454857, -0.77123349, -0.08645361, -0.70749965, 0.18384816, -0.03472589, 0.91085324, -0.65609358, -0.86726516, 0.54576814, 0.24076681, -0.30840465, -0.5313792, 0.07682758, 0.76773534, 0.40358264, 0.27678244, 0.43462538, -1.03705345, 0.49026133, 0.01224966, 0.00974685, -0.66897054, 0.58847769, 0.49725306, 1.97786822, -0.65206801, -0.64586137, 0.12449402, 1.42084643, 1.08103177, -0.22622629, -0.07062538, 1.2315496, 0.08385384, -0.12809868, -0.46131045, 0.43899598, -0.68583177, -0.33213774, -0.81493566, 0.29286754, 0.27728822, -0.25053776, 0.41568725, 0.26782578, 0.31836444, -0.05486111, 0.05135012, 0.65099938, 0.48524417, -0.82651902, -0.13002597, 0.12020949, -1.49604353, 0.75119153, 0.55629104, 0.61860948, 0.5967996, 0.05401974, -1.36556147, 0.75489861, 0.53426738, -0.02746313, 1.42202116, 0.03970474, -0.66756951, -0.36067738, 0.91961792, -0.64077952, -0.79467445, 0.15859935, -0.33707813, 0.02555191, 0.47034752, -0.13964864, 0.84173122, 0.19963754, 0.72483867, -1.34620363, 0.30371552, -0.19587663, 0.31317233, -0.02417105, 0.76240676, 0.83051728, 0.54055567, 0.10106575, 0.52938981, 0.6412371, -0.00061729, -0.11836649, 0.25773459, -1.25443998, 0.45158464, -0.40685816, 0.10939157, -0.23629962, 0.4190113, 0.0151415, 1.65716366, 0.07956642, 0.02683256, -0.22190233, -0.52132491, 0.63351318, 0.54048019, 0.83168563, 0.0931095, 0.14586689, 0.87839571, 0.95732508, 0.07977731, -0.53589549, -0.52639608, 0.76511015, -1.04188714, 0.19347787, 0.22468825, 0.08811923, 0.08738243, -0.08969664, -0.11254295, -0.24766247, -0.2403831, -0.98462404, -1.11993064, 0.30585383, 0.03042275, 0.05862472, -0.33229928, 0.7199741, 0.62506505, 0.25443103, -0.30632027, 0.13891787, 1.26218249, 1.49375002, -0.47224676, -1.28802186, 1.21731295, -0.38098078, -0.20141237, 0.0993211, 0.58353299, 0.02704011, 0.51091819, 0.07117388, -0.01827415, -0.89567564, 0.41927815, -1.39582026, -0.1481669, 0.38432581, 0.57463461, 0.51060598, 0.17994721, 1.4035534, -0.25579197, -0.15656692, -0.49755301, 0.38289493, -0.65186062, 0.27202096, -0.43770286, -0.07496871, 0.24509695, 0.06285006, 0.80449349, 0.19586276, -0.20705442, -0.34880283, 0.16164587, -1.03384473, -0.35670064, 0.32451549, -0.01814135, -0.23833017, 0.14274742, 0.61819362, -0.33721972, -0.15776996, 0.52879497, 0.29705423, 0.14802691, -0.78058979, -0.82254937, -1.01415181, 0.35889543, 0.35376524, 0.28031242, -1.01927209, 0.01748123, 0.77965917, -1.70447032, 0.7109695, -0.2395605, -0.36057536, 0.89973435, -0.3373749, 0.68793303, 0.64306384, -0.39516895, -0.1502043, 0.3654599, -0.17567938, 0.18945543, -0.33888844, -0.55621169, -0.36094855, 0.11007959, 0.14841333, -1.14239413, 0.09839317, 0.15199876, -0.23190643, 0.83805994, -0.49730437, 0.29072051, 0.79214225, 0.14200635, 0.41466407, -0.09274874, -0.18816325, 0.33851638, -0.28400497, -0.61016419, 0.27116654, 0.42679709, -0.62641292, -0.06665195, 0.40810253, 0.26042455, 0.21158194, -0.31835846, 0.12977399, -0.81425096, 0.54051362, -0.6414509, 0.6629502, -0.33285372, 0.38625296, 0.96645365, -0.11185877, -0.23181832, 0.19703774, -0.83886375, 0.31942274, -0.44780846, -0.15595656, -0.38674412, -0.4624189, 0.33090536, 0.27492663, -1.14101775, 0.63248367, -0.87532827, -1.32275133, 0.01978741, -0.14671085, -1.05521662, 0.40408981, -0.02338397, -0.13490036, -0.04447539, 1.74174271, -0.02188144, 0.51412417, -0.59633053, 0.71741391, 0.79324606, -0.14084019, -0.24975723, 0.87418984, 0.11675874, -0.76452367, 0.33141206, 0.18592844, -1.07480724, 0.6472541, -1.48832534, -0.38231212, -0.25332417, -0.25638358, 0.68149747, 0.54311154, 2.01129709, -1.43876073, 0.53272536]);
  const b2 = new Float64Array([0.45261435, -0.58040696, 0.43784002, -0.13910446, -0.04917782, -1.18926154, -0.07066224, -0.07420014, -0.24871637, -0.40754841, -0.17683533, 0.12829796, -0.21241861, 0.12076317, -0.53071385, -0.73627336]);
  const W3 = new Float64Array([0.28760016, -0.65285029, 0.17789713, -0.37839225, -0.49782331, 0.20575594, -0.57984674, -0.06839554, -0.56013671, 1.4471775, 0.32217413, 0.26936003, 0.20922666, 0.85309594, 0.82658278, 0.15407085, 0.66951093, 0.5982665, 0.11036723, -0.05378329, -0.14516461, 0.6068251, 0.3924409, -0.27878296, -0.0267743, 0.42463176, 0.10916228, 0.31222802, 0.01673425, 0.39181743, 0.14771481, -0.15766715, -0.15471667, -0.03070172, 0.03738149, 0.30431959, -0.35748545, 0.26403693, -0.00691465, 0.18535786, -0.61252353, -0.10790325, -0.07356613, -0.34770727, 0.47243495, -0.1431949, -0.24873549, 0.88625045, -0.330639, 0.19223645, -0.04578304, -0.18134003, -0.20291801, 0.06774271, -0.09382678, -0.13392066, -0.20538409, 0.21255898, -0.19718467, 0.16805043, -0.07026935, 0.0300879, -0.49981019, 0.45200394, 0.80342781, 0.73019016, 0.21863719, -0.45671054, -0.51988824, 0.53328331, -0.41895041, -0.74322876, -0.08556457, 0.56082165, 0.03300213, 0.99750375, -0.23713926, 0.48294345, 0.72406865, 1.83102798]);
  const b3 = new Float64Array([0.15357762, -0.05741838, 0.28322824, 0.31032363, 0.52176329]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-3"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.43790552, 0.28667445, 0.29146866, -0.10083556, -0.10943076, -0.28717854, 0.34111587, 0.10557079, 0.55717376, -5.61994379, -0.27722839, 0.36063351, 0.0718853, 0.45636362, 0.40585164, 0.16047504, -0.23512074, 0.14881862, -0.33329282, 0.0648078, 0.29152137, 0.64120843, -0.05480317, -0.14874023, -0.40090724, -0.35002197, 0.3091271, 0.4051397, 0.85064322, -0.22651637, -0.16105264, 0.7006894, -0.28201989, 0.48340796, -0.23235781, -0.26979255, 0.43403731, 0.64313606, 0.96556927, 0.03570268, -0.15051028, 0.39582946, -0.22895588, 0.61818475, 0.40916528, -0.69208004, 0.4571102, 0.1735228, 1.07139671, -0.00031113, -0.33939067, 1.32194154, -1.74826511, -1.36365094, 0.25472051, 0.38659474, 0.35009458, -1.19683509, 1.00852354, 0.46808125, -0.52390067, -0.51198914, 1.72981892, 1.55383002, 0.44710828, 0.44927636, 0.90969231, -1.58195574, 1.07800668, -0.66734118, -0.48763575, 7.40851416, 0.54088755, 1.31914028, 0.64460509, 1.45555297, 4.97408468, 0.7954445, 1.2141104, 0.44066381, -0.39116369, 1.92661508, 0.39178036, -0.26493241, -0.00877638, -0.54047246, 0.43857311, 0.2628301, 0.28038817, -0.08991614, 0.00562096, 0.07909606, -0.33394848, 0.81173666, -0.99119724, -2.40418836, 0.20683362, 0.57010329, 0.50706288, 0.04475721, -1.6923782, 0.44234895, 0.28192312, -0.41569071, -0.40097114, -0.21270939, -1.48213758, -1.35673722, 0.64426118, 0.62463704, 1.62307793, 1.55368966, -0.52942548, 1.01280246, 0.46965761, 0.59909363, 0.57445636, -0.58310112, -0.35849256, -0.5103396, 0.97573035, 0.12385534, 0.42429294, -0.17578239, 0.15137795, 0.05255061, 0.21706019, -0.133915, 0.78614439, -0.36118624, 0.01983596, -0.4719965, -0.53748171, -0.06507518, -0.84473667, -0.21252155, 0.01425524, -0.2332369, 0.45602945, -0.0017205, -0.9220035, -0.86182999, 0.46711704, -0.22868938, -0.3984326, -0.56002579, 0.93126113, -0.76314673, -0.13618089, 1.6050381, 0.55343064, -1.25071673, 0.18836974, 1.05970012, -0.58777365, -0.42381295, -0.01989542, 1.21581512, -0.09301666, 0.57711358, 0.06524754, -0.93012569, -0.60666752, 0.03643859, -0.33341537, 0.06469217, -0.85885903, 0.12184405, -0.70331632, -0.35838915, 0.99211349, -0.11757183, 0.08672163, 0.47150356, 0.22588279, 0.56287101, 0.06258171, -0.14941481, -0.02253153, 0.1529853, -0.02648026, -4.14536007, 0.58905402, 0.58733332, -0.24634963, 0.26527182, -0.07549294, -0.08199109, -0.26349965, -0.50722975, 0.23642582, 0.52952442, -1.05311519, 0.77329085, -0.09639001, 0.29902959, 0.74671193, -0.1438305, -0.82805139, 0.74975143, 0.62837672, -0.02263945, 0.44817443, -0.01960781, -0.27410757, 0.58861762, 0.52108862, -0.34019261, 0.50618758, -0.33906053, 0.29810917, -1.06793901, 0.29261285, 0.49198256, 0.20554799, -1.13114923, -0.04443075, -0.71076359, 0.08113087, -0.58061603, 0.59296573, -0.3429898, 0.44819549, 1.59346377, -2.61945133, 0.0115471, -0.09130324, 1.55775826, 1.21915834, 0.01826581, -0.60943431, 0.55488353, 0.41412301, -0.18633928, -0.11519492, 0.14395246, -0.274614, 0.31022997, -0.88624122, -0.76087041, 0.84386313, -0.48345321, 0.53104081, 0.57218027, -2.55074843, -0.56367925, 0.05213854, -0.18528107, 1.71648284, -0.82593726, -0.52529301, -0.06369078, -1.29506084, 0.79300664, 0.52014037, -0.65330576, -0.37278706, -0.1183534, -0.30385234, 0.10153757, 0.50390224, 0.18589201, 0.1572268, 0.37320647, -0.24873547, 0.48522964, 0.61427802, -0.58838985, 1.27024363, 0.33047243, -0.88564803, -0.23824035, 0.9698733, -0.59554315, -0.63276144, 0.62563084, 0.67460072, -0.26991931, -0.42178144, -0.58483235, -0.07731733, 0.32731518, 0.38657588, -1.0380873, -0.04714119, 0.26012602, 1.85201329, 0.01056569, 0.37896189, -0.92339511, 1.60935713, 0.3519358, 1.01701588, 0.41334551, -0.8229241, 0.7446023, 0.19826225, 0.01837637, -0.18924691, -0.22272479, 0.39300219, -0.16064378, -0.01502117, 0.06694503, -0.21591942, -0.44848074, -0.57665888, -0.75902568, -0.18684585, 1.75812951, 2.52716162, 0.04624047, 0.08341713, -0.35477066, -0.79106952, 0.57576331, 0.32384616, 0.22890642, 0.11154918, 0.99016834, 0.27619942, 1.82128783, -1.1147363, -0.1514259, 0.49815359, 0.63262197, -0.85261822, -0.24408185, 0.04092865, -0.40898409, 0.2187659, 0.5939429, 0.25120273, 0.04767159, 0.61222427, -0.22889286, 0.15874019, 0.06538034, 1.04925303, 0.0977568, -1.03568249, -0.79114084, -0.67013313, -0.43621703, -0.45010369, 0.32875039, 0.50793556, -0.25741618, -0.45254671, -0.53803813, 0.16362462, -0.14334803, -0.19935954, -6.5311422, -0.02943762, -0.16420222, -0.10827991, 0.1547662, 1.04737688, -0.27820864, 0.04903922, 0.5033388, 0.63484467, 0.06518909, 1.4467137, 0.99559152, 0.0637428, -0.41627302, -0.52783621, -0.97442636, 0.41868684, 0.19327585, -0.08633218, -0.16769813, -0.02152273, 1.12148376, -0.24177989, -0.21112556, -0.55037804, 0.10022064, 0.32302101, 0.04755423, 0.04394149, -0.07573192, 0.23004496, 0.52188947, 0.47779696, -1.09222283, 0.05517106, -0.47166323, -0.30100395, -0.87782714, -0.63097463, -0.10320982, 0.19983009, -0.83486804, 0.76870876, -0.41389931, -0.95068899, -0.46939508, 0.11882143, 0.18213007, -0.85742938, -0.95910751, 0.01303034, 0.50021041, 0.21806978, -1.35411049, 0.33796412, 0.11304469, -0.27159458, 0.27671941, -0.63896321, -0.85718552, -0.10484049, 0.47597432, 0.66795252, 0.23523047, -0.32766585, -0.71392922, 0.32901856, -0.72913046, -0.32441547, 0.13735976, 0.28795793, -0.20754993, -0.41433265, 0.44773699, 0.12536568, -0.01509058, 0.19212788, 0.04281058, 0.33889086, -0.14777078, -0.66142111, -0.13231776, -0.88677939, -0.78521909, 0.33272822, 2.79950883, -0.72876622, -0.70469221, 0.14997329, -0.57367741, -0.32259341, -0.76819714, 0.75968589, 0.65307013, 0.07837013, -0.24464961, 0.75713633, -0.63777248, -0.09309103, -0.06051813, -0.12197373, 0.18103338, -0.32278231, -0.82417426, 0.15852481, -0.78133597, -0.45692952, 0.40125851, -0.66136018, -0.10561747, 0.40668301, -0.51587459, 0.57578647, -1.1929422, 0.21366893, 0.23895185, 0.13499196, 0.19411319, 0.07774001, 1.46468836, 0.04176726, 0.20548891, -0.58304135, 0.20610866, 1.37245001, 0.0715244, 0.60900116, -1.53037955, 1.42275085, -0.08166345, -0.26229319, 2.29872619, -0.09309751, 0.56090344, 0.42332203, 0.26195289, -0.43361581, 0.06926367, -0.02695036, -1.53261339, 0.81738667, 0.50243947, -1.26820652, -0.98084869, -0.53507638, 0.75451162, -0.33540848, -1.36245481, -1.60953541, -0.08722931, 0.30229661, -0.24172879, 0.38882719, -1.60314125, 0.62924454, 0.06807803, -0.15915038, -0.15915185, -0.41984272, 0.42976239, -0.03614878, 0.43237035, 0.02648312, -0.20609888, -0.09494591, -0.38808155, -0.19664323, -0.18316339, 0.55482654, -0.68394016, 2.24564119, -1.80847715, -0.47006498, -0.31210835, 0.51521929, -0.43384669, -0.76040579, -0.33059709, -0.15571589, -0.55749422, 0.13874144, 0.070883, -1.9380512, -0.57284265, 1.31700903, -2.15368892, 0.61544529, 0.36736054, -0.04128216, 0.0525769, 0.49134459, -0.31473704, 0.04358571, 0.09602795, -2.47298023, 0.83663427, 0.12020037, 0.60157181, 0.12494483, -2.54425341, -0.07002261, 0.4801155, 0.33224919, -0.08470422, -1.09316177, -0.04707545, 0.18678039, -0.05895869, 0.05456543, 0.05315762, -0.38052479, -0.11328626, 0.45199996, 0.10382705, 1.99747534, -0.19385167, -1.08943956, 0.16894069, -0.86439847, -0.58266749, -0.49794542, -0.56735153, -0.08085438, -0.62715865, -1.23537351, 0.78216862, -0.36249201, -1.08253244, 0.12590188, -0.2981104, 0.34463625, -0.80850699, -0.75057165, 0.89106056, 0.14711991, 0.43040693, 0.24400467, -0.28825202, 0.52935872, 0.55507687, 0.22138433, 0.24365673, -0.23308503, -0.07489313, 0.27984791, -0.45942712, 0.37620399, -0.24140955, 0.62330793, 0.77921792, 0.71123988, 0.02079538, -0.52510845, 0.32942113, 0.1607535, 0.96151555, -0.16079034, -1.93859221, -0.36190573, -0.19783436, 0.64001555, -0.11982791, 0.37611482, 0.78146002, -0.29536282, -0.291881, -0.1050257, 0.79742206, -0.17266075, -0.88210515, 0.71315302, 0.10720733, -0.15652838, -0.49973341, -0.45632669, 0.16452009, 2.48697164, 1.11017542, 0.47732019, -0.08347426, 2.54925165, 0.95313778, 0.79396991, 0.67585751, -0.20691878, 1.10924548, 0.55181554, -0.75626899, 0.69224745, -0.10301377, 0.60962182, -0.79353267, -0.04272982, 0.2881041, -0.27729901, -0.44808305, -0.16943179, -0.37507713, -0.19335074, -0.00148306, 3.19323577, 0.1035666, -0.57338948, 0.52968303, 0.32556781, -0.15723568, -0.12659113, 0.12663175, 0.09059224, 0.11972124, -0.07987135, 0.19573581, 1.66614221, -0.02746732, 0.01809177, 0.9322043, 0.23503757, -0.21352856, -0.54890718, -0.38095916, 0.54091449, -0.34022734, 0.72674154, 0.64074993, -0.76762368, -0.04648122, -0.29888653, -0.31396683, -0.18739208, 0.53936865, -0.41735965, -0.1562445, -0.2633629, -0.48597415, -0.08265106, -0.27398756, 0.01136865, 0.1887991, -0.06646916, 0.41479363, -0.09480974, -0.63911342, 2.50579508, 0.71400369, -0.11481813, 0.05201703, -0.11187266, -0.09966212, -0.55138482, -0.10820827, -1.15806636, -0.64752434, -0.86332061, -0.19997056, -2.14528927, -2.87757969, 0.7424284, -0.24504957, 1.32902126, -1.93770945, -0.61731616, 0.25588802, -1.34319156, 4.27656895, 1.87244775, -0.08158902, -0.3864889, -1.17278103, 0.52114927, -0.19224884, 0.10702464, 0.21013826, -0.61004765, -0.40792327, 0.57599278, -0.0397493, -0.41217899, 0.92912994, -0.23223925, 0.08743698, 0.46663486, 0.56753572, 0.32071805, -0.21116781, 0.40453932, -1.02160473, -1.84046832, -1.00500846, 0.60869917, 0.54639748, 0.26393022, -0.02675387, -0.32765293, -0.58487253, -0.79630644, -0.02546589, -0.66765198, -0.4398617, -0.35442079, -0.31269691, 0.0557983, -0.35000629, -0.48865672, 0.19870154, 0.5036284, 0.03823856, 0.99535683, -0.73840532, -0.59068848, -0.31840297, -0.0383206, 0.43449538, -0.02495137, -0.22737291, 0.67246412, -0.0403685, 0.63442454, -0.14994881, 0.03197217, 0.81119842, 1.60716682, 0.7331085, 0.21922967, 0.41034227, 0.34342446, 0.76305537, 0.42669919, 0.3550817, -1.06769092, -0.30641643, -1.34493604, -0.40432105, 0.05680819, -1.51733025, 0.72987137, 0.04370459, -0.0010694, -0.65229962, 0.21843868, 0.97331664, -3.29918687, -3.24643764, 0.29392696, 0.33741948, -1.37560109, -0.16699405, 0.27196616, -0.58381965, 1.81667367, 1.75141047, 1.97774891, 0.1396678, 1.58182969, 0.75116523, -0.61174129, 1.01652231, 0.85792504, 0.39826911, -0.8885599, -1.30460266, 0.14052694, 0.40016586, 0.73007537, 0.03082803, 0.0396427, -0.69563624, -0.03033443, -0.54946731, -0.6848278, -0.25859658, 0.14599258, -0.03088124, -0.13220514, -1.68072428, -0.09271895, -0.6630331, 0.33079586, 0.53328276, -0.64429227, 0.25992795, 1.29739499, -0.44481283, -0.76556351, -0.56668475, 2.47334204, -0.62998962, 0.65989463, 0.66443107, 0.98572862, 1.16980806, -0.35108564, 1.3472356, 5.94033877, 0.30974987, -0.83999408, 1.02026831, -0.15030077, 1.7298327, 0.32290212, 0.95685008, 2.61298772, 1.25082845, 0.80658685, -0.06049918, 0.00472654, 0.52354259, 0.31825409, 0.68213935, -0.05298223, 0.43634643, 0.3128813, -1.14961688, -0.25263141, 0.17612209, -0.78700307, -1.19793967, -0.0570563, 0.39552643, 0.25223549, 0.85410401, 0.04226136, 0.7672748, -0.81128183, 0.34537788, -0.08369965, -0.08769349, 1.60136065, 0.68536087, 0.86071233, 0.37937505, -1.62376555, 0.46391922, 0.03859705, 0.20528158, -1.69123894, -1.41628122, -0.13261515, -0.5322042, -0.07635726, -0.3460316, -1.44325928, 0.37801554, -0.1965497, -0.59632468, -1.10459054, -0.02814148, 0.63280748, -0.48001112, -0.27577878, -0.74510699, -0.17404939, 0.0409552, -0.31708707, 0.20400628, -0.19372669, 0.2039152, -0.87461198, 0.01023884, -3.18606041, -0.10653382, 0.35766341, -0.13387789, -0.4777505, 0.30275907, 0.23928922, 0.42820351, -0.34367539, -0.56442334, -0.671005, -0.493529, 0.08647177, -0.03925029, 0.06683962, 1.38893815, 0.05073875, -0.87379694, 0.77262228, -0.14076952, -0.00650348, -0.39342401, 0.2909445, -0.09741293, 0.24100898, -0.58485485, 0.40464968, 0.2530926, 0.21718034, 0.3653357, -0.63079716, 0.09079719, 0.59786396, 0.28176903, 0.91078974, -0.50806508, 0.17058284, 0.66246559, 0.52250169, 0.77092678, 1.67037803, -0.3148234, -0.62721196, 3.1307736, -0.23737039, -0.25403343, 0.26959777, -0.08163353, -0.84077738, 0.77060027, -1.08085227, 0.62796409, -0.47726477, 0.84447749, -1.54525213, -0.07011557, 0.53000478, 0.03092981, 0.42095566, 0.45938867, -0.45169126, 0.56525877, -0.40021603, 1.595647, 0.42221703, 0.56547121, 0.11456523, -0.61567926, 2.05573337, 0.25747906, 0.07542924, 0.46609067, -0.62387698, 0.6761681, 0.50903264, 0.28322544, -0.75403803, 0.21051104, -0.39142604, 0.78154273, -0.51775019, 0.01510606, 1.23920286, 0.77384772, 0.57167831, 0.18109808, -0.45302109, -0.86129097, -0.7482826, 0.07389122, -0.76530534, -0.33736896, 0.19241592, -0.47162977, -0.20982558, -0.67358201, 0.58463259, 0.24785388, -1.84949452, 0.11330084, -0.8019222, 1.50373494, -1.1112966, -0.5712871, 0.63816383, -2.36288388, -1.32599372, -0.3562986, 0.81400162, -0.68727144, -1.05544968, -1.57924127, 0.14167307, -0.59285951, -0.39955664, -0.30652663, -0.84222451, 0.15224943, 0.58428033, 0.34091398]);
  const b1 = new Float64Array([-0.38756922, -0.01529645, -0.55953228, 0.07328275, 0.3129152, 0.06458981, 0.32244239, -0.21778243, -0.84407298, -0.81866391, -0.14618679, 0.65203703, 0.22879418, -0.45532186, 0.76164877, -0.314204, -0.24818741, -0.53805022, -0.10354619, 0.21180893, 0.33213273, -0.29319018, 0.55788904, 0.4333498]);
  const W2 = new Float64Array([0.09408662, -0.3336107, 0.36611701, -0.11292449, -0.59773382, 0.10727941, -0.04072949, -0.55377516, 1.25220999, -0.31683503, -0.41767058, 0.58706581, -0.67541487, -0.95871286, 0.20463733, -1.01013991, -0.03276556, 0.59471819, -0.27019869, 0.09009908, 1.46542189, -0.22811529, -1.09586614, 0.96074048, 1.34545145, -0.1814754, 1.41500774, -0.24100818, 0.44782941, 1.16077169, -0.00972746, -0.46052183, -0.4810369, 0.71366344, -0.08967912, 0.4997682, 0.51976109, 0.69577377, 0.60622204, -0.65142191, -0.00241908, -0.54516251, 1.15591911, -0.47086452, 0.13457477, -0.12023731, 0.23095488, 1.41638319, 0.50639571, -0.17441286, 0.05495283, -1.19395757, -0.93771248, 0.44948852, -0.28754033, -1.06089319, -0.27942543, 0.01618807, -0.79634621, 0.98867083, -0.32474711, -0.2105568, -0.44205541, 0.1932159, 0.00407995, 0.49608229, -0.94538508, 0.71060845, 1.12277356, -0.35115785, -0.2035635, 1.57852399, -1.14811154, 0.16596729, 0.06889257, -0.41457082, -0.62527615, -0.02929614, 0.2690992, 1.09394444, -2.44932213, -0.09026784, -0.59504263, 0.48833538, -0.55208794, 0.65296831, -0.96156054, 0.51376285, -0.79230113, -0.44862232, 0.55084261, -0.01900226, -0.64967349, -0.16581617, 0.6975699, -0.51454857, -0.77123349, -0.08645361, -0.70749965, 0.18384816, -0.03472589, 0.91085324, -0.65609358, -0.86726516, 0.54576814, 0.24076681, -0.30840465, -0.5313792, 0.07682758, 0.76773534, 0.40358264, 0.27678244, 0.43462538, -1.03705345, 0.49026133, 0.01224966, 0.00974685, -0.66897054, 0.58847769, 0.49725306, 1.97786822, -0.65206801, -0.64586137, 0.12449402, 1.42084643, 1.08103177, -0.22622629, -0.07062538, 1.2315496, 0.08385384, -0.12809868, -0.46131045, 0.43899598, -0.68583177, -0.33213774, -0.81493566, 0.29286754, 0.27728822, -0.25053776, 0.41568725, 0.26782578, 0.31836444, -0.05486111, 0.05135012, 0.65099938, 0.48524417, -0.82651902, -0.13002597, 0.12020949, -1.49604353, 0.75119153, 0.55629104, 0.61860948, 0.5967996, 0.05401974, -1.36556147, 0.75489861, 0.53426738, -0.02746313, 1.42202116, 0.03970474, -0.66756951, -0.36067738, 0.91961792, -0.64077952, -0.79467445, 0.15859935, -0.33707813, 0.02555191, 0.47034752, -0.13964864, 0.84173122, 0.19963754, 0.72483867, -1.34620363, 0.30371552, -0.19587663, 0.31317233, -0.02417105, 0.76240676, 0.83051728, 0.54055567, 0.10106575, 0.52938981, 0.6412371, -0.00061729, -0.11836649, 0.25773459, -1.25443998, 0.45158464, -0.40685816, 0.10939157, -0.23629962, 0.4190113, 0.0151415, 1.65716366, 0.07956642, 0.02683256, -0.22190233, -0.52132491, 0.63351318, 0.54048019, 0.83168563, 0.0931095, 0.14586689, 0.87839571, 0.95732508, 0.07977731, -0.53589549, -0.52639608, 0.76511015, -1.04188714, 0.19347787, 0.22468825, 0.08811923, 0.08738243, -0.08969664, -0.11254295, -0.24766247, -0.2403831, -0.98462404, -1.11993064, 0.30585383, 0.03042275, 0.05862472, -0.33229928, 0.7199741, 0.62506505, 0.25443103, -0.30632027, 0.13891787, 1.26218249, 1.49375002, -0.47224676, -1.28802186, 1.21731295, -0.38098078, -0.20141237, 0.0993211, 0.58353299, 0.02704011, 0.51091819, 0.07117388, -0.01827415, -0.89567564, 0.41927815, -1.39582026, -0.1481669, 0.38432581, 0.57463461, 0.51060598, 0.17994721, 1.4035534, -0.25579197, -0.15656692, -0.49755301, 0.38289493, -0.65186062, 0.27202096, -0.43770286, -0.07496871, 0.24509695, 0.06285006, 0.80449349, 0.19586276, -0.20705442, -0.34880283, 0.16164587, -1.03384473, -0.35670064, 0.32451549, -0.01814135, -0.23833017, 0.14274742, 0.61819362, -0.33721972, -0.15776996, 0.52879497, 0.29705423, 0.14802691, -0.78058979, -0.82254937, -1.01415181, 0.35889543, 0.35376524, 0.28031242, -1.01927209, 0.01748123, 0.77965917, -1.70447032, 0.7109695, -0.2395605, -0.36057536, 0.89973435, -0.3373749, 0.68793303, 0.64306384, -0.39516895, -0.1502043, 0.3654599, -0.17567938, 0.18945543, -0.33888844, -0.55621169, -0.36094855, 0.11007959, 0.14841333, -1.14239413, 0.09839317, 0.15199876, -0.23190643, 0.83805994, -0.49730437, 0.29072051, 0.79214225, 0.14200635, 0.41466407, -0.09274874, -0.18816325, 0.33851638, -0.28400497, -0.61016419, 0.27116654, 0.42679709, -0.62641292, -0.06665195, 0.40810253, 0.26042455, 0.21158194, -0.31835846, 0.12977399, -0.81425096, 0.54051362, -0.6414509, 0.6629502, -0.33285372, 0.38625296, 0.96645365, -0.11185877, -0.23181832, 0.19703774, -0.83886375, 0.31942274, -0.44780846, -0.15595656, -0.38674412, -0.4624189, 0.33090536, 0.27492663, -1.14101775, 0.63248367, -0.87532827, -1.32275133, 0.01978741, -0.14671085, -1.05521662, 0.40408981, -0.02338397, -0.13490036, -0.04447539, 1.74174271, -0.02188144, 0.51412417, -0.59633053, 0.71741391, 0.79324606, -0.14084019, -0.24975723, 0.87418984, 0.11675874, -0.76452367, 0.33141206, 0.18592844, -1.07480724, 0.6472541, -1.48832534, -0.38231212, -0.25332417, -0.25638358, 0.68149747, 0.54311154, 2.01129709, -1.43876073, 0.53272536]);
  const b2 = new Float64Array([0.45261435, -0.58040696, 0.43784002, -0.13910446, -0.04917782, -1.18926154, -0.07066224, -0.07420014, -0.24871637, -0.40754841, -0.17683533, 0.12829796, -0.21241861, 0.12076317, -0.53071385, -0.73627336]);
  const W3 = new Float64Array([0.28760016, -0.65285029, 0.17789713, -0.37839225, -0.49782331, 0.20575594, -0.57984674, -0.06839554, -0.56013671, 1.4471775, 0.32217413, 0.26936003, 0.20922666, 0.85309594, 0.82658278, 0.15407085, 0.66951093, 0.5982665, 0.11036723, -0.05378329, -0.14516461, 0.6068251, 0.3924409, -0.27878296, -0.0267743, 0.42463176, 0.10916228, 0.31222802, 0.01673425, 0.39181743, 0.14771481, -0.15766715, -0.15471667, -0.03070172, 0.03738149, 0.30431959, -0.35748545, 0.26403693, -0.00691465, 0.18535786, -0.61252353, -0.10790325, -0.07356613, -0.34770727, 0.47243495, -0.1431949, -0.24873549, 0.88625045, -0.330639, 0.19223645, -0.04578304, -0.18134003, -0.20291801, 0.06774271, -0.09382678, -0.13392066, -0.20538409, 0.21255898, -0.19718467, 0.16805043, -0.07026935, 0.0300879, -0.49981019, 0.45200394, 0.80342781, 0.73019016, 0.21863719, -0.45671054, -0.51988824, 0.53328331, -0.41895041, -0.74322876, -0.08556457, 0.56082165, 0.03300213, 0.99750375, -0.23713926, 0.48294345, 0.72406865, 1.83102798]);
  const b3 = new Float64Array([0.15357762, -0.05741838, 0.28322824, 0.31032363, 0.52176329]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-4"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.43790552, 0.28667445, 0.29146866, -0.10083556, -0.10943076, -0.28717854, 0.34111587, 0.10557079, 0.55717376, -5.61994379, -0.27722839, 0.36063351, 0.0718853, 0.45636362, 0.40585164, 0.16047504, -0.23512074, 0.14881862, -0.33329282, 0.0648078, 0.29152137, 0.64120843, -0.05480317, -0.14874023, -0.40090724, -0.35002197, 0.3091271, 0.4051397, 0.85064322, -0.22651637, -0.16105264, 0.7006894, -0.28201989, 0.48340796, -0.23235781, -0.26979255, 0.43403731, 0.64313606, 0.96556927, 0.03570268, -0.15051028, 0.39582946, -0.22895588, 0.61818475, 0.40916528, -0.69208004, 0.4571102, 0.1735228, 1.07139671, -0.00031113, -0.33939067, 1.32194154, -1.74826511, -1.36365094, 0.25472051, 0.38659474, 0.35009458, -1.19683509, 1.00852354, 0.46808125, -0.52390067, -0.51198914, 1.72981892, 1.55383002, 0.44710828, 0.44927636, 0.90969231, -1.58195574, 1.07800668, -0.66734118, -0.48763575, 7.40851416, 0.54088755, 1.31914028, 0.64460509, 1.45555297, 4.97408468, 0.7954445, 1.2141104, 0.44066381, -0.39116369, 1.92661508, 0.39178036, -0.26493241, -0.00877638, -0.54047246, 0.43857311, 0.2628301, 0.28038817, -0.08991614, 0.00562096, 0.07909606, -0.33394848, 0.81173666, -0.99119724, -2.40418836, 0.20683362, 0.57010329, 0.50706288, 0.04475721, -1.6923782, 0.44234895, 0.28192312, -0.41569071, -0.40097114, -0.21270939, -1.48213758, -1.35673722, 0.64426118, 0.62463704, 1.62307793, 1.55368966, -0.52942548, 1.01280246, 0.46965761, 0.59909363, 0.57445636, -0.58310112, -0.35849256, -0.5103396, 0.97573035, 0.12385534, 0.42429294, -0.17578239, 0.15137795, 0.05255061, 0.21706019, -0.133915, 0.78614439, -0.36118624, 0.01983596, -0.4719965, -0.53748171, -0.06507518, -0.84473667, -0.21252155, 0.01425524, -0.2332369, 0.45602945, -0.0017205, -0.9220035, -0.86182999, 0.46711704, -0.22868938, -0.3984326, -0.56002579, 0.93126113, -0.76314673, -0.13618089, 1.6050381, 0.55343064, -1.25071673, 0.18836974, 1.05970012, -0.58777365, -0.42381295, -0.01989542, 1.21581512, -0.09301666, 0.57711358, 0.06524754, -0.93012569, -0.60666752, 0.03643859, -0.33341537, 0.06469217, -0.85885903, 0.12184405, -0.70331632, -0.35838915, 0.99211349, -0.11757183, 0.08672163, 0.47150356, 0.22588279, 0.56287101, 0.06258171, -0.14941481, -0.02253153, 0.1529853, -0.02648026, -4.14536007, 0.58905402, 0.58733332, -0.24634963, 0.26527182, -0.07549294, -0.08199109, -0.26349965, -0.50722975, 0.23642582, 0.52952442, -1.05311519, 0.77329085, -0.09639001, 0.29902959, 0.74671193, -0.1438305, -0.82805139, 0.74975143, 0.62837672, -0.02263945, 0.44817443, -0.01960781, -0.27410757, 0.58861762, 0.52108862, -0.34019261, 0.50618758, -0.33906053, 0.29810917, -1.06793901, 0.29261285, 0.49198256, 0.20554799, -1.13114923, -0.04443075, -0.71076359, 0.08113087, -0.58061603, 0.59296573, -0.3429898, 0.44819549, 1.59346377, -2.61945133, 0.0115471, -0.09130324, 1.55775826, 1.21915834, 0.01826581, -0.60943431, 0.55488353, 0.41412301, -0.18633928, -0.11519492, 0.14395246, -0.274614, 0.31022997, -0.88624122, -0.76087041, 0.84386313, -0.48345321, 0.53104081, 0.57218027, -2.55074843, -0.56367925, 0.05213854, -0.18528107, 1.71648284, -0.82593726, -0.52529301, -0.06369078, -1.29506084, 0.79300664, 0.52014037, -0.65330576, -0.37278706, -0.1183534, -0.30385234, 0.10153757, 0.50390224, 0.18589201, 0.1572268, 0.37320647, -0.24873547, 0.48522964, 0.61427802, -0.58838985, 1.27024363, 0.33047243, -0.88564803, -0.23824035, 0.9698733, -0.59554315, -0.63276144, 0.62563084, 0.67460072, -0.26991931, -0.42178144, -0.58483235, -0.07731733, 0.32731518, 0.38657588, -1.0380873, -0.04714119, 0.26012602, 1.85201329, 0.01056569, 0.37896189, -0.92339511, 1.60935713, 0.3519358, 1.01701588, 0.41334551, -0.8229241, 0.7446023, 0.19826225, 0.01837637, -0.18924691, -0.22272479, 0.39300219, -0.16064378, -0.01502117, 0.06694503, -0.21591942, -0.44848074, -0.57665888, -0.75902568, -0.18684585, 1.75812951, 2.52716162, 0.04624047, 0.08341713, -0.35477066, -0.79106952, 0.57576331, 0.32384616, 0.22890642, 0.11154918, 0.99016834, 0.27619942, 1.82128783, -1.1147363, -0.1514259, 0.49815359, 0.63262197, -0.85261822, -0.24408185, 0.04092865, -0.40898409, 0.2187659, 0.5939429, 0.25120273, 0.04767159, 0.61222427, -0.22889286, 0.15874019, 0.06538034, 1.04925303, 0.0977568, -1.03568249, -0.79114084, -0.67013313, -0.43621703, -0.45010369, 0.32875039, 0.50793556, -0.25741618, -0.45254671, -0.53803813, 0.16362462, -0.14334803, -0.19935954, -6.5311422, -0.02943762, -0.16420222, -0.10827991, 0.1547662, 1.04737688, -0.27820864, 0.04903922, 0.5033388, 0.63484467, 0.06518909, 1.4467137, 0.99559152, 0.0637428, -0.41627302, -0.52783621, -0.97442636, 0.41868684, 0.19327585, -0.08633218, -0.16769813, -0.02152273, 1.12148376, -0.24177989, -0.21112556, -0.55037804, 0.10022064, 0.32302101, 0.04755423, 0.04394149, -0.07573192, 0.23004496, 0.52188947, 0.47779696, -1.09222283, 0.05517106, -0.47166323, -0.30100395, -0.87782714, -0.63097463, -0.10320982, 0.19983009, -0.83486804, 0.76870876, -0.41389931, -0.95068899, -0.46939508, 0.11882143, 0.18213007, -0.85742938, -0.95910751, 0.01303034, 0.50021041, 0.21806978, -1.35411049, 0.33796412, 0.11304469, -0.27159458, 0.27671941, -0.63896321, -0.85718552, -0.10484049, 0.47597432, 0.66795252, 0.23523047, -0.32766585, -0.71392922, 0.32901856, -0.72913046, -0.32441547, 0.13735976, 0.28795793, -0.20754993, -0.41433265, 0.44773699, 0.12536568, -0.01509058, 0.19212788, 0.04281058, 0.33889086, -0.14777078, -0.66142111, -0.13231776, -0.88677939, -0.78521909, 0.33272822, 2.79950883, -0.72876622, -0.70469221, 0.14997329, -0.57367741, -0.32259341, -0.76819714, 0.75968589, 0.65307013, 0.07837013, -0.24464961, 0.75713633, -0.63777248, -0.09309103, -0.06051813, -0.12197373, 0.18103338, -0.32278231, -0.82417426, 0.15852481, -0.78133597, -0.45692952, 0.40125851, -0.66136018, -0.10561747, 0.40668301, -0.51587459, 0.57578647, -1.1929422, 0.21366893, 0.23895185, 0.13499196, 0.19411319, 0.07774001, 1.46468836, 0.04176726, 0.20548891, -0.58304135, 0.20610866, 1.37245001, 0.0715244, 0.60900116, -1.53037955, 1.42275085, -0.08166345, -0.26229319, 2.29872619, -0.09309751, 0.56090344, 0.42332203, 0.26195289, -0.43361581, 0.06926367, -0.02695036, -1.53261339, 0.81738667, 0.50243947, -1.26820652, -0.98084869, -0.53507638, 0.75451162, -0.33540848, -1.36245481, -1.60953541, -0.08722931, 0.30229661, -0.24172879, 0.38882719, -1.60314125, 0.62924454, 0.06807803, -0.15915038, -0.15915185, -0.41984272, 0.42976239, -0.03614878, 0.43237035, 0.02648312, -0.20609888, -0.09494591, -0.38808155, -0.19664323, -0.18316339, 0.55482654, -0.68394016, 2.24564119, -1.80847715, -0.47006498, -0.31210835, 0.51521929, -0.43384669, -0.76040579, -0.33059709, -0.15571589, -0.55749422, 0.13874144, 0.070883, -1.9380512, -0.57284265, 1.31700903, -2.15368892, 0.61544529, 0.36736054, -0.04128216, 0.0525769, 0.49134459, -0.31473704, 0.04358571, 0.09602795, -2.47298023, 0.83663427, 0.12020037, 0.60157181, 0.12494483, -2.54425341, -0.07002261, 0.4801155, 0.33224919, -0.08470422, -1.09316177, -0.04707545, 0.18678039, -0.05895869, 0.05456543, 0.05315762, -0.38052479, -0.11328626, 0.45199996, 0.10382705, 1.99747534, -0.19385167, -1.08943956, 0.16894069, -0.86439847, -0.58266749, -0.49794542, -0.56735153, -0.08085438, -0.62715865, -1.23537351, 0.78216862, -0.36249201, -1.08253244, 0.12590188, -0.2981104, 0.34463625, -0.80850699, -0.75057165, 0.89106056, 0.14711991, 0.43040693, 0.24400467, -0.28825202, 0.52935872, 0.55507687, 0.22138433, 0.24365673, -0.23308503, -0.07489313, 0.27984791, -0.45942712, 0.37620399, -0.24140955, 0.62330793, 0.77921792, 0.71123988, 0.02079538, -0.52510845, 0.32942113, 0.1607535, 0.96151555, -0.16079034, -1.93859221, -0.36190573, -0.19783436, 0.64001555, -0.11982791, 0.37611482, 0.78146002, -0.29536282, -0.291881, -0.1050257, 0.79742206, -0.17266075, -0.88210515, 0.71315302, 0.10720733, -0.15652838, -0.49973341, -0.45632669, 0.16452009, 2.48697164, 1.11017542, 0.47732019, -0.08347426, 2.54925165, 0.95313778, 0.79396991, 0.67585751, -0.20691878, 1.10924548, 0.55181554, -0.75626899, 0.69224745, -0.10301377, 0.60962182, -0.79353267, -0.04272982, 0.2881041, -0.27729901, -0.44808305, -0.16943179, -0.37507713, -0.19335074, -0.00148306, 3.19323577, 0.1035666, -0.57338948, 0.52968303, 0.32556781, -0.15723568, -0.12659113, 0.12663175, 0.09059224, 0.11972124, -0.07987135, 0.19573581, 1.66614221, -0.02746732, 0.01809177, 0.9322043, 0.23503757, -0.21352856, -0.54890718, -0.38095916, 0.54091449, -0.34022734, 0.72674154, 0.64074993, -0.76762368, -0.04648122, -0.29888653, -0.31396683, -0.18739208, 0.53936865, -0.41735965, -0.1562445, -0.2633629, -0.48597415, -0.08265106, -0.27398756, 0.01136865, 0.1887991, -0.06646916, 0.41479363, -0.09480974, -0.63911342, 2.50579508, 0.71400369, -0.11481813, 0.05201703, -0.11187266, -0.09966212, -0.55138482, -0.10820827, -1.15806636, -0.64752434, -0.86332061, -0.19997056, -2.14528927, -2.87757969, 0.7424284, -0.24504957, 1.32902126, -1.93770945, -0.61731616, 0.25588802, -1.34319156, 4.27656895, 1.87244775, -0.08158902, -0.3864889, -1.17278103, 0.52114927, -0.19224884, 0.10702464, 0.21013826, -0.61004765, -0.40792327, 0.57599278, -0.0397493, -0.41217899, 0.92912994, -0.23223925, 0.08743698, 0.46663486, 0.56753572, 0.32071805, -0.21116781, 0.40453932, -1.02160473, -1.84046832, -1.00500846, 0.60869917, 0.54639748, 0.26393022, -0.02675387, -0.32765293, -0.58487253, -0.79630644, -0.02546589, -0.66765198, -0.4398617, -0.35442079, -0.31269691, 0.0557983, -0.35000629, -0.48865672, 0.19870154, 0.5036284, 0.03823856, 0.99535683, -0.73840532, -0.59068848, -0.31840297, -0.0383206, 0.43449538, -0.02495137, -0.22737291, 0.67246412, -0.0403685, 0.63442454, -0.14994881, 0.03197217, 0.81119842, 1.60716682, 0.7331085, 0.21922967, 0.41034227, 0.34342446, 0.76305537, 0.42669919, 0.3550817, -1.06769092, -0.30641643, -1.34493604, -0.40432105, 0.05680819, -1.51733025, 0.72987137, 0.04370459, -0.0010694, -0.65229962, 0.21843868, 0.97331664, -3.29918687, -3.24643764, 0.29392696, 0.33741948, -1.37560109, -0.16699405, 0.27196616, -0.58381965, 1.81667367, 1.75141047, 1.97774891, 0.1396678, 1.58182969, 0.75116523, -0.61174129, 1.01652231, 0.85792504, 0.39826911, -0.8885599, -1.30460266, 0.14052694, 0.40016586, 0.73007537, 0.03082803, 0.0396427, -0.69563624, -0.03033443, -0.54946731, -0.6848278, -0.25859658, 0.14599258, -0.03088124, -0.13220514, -1.68072428, -0.09271895, -0.6630331, 0.33079586, 0.53328276, -0.64429227, 0.25992795, 1.29739499, -0.44481283, -0.76556351, -0.56668475, 2.47334204, -0.62998962, 0.65989463, 0.66443107, 0.98572862, 1.16980806, -0.35108564, 1.3472356, 5.94033877, 0.30974987, -0.83999408, 1.02026831, -0.15030077, 1.7298327, 0.32290212, 0.95685008, 2.61298772, 1.25082845, 0.80658685, -0.06049918, 0.00472654, 0.52354259, 0.31825409, 0.68213935, -0.05298223, 0.43634643, 0.3128813, -1.14961688, -0.25263141, 0.17612209, -0.78700307, -1.19793967, -0.0570563, 0.39552643, 0.25223549, 0.85410401, 0.04226136, 0.7672748, -0.81128183, 0.34537788, -0.08369965, -0.08769349, 1.60136065, 0.68536087, 0.86071233, 0.37937505, -1.62376555, 0.46391922, 0.03859705, 0.20528158, -1.69123894, -1.41628122, -0.13261515, -0.5322042, -0.07635726, -0.3460316, -1.44325928, 0.37801554, -0.1965497, -0.59632468, -1.10459054, -0.02814148, 0.63280748, -0.48001112, -0.27577878, -0.74510699, -0.17404939, 0.0409552, -0.31708707, 0.20400628, -0.19372669, 0.2039152, -0.87461198, 0.01023884, -3.18606041, -0.10653382, 0.35766341, -0.13387789, -0.4777505, 0.30275907, 0.23928922, 0.42820351, -0.34367539, -0.56442334, -0.671005, -0.493529, 0.08647177, -0.03925029, 0.06683962, 1.38893815, 0.05073875, -0.87379694, 0.77262228, -0.14076952, -0.00650348, -0.39342401, 0.2909445, -0.09741293, 0.24100898, -0.58485485, 0.40464968, 0.2530926, 0.21718034, 0.3653357, -0.63079716, 0.09079719, 0.59786396, 0.28176903, 0.91078974, -0.50806508, 0.17058284, 0.66246559, 0.52250169, 0.77092678, 1.67037803, -0.3148234, -0.62721196, 3.1307736, -0.23737039, -0.25403343, 0.26959777, -0.08163353, -0.84077738, 0.77060027, -1.08085227, 0.62796409, -0.47726477, 0.84447749, -1.54525213, -0.07011557, 0.53000478, 0.03092981, 0.42095566, 0.45938867, -0.45169126, 0.56525877, -0.40021603, 1.595647, 0.42221703, 0.56547121, 0.11456523, -0.61567926, 2.05573337, 0.25747906, 0.07542924, 0.46609067, -0.62387698, 0.6761681, 0.50903264, 0.28322544, -0.75403803, 0.21051104, -0.39142604, 0.78154273, -0.51775019, 0.01510606, 1.23920286, 0.77384772, 0.57167831, 0.18109808, -0.45302109, -0.86129097, -0.7482826, 0.07389122, -0.76530534, -0.33736896, 0.19241592, -0.47162977, -0.20982558, -0.67358201, 0.58463259, 0.24785388, -1.84949452, 0.11330084, -0.8019222, 1.50373494, -1.1112966, -0.5712871, 0.63816383, -2.36288388, -1.32599372, -0.3562986, 0.81400162, -0.68727144, -1.05544968, -1.57924127, 0.14167307, -0.59285951, -0.39955664, -0.30652663, -0.84222451, 0.15224943, 0.58428033, 0.34091398]);
  const b1 = new Float64Array([-0.38756922, -0.01529645, -0.55953228, 0.07328275, 0.3129152, 0.06458981, 0.32244239, -0.21778243, -0.84407298, -0.81866391, -0.14618679, 0.65203703, 0.22879418, -0.45532186, 0.76164877, -0.314204, -0.24818741, -0.53805022, -0.10354619, 0.21180893, 0.33213273, -0.29319018, 0.55788904, 0.4333498]);
  const W2 = new Float64Array([0.09408662, -0.3336107, 0.36611701, -0.11292449, -0.59773382, 0.10727941, -0.04072949, -0.55377516, 1.25220999, -0.31683503, -0.41767058, 0.58706581, -0.67541487, -0.95871286, 0.20463733, -1.01013991, -0.03276556, 0.59471819, -0.27019869, 0.09009908, 1.46542189, -0.22811529, -1.09586614, 0.96074048, 1.34545145, -0.1814754, 1.41500774, -0.24100818, 0.44782941, 1.16077169, -0.00972746, -0.46052183, -0.4810369, 0.71366344, -0.08967912, 0.4997682, 0.51976109, 0.69577377, 0.60622204, -0.65142191, -0.00241908, -0.54516251, 1.15591911, -0.47086452, 0.13457477, -0.12023731, 0.23095488, 1.41638319, 0.50639571, -0.17441286, 0.05495283, -1.19395757, -0.93771248, 0.44948852, -0.28754033, -1.06089319, -0.27942543, 0.01618807, -0.79634621, 0.98867083, -0.32474711, -0.2105568, -0.44205541, 0.1932159, 0.00407995, 0.49608229, -0.94538508, 0.71060845, 1.12277356, -0.35115785, -0.2035635, 1.57852399, -1.14811154, 0.16596729, 0.06889257, -0.41457082, -0.62527615, -0.02929614, 0.2690992, 1.09394444, -2.44932213, -0.09026784, -0.59504263, 0.48833538, -0.55208794, 0.65296831, -0.96156054, 0.51376285, -0.79230113, -0.44862232, 0.55084261, -0.01900226, -0.64967349, -0.16581617, 0.6975699, -0.51454857, -0.77123349, -0.08645361, -0.70749965, 0.18384816, -0.03472589, 0.91085324, -0.65609358, -0.86726516, 0.54576814, 0.24076681, -0.30840465, -0.5313792, 0.07682758, 0.76773534, 0.40358264, 0.27678244, 0.43462538, -1.03705345, 0.49026133, 0.01224966, 0.00974685, -0.66897054, 0.58847769, 0.49725306, 1.97786822, -0.65206801, -0.64586137, 0.12449402, 1.42084643, 1.08103177, -0.22622629, -0.07062538, 1.2315496, 0.08385384, -0.12809868, -0.46131045, 0.43899598, -0.68583177, -0.33213774, -0.81493566, 0.29286754, 0.27728822, -0.25053776, 0.41568725, 0.26782578, 0.31836444, -0.05486111, 0.05135012, 0.65099938, 0.48524417, -0.82651902, -0.13002597, 0.12020949, -1.49604353, 0.75119153, 0.55629104, 0.61860948, 0.5967996, 0.05401974, -1.36556147, 0.75489861, 0.53426738, -0.02746313, 1.42202116, 0.03970474, -0.66756951, -0.36067738, 0.91961792, -0.64077952, -0.79467445, 0.15859935, -0.33707813, 0.02555191, 0.47034752, -0.13964864, 0.84173122, 0.19963754, 0.72483867, -1.34620363, 0.30371552, -0.19587663, 0.31317233, -0.02417105, 0.76240676, 0.83051728, 0.54055567, 0.10106575, 0.52938981, 0.6412371, -0.00061729, -0.11836649, 0.25773459, -1.25443998, 0.45158464, -0.40685816, 0.10939157, -0.23629962, 0.4190113, 0.0151415, 1.65716366, 0.07956642, 0.02683256, -0.22190233, -0.52132491, 0.63351318, 0.54048019, 0.83168563, 0.0931095, 0.14586689, 0.87839571, 0.95732508, 0.07977731, -0.53589549, -0.52639608, 0.76511015, -1.04188714, 0.19347787, 0.22468825, 0.08811923, 0.08738243, -0.08969664, -0.11254295, -0.24766247, -0.2403831, -0.98462404, -1.11993064, 0.30585383, 0.03042275, 0.05862472, -0.33229928, 0.7199741, 0.62506505, 0.25443103, -0.30632027, 0.13891787, 1.26218249, 1.49375002, -0.47224676, -1.28802186, 1.21731295, -0.38098078, -0.20141237, 0.0993211, 0.58353299, 0.02704011, 0.51091819, 0.07117388, -0.01827415, -0.89567564, 0.41927815, -1.39582026, -0.1481669, 0.38432581, 0.57463461, 0.51060598, 0.17994721, 1.4035534, -0.25579197, -0.15656692, -0.49755301, 0.38289493, -0.65186062, 0.27202096, -0.43770286, -0.07496871, 0.24509695, 0.06285006, 0.80449349, 0.19586276, -0.20705442, -0.34880283, 0.16164587, -1.03384473, -0.35670064, 0.32451549, -0.01814135, -0.23833017, 0.14274742, 0.61819362, -0.33721972, -0.15776996, 0.52879497, 0.29705423, 0.14802691, -0.78058979, -0.82254937, -1.01415181, 0.35889543, 0.35376524, 0.28031242, -1.01927209, 0.01748123, 0.77965917, -1.70447032, 0.7109695, -0.2395605, -0.36057536, 0.89973435, -0.3373749, 0.68793303, 0.64306384, -0.39516895, -0.1502043, 0.3654599, -0.17567938, 0.18945543, -0.33888844, -0.55621169, -0.36094855, 0.11007959, 0.14841333, -1.14239413, 0.09839317, 0.15199876, -0.23190643, 0.83805994, -0.49730437, 0.29072051, 0.79214225, 0.14200635, 0.41466407, -0.09274874, -0.18816325, 0.33851638, -0.28400497, -0.61016419, 0.27116654, 0.42679709, -0.62641292, -0.06665195, 0.40810253, 0.26042455, 0.21158194, -0.31835846, 0.12977399, -0.81425096, 0.54051362, -0.6414509, 0.6629502, -0.33285372, 0.38625296, 0.96645365, -0.11185877, -0.23181832, 0.19703774, -0.83886375, 0.31942274, -0.44780846, -0.15595656, -0.38674412, -0.4624189, 0.33090536, 0.27492663, -1.14101775, 0.63248367, -0.87532827, -1.32275133, 0.01978741, -0.14671085, -1.05521662, 0.40408981, -0.02338397, -0.13490036, -0.04447539, 1.74174271, -0.02188144, 0.51412417, -0.59633053, 0.71741391, 0.79324606, -0.14084019, -0.24975723, 0.87418984, 0.11675874, -0.76452367, 0.33141206, 0.18592844, -1.07480724, 0.6472541, -1.48832534, -0.38231212, -0.25332417, -0.25638358, 0.68149747, 0.54311154, 2.01129709, -1.43876073, 0.53272536]);
  const b2 = new Float64Array([0.45261435, -0.58040696, 0.43784002, -0.13910446, -0.04917782, -1.18926154, -0.07066224, -0.07420014, -0.24871637, -0.40754841, -0.17683533, 0.12829796, -0.21241861, 0.12076317, -0.53071385, -0.73627336]);
  const W3 = new Float64Array([0.28760016, -0.65285029, 0.17789713, -0.37839225, -0.49782331, 0.20575594, -0.57984674, -0.06839554, -0.56013671, 1.4471775, 0.32217413, 0.26936003, 0.20922666, 0.85309594, 0.82658278, 0.15407085, 0.66951093, 0.5982665, 0.11036723, -0.05378329, -0.14516461, 0.6068251, 0.3924409, -0.27878296, -0.0267743, 0.42463176, 0.10916228, 0.31222802, 0.01673425, 0.39181743, 0.14771481, -0.15766715, -0.15471667, -0.03070172, 0.03738149, 0.30431959, -0.35748545, 0.26403693, -0.00691465, 0.18535786, -0.61252353, -0.10790325, -0.07356613, -0.34770727, 0.47243495, -0.1431949, -0.24873549, 0.88625045, -0.330639, 0.19223645, -0.04578304, -0.18134003, -0.20291801, 0.06774271, -0.09382678, -0.13392066, -0.20538409, 0.21255898, -0.19718467, 0.16805043, -0.07026935, 0.0300879, -0.49981019, 0.45200394, 0.80342781, 0.73019016, 0.21863719, -0.45671054, -0.51988824, 0.53328331, -0.41895041, -0.74322876, -0.08556457, 0.56082165, 0.03300213, 0.99750375, -0.23713926, 0.48294345, 0.72406865, 1.83102798]);
  const b3 = new Float64Array([0.15357762, -0.05741838, 0.28322824, 0.31032363, 0.52176329]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-5"; }
function type(){ return Type.DEALER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.43790552, 0.28667445, 0.29146866, -0.10083556, -0.10943076, -0.28717854, 0.34111587, 0.10557079, 0.55717376, -5.61994379, -0.27722839, 0.36063351, 0.0718853, 0.45636362, 0.40585164, 0.16047504, -0.23512074, 0.14881862, -0.33329282, 0.0648078, 0.29152137, 0.64120843, -0.05480317, -0.14874023, -0.40090724, -0.35002197, 0.3091271, 0.4051397, 0.85064322, -0.22651637, -0.16105264, 0.7006894, -0.28201989, 0.48340796, -0.23235781, -0.26979255, 0.43403731, 0.64313606, 0.96556927, 0.03570268, -0.15051028, 0.39582946, -0.22895588, 0.61818475, 0.40916528, -0.69208004, 0.4571102, 0.1735228, 1.07139671, -0.00031113, -0.33939067, 1.32194154, -1.74826511, -1.36365094, 0.25472051, 0.38659474, 0.35009458, -1.19683509, 1.00852354, 0.46808125, -0.52390067, -0.51198914, 1.72981892, 1.55383002, 0.44710828, 0.44927636, 0.90969231, -1.58195574, 1.07800668, -0.66734118, -0.48763575, 7.40851416, 0.54088755, 1.31914028, 0.64460509, 1.45555297, 4.97408468, 0.7954445, 1.2141104, 0.44066381, -0.39116369, 1.92661508, 0.39178036, -0.26493241, -0.00877638, -0.54047246, 0.43857311, 0.2628301, 0.28038817, -0.08991614, 0.00562096, 0.07909606, -0.33394848, 0.81173666, -0.99119724, -2.40418836, 0.20683362, 0.57010329, 0.50706288, 0.04475721, -1.6923782, 0.44234895, 0.28192312, -0.41569071, -0.40097114, -0.21270939, -1.48213758, -1.35673722, 0.64426118, 0.62463704, 1.62307793, 1.55368966, -0.52942548, 1.01280246, 0.46965761, 0.59909363, 0.57445636, -0.58310112, -0.35849256, -0.5103396, 0.97573035, 0.12385534, 0.42429294, -0.17578239, 0.15137795, 0.05255061, 0.21706019, -0.133915, 0.78614439, -0.36118624, 0.01983596, -0.4719965, -0.53748171, -0.06507518, -0.84473667, -0.21252155, 0.01425524, -0.2332369, 0.45602945, -0.0017205, -0.9220035, -0.86182999, 0.46711704, -0.22868938, -0.3984326, -0.56002579, 0.93126113, -0.76314673, -0.13618089, 1.6050381, 0.55343064, -1.25071673, 0.18836974, 1.05970012, -0.58777365, -0.42381295, -0.01989542, 1.21581512, -0.09301666, 0.57711358, 0.06524754, -0.93012569, -0.60666752, 0.03643859, -0.33341537, 0.06469217, -0.85885903, 0.12184405, -0.70331632, -0.35838915, 0.99211349, -0.11757183, 0.08672163, 0.47150356, 0.22588279, 0.56287101, 0.06258171, -0.14941481, -0.02253153, 0.1529853, -0.02648026, -4.14536007, 0.58905402, 0.58733332, -0.24634963, 0.26527182, -0.07549294, -0.08199109, -0.26349965, -0.50722975, 0.23642582, 0.52952442, -1.05311519, 0.77329085, -0.09639001, 0.29902959, 0.74671193, -0.1438305, -0.82805139, 0.74975143, 0.62837672, -0.02263945, 0.44817443, -0.01960781, -0.27410757, 0.58861762, 0.52108862, -0.34019261, 0.50618758, -0.33906053, 0.29810917, -1.06793901, 0.29261285, 0.49198256, 0.20554799, -1.13114923, -0.04443075, -0.71076359, 0.08113087, -0.58061603, 0.59296573, -0.3429898, 0.44819549, 1.59346377, -2.61945133, 0.0115471, -0.09130324, 1.55775826, 1.21915834, 0.01826581, -0.60943431, 0.55488353, 0.41412301, -0.18633928, -0.11519492, 0.14395246, -0.274614, 0.31022997, -0.88624122, -0.76087041, 0.84386313, -0.48345321, 0.53104081, 0.57218027, -2.55074843, -0.56367925, 0.05213854, -0.18528107, 1.71648284, -0.82593726, -0.52529301, -0.06369078, -1.29506084, 0.79300664, 0.52014037, -0.65330576, -0.37278706, -0.1183534, -0.30385234, 0.10153757, 0.50390224, 0.18589201, 0.1572268, 0.37320647, -0.24873547, 0.48522964, 0.61427802, -0.58838985, 1.27024363, 0.33047243, -0.88564803, -0.23824035, 0.9698733, -0.59554315, -0.63276144, 0.62563084, 0.67460072, -0.26991931, -0.42178144, -0.58483235, -0.07731733, 0.32731518, 0.38657588, -1.0380873, -0.04714119, 0.26012602, 1.85201329, 0.01056569, 0.37896189, -0.92339511, 1.60935713, 0.3519358, 1.01701588, 0.41334551, -0.8229241, 0.7446023, 0.19826225, 0.01837637, -0.18924691, -0.22272479, 0.39300219, -0.16064378, -0.01502117, 0.06694503, -0.21591942, -0.44848074, -0.57665888, -0.75902568, -0.18684585, 1.75812951, 2.52716162, 0.04624047, 0.08341713, -0.35477066, -0.79106952, 0.57576331, 0.32384616, 0.22890642, 0.11154918, 0.99016834, 0.27619942, 1.82128783, -1.1147363, -0.1514259, 0.49815359, 0.63262197, -0.85261822, -0.24408185, 0.04092865, -0.40898409, 0.2187659, 0.5939429, 0.25120273, 0.04767159, 0.61222427, -0.22889286, 0.15874019, 0.06538034, 1.04925303, 0.0977568, -1.03568249, -0.79114084, -0.67013313, -0.43621703, -0.45010369, 0.32875039, 0.50793556, -0.25741618, -0.45254671, -0.53803813, 0.16362462, -0.14334803, -0.19935954, -6.5311422, -0.02943762, -0.16420222, -0.10827991, 0.1547662, 1.04737688, -0.27820864, 0.04903922, 0.5033388, 0.63484467, 0.06518909, 1.4467137, 0.99559152, 0.0637428, -0.41627302, -0.52783621, -0.97442636, 0.41868684, 0.19327585, -0.08633218, -0.16769813, -0.02152273, 1.12148376, -0.24177989, -0.21112556, -0.55037804, 0.10022064, 0.32302101, 0.04755423, 0.04394149, -0.07573192, 0.23004496, 0.52188947, 0.47779696, -1.09222283, 0.05517106, -0.47166323, -0.30100395, -0.87782714, -0.63097463, -0.10320982, 0.19983009, -0.83486804, 0.76870876, -0.41389931, -0.95068899, -0.46939508, 0.11882143, 0.18213007, -0.85742938, -0.95910751, 0.01303034, 0.50021041, 0.21806978, -1.35411049, 0.33796412, 0.11304469, -0.27159458, 0.27671941, -0.63896321, -0.85718552, -0.10484049, 0.47597432, 0.66795252, 0.23523047, -0.32766585, -0.71392922, 0.32901856, -0.72913046, -0.32441547, 0.13735976, 0.28795793, -0.20754993, -0.41433265, 0.44773699, 0.12536568, -0.01509058, 0.19212788, 0.04281058, 0.33889086, -0.14777078, -0.66142111, -0.13231776, -0.88677939, -0.78521909, 0.33272822, 2.79950883, -0.72876622, -0.70469221, 0.14997329, -0.57367741, -0.32259341, -0.76819714, 0.75968589, 0.65307013, 0.07837013, -0.24464961, 0.75713633, -0.63777248, -0.09309103, -0.06051813, -0.12197373, 0.18103338, -0.32278231, -0.82417426, 0.15852481, -0.78133597, -0.45692952, 0.40125851, -0.66136018, -0.10561747, 0.40668301, -0.51587459, 0.57578647, -1.1929422, 0.21366893, 0.23895185, 0.13499196, 0.19411319, 0.07774001, 1.46468836, 0.04176726, 0.20548891, -0.58304135, 0.20610866, 1.37245001, 0.0715244, 0.60900116, -1.53037955, 1.42275085, -0.08166345, -0.26229319, 2.29872619, -0.09309751, 0.56090344, 0.42332203, 0.26195289, -0.43361581, 0.06926367, -0.02695036, -1.53261339, 0.81738667, 0.50243947, -1.26820652, -0.98084869, -0.53507638, 0.75451162, -0.33540848, -1.36245481, -1.60953541, -0.08722931, 0.30229661, -0.24172879, 0.38882719, -1.60314125, 0.62924454, 0.06807803, -0.15915038, -0.15915185, -0.41984272, 0.42976239, -0.03614878, 0.43237035, 0.02648312, -0.20609888, -0.09494591, -0.38808155, -0.19664323, -0.18316339, 0.55482654, -0.68394016, 2.24564119, -1.80847715, -0.47006498, -0.31210835, 0.51521929, -0.43384669, -0.76040579, -0.33059709, -0.15571589, -0.55749422, 0.13874144, 0.070883, -1.9380512, -0.57284265, 1.31700903, -2.15368892, 0.61544529, 0.36736054, -0.04128216, 0.0525769, 0.49134459, -0.31473704, 0.04358571, 0.09602795, -2.47298023, 0.83663427, 0.12020037, 0.60157181, 0.12494483, -2.54425341, -0.07002261, 0.4801155, 0.33224919, -0.08470422, -1.09316177, -0.04707545, 0.18678039, -0.05895869, 0.05456543, 0.05315762, -0.38052479, -0.11328626, 0.45199996, 0.10382705, 1.99747534, -0.19385167, -1.08943956, 0.16894069, -0.86439847, -0.58266749, -0.49794542, -0.56735153, -0.08085438, -0.62715865, -1.23537351, 0.78216862, -0.36249201, -1.08253244, 0.12590188, -0.2981104, 0.34463625, -0.80850699, -0.75057165, 0.89106056, 0.14711991, 0.43040693, 0.24400467, -0.28825202, 0.52935872, 0.55507687, 0.22138433, 0.24365673, -0.23308503, -0.07489313, 0.27984791, -0.45942712, 0.37620399, -0.24140955, 0.62330793, 0.77921792, 0.71123988, 0.02079538, -0.52510845, 0.32942113, 0.1607535, 0.96151555, -0.16079034, -1.93859221, -0.36190573, -0.19783436, 0.64001555, -0.11982791, 0.37611482, 0.78146002, -0.29536282, -0.291881, -0.1050257, 0.79742206, -0.17266075, -0.88210515, 0.71315302, 0.10720733, -0.15652838, -0.49973341, -0.45632669, 0.16452009, 2.48697164, 1.11017542, 0.47732019, -0.08347426, 2.54925165, 0.95313778, 0.79396991, 0.67585751, -0.20691878, 1.10924548, 0.55181554, -0.75626899, 0.69224745, -0.10301377, 0.60962182, -0.79353267, -0.04272982, 0.2881041, -0.27729901, -0.44808305, -0.16943179, -0.37507713, -0.19335074, -0.00148306, 3.19323577, 0.1035666, -0.57338948, 0.52968303, 0.32556781, -0.15723568, -0.12659113, 0.12663175, 0.09059224, 0.11972124, -0.07987135, 0.19573581, 1.66614221, -0.02746732, 0.01809177, 0.9322043, 0.23503757, -0.21352856, -0.54890718, -0.38095916, 0.54091449, -0.34022734, 0.72674154, 0.64074993, -0.76762368, -0.04648122, -0.29888653, -0.31396683, -0.18739208, 0.53936865, -0.41735965, -0.1562445, -0.2633629, -0.48597415, -0.08265106, -0.27398756, 0.01136865, 0.1887991, -0.06646916, 0.41479363, -0.09480974, -0.63911342, 2.50579508, 0.71400369, -0.11481813, 0.05201703, -0.11187266, -0.09966212, -0.55138482, -0.10820827, -1.15806636, -0.64752434, -0.86332061, -0.19997056, -2.14528927, -2.87757969, 0.7424284, -0.24504957, 1.32902126, -1.93770945, -0.61731616, 0.25588802, -1.34319156, 4.27656895, 1.87244775, -0.08158902, -0.3864889, -1.17278103, 0.52114927, -0.19224884, 0.10702464, 0.21013826, -0.61004765, -0.40792327, 0.57599278, -0.0397493, -0.41217899, 0.92912994, -0.23223925, 0.08743698, 0.46663486, 0.56753572, 0.32071805, -0.21116781, 0.40453932, -1.02160473, -1.84046832, -1.00500846, 0.60869917, 0.54639748, 0.26393022, -0.02675387, -0.32765293, -0.58487253, -0.79630644, -0.02546589, -0.66765198, -0.4398617, -0.35442079, -0.31269691, 0.0557983, -0.35000629, -0.48865672, 0.19870154, 0.5036284, 0.03823856, 0.99535683, -0.73840532, -0.59068848, -0.31840297, -0.0383206, 0.43449538, -0.02495137, -0.22737291, 0.67246412, -0.0403685, 0.63442454, -0.14994881, 0.03197217, 0.81119842, 1.60716682, 0.7331085, 0.21922967, 0.41034227, 0.34342446, 0.76305537, 0.42669919, 0.3550817, -1.06769092, -0.30641643, -1.34493604, -0.40432105, 0.05680819, -1.51733025, 0.72987137, 0.04370459, -0.0010694, -0.65229962, 0.21843868, 0.97331664, -3.29918687, -3.24643764, 0.29392696, 0.33741948, -1.37560109, -0.16699405, 0.27196616, -0.58381965, 1.81667367, 1.75141047, 1.97774891, 0.1396678, 1.58182969, 0.75116523, -0.61174129, 1.01652231, 0.85792504, 0.39826911, -0.8885599, -1.30460266, 0.14052694, 0.40016586, 0.73007537, 0.03082803, 0.0396427, -0.69563624, -0.03033443, -0.54946731, -0.6848278, -0.25859658, 0.14599258, -0.03088124, -0.13220514, -1.68072428, -0.09271895, -0.6630331, 0.33079586, 0.53328276, -0.64429227, 0.25992795, 1.29739499, -0.44481283, -0.76556351, -0.56668475, 2.47334204, -0.62998962, 0.65989463, 0.66443107, 0.98572862, 1.16980806, -0.35108564, 1.3472356, 5.94033877, 0.30974987, -0.83999408, 1.02026831, -0.15030077, 1.7298327, 0.32290212, 0.95685008, 2.61298772, 1.25082845, 0.80658685, -0.06049918, 0.00472654, 0.52354259, 0.31825409, 0.68213935, -0.05298223, 0.43634643, 0.3128813, -1.14961688, -0.25263141, 0.17612209, -0.78700307, -1.19793967, -0.0570563, 0.39552643, 0.25223549, 0.85410401, 0.04226136, 0.7672748, -0.81128183, 0.34537788, -0.08369965, -0.08769349, 1.60136065, 0.68536087, 0.86071233, 0.37937505, -1.62376555, 0.46391922, 0.03859705, 0.20528158, -1.69123894, -1.41628122, -0.13261515, -0.5322042, -0.07635726, -0.3460316, -1.44325928, 0.37801554, -0.1965497, -0.59632468, -1.10459054, -0.02814148, 0.63280748, -0.48001112, -0.27577878, -0.74510699, -0.17404939, 0.0409552, -0.31708707, 0.20400628, -0.19372669, 0.2039152, -0.87461198, 0.01023884, -3.18606041, -0.10653382, 0.35766341, -0.13387789, -0.4777505, 0.30275907, 0.23928922, 0.42820351, -0.34367539, -0.56442334, -0.671005, -0.493529, 0.08647177, -0.03925029, 0.06683962, 1.38893815, 0.05073875, -0.87379694, 0.77262228, -0.14076952, -0.00650348, -0.39342401, 0.2909445, -0.09741293, 0.24100898, -0.58485485, 0.40464968, 0.2530926, 0.21718034, 0.3653357, -0.63079716, 0.09079719, 0.59786396, 0.28176903, 0.91078974, -0.50806508, 0.17058284, 0.66246559, 0.52250169, 0.77092678, 1.67037803, -0.3148234, -0.62721196, 3.1307736, -0.23737039, -0.25403343, 0.26959777, -0.08163353, -0.84077738, 0.77060027, -1.08085227, 0.62796409, -0.47726477, 0.84447749, -1.54525213, -0.07011557, 0.53000478, 0.03092981, 0.42095566, 0.45938867, -0.45169126, 0.56525877, -0.40021603, 1.595647, 0.42221703, 0.56547121, 0.11456523, -0.61567926, 2.05573337, 0.25747906, 0.07542924, 0.46609067, -0.62387698, 0.6761681, 0.50903264, 0.28322544, -0.75403803, 0.21051104, -0.39142604, 0.78154273, -0.51775019, 0.01510606, 1.23920286, 0.77384772, 0.57167831, 0.18109808, -0.45302109, -0.86129097, -0.7482826, 0.07389122, -0.76530534, -0.33736896, 0.19241592, -0.47162977, -0.20982558, -0.67358201, 0.58463259, 0.24785388, -1.84949452, 0.11330084, -0.8019222, 1.50373494, -1.1112966, -0.5712871, 0.63816383, -2.36288388, -1.32599372, -0.3562986, 0.81400162, -0.68727144, -1.05544968, -1.57924127, 0.14167307, -0.59285951, -0.39955664, -0.30652663, -0.84222451, 0.15224943, 0.58428033, 0.34091398]);
  const b1 = new Float64Array([-0.38756922, -0.01529645, -0.55953228, 0.07328275, 0.3129152, 0.06458981, 0.32244239, -0.21778243, -0.84407298, -0.81866391, -0.14618679, 0.65203703, 0.22879418, -0.45532186, 0.76164877, -0.314204, -0.24818741, -0.53805022, -0.10354619, 0.21180893, 0.33213273, -0.29319018, 0.55788904, 0.4333498]);
  const W2 = new Float64Array([0.09408662, -0.3336107, 0.36611701, -0.11292449, -0.59773382, 0.10727941, -0.04072949, -0.55377516, 1.25220999, -0.31683503, -0.41767058, 0.58706581, -0.67541487, -0.95871286, 0.20463733, -1.01013991, -0.03276556, 0.59471819, -0.27019869, 0.09009908, 1.46542189, -0.22811529, -1.09586614, 0.96074048, 1.34545145, -0.1814754, 1.41500774, -0.24100818, 0.44782941, 1.16077169, -0.00972746, -0.46052183, -0.4810369, 0.71366344, -0.08967912, 0.4997682, 0.51976109, 0.69577377, 0.60622204, -0.65142191, -0.00241908, -0.54516251, 1.15591911, -0.47086452, 0.13457477, -0.12023731, 0.23095488, 1.41638319, 0.50639571, -0.17441286, 0.05495283, -1.19395757, -0.93771248, 0.44948852, -0.28754033, -1.06089319, -0.27942543, 0.01618807, -0.79634621, 0.98867083, -0.32474711, -0.2105568, -0.44205541, 0.1932159, 0.00407995, 0.49608229, -0.94538508, 0.71060845, 1.12277356, -0.35115785, -0.2035635, 1.57852399, -1.14811154, 0.16596729, 0.06889257, -0.41457082, -0.62527615, -0.02929614, 0.2690992, 1.09394444, -2.44932213, -0.09026784, -0.59504263, 0.48833538, -0.55208794, 0.65296831, -0.96156054, 0.51376285, -0.79230113, -0.44862232, 0.55084261, -0.01900226, -0.64967349, -0.16581617, 0.6975699, -0.51454857, -0.77123349, -0.08645361, -0.70749965, 0.18384816, -0.03472589, 0.91085324, -0.65609358, -0.86726516, 0.54576814, 0.24076681, -0.30840465, -0.5313792, 0.07682758, 0.76773534, 0.40358264, 0.27678244, 0.43462538, -1.03705345, 0.49026133, 0.01224966, 0.00974685, -0.66897054, 0.58847769, 0.49725306, 1.97786822, -0.65206801, -0.64586137, 0.12449402, 1.42084643, 1.08103177, -0.22622629, -0.07062538, 1.2315496, 0.08385384, -0.12809868, -0.46131045, 0.43899598, -0.68583177, -0.33213774, -0.81493566, 0.29286754, 0.27728822, -0.25053776, 0.41568725, 0.26782578, 0.31836444, -0.05486111, 0.05135012, 0.65099938, 0.48524417, -0.82651902, -0.13002597, 0.12020949, -1.49604353, 0.75119153, 0.55629104, 0.61860948, 0.5967996, 0.05401974, -1.36556147, 0.75489861, 0.53426738, -0.02746313, 1.42202116, 0.03970474, -0.66756951, -0.36067738, 0.91961792, -0.64077952, -0.79467445, 0.15859935, -0.33707813, 0.02555191, 0.47034752, -0.13964864, 0.84173122, 0.19963754, 0.72483867, -1.34620363, 0.30371552, -0.19587663, 0.31317233, -0.02417105, 0.76240676, 0.83051728, 0.54055567, 0.10106575, 0.52938981, 0.6412371, -0.00061729, -0.11836649, 0.25773459, -1.25443998, 0.45158464, -0.40685816, 0.10939157, -0.23629962, 0.4190113, 0.0151415, 1.65716366, 0.07956642, 0.02683256, -0.22190233, -0.52132491, 0.63351318, 0.54048019, 0.83168563, 0.0931095, 0.14586689, 0.87839571, 0.95732508, 0.07977731, -0.53589549, -0.52639608, 0.76511015, -1.04188714, 0.19347787, 0.22468825, 0.08811923, 0.08738243, -0.08969664, -0.11254295, -0.24766247, -0.2403831, -0.98462404, -1.11993064, 0.30585383, 0.03042275, 0.05862472, -0.33229928, 0.7199741, 0.62506505, 0.25443103, -0.30632027, 0.13891787, 1.26218249, 1.49375002, -0.47224676, -1.28802186, 1.21731295, -0.38098078, -0.20141237, 0.0993211, 0.58353299, 0.02704011, 0.51091819, 0.07117388, -0.01827415, -0.89567564, 0.41927815, -1.39582026, -0.1481669, 0.38432581, 0.57463461, 0.51060598, 0.17994721, 1.4035534, -0.25579197, -0.15656692, -0.49755301, 0.38289493, -0.65186062, 0.27202096, -0.43770286, -0.07496871, 0.24509695, 0.06285006, 0.80449349, 0.19586276, -0.20705442, -0.34880283, 0.16164587, -1.03384473, -0.35670064, 0.32451549, -0.01814135, -0.23833017, 0.14274742, 0.61819362, -0.33721972, -0.15776996, 0.52879497, 0.29705423, 0.14802691, -0.78058979, -0.82254937, -1.01415181, 0.35889543, 0.35376524, 0.28031242, -1.01927209, 0.01748123, 0.77965917, -1.70447032, 0.7109695, -0.2395605, -0.36057536, 0.89973435, -0.3373749, 0.68793303, 0.64306384, -0.39516895, -0.1502043, 0.3654599, -0.17567938, 0.18945543, -0.33888844, -0.55621169, -0.36094855, 0.11007959, 0.14841333, -1.14239413, 0.09839317, 0.15199876, -0.23190643, 0.83805994, -0.49730437, 0.29072051, 0.79214225, 0.14200635, 0.41466407, -0.09274874, -0.18816325, 0.33851638, -0.28400497, -0.61016419, 0.27116654, 0.42679709, -0.62641292, -0.06665195, 0.40810253, 0.26042455, 0.21158194, -0.31835846, 0.12977399, -0.81425096, 0.54051362, -0.6414509, 0.6629502, -0.33285372, 0.38625296, 0.96645365, -0.11185877, -0.23181832, 0.19703774, -0.83886375, 0.31942274, -0.44780846, -0.15595656, -0.38674412, -0.4624189, 0.33090536, 0.27492663, -1.14101775, 0.63248367, -0.87532827, -1.32275133, 0.01978741, -0.14671085, -1.05521662, 0.40408981, -0.02338397, -0.13490036, -0.04447539, 1.74174271, -0.02188144, 0.51412417, -0.59633053, 0.71741391, 0.79324606, -0.14084019, -0.24975723, 0.87418984, 0.11675874, -0.76452367, 0.33141206, 0.18592844, -1.07480724, 0.6472541, -1.48832534, -0.38231212, -0.25332417, -0.25638358, 0.68149747, 0.54311154, 2.01129709, -1.43876073, 0.53272536]);
  const b2 = new Float64Array([0.45261435, -0.58040696, 0.43784002, -0.13910446, -0.04917782, -1.18926154, -0.07066224, -0.07420014, -0.24871637, -0.40754841, -0.17683533, 0.12829796, -0.21241861, 0.12076317, -0.53071385, -0.73627336]);
  const W3 = new Float64Array([0.28760016, -0.65285029, 0.17789713, -0.37839225, -0.49782331, 0.20575594, -0.57984674, -0.06839554, -0.56013671, 1.4471775, 0.32217413, 0.26936003, 0.20922666, 0.85309594, 0.82658278, 0.15407085, 0.66951093, 0.5982665, 0.11036723, -0.05378329, -0.14516461, 0.6068251, 0.3924409, -0.27878296, -0.0267743, 0.42463176, 0.10916228, 0.31222802, 0.01673425, 0.39181743, 0.14771481, -0.15766715, -0.15471667, -0.03070172, 0.03738149, 0.30431959, -0.35748545, 0.26403693, -0.00691465, 0.18535786, -0.61252353, -0.10790325, -0.07356613, -0.34770727, 0.47243495, -0.1431949, -0.24873549, 0.88625045, -0.330639, 0.19223645, -0.04578304, -0.18134003, -0.20291801, 0.06774271, -0.09382678, -0.13392066, -0.20538409, 0.21255898, -0.19718467, 0.16805043, -0.07026935, 0.0300879, -0.49981019, 0.45200394, 0.80342781, 0.73019016, 0.21863719, -0.45671054, -0.51988824, 0.53328331, -0.41895041, -0.74322876, -0.08556457, 0.56082165, 0.03300213, 0.99750375, -0.23713926, 0.48294345, 0.72406865, 1.83102798]);
  const b3 = new Float64Array([0.15357762, -0.05741838, 0.28322824, 0.31032363, 0.52176329]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}


// ===== 다음 로봇 =====

function name(){ return "DNN-6"; }
function type(){ return Type.TANKER; }
function update(tank,enemies,allies,bulletInfo){
  // ===== DNN 기반 정책 =====
  // 입력: self + 상위 K개의 enemy/allies/bullets 특징
  // 출력: [move1, move2, move3, move4, fireAngle] (각도: 0~360)

  // 고정 하이퍼파라미터(플랫폼 상수)
  const W=900, H=600; const EMAX=150, SCL=700; const VX=10, VY=10;
  const EN_K=3, AL_K=2, BL_K=3;

  // 특징 벡터 구성
  function norm(v, s){ return s ? v/s : v; }
  function angleWrap(a){ a%=360; if(a<0)a+=360; return a; }

  function nearest(arr, k){
    const tmp = arr.map((e)=>({e, d: e.distance!==undefined? e.distance : Math.hypot((e.x||0)-tank.x,(e.y||0)-tank.y)}));
    tmp.sort((a,b)=>a.d-b.d);
    const out=[]; for(let i=0;i<k;i++){ out.push(tmp[i]? tmp[i].e:null); }
    return out;
  }

  const xSelf = [
    norm(tank.x, W),
    norm(tank.y, H),
    norm(tank.health, EMAX),
    norm(tank.energy, EMAX),
    norm(tank.size, 50),
    (tank.type===0?1:0),
    (tank.type===1?1:0),
    (tank.type===2?1:0),
  ];

  const ens = nearest(enemies, EN_K);
  const als = nearest(allies, AL_K);
  const bls = nearest(bulletInfo, BL_K);

  const xEn = [];
  for(let i=0;i<EN_K;i++){
    const e = ens[i];
    if(e){
      xEn.push( norm(e.x - tank.x, W), norm(e.y - tank.y, H), norm(e.health, EMAX), norm(e.distance, SCL) );
    } else {
      xEn.push(0,0,0,0);
    }
  }

  const xAl = [];
  for(let i=0;i<AL_K;i++){
    const a = als[i];
    if(a){
      xAl.push( norm(a.x - tank.x, W), norm(a.y - tank.y, H), norm(a.health, EMAX), norm(a.distance, SCL) );
    } else {
      xAl.push(0,0,0,0);
    }
  }

  const xBl = [];
  for(let i=0;i<BL_K;i++){
    const b = bls[i];
    if(b){
      xBl.push( norm(b.x - tank.x, W), norm(b.y - tank.y, H), norm(b.vx, VX), norm(b.vy, VY), norm(b.distance, SCL) );
    } else {
      xBl.push(0,0,0,0,0);
    }
  }

  const X = new Float64Array([].concat(xSelf, xEn, xAl, xBl));

  // 네트워크 파라미터
  const W1 = new Float64Array([0.43790552, 0.28667445, 0.29146866, -0.10083556, -0.10943076, -0.28717854, 0.34111587, 0.10557079, 0.55717376, -5.61994379, -0.27722839, 0.36063351, 0.0718853, 0.45636362, 0.40585164, 0.16047504, -0.23512074, 0.14881862, -0.33329282, 0.0648078, 0.29152137, 0.64120843, -0.05480317, -0.14874023, -0.40090724, -0.35002197, 0.3091271, 0.4051397, 0.85064322, -0.22651637, -0.16105264, 0.7006894, -0.28201989, 0.48340796, -0.23235781, -0.26979255, 0.43403731, 0.64313606, 0.96556927, 0.03570268, -0.15051028, 0.39582946, -0.22895588, 0.61818475, 0.40916528, -0.69208004, 0.4571102, 0.1735228, 1.07139671, -0.00031113, -0.33939067, 1.32194154, -1.74826511, -1.36365094, 0.25472051, 0.38659474, 0.35009458, -1.19683509, 1.00852354, 0.46808125, -0.52390067, -0.51198914, 1.72981892, 1.55383002, 0.44710828, 0.44927636, 0.90969231, -1.58195574, 1.07800668, -0.66734118, -0.48763575, 7.40851416, 0.54088755, 1.31914028, 0.64460509, 1.45555297, 4.97408468, 0.7954445, 1.2141104, 0.44066381, -0.39116369, 1.92661508, 0.39178036, -0.26493241, -0.00877638, -0.54047246, 0.43857311, 0.2628301, 0.28038817, -0.08991614, 0.00562096, 0.07909606, -0.33394848, 0.81173666, -0.99119724, -2.40418836, 0.20683362, 0.57010329, 0.50706288, 0.04475721, -1.6923782, 0.44234895, 0.28192312, -0.41569071, -0.40097114, -0.21270939, -1.48213758, -1.35673722, 0.64426118, 0.62463704, 1.62307793, 1.55368966, -0.52942548, 1.01280246, 0.46965761, 0.59909363, 0.57445636, -0.58310112, -0.35849256, -0.5103396, 0.97573035, 0.12385534, 0.42429294, -0.17578239, 0.15137795, 0.05255061, 0.21706019, -0.133915, 0.78614439, -0.36118624, 0.01983596, -0.4719965, -0.53748171, -0.06507518, -0.84473667, -0.21252155, 0.01425524, -0.2332369, 0.45602945, -0.0017205, -0.9220035, -0.86182999, 0.46711704, -0.22868938, -0.3984326, -0.56002579, 0.93126113, -0.76314673, -0.13618089, 1.6050381, 0.55343064, -1.25071673, 0.18836974, 1.05970012, -0.58777365, -0.42381295, -0.01989542, 1.21581512, -0.09301666, 0.57711358, 0.06524754, -0.93012569, -0.60666752, 0.03643859, -0.33341537, 0.06469217, -0.85885903, 0.12184405, -0.70331632, -0.35838915, 0.99211349, -0.11757183, 0.08672163, 0.47150356, 0.22588279, 0.56287101, 0.06258171, -0.14941481, -0.02253153, 0.1529853, -0.02648026, -4.14536007, 0.58905402, 0.58733332, -0.24634963, 0.26527182, -0.07549294, -0.08199109, -0.26349965, -0.50722975, 0.23642582, 0.52952442, -1.05311519, 0.77329085, -0.09639001, 0.29902959, 0.74671193, -0.1438305, -0.82805139, 0.74975143, 0.62837672, -0.02263945, 0.44817443, -0.01960781, -0.27410757, 0.58861762, 0.52108862, -0.34019261, 0.50618758, -0.33906053, 0.29810917, -1.06793901, 0.29261285, 0.49198256, 0.20554799, -1.13114923, -0.04443075, -0.71076359, 0.08113087, -0.58061603, 0.59296573, -0.3429898, 0.44819549, 1.59346377, -2.61945133, 0.0115471, -0.09130324, 1.55775826, 1.21915834, 0.01826581, -0.60943431, 0.55488353, 0.41412301, -0.18633928, -0.11519492, 0.14395246, -0.274614, 0.31022997, -0.88624122, -0.76087041, 0.84386313, -0.48345321, 0.53104081, 0.57218027, -2.55074843, -0.56367925, 0.05213854, -0.18528107, 1.71648284, -0.82593726, -0.52529301, -0.06369078, -1.29506084, 0.79300664, 0.52014037, -0.65330576, -0.37278706, -0.1183534, -0.30385234, 0.10153757, 0.50390224, 0.18589201, 0.1572268, 0.37320647, -0.24873547, 0.48522964, 0.61427802, -0.58838985, 1.27024363, 0.33047243, -0.88564803, -0.23824035, 0.9698733, -0.59554315, -0.63276144, 0.62563084, 0.67460072, -0.26991931, -0.42178144, -0.58483235, -0.07731733, 0.32731518, 0.38657588, -1.0380873, -0.04714119, 0.26012602, 1.85201329, 0.01056569, 0.37896189, -0.92339511, 1.60935713, 0.3519358, 1.01701588, 0.41334551, -0.8229241, 0.7446023, 0.19826225, 0.01837637, -0.18924691, -0.22272479, 0.39300219, -0.16064378, -0.01502117, 0.06694503, -0.21591942, -0.44848074, -0.57665888, -0.75902568, -0.18684585, 1.75812951, 2.52716162, 0.04624047, 0.08341713, -0.35477066, -0.79106952, 0.57576331, 0.32384616, 0.22890642, 0.11154918, 0.99016834, 0.27619942, 1.82128783, -1.1147363, -0.1514259, 0.49815359, 0.63262197, -0.85261822, -0.24408185, 0.04092865, -0.40898409, 0.2187659, 0.5939429, 0.25120273, 0.04767159, 0.61222427, -0.22889286, 0.15874019, 0.06538034, 1.04925303, 0.0977568, -1.03568249, -0.79114084, -0.67013313, -0.43621703, -0.45010369, 0.32875039, 0.50793556, -0.25741618, -0.45254671, -0.53803813, 0.16362462, -0.14334803, -0.19935954, -6.5311422, -0.02943762, -0.16420222, -0.10827991, 0.1547662, 1.04737688, -0.27820864, 0.04903922, 0.5033388, 0.63484467, 0.06518909, 1.4467137, 0.99559152, 0.0637428, -0.41627302, -0.52783621, -0.97442636, 0.41868684, 0.19327585, -0.08633218, -0.16769813, -0.02152273, 1.12148376, -0.24177989, -0.21112556, -0.55037804, 0.10022064, 0.32302101, 0.04755423, 0.04394149, -0.07573192, 0.23004496, 0.52188947, 0.47779696, -1.09222283, 0.05517106, -0.47166323, -0.30100395, -0.87782714, -0.63097463, -0.10320982, 0.19983009, -0.83486804, 0.76870876, -0.41389931, -0.95068899, -0.46939508, 0.11882143, 0.18213007, -0.85742938, -0.95910751, 0.01303034, 0.50021041, 0.21806978, -1.35411049, 0.33796412, 0.11304469, -0.27159458, 0.27671941, -0.63896321, -0.85718552, -0.10484049, 0.47597432, 0.66795252, 0.23523047, -0.32766585, -0.71392922, 0.32901856, -0.72913046, -0.32441547, 0.13735976, 0.28795793, -0.20754993, -0.41433265, 0.44773699, 0.12536568, -0.01509058, 0.19212788, 0.04281058, 0.33889086, -0.14777078, -0.66142111, -0.13231776, -0.88677939, -0.78521909, 0.33272822, 2.79950883, -0.72876622, -0.70469221, 0.14997329, -0.57367741, -0.32259341, -0.76819714, 0.75968589, 0.65307013, 0.07837013, -0.24464961, 0.75713633, -0.63777248, -0.09309103, -0.06051813, -0.12197373, 0.18103338, -0.32278231, -0.82417426, 0.15852481, -0.78133597, -0.45692952, 0.40125851, -0.66136018, -0.10561747, 0.40668301, -0.51587459, 0.57578647, -1.1929422, 0.21366893, 0.23895185, 0.13499196, 0.19411319, 0.07774001, 1.46468836, 0.04176726, 0.20548891, -0.58304135, 0.20610866, 1.37245001, 0.0715244, 0.60900116, -1.53037955, 1.42275085, -0.08166345, -0.26229319, 2.29872619, -0.09309751, 0.56090344, 0.42332203, 0.26195289, -0.43361581, 0.06926367, -0.02695036, -1.53261339, 0.81738667, 0.50243947, -1.26820652, -0.98084869, -0.53507638, 0.75451162, -0.33540848, -1.36245481, -1.60953541, -0.08722931, 0.30229661, -0.24172879, 0.38882719, -1.60314125, 0.62924454, 0.06807803, -0.15915038, -0.15915185, -0.41984272, 0.42976239, -0.03614878, 0.43237035, 0.02648312, -0.20609888, -0.09494591, -0.38808155, -0.19664323, -0.18316339, 0.55482654, -0.68394016, 2.24564119, -1.80847715, -0.47006498, -0.31210835, 0.51521929, -0.43384669, -0.76040579, -0.33059709, -0.15571589, -0.55749422, 0.13874144, 0.070883, -1.9380512, -0.57284265, 1.31700903, -2.15368892, 0.61544529, 0.36736054, -0.04128216, 0.0525769, 0.49134459, -0.31473704, 0.04358571, 0.09602795, -2.47298023, 0.83663427, 0.12020037, 0.60157181, 0.12494483, -2.54425341, -0.07002261, 0.4801155, 0.33224919, -0.08470422, -1.09316177, -0.04707545, 0.18678039, -0.05895869, 0.05456543, 0.05315762, -0.38052479, -0.11328626, 0.45199996, 0.10382705, 1.99747534, -0.19385167, -1.08943956, 0.16894069, -0.86439847, -0.58266749, -0.49794542, -0.56735153, -0.08085438, -0.62715865, -1.23537351, 0.78216862, -0.36249201, -1.08253244, 0.12590188, -0.2981104, 0.34463625, -0.80850699, -0.75057165, 0.89106056, 0.14711991, 0.43040693, 0.24400467, -0.28825202, 0.52935872, 0.55507687, 0.22138433, 0.24365673, -0.23308503, -0.07489313, 0.27984791, -0.45942712, 0.37620399, -0.24140955, 0.62330793, 0.77921792, 0.71123988, 0.02079538, -0.52510845, 0.32942113, 0.1607535, 0.96151555, -0.16079034, -1.93859221, -0.36190573, -0.19783436, 0.64001555, -0.11982791, 0.37611482, 0.78146002, -0.29536282, -0.291881, -0.1050257, 0.79742206, -0.17266075, -0.88210515, 0.71315302, 0.10720733, -0.15652838, -0.49973341, -0.45632669, 0.16452009, 2.48697164, 1.11017542, 0.47732019, -0.08347426, 2.54925165, 0.95313778, 0.79396991, 0.67585751, -0.20691878, 1.10924548, 0.55181554, -0.75626899, 0.69224745, -0.10301377, 0.60962182, -0.79353267, -0.04272982, 0.2881041, -0.27729901, -0.44808305, -0.16943179, -0.37507713, -0.19335074, -0.00148306, 3.19323577, 0.1035666, -0.57338948, 0.52968303, 0.32556781, -0.15723568, -0.12659113, 0.12663175, 0.09059224, 0.11972124, -0.07987135, 0.19573581, 1.66614221, -0.02746732, 0.01809177, 0.9322043, 0.23503757, -0.21352856, -0.54890718, -0.38095916, 0.54091449, -0.34022734, 0.72674154, 0.64074993, -0.76762368, -0.04648122, -0.29888653, -0.31396683, -0.18739208, 0.53936865, -0.41735965, -0.1562445, -0.2633629, -0.48597415, -0.08265106, -0.27398756, 0.01136865, 0.1887991, -0.06646916, 0.41479363, -0.09480974, -0.63911342, 2.50579508, 0.71400369, -0.11481813, 0.05201703, -0.11187266, -0.09966212, -0.55138482, -0.10820827, -1.15806636, -0.64752434, -0.86332061, -0.19997056, -2.14528927, -2.87757969, 0.7424284, -0.24504957, 1.32902126, -1.93770945, -0.61731616, 0.25588802, -1.34319156, 4.27656895, 1.87244775, -0.08158902, -0.3864889, -1.17278103, 0.52114927, -0.19224884, 0.10702464, 0.21013826, -0.61004765, -0.40792327, 0.57599278, -0.0397493, -0.41217899, 0.92912994, -0.23223925, 0.08743698, 0.46663486, 0.56753572, 0.32071805, -0.21116781, 0.40453932, -1.02160473, -1.84046832, -1.00500846, 0.60869917, 0.54639748, 0.26393022, -0.02675387, -0.32765293, -0.58487253, -0.79630644, -0.02546589, -0.66765198, -0.4398617, -0.35442079, -0.31269691, 0.0557983, -0.35000629, -0.48865672, 0.19870154, 0.5036284, 0.03823856, 0.99535683, -0.73840532, -0.59068848, -0.31840297, -0.0383206, 0.43449538, -0.02495137, -0.22737291, 0.67246412, -0.0403685, 0.63442454, -0.14994881, 0.03197217, 0.81119842, 1.60716682, 0.7331085, 0.21922967, 0.41034227, 0.34342446, 0.76305537, 0.42669919, 0.3550817, -1.06769092, -0.30641643, -1.34493604, -0.40432105, 0.05680819, -1.51733025, 0.72987137, 0.04370459, -0.0010694, -0.65229962, 0.21843868, 0.97331664, -3.29918687, -3.24643764, 0.29392696, 0.33741948, -1.37560109, -0.16699405, 0.27196616, -0.58381965, 1.81667367, 1.75141047, 1.97774891, 0.1396678, 1.58182969, 0.75116523, -0.61174129, 1.01652231, 0.85792504, 0.39826911, -0.8885599, -1.30460266, 0.14052694, 0.40016586, 0.73007537, 0.03082803, 0.0396427, -0.69563624, -0.03033443, -0.54946731, -0.6848278, -0.25859658, 0.14599258, -0.03088124, -0.13220514, -1.68072428, -0.09271895, -0.6630331, 0.33079586, 0.53328276, -0.64429227, 0.25992795, 1.29739499, -0.44481283, -0.76556351, -0.56668475, 2.47334204, -0.62998962, 0.65989463, 0.66443107, 0.98572862, 1.16980806, -0.35108564, 1.3472356, 5.94033877, 0.30974987, -0.83999408, 1.02026831, -0.15030077, 1.7298327, 0.32290212, 0.95685008, 2.61298772, 1.25082845, 0.80658685, -0.06049918, 0.00472654, 0.52354259, 0.31825409, 0.68213935, -0.05298223, 0.43634643, 0.3128813, -1.14961688, -0.25263141, 0.17612209, -0.78700307, -1.19793967, -0.0570563, 0.39552643, 0.25223549, 0.85410401, 0.04226136, 0.7672748, -0.81128183, 0.34537788, -0.08369965, -0.08769349, 1.60136065, 0.68536087, 0.86071233, 0.37937505, -1.62376555, 0.46391922, 0.03859705, 0.20528158, -1.69123894, -1.41628122, -0.13261515, -0.5322042, -0.07635726, -0.3460316, -1.44325928, 0.37801554, -0.1965497, -0.59632468, -1.10459054, -0.02814148, 0.63280748, -0.48001112, -0.27577878, -0.74510699, -0.17404939, 0.0409552, -0.31708707, 0.20400628, -0.19372669, 0.2039152, -0.87461198, 0.01023884, -3.18606041, -0.10653382, 0.35766341, -0.13387789, -0.4777505, 0.30275907, 0.23928922, 0.42820351, -0.34367539, -0.56442334, -0.671005, -0.493529, 0.08647177, -0.03925029, 0.06683962, 1.38893815, 0.05073875, -0.87379694, 0.77262228, -0.14076952, -0.00650348, -0.39342401, 0.2909445, -0.09741293, 0.24100898, -0.58485485, 0.40464968, 0.2530926, 0.21718034, 0.3653357, -0.63079716, 0.09079719, 0.59786396, 0.28176903, 0.91078974, -0.50806508, 0.17058284, 0.66246559, 0.52250169, 0.77092678, 1.67037803, -0.3148234, -0.62721196, 3.1307736, -0.23737039, -0.25403343, 0.26959777, -0.08163353, -0.84077738, 0.77060027, -1.08085227, 0.62796409, -0.47726477, 0.84447749, -1.54525213, -0.07011557, 0.53000478, 0.03092981, 0.42095566, 0.45938867, -0.45169126, 0.56525877, -0.40021603, 1.595647, 0.42221703, 0.56547121, 0.11456523, -0.61567926, 2.05573337, 0.25747906, 0.07542924, 0.46609067, -0.62387698, 0.6761681, 0.50903264, 0.28322544, -0.75403803, 0.21051104, -0.39142604, 0.78154273, -0.51775019, 0.01510606, 1.23920286, 0.77384772, 0.57167831, 0.18109808, -0.45302109, -0.86129097, -0.7482826, 0.07389122, -0.76530534, -0.33736896, 0.19241592, -0.47162977, -0.20982558, -0.67358201, 0.58463259, 0.24785388, -1.84949452, 0.11330084, -0.8019222, 1.50373494, -1.1112966, -0.5712871, 0.63816383, -2.36288388, -1.32599372, -0.3562986, 0.81400162, -0.68727144, -1.05544968, -1.57924127, 0.14167307, -0.59285951, -0.39955664, -0.30652663, -0.84222451, 0.15224943, 0.58428033, 0.34091398]);
  const b1 = new Float64Array([-0.38756922, -0.01529645, -0.55953228, 0.07328275, 0.3129152, 0.06458981, 0.32244239, -0.21778243, -0.84407298, -0.81866391, -0.14618679, 0.65203703, 0.22879418, -0.45532186, 0.76164877, -0.314204, -0.24818741, -0.53805022, -0.10354619, 0.21180893, 0.33213273, -0.29319018, 0.55788904, 0.4333498]);
  const W2 = new Float64Array([0.09408662, -0.3336107, 0.36611701, -0.11292449, -0.59773382, 0.10727941, -0.04072949, -0.55377516, 1.25220999, -0.31683503, -0.41767058, 0.58706581, -0.67541487, -0.95871286, 0.20463733, -1.01013991, -0.03276556, 0.59471819, -0.27019869, 0.09009908, 1.46542189, -0.22811529, -1.09586614, 0.96074048, 1.34545145, -0.1814754, 1.41500774, -0.24100818, 0.44782941, 1.16077169, -0.00972746, -0.46052183, -0.4810369, 0.71366344, -0.08967912, 0.4997682, 0.51976109, 0.69577377, 0.60622204, -0.65142191, -0.00241908, -0.54516251, 1.15591911, -0.47086452, 0.13457477, -0.12023731, 0.23095488, 1.41638319, 0.50639571, -0.17441286, 0.05495283, -1.19395757, -0.93771248, 0.44948852, -0.28754033, -1.06089319, -0.27942543, 0.01618807, -0.79634621, 0.98867083, -0.32474711, -0.2105568, -0.44205541, 0.1932159, 0.00407995, 0.49608229, -0.94538508, 0.71060845, 1.12277356, -0.35115785, -0.2035635, 1.57852399, -1.14811154, 0.16596729, 0.06889257, -0.41457082, -0.62527615, -0.02929614, 0.2690992, 1.09394444, -2.44932213, -0.09026784, -0.59504263, 0.48833538, -0.55208794, 0.65296831, -0.96156054, 0.51376285, -0.79230113, -0.44862232, 0.55084261, -0.01900226, -0.64967349, -0.16581617, 0.6975699, -0.51454857, -0.77123349, -0.08645361, -0.70749965, 0.18384816, -0.03472589, 0.91085324, -0.65609358, -0.86726516, 0.54576814, 0.24076681, -0.30840465, -0.5313792, 0.07682758, 0.76773534, 0.40358264, 0.27678244, 0.43462538, -1.03705345, 0.49026133, 0.01224966, 0.00974685, -0.66897054, 0.58847769, 0.49725306, 1.97786822, -0.65206801, -0.64586137, 0.12449402, 1.42084643, 1.08103177, -0.22622629, -0.07062538, 1.2315496, 0.08385384, -0.12809868, -0.46131045, 0.43899598, -0.68583177, -0.33213774, -0.81493566, 0.29286754, 0.27728822, -0.25053776, 0.41568725, 0.26782578, 0.31836444, -0.05486111, 0.05135012, 0.65099938, 0.48524417, -0.82651902, -0.13002597, 0.12020949, -1.49604353, 0.75119153, 0.55629104, 0.61860948, 0.5967996, 0.05401974, -1.36556147, 0.75489861, 0.53426738, -0.02746313, 1.42202116, 0.03970474, -0.66756951, -0.36067738, 0.91961792, -0.64077952, -0.79467445, 0.15859935, -0.33707813, 0.02555191, 0.47034752, -0.13964864, 0.84173122, 0.19963754, 0.72483867, -1.34620363, 0.30371552, -0.19587663, 0.31317233, -0.02417105, 0.76240676, 0.83051728, 0.54055567, 0.10106575, 0.52938981, 0.6412371, -0.00061729, -0.11836649, 0.25773459, -1.25443998, 0.45158464, -0.40685816, 0.10939157, -0.23629962, 0.4190113, 0.0151415, 1.65716366, 0.07956642, 0.02683256, -0.22190233, -0.52132491, 0.63351318, 0.54048019, 0.83168563, 0.0931095, 0.14586689, 0.87839571, 0.95732508, 0.07977731, -0.53589549, -0.52639608, 0.76511015, -1.04188714, 0.19347787, 0.22468825, 0.08811923, 0.08738243, -0.08969664, -0.11254295, -0.24766247, -0.2403831, -0.98462404, -1.11993064, 0.30585383, 0.03042275, 0.05862472, -0.33229928, 0.7199741, 0.62506505, 0.25443103, -0.30632027, 0.13891787, 1.26218249, 1.49375002, -0.47224676, -1.28802186, 1.21731295, -0.38098078, -0.20141237, 0.0993211, 0.58353299, 0.02704011, 0.51091819, 0.07117388, -0.01827415, -0.89567564, 0.41927815, -1.39582026, -0.1481669, 0.38432581, 0.57463461, 0.51060598, 0.17994721, 1.4035534, -0.25579197, -0.15656692, -0.49755301, 0.38289493, -0.65186062, 0.27202096, -0.43770286, -0.07496871, 0.24509695, 0.06285006, 0.80449349, 0.19586276, -0.20705442, -0.34880283, 0.16164587, -1.03384473, -0.35670064, 0.32451549, -0.01814135, -0.23833017, 0.14274742, 0.61819362, -0.33721972, -0.15776996, 0.52879497, 0.29705423, 0.14802691, -0.78058979, -0.82254937, -1.01415181, 0.35889543, 0.35376524, 0.28031242, -1.01927209, 0.01748123, 0.77965917, -1.70447032, 0.7109695, -0.2395605, -0.36057536, 0.89973435, -0.3373749, 0.68793303, 0.64306384, -0.39516895, -0.1502043, 0.3654599, -0.17567938, 0.18945543, -0.33888844, -0.55621169, -0.36094855, 0.11007959, 0.14841333, -1.14239413, 0.09839317, 0.15199876, -0.23190643, 0.83805994, -0.49730437, 0.29072051, 0.79214225, 0.14200635, 0.41466407, -0.09274874, -0.18816325, 0.33851638, -0.28400497, -0.61016419, 0.27116654, 0.42679709, -0.62641292, -0.06665195, 0.40810253, 0.26042455, 0.21158194, -0.31835846, 0.12977399, -0.81425096, 0.54051362, -0.6414509, 0.6629502, -0.33285372, 0.38625296, 0.96645365, -0.11185877, -0.23181832, 0.19703774, -0.83886375, 0.31942274, -0.44780846, -0.15595656, -0.38674412, -0.4624189, 0.33090536, 0.27492663, -1.14101775, 0.63248367, -0.87532827, -1.32275133, 0.01978741, -0.14671085, -1.05521662, 0.40408981, -0.02338397, -0.13490036, -0.04447539, 1.74174271, -0.02188144, 0.51412417, -0.59633053, 0.71741391, 0.79324606, -0.14084019, -0.24975723, 0.87418984, 0.11675874, -0.76452367, 0.33141206, 0.18592844, -1.07480724, 0.6472541, -1.48832534, -0.38231212, -0.25332417, -0.25638358, 0.68149747, 0.54311154, 2.01129709, -1.43876073, 0.53272536]);
  const b2 = new Float64Array([0.45261435, -0.58040696, 0.43784002, -0.13910446, -0.04917782, -1.18926154, -0.07066224, -0.07420014, -0.24871637, -0.40754841, -0.17683533, 0.12829796, -0.21241861, 0.12076317, -0.53071385, -0.73627336]);
  const W3 = new Float64Array([0.28760016, -0.65285029, 0.17789713, -0.37839225, -0.49782331, 0.20575594, -0.57984674, -0.06839554, -0.56013671, 1.4471775, 0.32217413, 0.26936003, 0.20922666, 0.85309594, 0.82658278, 0.15407085, 0.66951093, 0.5982665, 0.11036723, -0.05378329, -0.14516461, 0.6068251, 0.3924409, -0.27878296, -0.0267743, 0.42463176, 0.10916228, 0.31222802, 0.01673425, 0.39181743, 0.14771481, -0.15766715, -0.15471667, -0.03070172, 0.03738149, 0.30431959, -0.35748545, 0.26403693, -0.00691465, 0.18535786, -0.61252353, -0.10790325, -0.07356613, -0.34770727, 0.47243495, -0.1431949, -0.24873549, 0.88625045, -0.330639, 0.19223645, -0.04578304, -0.18134003, -0.20291801, 0.06774271, -0.09382678, -0.13392066, -0.20538409, 0.21255898, -0.19718467, 0.16805043, -0.07026935, 0.0300879, -0.49981019, 0.45200394, 0.80342781, 0.73019016, 0.21863719, -0.45671054, -0.51988824, 0.53328331, -0.41895041, -0.74322876, -0.08556457, 0.56082165, 0.03300213, 0.99750375, -0.23713926, 0.48294345, 0.72406865, 1.83102798]);
  const b3 = new Float64Array([0.15357762, -0.05741838, 0.28322824, 0.31032363, 0.52176329]);

  function dotRow(mat, cols, r, vec){
    let s=0, off=r*cols;
    for(let c=0;c<cols;c++){ s += mat[off+c]*vec[c]; }
    return s;
  }
  function tanh(x){ return Math.tanh(x); }

  const IN=43, H1=24, H2=16, OUT=5;
  const h1 = new Float64Array(H1);
  for(let i=0;i<H1;i++){ h1[i] = tanh(dotRow(W1, IN, i, X) + b1[i]); }
  const h2 = new Float64Array(H2);
  for(let i=0;i<H2;i++){ h2[i] = tanh(dotRow(W2, H1, i, h1) + b2[i]); }
  const y = new Float64Array(OUT);
  for(let i=0;i<OUT;i++){ y[i] = dotRow(W3, H2, i, h2) + b3[i]; }

  // 각도 변환: y in R -> [0,360)
  function toDeg(v){
    if (!(v===v) || !isFinite(v)) v = 0; // NaN/Infinity 방지
    return angleWrap((v*180/Math.PI));
  }

  const m1 = toDeg(y[0]);
  const m2 = toDeg(y[1]);
  const m3 = toDeg(y[2]);
  const m4 = toDeg(y[3]);
  const fA = toDeg(y[4]);

  // 사격 및 이동 시도 (DNN 출력만 사용)
  tank.fire(fA);
  if(tank.move(m1)) return;
  if(tank.move(m2)) return;
  if(tank.move(m3)) return;
  if(tank.move(m4)) return;
}
